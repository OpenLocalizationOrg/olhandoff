ms입니다. ContentId: e586a11a-870f-403b-8af8-4c2931589d26
제목: Windows PowerShell 직접와 관리

#Windows PowerShell 직접와 관리

Windows 10 또는 Windows Server 기술 미리 보기 Hyper-v 호스트에서 Windows 10 또는 Windows Server 기술 미리 보기 가상 컴퓨터를 원격으로 관리 하려면 PowerShell 직접 사용할 수 있습니다.
PowerShell 직접 가상 컴퓨터 또는 네트워크 구성 또는 Hyper-v 호스트에서 원격 관리 설정에 관계 없이 virtual machine 내 PowerShell 관리를 수 있습니다.
그러면 자동화 하 고 가상 컴퓨터 관리 및 구성 스크립트를 Hyper-v 관리자를 위한 더 쉽습니다.

PowerShell 직접 실행 하려면 두 가지가 있습니다.
* 만들고 PSSession cmdlet을 사용 하 여 직접 PowerShell 세션을 종료 합니다.
* Invoke-command cmdlet과 스크립트 또는 명령을 실행합니다

가상 컴퓨터 연결 (VMConnect)를 사용 하 여 이전 가상 컴퓨터를 관리 하는 경우 또는 [가상 컴퓨터에 대 한 가상 네트워크 구성](http://technet.microsoft.com/library/cc816585.aspx).

##만들고 PSSession cmdlet을 사용 하 여 직접 PowerShell 세션을 종료 합니다.

1. Hyper-v 호스트에서 관리자 권한으로 Windows PowerShell을 엽니다.
   
3. 가상 컴퓨터 이름 또는 GUID를 사용 하 여 세션을 만들려면 다음 명령 중 하나를 실행 합니다.
``` PowerShell
Enter-PSSession -VMName <VMName>
Enter-PSSession -VMGUID <VMGUID>
```

4. 에 필요한 모든 명령을 실행 합니다.
   세션을 만든 가상 컴퓨터에서 이러한 명령을 실행 합니다.
5. 완료 되 면 세션을 닫는 다음 명령을 실행 합니다.
``` PowerShell
Exit-PSSession 
```

> 참고: 세션 라면 않습니다에 있는지 확인-하지 Hyper-v 호스트에 연결 하는 가상 컴퓨터에 대 한 자격 증명 사용 중인 연결 합니다.

이러한 cmdlet에 대 한 자세한 참조 [Enter-pssession](http://technet.microsoft.com/library/hh849707.aspx) 및 [끝내기 PSSession](http://technet.microsoft.com/library/hh849743.aspx).

##Invoke-command cmdlet과 스크립트 또는 명령을 실행합니다

사용할 수는 [Invoke-command](http://technet.microsoft.com/library/hh849719.aspx) 가상 컴퓨터에 미리 결정된 된 일련의 명령 실행 하는 cmdlet입니다.
다음은 Invoke-command cmdlet을 사용 하는 방법의 예 여기서 PSTest는 가상 컴퓨터 이름 하 고 (foo.ps1)를 실행 하는 스크립트는 스크립트 폴더에 c: / 드라이브:

 ``` PowerShell
 Invoke-Command -VMName PSTest -FilePath C:\script\foo.ps1 
 ```

명령 중 하나를 실행 하려면 사용 된 **-ScriptBlock** 매개 변수:

 ``` PowerShell
 Invoke-Command -VMName PSTest -ScriptBlock { cmdlet } 
 ```

##PowerShell 직접 사용 하 여 필요한 사항이 있습니까?

가상 컴퓨터에서 직접 PowerShell 세션을 만들려면
* 가상 컴퓨터 호스트에서 로컬로 실행 되어야 합니다 및 부팅 합니다.
* Hyper-v 관리자를 사용 하는 호스트 컴퓨터에 로그인 해야 합니다.
* 가상 컴퓨터에 대 한 유효한 사용자 자격 증명을 제공 해야 합니다.
* 호스트 운영 체제가 Windows 10, Windows Server 기술 미리 보기, 또는 더 높은 버전을 실행 해야 합니다.
* 가상 컴퓨터가 Windows 10, Windows Server 기술 미리 보기, 또는 더 높은 버전을 실행 해야 합니다.

사용할 수는 [Get VM](http://technet.microsoft.com/library/hh848479.aspx) cmdlet는 자격 증명을 사용 하는 Hyper-v 관리자 역할이 있는지 확인 하 고 Vm 호스트에서 로컬로 실행 되 고 부팅 하는 참조 합니다.

##PowerShell 직접 사용 합니까?

참조 [PowerShell 직접 조각](../develop/powershell_snippets.md) 수많은 예도 사용자 환경에서 직접 PowerShell을 사용 하는 방법에 대 한 마찬가지로 위한 팁과 트릭 PowerShell 사용한 Hyper-v 스크립트 작성.






