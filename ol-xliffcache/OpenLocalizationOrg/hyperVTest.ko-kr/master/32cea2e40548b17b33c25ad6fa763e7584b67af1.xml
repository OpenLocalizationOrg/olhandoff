{
  "nodes": [
    {
      "pos": [
        27,
        94
      ],
      "content": "Customize HDInsight Clusters using script actions | Microsoft Azure"
    },
    {
      "pos": [
        113,
        387
      ],
      "content": "Learn how to add custom components to Linux-based HDInsight clusters using Script Actions. Script Actions are Bash scripts that run during cluster creation, and can be used to customize the cluster configuration or add additional services and utilities like Hue, Solr, or R.",
      "nodes": [
        {
          "content": "Learn how to add custom components to Linux-based HDInsight clusters using Script Actions.",
          "pos": [
            0,
            90
          ]
        },
        {
          "content": "Script Actions are Bash scripts that run during cluster creation, and can be used to customize the cluster configuration or add additional services and utilities like Hue, Solr, or R.",
          "pos": [
            91,
            274
          ]
        }
      ]
    },
    {
      "pos": [
        717,
        777
      ],
      "content": "Customize Linux-based HDInsight clusters using Script Action"
    },
    {
      "pos": [
        868,
        1186
      ],
      "content": "HDInsight provides a configuration option called <bpt id=\"p1\">**</bpt>Script Action<ept id=\"p1\">**</ept><ph id=\"ph3\"/> that invokes custom scripts, which define the customization to be performed on the cluster during the creation process. These scripts can be used to install additional software on a cluster, or to change the configuration of applications on a cluster.",
      "nodes": [
        {
          "content": "HDInsight provides a configuration option called <bpt id=\"p1\">**</bpt>Script Action<ept id=\"p1\">**</ept><ph id=\"ph3\"/> that invokes custom scripts, which define the customization to be performed on the cluster during the creation process.",
          "pos": [
            0,
            238
          ]
        },
        {
          "content": "These scripts can be used to install additional software on a cluster, or to change the configuration of applications on a cluster.",
          "pos": [
            239,
            370
          ]
        }
      ]
    },
    {
      "pos": [
        1190,
        1459
      ],
      "content": "<ph id=\"ph4\">[AZURE.NOTE]</ph><ph id=\"ph5\"/> The information in this article is specific to Linux-based HDInsight clusters. For a version of this article that is specific to Windows-based clusters, see <bpt id=\"p2\">[</bpt>Customize HDInsight clusters using Script Action (Windows)<ept id=\"p2\">](hdinsight-hadoop-customize-cluster.md)</ept>",
      "nodes": [
        {
          "content": "<ph id=\"ph4\">[AZURE.NOTE]</ph><ph id=\"ph5\"/> The information in this article is specific to Linux-based HDInsight clusters.",
          "pos": [
            0,
            123
          ]
        },
        {
          "content": "For a version of this article that is specific to Windows-based clusters, see <bpt id=\"p2\">[</bpt>Customize HDInsight clusters using Script Action (Windows)<ept id=\"p2\">](hdinsight-hadoop-customize-cluster.md)</ept>",
          "pos": [
            124,
            339
          ]
        }
      ]
    },
    {
      "pos": [
        1464,
        1509
      ],
      "content": "Script Action in the cluster creation process"
    },
    {
      "pos": [
        1511,
        1684
      ],
      "content": "Script Action is only used while a clusters is in the process of being created. The following diagram illustrates when Script Action is executed during the creation process:",
      "nodes": [
        {
          "content": "Script Action is only used while a clusters is in the process of being created.",
          "pos": [
            0,
            79
          ]
        },
        {
          "content": "The following diagram illustrates when Script Action is executed during the creation process:",
          "pos": [
            80,
            173
          ]
        }
      ]
    },
    {
      "pos": [
        1686,
        1779
      ],
      "content": "<ph id=\"ph6\">![</ph>HDInsight cluster customization and stages during cluster creation<ph id=\"ph7\">][img-hdi-cluster-states]</ph>"
    },
    {
      "pos": [
        1781,
        1969
      ],
      "content": "The script is ran while HDInsight is being configured. At this stage, the script is run in parallel on all the specified nodes in the cluster, and is ran with root privileges on the nodes.",
      "nodes": [
        {
          "content": "The script is ran while HDInsight is being configured.",
          "pos": [
            0,
            54
          ]
        },
        {
          "content": "At this stage, the script is run in parallel on all the specified nodes in the cluster, and is ran with root privileges on the nodes.",
          "pos": [
            55,
            188
          ]
        }
      ]
    },
    {
      "pos": [
        1973,
        2430
      ],
      "content": "<ph id=\"ph8\">[AZURE.NOTE]</ph><ph id=\"ph9\"/> Because you have root privileges on the cluster nodes when the script is ran, you can perform operations like stopping and starting services, including Hadoop-related services. If you stop services, you must ensure that the Ambari service and other Hadoop-related services are up and running before the script finishes running. These services are required to successfully ascertain the health and state of the cluster while it is being created.",
      "nodes": [
        {
          "content": "<ph id=\"ph8\">[AZURE.NOTE]</ph><ph id=\"ph9\"/> Because you have root privileges on the cluster nodes when the script is ran, you can perform operations like stopping and starting services, including Hadoop-related services.",
          "pos": [
            0,
            221
          ]
        },
        {
          "content": "If you stop services, you must ensure that the Ambari service and other Hadoop-related services are up and running before the script finishes running.",
          "pos": [
            222,
            372
          ]
        },
        {
          "content": "These services are required to successfully ascertain the health and state of the cluster while it is being created.",
          "pos": [
            373,
            489
          ]
        }
      ]
    },
    {
      "pos": [
        2432,
        2604
      ],
      "content": "Each cluster can accept multiple script actions that are invoked in the order in which they are specified. A script can be ran on the head nodes, the worker nodes, or both.",
      "nodes": [
        {
          "content": "Each cluster can accept multiple script actions that are invoked in the order in which they are specified.",
          "pos": [
            0,
            106
          ]
        },
        {
          "content": "A script can be ran on the head nodes, the worker nodes, or both.",
          "pos": [
            107,
            172
          ]
        }
      ]
    },
    {
      "pos": [
        2608,
        2954
      ],
      "content": "<ph id=\"ph10\">[AZURE.IMPORTANT]</ph><ph id=\"ph11\"/> Script actions must complete within 60 minutes, or they will timeout. During node provisioning, the script is ran concurrently with other setup and configuration processes. Competition for resources such as CPU time or network bandwidth may cause the script to take longer to finish than it does in your development environment.",
      "nodes": [
        {
          "content": "<ph id=\"ph10\">[AZURE.IMPORTANT]</ph><ph id=\"ph11\"/> Script actions must complete within 60 minutes, or they will timeout.",
          "pos": [
            0,
            121
          ]
        },
        {
          "content": "During node provisioning, the script is ran concurrently with other setup and configuration processes.",
          "pos": [
            122,
            224
          ]
        },
        {
          "content": "Competition for resources such as CPU time or network bandwidth may cause the script to take longer to finish than it does in your development environment.",
          "pos": [
            225,
            380
          ]
        }
      ]
    },
    {
      "pos": [
        2960,
        3213
      ],
      "content": "To minimize the time it takes to run the script, avoid tasks such as downloading and compiling applications from source. Instead, pre-compile the application and store the binary in Azure Blob storage so that it can quickly be downloaded to the cluster.",
      "nodes": [
        {
          "content": "To minimize the time it takes to run the script, avoid tasks such as downloading and compiling applications from source.",
          "pos": [
            0,
            120
          ]
        },
        {
          "content": "Instead, pre-compile the application and store the binary in Azure Blob storage so that it can quickly be downloaded to the cluster.",
          "pos": [
            121,
            253
          ]
        }
      ]
    },
    {
      "pos": [
        3219,
        3248
      ],
      "content": "Example Script Action scripts"
    },
    {
      "pos": [
        3250,
        3525
      ],
      "content": "Script Action scripts can be used from the Azure Portal, Azure PowerShell, or the HDInsight .NET SDK. This article shows how to use Script Action from the portal. To learn how to use PowerShell and .NET SDK to use Script Action, look at the samples listed in the table below.",
      "nodes": [
        {
          "content": "Script Action scripts can be used from the Azure Portal, Azure PowerShell, or the HDInsight .NET SDK.",
          "pos": [
            0,
            101
          ]
        },
        {
          "content": "This article shows how to use Script Action from the portal.",
          "pos": [
            102,
            162
          ]
        },
        {
          "content": "To learn how to use PowerShell and .NET SDK to use Script Action, look at the samples listed in the table below.",
          "pos": [
            163,
            275
          ]
        }
      ]
    },
    {
      "pos": [
        3527,
        3620
      ],
      "content": "HDInsight provides several scripts to install the following components on HDInsight clusters:"
    },
    {
      "pos": [
        3622,
        3626
      ],
      "content": "Name"
    },
    {
      "pos": [
        3629,
        3635
      ],
      "content": "Script"
    },
    {
      "pos": [
        3650,
        3665
      ],
      "content": "<bpt id=\"p3\">**</bpt>Install Hue<ept id=\"p3\">**</ept>"
    },
    {
      "pos": [
        3668,
        3843
      ],
      "content": "https://hdiconfigactions.blob.core.windows.net/linuxhueconfigactionv01/install-hue-uber-v01.sh. See <bpt id=\"p4\">[</bpt>Install and use Hue on HDInsight clusters<ept id=\"p4\">](hdinsight-hadoop-hue-linux.md)</ept>.",
      "nodes": [
        {
          "content": "https://hdiconfigactions.blob.core.windows.net/linuxhueconfigactionv01/install-hue-uber-v01.sh.",
          "pos": [
            0,
            95
          ]
        },
        {
          "content": "See <bpt id=\"p4\">[</bpt>Install and use Hue on HDInsight clusters<ept id=\"p4\">](hdinsight-hadoop-hue-linux.md)</ept>.",
          "pos": [
            96,
            213
          ]
        }
      ]
    },
    {
      "pos": [
        3844,
        3861
      ],
      "content": "<bpt id=\"p5\">**</bpt>Install Spark<ept id=\"p5\">**</ept>"
    },
    {
      "pos": [
        3864,
        4052
      ],
      "content": "https://hdiconfigactions.blob.core.windows.net/linuxsparkconfigactionv02/spark-installer-v02.sh. See <bpt id=\"p6\">[</bpt>Install and use Spark on HDInsight clusters<ept id=\"p6\">](hdinsight-hadoop-spark-install-linux.md)</ept>.",
      "nodes": [
        {
          "content": "https://hdiconfigactions.blob.core.windows.net/linuxsparkconfigactionv02/spark-installer-v02.sh.",
          "pos": [
            0,
            96
          ]
        },
        {
          "content": "See <bpt id=\"p6\">[</bpt>Install and use Spark on HDInsight clusters<ept id=\"p6\">](hdinsight-hadoop-spark-install-linux.md)</ept>.",
          "pos": [
            97,
            226
          ]
        }
      ]
    },
    {
      "pos": [
        4053,
        4066
      ],
      "content": "<bpt id=\"p7\">**</bpt>Install R<ept id=\"p7\">**</ept>"
    },
    {
      "pos": [
        4069,
        4241
      ],
      "content": "https://hdiconfigactions.blob.core.windows.net/linuxrconfigactionv01/r-installer-v01.sh. See <bpt id=\"p8\">[</bpt>Install and use R on HDInsight clusters<ept id=\"p8\">](hdinsight-hadoop-r-scripts-linux.md)</ept>.",
      "nodes": [
        {
          "content": "https://hdiconfigactions.blob.core.windows.net/linuxrconfigactionv01/r-installer-v01.sh.",
          "pos": [
            0,
            88
          ]
        },
        {
          "content": "See <bpt id=\"p8\">[</bpt>Install and use R on HDInsight clusters<ept id=\"p8\">](hdinsight-hadoop-r-scripts-linux.md)</ept>.",
          "pos": [
            89,
            210
          ]
        }
      ]
    },
    {
      "pos": [
        4242,
        4258
      ],
      "content": "<bpt id=\"p9\">**</bpt>Install Solr<ept id=\"p9\">**</ept>"
    },
    {
      "pos": [
        4261,
        4445
      ],
      "content": "https://hdiconfigactions.blob.core.windows.net/linuxsolrconfigactionv01/solr-installer-v01.sh. See <bpt id=\"p10\">[</bpt>Install and use Solr on HDInsight clusters<ept id=\"p10\">](hdinsight-hadoop-solr-install-linux.md)</ept>.",
      "nodes": [
        {
          "content": "https://hdiconfigactions.blob.core.windows.net/linuxsolrconfigactionv01/solr-installer-v01.sh.",
          "pos": [
            0,
            94
          ]
        },
        {
          "content": "See <bpt id=\"p10\">[</bpt>Install and use Solr on HDInsight clusters<ept id=\"p10\">](hdinsight-hadoop-solr-install-linux.md)</ept>.",
          "pos": [
            95,
            224
          ]
        }
      ]
    },
    {
      "pos": [
        4446,
        4464
      ],
      "content": "<bpt id=\"p11\">**</bpt>Install Giraph<ept id=\"p11\">**</ept>"
    },
    {
      "pos": [
        4467,
        4659
      ],
      "content": "https://hdiconfigactions.blob.core.windows.net/linuxgiraphconfigactionv01/giraph-installer-v01.sh. See <bpt id=\"p12\">[</bpt>Install and use Giraph on HDInsight clusters<ept id=\"p12\">](hdinsight-hadoop-giraph-install-linux.md)</ept>.",
      "nodes": [
        {
          "content": "https://hdiconfigactions.blob.core.windows.net/linuxgiraphconfigactionv01/giraph-installer-v01.sh.",
          "pos": [
            0,
            98
          ]
        },
        {
          "content": "See <bpt id=\"p12\">[</bpt>Install and use Giraph on HDInsight clusters<ept id=\"p12\">](hdinsight-hadoop-giraph-install-linux.md)</ept>.",
          "pos": [
            99,
            232
          ]
        }
      ]
    },
    {
      "pos": [
        4662,
        4689
      ],
      "content": "<bpt id=\"p13\">**</bpt>Pre-load Hive libraries<ept id=\"p13\">**</ept>"
    },
    {
      "pos": [
        4692,
        4882
      ],
      "content": "https://hdiconfigactions.blob.core.windows.net/linuxsetupcustomhivelibsv01/setup-customhivelibs-v01.sh. See <bpt id=\"p14\">[</bpt>Add Hive libraries on HDInsight clusters<ept id=\"p14\">](hdinsight-hadoop-add-hive-libraries.md)</ept>",
      "nodes": [
        {
          "content": "https://hdiconfigactions.blob.core.windows.net/linuxsetupcustomhivelibsv01/setup-customhivelibs-v01.sh.",
          "pos": [
            0,
            103
          ]
        },
        {
          "content": "See <bpt id=\"p14\">[</bpt>Add Hive libraries on HDInsight clusters<ept id=\"p14\">](hdinsight-hadoop-add-hive-libraries.md)</ept>",
          "pos": [
            104,
            230
          ]
        }
      ]
    },
    {
      "pos": [
        4889,
        4930
      ],
      "content": "Use a Script Action from the Azure Portal"
    },
    {
      "pos": [
        4935,
        5054
      ],
      "content": "Start creating a cluster as described at <bpt id=\"p15\">[</bpt>Create Hadoop clusters in HDInsight<ept id=\"p15\">](hdinsight-provision-clusters.md#portal)</ept>."
    },
    {
      "pos": [
        5059,
        5214
      ],
      "content": "Under <bpt id=\"p16\">__</bpt>Optional Configuration<ept id=\"p16\">__</ept>, for the <bpt id=\"p17\">**</bpt>Script Actions<ept id=\"p17\">**</ept><ph id=\"ph12\"/> blade, click <bpt id=\"p18\">**</bpt>add script action<ept id=\"p18\">**</ept><ph id=\"ph13\"/> to provide details about the script action, as shown below:"
    },
    {
      "pos": [
        5220,
        5337
      ],
      "content": "<ph id=\"ph14\">![</ph>Use Script Action to customize a cluster<ph id=\"ph15\">](./media/hdinsight-hadoop-customize-cluster-linux/HDI.CreateCluster.8.png)</ph>"
    },
    {
      "pos": [
        5345,
        5353
      ],
      "content": "Property"
    },
    {
      "pos": [
        5356,
        5361
      ],
      "content": "Value"
    },
    {
      "pos": [
        5395,
        5399
      ],
      "content": "Name"
    },
    {
      "pos": [
        5402,
        5439
      ],
      "content": "Specify a name for the script action."
    },
    {
      "pos": [
        5448,
        5458
      ],
      "content": "Script URI"
    },
    {
      "pos": [
        5461,
        5532
      ],
      "content": "Specify the URI to the script that is invoked to customize the cluster."
    },
    {
      "pos": [
        5541,
        5552
      ],
      "content": "Head/Worker"
    },
    {
      "pos": [
        5555,
        5655
      ],
      "content": "Specify the nodes (<bpt id=\"p19\">**</bpt>Head<ept id=\"p19\">**</ept>, <bpt id=\"p20\">**</bpt>Worker<ept id=\"p20\">**</ept>, or <bpt id=\"p21\">**</bpt>ZooKeeper<ept id=\"p21\">**</ept>) on which the customization script is run."
    },
    {
      "pos": [
        5664,
        5674
      ],
      "content": "Parameters"
    },
    {
      "pos": [
        5677,
        5727
      ],
      "content": "Specify the parameters, if required by the script."
    },
    {
      "pos": [
        5735,
        5828
      ],
      "content": "Press ENTER to add more than one script action to install multiple components on the cluster."
    },
    {
      "pos": [
        5833,
        5925
      ],
      "content": "Click <bpt id=\"p22\">**</bpt>Select<ept id=\"p22\">**</ept><ph id=\"ph16\"/> to save the script action configuration and continue with cluster creation."
    },
    {
      "pos": [
        5930,
        5987
      ],
      "content": "Use a Script Action from Azure Resource Manager templates"
    },
    {
      "pos": [
        5989,
        6262
      ],
      "content": "In this section, we use Azure Resource Manager (ARM) templates to create an HDInsight cluster and also use a script action to install custom components (R, in this example) on the cluster. This section provides a sample ARM template to create a cluster using script action.",
      "nodes": [
        {
          "content": "In this section, we use Azure Resource Manager (ARM) templates to create an HDInsight cluster and also use a script action to install custom components (R, in this example) on the cluster.",
          "pos": [
            0,
            188
          ]
        },
        {
          "content": "This section provides a sample ARM template to create a cluster using script action.",
          "pos": [
            189,
            273
          ]
        }
      ]
    },
    {
      "pos": [
        6268,
        6284
      ],
      "content": "Before you begin"
    },
    {
      "pos": [
        6288,
        6454
      ],
      "content": "For information about configuring a workstation to run HDInsight Powershell cmdlets, see <bpt id=\"p23\">[</bpt>Install and configure Azure PowerShell<ept id=\"p23\">](../powershell-install-configure.md)</ept>."
    },
    {
      "pos": [
        6457,
        6597
      ],
      "content": "For instructions on how to create ARM templates, see <bpt id=\"p24\">[</bpt>Authoring Azure Resource Manager templates<ept id=\"p24\">](../resource-group-authoring-templates.md)</ept>."
    },
    {
      "pos": [
        6600,
        6770
      ],
      "content": "If you have not previously used Azure PowerShell with Resource Manager, see <bpt id=\"p25\">[</bpt>Using Azure PowerShell with Azure Resource Manager<ept id=\"p25\">](../powershell-azure-resource-manager.md)</ept>."
    },
    {
      "pos": [
        6776,
        6811
      ],
      "content": "Create clusters using script action"
    },
    {
      "pos": [
        6816,
        7101
      ],
      "content": "Copy the following template to a location on your computer. This template installs R on headnode as well as worker nodes in the cluster. You can also verify if the JSON template is valid. Paste your template content into <bpt id=\"p26\">[</bpt>JSONLint<ept id=\"p26\">](http://jsonlint.com/)</ept>, an online JSON validaton tool.",
      "nodes": [
        {
          "content": "Copy the following template to a location on your computer.",
          "pos": [
            0,
            59
          ]
        },
        {
          "content": "This template installs R on headnode as well as worker nodes in the cluster.",
          "pos": [
            60,
            136
          ]
        },
        {
          "content": "You can also verify if the JSON template is valid.",
          "pos": [
            137,
            187
          ]
        },
        {
          "content": "Paste your template content into <bpt id=\"p26\">[</bpt>JSONLint<ept id=\"p26\">](http://jsonlint.com/)</ept>, an online JSON validaton tool.",
          "pos": [
            188,
            325
          ]
        }
      ]
    },
    {
      "pos": [
        14314,
        14456
      ],
      "content": "Start Azure PowerShell and Log in to your Azure account. After providing your credentials, the command returns information about your account.",
      "nodes": [
        {
          "content": "Start Azure PowerShell and Log in to your Azure account.",
          "pos": [
            0,
            56
          ]
        },
        {
          "content": "After providing your credentials, the command returns information about your account.",
          "pos": [
            57,
            142
          ]
        }
      ]
    },
    {
      "pos": [
        14642,
        14737
      ],
      "content": "If you have multiple subscriptions, provide the subscription id you wish to use for deployment."
    },
    {
      "pos": [
        14818,
        14982
      ],
      "content": "<ph id=\"ph17\">[AZURE.NOTE]</ph><ph id=\"ph18\"/> You can use <ph id=\"ph19\">`Get-AzureRmSubscription`</ph><ph id=\"ph20\"/> to get a list of all subscriptions associated with your account, which includes the subscription Id for each one."
    },
    {
      "pos": [
        14987,
        15196
      ],
      "content": "If you do not have an existing resource group, create a new resource group. Provide the name of the resource group and location that you need for your solution. A summary of the new resource group is returned.",
      "nodes": [
        {
          "content": "If you do not have an existing resource group, create a new resource group.",
          "pos": [
            0,
            75
          ]
        },
        {
          "content": "Provide the name of the resource group and location that you need for your solution.",
          "pos": [
            76,
            160
          ]
        },
        {
          "content": "A summary of the new resource group is returned.",
          "pos": [
            161,
            209
          ]
        }
      ]
    },
    {
      "pos": [
        15664,
        16121
      ],
      "content": "To create a new deployment for your resource group, run the <bpt id=\"p27\">**</bpt>New-AzureRmResourceGroupDeployment<ept id=\"p27\">**</ept><ph id=\"ph21\"/> command and provide the necessary parameters. The parameters will include a name for your deployment, the name of your resource group, and the path or URL to the template you created. If your template requires any parameters, you must pass those parameters as well. In this case, the script action to install R on the cluster does not require any parameters.",
      "nodes": [
        {
          "content": "To create a new deployment for your resource group, run the <bpt id=\"p27\">**</bpt>New-AzureRmResourceGroupDeployment<ept id=\"p27\">**</ept><ph id=\"ph21\"/> command and provide the necessary parameters.",
          "pos": [
            0,
            199
          ]
        },
        {
          "content": "The parameters will include a name for your deployment, the name of your resource group, and the path or URL to the template you created.",
          "pos": [
            200,
            337
          ]
        },
        {
          "content": "If your template requires any parameters, you must pass those parameters as well.",
          "pos": [
            338,
            419
          ]
        },
        {
          "content": "In this case, the script action to install R on the cluster does not require any parameters.",
          "pos": [
            420,
            512
          ]
        }
      ]
    },
    {
      "pos": [
        16351,
        16435
      ],
      "content": "When the resource group has been deployed, you will see a summary of the deployment."
    },
    {
      "pos": [
        16677,
        16775
      ],
      "content": "If your deployment fails, you can use the following cmdlets to get information about the failures."
    },
    {
      "pos": [
        16885,
        16926
      ],
      "content": "Use a Script Action from Azure PowerShell"
    },
    {
      "pos": [
        16928,
        17360
      ],
      "content": "In this section, we use the <bpt id=\"p28\">[</bpt>Add-AzureRmHDInsightScriptAction<ept id=\"p28\">](https://msdn.microsoft.com/library/mt603527.aspx)</ept><ph id=\"ph22\"/> cmdlet to invoke scripts by using Script Action to customize a cluster. Before proceeding, make sure you have installed and configured Azure PowerShell. For information about configuring a workstation to run HDInsight PowerShell cmdlets, see <bpt id=\"p29\">[</bpt>Install and configure Azure PowerShell<ept id=\"p29\">](../powershell-install-configure.md)</ept>.",
      "nodes": [
        {
          "content": "In this section, we use the <bpt id=\"p28\">[</bpt>Add-AzureRmHDInsightScriptAction<ept id=\"p28\">](https://msdn.microsoft.com/library/mt603527.aspx)</ept><ph id=\"ph22\"/> cmdlet to invoke scripts by using Script Action to customize a cluster.",
          "pos": [
            0,
            239
          ]
        },
        {
          "content": "Before proceeding, make sure you have installed and configured Azure PowerShell.",
          "pos": [
            240,
            320
          ]
        },
        {
          "content": "For information about configuring a workstation to run HDInsight PowerShell cmdlets, see <bpt id=\"p29\">[</bpt>Install and configure Azure PowerShell<ept id=\"p29\">](../powershell-install-configure.md)</ept>.",
          "pos": [
            321,
            527
          ]
        }
      ]
    },
    {
      "pos": [
        17362,
        17390
      ],
      "content": "Perform the following steps:"
    },
    {
      "pos": [
        17395,
        17465
      ],
      "content": "Open the Azure PowerShell console and declare the following variables:"
    },
    {
      "pos": [
        18296,
        18395
      ],
      "content": "Specify the configuration values (such as nodes in the cluster) and the default storage to be used."
    },
    {
      "pos": [
        18710,
        18847
      ],
      "content": "Use <bpt id=\"p30\">**</bpt>Add-AzureRmHDInsightScriptAction<ept id=\"p30\">**</ept><ph id=\"ph23\"/> cmdlet to invoke the script. The following example uses a script that installs R on the cluster:",
      "nodes": [
        {
          "content": "Use <bpt id=\"p30\">**</bpt>Add-AzureRmHDInsightScriptAction<ept id=\"p30\">**</ept><ph id=\"ph23\"/> cmdlet to invoke the script.",
          "pos": [
            0,
            124
          ]
        },
        {
          "content": "The following example uses a script that installs R on the cluster:",
          "pos": [
            125,
            192
          ]
        }
      ]
    },
    {
      "pos": [
        19332,
        19411
      ],
      "content": "The <bpt id=\"p31\">**</bpt>Add-AzureRmHDInsightScriptAction<ept id=\"p31\">**</ept><ph id=\"ph24\"/> cmdlet takes the following parameters:"
    },
    {
      "pos": [
        19419,
        19428
      ],
      "content": "Parameter"
    },
    {
      "pos": [
        19431,
        19441
      ],
      "content": "Definition"
    },
    {
      "pos": [
        19481,
        19487
      ],
      "content": "Config"
    },
    {
      "pos": [
        19490,
        19555
      ],
      "content": "Configuration object to which script action information is added."
    },
    {
      "pos": [
        19564,
        19568
      ],
      "content": "Name"
    },
    {
      "pos": [
        19571,
        19597
      ],
      "content": "Name of the script action."
    },
    {
      "pos": [
        19606,
        19614
      ],
      "content": "NodeType"
    },
    {
      "pos": [
        19617,
        19850
      ],
      "content": "Specifies the node on which the customization script is run. The valid values are <bpt id=\"p32\">**</bpt>HeadNode<ept id=\"p32\">**</ept><ph id=\"ph25\"/> (to install on the head node), <bpt id=\"p33\">**</bpt>WorkerNode<ept id=\"p33\">**</ept><ph id=\"ph26\"/> (to install on all the data nodes), or <bpt id=\"p34\">**</bpt>ZookeeperNode<ept id=\"p34\">**</ept><ph id=\"ph27\"/> (to install on the zookeeper node).",
      "nodes": [
        {
          "content": "Specifies the node on which the customization script is run.",
          "pos": [
            0,
            60
          ]
        },
        {
          "content": "The valid values are <bpt id=\"p32\">**</bpt>HeadNode<ept id=\"p32\">**</ept><ph id=\"ph25\"/> (to install on the head node), <bpt id=\"p33\">**</bpt>WorkerNode<ept id=\"p33\">**</ept><ph id=\"ph26\"/> (to install on all the data nodes), or <bpt id=\"p34\">**</bpt>ZookeeperNode<ept id=\"p34\">**</ept><ph id=\"ph27\"/> (to install on the zookeeper node).",
          "pos": [
            61,
            398
          ]
        }
      ]
    },
    {
      "pos": [
        19859,
        19869
      ],
      "content": "Parameters"
    },
    {
      "pos": [
        19872,
        19906
      ],
      "content": "Parameters required by the script."
    },
    {
      "pos": [
        19915,
        19918
      ],
      "content": "Uri"
    },
    {
      "pos": [
        19921,
        19970
      ],
      "content": "Specifies the URI to the script that is executed."
    },
    {
      "pos": [
        19977,
        20018
      ],
      "content": "Set the admin/HTTPS user for the cluster:"
    },
    {
      "pos": [
        20069,
        20134
      ],
      "content": "When prompted, enter 'admin' as the name, and provide a password."
    },
    {
      "pos": [
        20139,
        20163
      ],
      "content": "Set the SSH credentials:"
    },
    {
      "pos": [
        20209,
        20462
      ],
      "content": "When prompted, enter the SSH user name and password. If you want to secure the SSH account with a certificate instead of a password, use a blank password and set <ph id=\"ph28\">`$sshPublicKey`</ph><ph id=\"ph29\"/> to the contents of the certificate public key you wish to use. For example:",
      "nodes": [
        {
          "content": "When prompted, enter the SSH user name and password.",
          "pos": [
            0,
            52
          ]
        },
        {
          "content": "If you want to secure the SSH account with a certificate instead of a password, use a blank password and set <ph id=\"ph28\">`$sshPublicKey`</ph><ph id=\"ph29\"/> to the contents of the certificate public key you wish to use.",
          "pos": [
            53,
            274
          ]
        },
        {
          "content": "For example:",
          "pos": [
            275,
            287
          ]
        }
      ]
    },
    {
      "pos": [
        20538,
        20566
      ],
      "content": "Finally, create the cluster:"
    },
    {
      "pos": [
        20861,
        20986
      ],
      "content": "If you are using a public key to secure your SSH account, you must also specify <ph id=\"ph30\">`-SshPublicKey $sshPublicKey`</ph><ph id=\"ph31\"/> as a parameter."
    },
    {
      "pos": [
        20988,
        21046
      ],
      "content": "It can take several minutes before the cluster is created."
    },
    {
      "pos": [
        21051,
        21098
      ],
      "content": "Use a Script Action from the HDInsight .NET SDK"
    },
    {
      "pos": [
        21100,
        21375
      ],
      "content": "The HDInsight .NET SDK provides client libraries that makes it easier to work with HDInsight from a .NET application. For a code sample, see <bpt id=\"p35\">[</bpt>Create Linux-based clusters in HDInsight using the .NET SDK<ept id=\"p35\">](hdinsight-hadoop-create-linux-clusters-dotnet-sdk.md#use-script-action)</ept>.",
      "nodes": [
        {
          "content": "The HDInsight .NET SDK provides client libraries that makes it easier to work with HDInsight from a .NET application.",
          "pos": [
            0,
            117
          ]
        },
        {
          "content": "For a code sample, see <bpt id=\"p35\">[</bpt>Create Linux-based clusters in HDInsight using the .NET SDK<ept id=\"p35\">](hdinsight-hadoop-create-linux-clusters-dotnet-sdk.md#use-script-action)</ept>.",
          "pos": [
            118,
            315
          ]
        }
      ]
    },
    {
      "pos": [
        21381,
        21396
      ],
      "content": "Troubleshooting"
    },
    {
      "pos": [
        21398,
        21733
      ],
      "content": "You can use Ambari web UI to view information logged by scripts during cluster creation. However, if the cluster creation failed due to an error in the script, the logs are also available in the default storage account associated with the cluster. This section provides information on how to retrieve the logs using both these options.",
      "nodes": [
        {
          "content": "You can use Ambari web UI to view information logged by scripts during cluster creation.",
          "pos": [
            0,
            88
          ]
        },
        {
          "content": "However, if the cluster creation failed due to an error in the script, the logs are also available in the default storage account associated with the cluster.",
          "pos": [
            89,
            247
          ]
        },
        {
          "content": "This section provides information on how to retrieve the logs using both these options.",
          "pos": [
            248,
            335
          ]
        }
      ]
    },
    {
      "pos": [
        21739,
        21762
      ],
      "content": "Using the Ambari Web UI"
    },
    {
      "pos": [
        21767,
        21896
      ],
      "content": "In your browser, navigate to https://CLUSTERNAME.azurehdinsight.net. Replace CLUSTERNAME with the name of your HDInsight cluster.",
      "nodes": [
        {
          "content": "In your browser, navigate to https://CLUSTERNAME.azurehdinsight.net.",
          "pos": [
            0,
            68
          ]
        },
        {
          "content": "Replace CLUSTERNAME with the name of your HDInsight cluster.",
          "pos": [
            69,
            129
          ]
        }
      ]
    },
    {
      "pos": [
        21902,
        22045
      ],
      "content": "When prompted, enter the admin account name (admin) and password for the cluster. You may have to re-enter the admin credentials in a web form.",
      "nodes": [
        {
          "content": "When prompted, enter the admin account name (admin) and password for the cluster.",
          "pos": [
            0,
            81
          ]
        },
        {
          "content": "You may have to re-enter the admin credentials in a web form.",
          "pos": [
            82,
            143
          ]
        }
      ]
    },
    {
      "pos": [
        22050,
        22210
      ],
      "content": "From the bar at the top of the page, select the <bpt id=\"p36\">__</bpt>ops<ept id=\"p36\">__</ept><ph id=\"ph32\"/> entry. This will show a list of current and previous operations performed on the cluster through Ambari.",
      "nodes": [
        {
          "content": "From the bar at the top of the page, select the <bpt id=\"p36\">__</bpt>ops<ept id=\"p36\">__</ept><ph id=\"ph32\"/> entry.",
          "pos": [
            0,
            117
          ]
        },
        {
          "content": "This will show a list of current and previous operations performed on the cluster through Ambari.",
          "pos": [
            118,
            215
          ]
        }
      ]
    },
    {
      "pos": [
        22216,
        22319
      ],
      "content": "<ph id=\"ph33\">![</ph>Ambari web UI bar with ops selected<ph id=\"ph34\">](./media/hdinsight-hadoop-customize-cluster-linux/ambari-nav.png)</ph>"
    },
    {
      "pos": [
        22324,
        22459
      ],
      "content": "Find the entries that have <bpt id=\"p37\">__</bpt>run\\_customscriptaction<ept id=\"p37\">__</ept><ph id=\"ph35\"/> in the <bpt id=\"p38\">__</bpt>Operations<ept id=\"p38\">__</ept><ph id=\"ph36\"/> column. These are created when the Script Actions are ran.",
      "nodes": [
        {
          "content": "Find the entries that have <bpt id=\"p37\">__</bpt>run\\_customscriptaction<ept id=\"p37\">__</ept><ph id=\"ph35\"/> in the <bpt id=\"p38\">__</bpt>Operations<ept id=\"p38\">__</ept><ph id=\"ph36\"/> column.",
          "pos": [
            0,
            194
          ]
        },
        {
          "content": "These are created when the Script Actions are ran.",
          "pos": [
            195,
            245
          ]
        }
      ]
    },
    {
      "pos": [
        22465,
        22565
      ],
      "content": "<ph id=\"ph37\">![</ph>Screenshot of operations<ph id=\"ph38\">](./media/hdinsight-hadoop-customize-cluster-linux/ambariscriptaction.png)</ph>"
    },
    {
      "pos": [
        22571,
        22709
      ],
      "content": "Select this entry, and drill down through the links to view the STDOUT and STDERR output generated when the script was ran on the cluster."
    },
    {
      "pos": [
        22715,
        22759
      ],
      "content": "Access logs from the default storage account"
    },
    {
      "pos": [
        22761,
        22941
      ],
      "content": "If the cluster creation failed due to an error in script action, the script action logs can still be accessed directly from the default storage account associated with the cluster."
    },
    {
      "pos": [
        22945,
        23069
      ],
      "content": "The storage logs are available at <ph id=\"ph39\">`\\STORAGE_ACOCUNT_NAME\\DEFAULT_CONTAINER_NAME\\custom-scriptaction-logs\\CLUSTER_NAME\\DATE`</ph>."
    },
    {
      "pos": [
        23076,
        23187
      ],
      "content": "<ph id=\"ph40\">![</ph>Screenshot of operations<ph id=\"ph41\">](./media/hdinsight-hadoop-customize-cluster-linux/script_action_logs_in_storage.png)</ph>"
    },
    {
      "pos": [
        23193,
        23305
      ],
      "content": "Under this, the logs are organized separately for headnode, workdernode, and zookeeper nodes. Some examples are:",
      "nodes": [
        {
          "content": "Under this, the logs are organized separately for headnode, workdernode, and zookeeper nodes.",
          "pos": [
            0,
            93
          ]
        },
        {
          "content": "Some examples are:",
          "pos": [
            94,
            112
          ]
        }
      ]
    },
    {
      "pos": [
        23312,
        23390
      ],
      "content": "<bpt id=\"p39\">**</bpt>Headnode<ept id=\"p39\">**</ept><ph id=\"ph42\"/> - <ph id=\"ph43\">`&lt;uniqueidentifier&gt;AmbariDb-hn0-&lt;generated_value&gt;.cloudapp.net`</ph>"
    },
    {
      "pos": [
        23397,
        23478
      ],
      "content": "<bpt id=\"p40\">**</bpt>Worker node<ept id=\"p40\">**</ept><ph id=\"ph44\"/> - <ph id=\"ph45\">`&lt;uniqueidentifier&gt;AmbariDb-wn0-&lt;generated_value&gt;.cloudapp.net`</ph>"
    },
    {
      "pos": [
        23485,
        23569
      ],
      "content": "<bpt id=\"p41\">**</bpt>Zookeeper node<ept id=\"p41\">**</ept><ph id=\"ph46\"/> - <ph id=\"ph47\">`&lt;uniqueidentifier&gt;AmbariDb-zk0-&lt;generated_value&gt;.cloudapp.net`</ph>"
    },
    {
      "pos": [
        23573,
        23842
      ],
      "content": "All stdout and stderr of the corresponding host is uploaded to the storage account. There is one <bpt id=\"p42\">**</bpt>output-\\*.txt<ept id=\"p42\">**</ept><ph id=\"ph48\"/> and <bpt id=\"p43\">**</bpt>errors-\\*.txt<ept id=\"p43\">**</ept><ph id=\"ph49\"/> for each script action. The output-*.txt file contains information about the URI of the script that got run on the host. For example",
      "nodes": [
        {
          "content": "All stdout and stderr of the corresponding host is uploaded to the storage account.",
          "pos": [
            0,
            83
          ]
        },
        {
          "content": "There is one <bpt id=\"p42\">**</bpt>output-\\*.txt<ept id=\"p42\">**</ept><ph id=\"ph48\"/> and <bpt id=\"p43\">**</bpt>errors-\\*.txt<ept id=\"p43\">**</ept><ph id=\"ph49\"/> for each script action.",
          "pos": [
            84,
            270
          ]
        },
        {
          "content": "The output-*.txt file contains information about the URI of the script that got run on the host.",
          "pos": [
            271,
            367
          ]
        },
        {
          "content": "For example",
          "pos": [
            368,
            379
          ]
        }
      ]
    },
    {
      "pos": [
        23984,
        24247
      ],
      "content": "It's possible that you repeatedly create a script action cluster with the same name. In such case, you can distinguish the relevant logs based on the DATE folder name. For example, the folder structure for a cluster (mycluster) created on different dates will be:",
      "nodes": [
        {
          "content": "It's possible that you repeatedly create a script action cluster with the same name.",
          "pos": [
            0,
            84
          ]
        },
        {
          "content": "In such case, you can distinguish the relevant logs based on the DATE folder name.",
          "pos": [
            85,
            167
          ]
        },
        {
          "content": "For example, the folder structure for a cluster (mycluster) created on different dates will be:",
          "pos": [
            168,
            263
          ]
        }
      ]
    },
    {
      "pos": [
        24449,
        24588
      ],
      "content": "If you create a script action cluster with the same name on the same day, you can use the unique prefix to identify the relevant log files."
    },
    {
      "pos": [
        24592,
        24770
      ],
      "content": "If you create a cluster at the end of the day, it's possible that the log files span across two days. In such cases, you will see two different date folders for the same cluster.",
      "nodes": [
        {
          "content": "If you create a cluster at the end of the day, it's possible that the log files span across two days.",
          "pos": [
            0,
            101
          ]
        },
        {
          "content": "In such cases, you will see two different date folders for the same cluster.",
          "pos": [
            102,
            178
          ]
        }
      ]
    },
    {
      "pos": [
        24774,
        24980
      ],
      "content": "Uploading log files to the default container can take up to 5 mins, especially for large clusters. So, if you want to access the logs, you should not immediately delete the cluster if a script action fails.",
      "nodes": [
        {
          "content": "Uploading log files to the default container can take up to 5 mins, especially for large clusters.",
          "pos": [
            0,
            98
          ]
        },
        {
          "content": "So, if you want to access the logs, you should not immediately delete the cluster if a script action fails.",
          "pos": [
            99,
            206
          ]
        }
      ]
    },
    {
      "pos": [
        24986,
        25045
      ],
      "content": "Support for open-source software used on HDInsight clusters"
    },
    {
      "pos": [
        25047,
        25556
      ],
      "content": "The Microsoft Azure HDInsight service is a flexible platform that enables you to build big-data applications in the cloud by using an ecosystem of open-source technologies formed around Hadoop. Microsoft Azure provides a general level of support for open-source technologies, as discussed in the <bpt id=\"p44\">**</bpt>Support Scope<ept id=\"p44\">**</ept><ph id=\"ph52\"/> section of the <bpt id=\"p45\">[</bpt>Azure Support FAQ website<ept id=\"p45\">](https://azure.microsoft.com/support/faq/)</ept>. The HDInsight service provides an additional level of support for some of the components, as described below.",
      "nodes": [
        {
          "content": "The Microsoft Azure HDInsight service is a flexible platform that enables you to build big-data applications in the cloud by using an ecosystem of open-source technologies formed around Hadoop.",
          "pos": [
            0,
            193
          ]
        },
        {
          "content": "Microsoft Azure provides a general level of support for open-source technologies, as discussed in the <bpt id=\"p44\">**</bpt>Support Scope<ept id=\"p44\">**</ept><ph id=\"ph52\"/> section of the <bpt id=\"p45\">[</bpt>Azure Support FAQ website<ept id=\"p45\">](https://azure.microsoft.com/support/faq/)</ept>.",
          "pos": [
            194,
            494
          ]
        },
        {
          "content": "The HDInsight service provides an additional level of support for some of the components, as described below.",
          "pos": [
            495,
            604
          ]
        }
      ]
    },
    {
      "pos": [
        25558,
        25648
      ],
      "content": "There are two types of open-source components that are available in the HDInsight service:"
    },
    {
      "pos": [
        25652,
        26051
      ],
      "content": "<bpt id=\"p46\">**</bpt>Built-in components<ept id=\"p46\">**</ept><ph id=\"ph53\"/> - These components are pre-installed on HDInsight clusters and provide core functionality of the cluster. For example, YARN ResourceManager, the Hive query language (HiveQL), and the Mahout library belong to this category. A full list of cluster components is available in <bpt id=\"p47\">[</bpt>What's new in the Hadoop cluster versions provided by HDInsight?<ept id=\"p47\">](hdinsight-component-versioning.md)</ept>.",
      "nodes": [
        {
          "content": "<bpt id=\"p46\">**</bpt>Built-in components<ept id=\"p46\">**</ept><ph id=\"ph53\"/> - These components are pre-installed on HDInsight clusters and provide core functionality of the cluster.",
          "pos": [
            0,
            184
          ]
        },
        {
          "content": "For example, YARN ResourceManager, the Hive query language (HiveQL), and the Mahout library belong to this category.",
          "pos": [
            185,
            301
          ]
        },
        {
          "content": "A full list of cluster components is available in <bpt id=\"p47\">[</bpt>What's new in the Hadoop cluster versions provided by HDInsight?<ept id=\"p47\">](hdinsight-component-versioning.md)</ept>.",
          "pos": [
            302,
            494
          ]
        }
      ]
    },
    {
      "pos": [
        26055,
        26205
      ],
      "content": "<bpt id=\"p48\">**</bpt>Custom components<ept id=\"p48\">**</ept><ph id=\"ph54\"/> - You, as a user of the cluster, can install or use in your workload any component available in the community or created by you."
    },
    {
      "pos": [
        26209,
        26382
      ],
      "content": "<ph id=\"ph55\">[AZURE.WARNING]</ph><ph id=\"ph56\"/> Components provided with the HDInsight cluster are fully supported and Microsoft Support will help to isolate and resolve issues related to these components."
    },
    {
      "pos": [
        26387,
        27052
      ],
      "content": "Custom components receive commercially reasonable support to help you to further troubleshoot the issue. This might result in resolving the issue OR asking you to engage available channels for the open source technologies where deep expertise for that technology is found. For example, there are many community sites that can be used, like: <bpt id=\"p49\">[</bpt>MSDN forum for HDInsight<ept id=\"p49\">](https://social.msdn.microsoft.com/Forums/azure/en-US/home?forum=hdinsight)</ept>, <bpt id=\"p50\">[</bpt>http://stackoverflow.com<ept id=\"p50\">](http://stackoverflow.com)</ept>. Also Apache projects have project sites on <bpt id=\"p51\">[</bpt>http://apache.org<ept id=\"p51\">](http://apache.org)</ept>, for example: <bpt id=\"p52\">[</bpt>Hadoop<ept id=\"p52\">](http://hadoop.apache.org/)</ept>, <bpt id=\"p53\">[</bpt>Spark<ept id=\"p53\">](http://spark.apache.org/)</ept>.",
      "nodes": [
        {
          "content": "Custom components receive commercially reasonable support to help you to further troubleshoot the issue.",
          "pos": [
            0,
            104
          ]
        },
        {
          "content": "This might result in resolving the issue OR asking you to engage available channels for the open source technologies where deep expertise for that technology is found.",
          "pos": [
            105,
            272
          ]
        },
        {
          "content": "For example, there are many community sites that can be used, like: <bpt id=\"p49\">[</bpt>MSDN forum for HDInsight<ept id=\"p49\">](https://social.msdn.microsoft.com/Forums/azure/en-US/home?forum=hdinsight)</ept>, <bpt id=\"p50\">[</bpt>http://stackoverflow.com<ept id=\"p50\">](http://stackoverflow.com)</ept>.",
          "pos": [
            273,
            577
          ]
        },
        {
          "content": "Also Apache projects have project sites on <bpt id=\"p51\">[</bpt>http://apache.org<ept id=\"p51\">](http://apache.org)</ept>, for example: <bpt id=\"p52\">[</bpt>Hadoop<ept id=\"p52\">](http://hadoop.apache.org/)</ept>, <bpt id=\"p53\">[</bpt>Spark<ept id=\"p53\">](http://spark.apache.org/)</ept>.",
          "pos": [
            578,
            865
          ]
        }
      ]
    },
    {
      "pos": [
        27054,
        27323
      ],
      "content": "The HDInsight service provides several ways to use custom components. Regardless of how a component is used or installed on the cluster, the same level of support applies. Below is a list of the most common ways that custom components can be used on HDInsight clusters:",
      "nodes": [
        {
          "content": "The HDInsight service provides several ways to use custom components.",
          "pos": [
            0,
            69
          ]
        },
        {
          "content": "Regardless of how a component is used or installed on the cluster, the same level of support applies.",
          "pos": [
            70,
            171
          ]
        },
        {
          "content": "Below is a list of the most common ways that custom components can be used on HDInsight clusters:",
          "pos": [
            172,
            269
          ]
        }
      ]
    },
    {
      "pos": [
        27328,
        27445
      ],
      "content": "Job submission - Hadoop or other types of jobs that execute or use custom components can be submitted to the cluster."
    },
    {
      "pos": [
        27450,
        27601
      ],
      "content": "Cluster customization - During cluster creation, you can specify additional settings and custom components that will be installed on the cluster nodes."
    },
    {
      "pos": [
        27606,
        27794
      ],
      "content": "Samples - For popular custom components, Microsoft and others may provide samples of how these components can be used on the HDInsight clusters. These samples are provided without support.",
      "nodes": [
        {
          "content": "Samples - For popular custom components, Microsoft and others may provide samples of how these components can be used on the HDInsight clusters.",
          "pos": [
            0,
            144
          ]
        },
        {
          "content": "These samples are provided without support.",
          "pos": [
            145,
            188
          ]
        }
      ]
    },
    {
      "pos": [
        27799,
        27809
      ],
      "content": "Next steps"
    },
    {
      "pos": [
        27811,
        27911
      ],
      "content": "See the following for information and examples on creating and using scripts to customize a cluster:"
    },
    {
      "pos": [
        27915,
        28002
      ],
      "content": "<bpt id=\"p54\">[</bpt>Develop Script Action scripts for HDInsight<ept id=\"p54\">](hdinsight-hadoop-script-actions-linux.md)</ept>"
    },
    {
      "pos": [
        28005,
        28091
      ],
      "content": "<bpt id=\"p55\">[</bpt>Install and use Spark on HDInsight clusters<ept id=\"p55\">](hdinsight-hadoop-spark-install-linux.md)</ept>"
    },
    {
      "pos": [
        28094,
        28172
      ],
      "content": "<bpt id=\"p56\">[</bpt>Install and use R on HDInsight clusters<ept id=\"p56\">](hdinsight-hadoop-r-scripts-linux.md)</ept>"
    },
    {
      "pos": [
        28175,
        28259
      ],
      "content": "<bpt id=\"p57\">[</bpt>Install and use Solr on HDInsight clusters<ept id=\"p57\">](hdinsight-hadoop-solr-install-linux.md)</ept>"
    },
    {
      "pos": [
        28262,
        28350
      ],
      "content": "<bpt id=\"p58\">[</bpt>Install and use Giraph on HDInsight clusters<ept id=\"p58\">](hdinsight-hadoop-giraph-install-linux.md)</ept>"
    }
  ],
  "content": "<properties\n    pageTitle=\"Customize HDInsight Clusters using script actions | Microsoft Azure\"\n    description=\"Learn how to add custom components to Linux-based HDInsight clusters using Script Actions. Script Actions are Bash scripts that run during cluster creation, and can be used to customize the cluster configuration or add additional services and utilities like Hue, Solr, or R.\"\n    services=\"hdinsight\"\n    documentationCenter=\"\"\n    authors=\"Blackmist\"\n    manager=\"paulettm\"\n    editor=\"cgronlun\"\n    tags=\"azure-portal\"/>\n\n<tags\n    ms.service=\"hdinsight\"\n    ms.workload=\"big-data\"\n    ms.tgt_pltfrm=\"na\"\n    ms.devlang=\"na\"\n    ms.topic=\"article\"\n    ms.date=\"02/16/2016\"\n    ms.author=\"larryfr\"/>\n\n# Customize Linux-based HDInsight clusters using Script Action\n\n[AZURE.INCLUDE [selector](../../includes/hdinsight-create-windows-cluster-selector.md)]\n\nHDInsight provides a configuration option called **Script Action** that invokes custom scripts, which define the customization to be performed on the cluster during the creation process. These scripts can be used to install additional software on a cluster, or to change the configuration of applications on a cluster.\n\n> [AZURE.NOTE] The information in this article is specific to Linux-based HDInsight clusters. For a version of this article that is specific to Windows-based clusters, see [Customize HDInsight clusters using Script Action (Windows)](hdinsight-hadoop-customize-cluster.md)\n\n## Script Action in the cluster creation process\n\nScript Action is only used while a clusters is in the process of being created. The following diagram illustrates when Script Action is executed during the creation process:\n\n![HDInsight cluster customization and stages during cluster creation][img-hdi-cluster-states]\n\nThe script is ran while HDInsight is being configured. At this stage, the script is run in parallel on all the specified nodes in the cluster, and is ran with root privileges on the nodes.\n\n> [AZURE.NOTE] Because you have root privileges on the cluster nodes when the script is ran, you can perform operations like stopping and starting services, including Hadoop-related services. If you stop services, you must ensure that the Ambari service and other Hadoop-related services are up and running before the script finishes running. These services are required to successfully ascertain the health and state of the cluster while it is being created.\n\nEach cluster can accept multiple script actions that are invoked in the order in which they are specified. A script can be ran on the head nodes, the worker nodes, or both.\n\n> [AZURE.IMPORTANT] Script actions must complete within 60 minutes, or they will timeout. During node provisioning, the script is ran concurrently with other setup and configuration processes. Competition for resources such as CPU time or network bandwidth may cause the script to take longer to finish than it does in your development environment.\n> \n> To minimize the time it takes to run the script, avoid tasks such as downloading and compiling applications from source. Instead, pre-compile the application and store the binary in Azure Blob storage so that it can quickly be downloaded to the cluster.\n\n\n## Example Script Action scripts\n\nScript Action scripts can be used from the Azure Portal, Azure PowerShell, or the HDInsight .NET SDK. This article shows how to use Script Action from the portal. To learn how to use PowerShell and .NET SDK to use Script Action, look at the samples listed in the table below.\n\nHDInsight provides several scripts to install the following components on HDInsight clusters:\n\nName | Script\n----- | -----\n**Install Hue** | https://hdiconfigactions.blob.core.windows.net/linuxhueconfigactionv01/install-hue-uber-v01.sh. See [Install and use Hue on HDInsight clusters](hdinsight-hadoop-hue-linux.md).\n**Install Spark** | https://hdiconfigactions.blob.core.windows.net/linuxsparkconfigactionv02/spark-installer-v02.sh. See [Install and use Spark on HDInsight clusters](hdinsight-hadoop-spark-install-linux.md).\n**Install R** | https://hdiconfigactions.blob.core.windows.net/linuxrconfigactionv01/r-installer-v01.sh. See [Install and use R on HDInsight clusters](hdinsight-hadoop-r-scripts-linux.md).\n**Install Solr** | https://hdiconfigactions.blob.core.windows.net/linuxsolrconfigactionv01/solr-installer-v01.sh. See [Install and use Solr on HDInsight clusters](hdinsight-hadoop-solr-install-linux.md).\n**Install Giraph** | https://hdiconfigactions.blob.core.windows.net/linuxgiraphconfigactionv01/giraph-installer-v01.sh. See [Install and use Giraph on HDInsight clusters](hdinsight-hadoop-giraph-install-linux.md).\n| **Pre-load Hive libraries** | https://hdiconfigactions.blob.core.windows.net/linuxsetupcustomhivelibsv01/setup-customhivelibs-v01.sh. See [Add Hive libraries on HDInsight clusters](hdinsight-hadoop-add-hive-libraries.md) |\n\n## Use a Script Action from the Azure Portal\n\n1. Start creating a cluster as described at [Create Hadoop clusters in HDInsight](hdinsight-provision-clusters.md#portal).\n\n2. Under __Optional Configuration__, for the **Script Actions** blade, click **add script action** to provide details about the script action, as shown below:\n\n    ![Use Script Action to customize a cluster](./media/hdinsight-hadoop-customize-cluster-linux/HDI.CreateCluster.8.png)\n\n    | Property | Value |\n    | -------- | ----- |\n    | Name | Specify a name for the script action. |\n    | Script URI | Specify the URI to the script that is invoked to customize the cluster. |\n    | Head/Worker | Specify the nodes (**Head**, **Worker**, or **ZooKeeper**) on which the customization script is run. |\n    | Parameters | Specify the parameters, if required by the script. |\n\n    Press ENTER to add more than one script action to install multiple components on the cluster.\n\n3. Click **Select** to save the script action configuration and continue with cluster creation.\n\n## Use a Script Action from Azure Resource Manager templates\n\nIn this section, we use Azure Resource Manager (ARM) templates to create an HDInsight cluster and also use a script action to install custom components (R, in this example) on the cluster. This section provides a sample ARM template to create a cluster using script action.\n\n### Before you begin\n\n* For information about configuring a workstation to run HDInsight Powershell cmdlets, see [Install and configure Azure PowerShell](../powershell-install-configure.md).\n* For instructions on how to create ARM templates, see [Authoring Azure Resource Manager templates](../resource-group-authoring-templates.md).\n* If you have not previously used Azure PowerShell with Resource Manager, see [Using Azure PowerShell with Azure Resource Manager](../powershell-azure-resource-manager.md).\n\n### Create clusters using script action\n\n1. Copy the following template to a location on your computer. This template installs R on headnode as well as worker nodes in the cluster. You can also verify if the JSON template is valid. Paste your template content into [JSONLint](http://jsonlint.com/), an online JSON validaton tool.\n\n            {\n            \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n            \"contentVersion\": \"1.0.0.0\",\n            \"parameters\": {\n                \"clusterLocation\": {\n                    \"type\": \"string\",\n                    \"defaultValue\": \"West US\",\n                    \"allowedValues\": [ \"West US\" ]\n                },\n                \"clusterName\": {\n                    \"type\": \"string\"\n                },\n                \"clusterUserName\": {\n                    \"type\": \"string\",\n                    \"defaultValue\": \"admin\"\n                },\n                \"clusterUserPassword\": {\n                    \"type\": \"securestring\"\n                },\n                \"sshUserName\": {\n                    \"type\": \"string\",\n                    \"defaultValue\": \"username\"\n                },\n                \"sshPassword\": {\n                    \"type\": \"securestring\"\n                },\n                \"clusterStorageAccountName\": {\n                    \"type\": \"string\"\n                },\n                \"clusterStorageAccountResourceGroup\": {\n                    \"type\": \"string\"\n                },\n                \"clusterStorageType\": {\n                    \"type\": \"string\",\n                    \"defaultValue\": \"Standard_LRS\",\n                    \"allowedValues\": [\n                        \"Standard_LRS\",\n                        \"Standard_GRS\",\n                        \"Standard_ZRS\"\n                    ]\n                },\n                \"clusterStorageAccountContainer\": {\n                    \"type\": \"string\"\n                },\n                \"clusterHeadNodeCount\": {\n                    \"type\": \"int\",\n                    \"defaultValue\": 1\n                },\n                \"clusterWorkerNodeCount\": {\n                    \"type\": \"int\",\n                    \"defaultValue\": 2\n                }\n            },\n            \"variables\": {\n            },\n            \"resources\": [\n                {\n                    \"name\": \"[parameters('clusterStorageAccountName')]\",\n                    \"type\": \"Microsoft.Storage/storageAccounts\",\n                    \"location\": \"[parameters('clusterLocation')]\",\n                    \"apiVersion\": \"2015-05-01-preview\",\n                    \"dependsOn\": [ ],\n                    \"tags\": { },\n                    \"properties\": {\n                        \"accountType\": \"[parameters('clusterStorageType')]\"\n                    }\n                },\n                {\n                    \"name\": \"[parameters('clusterName')]\",\n                    \"type\": \"Microsoft.HDInsight/clusters\",\n                    \"location\": \"[parameters('clusterLocation')]\",\n                    \"apiVersion\": \"2015-03-01-preview\",\n                    \"dependsOn\": [\n                        \"[concat('Microsoft.Storage/storageAccounts/', parameters('clusterStorageAccountName'))]\"\n                    ],\n                    \"tags\": { },\n                    \"properties\": {\n                        \"clusterVersion\": \"3.2\",\n                        \"osType\": \"Linux\",\n                        \"clusterDefinition\": {\n                            \"kind\": \"hadoop\",\n                            \"configurations\": {\n                                \"gateway\": {\n                                    \"restAuthCredential.isEnabled\": true,\n                                    \"restAuthCredential.username\": \"[parameters('clusterUserName')]\",\n                                    \"restAuthCredential.password\": \"[parameters('clusterUserPassword')]\"\n                                }\n                            }\n                        },\n                        \"storageProfile\": {\n                            \"storageaccounts\": [\n                                {\n                                    \"name\": \"[concat(parameters('clusterStorageAccountName'),'.blob.core.windows.net')]\",\n                                    \"isDefault\": true,\n                                    \"container\": \"[parameters('clusterStorageAccountContainer')]\",\n                                    \"key\": \"[listKeys(resourceId(parameters('clusterStorageAccountResourceGroup'), 'Microsoft.Storage/storageAccounts', parameters('clusterStorageAccountName')), providers('Microsoft.Storage', 'storageAccounts').apiVersions[0]).key1]\"\n                                }\n                            ]\n                        },\n                        \"computeProfile\": {\n                            \"roles\": [\n                                {\n                                    \"name\": \"headnode\",\n                                    \"targetInstanceCount\": \"[parameters('clusterHeadNodeCount')]\",\n                                    \"hardwareProfile\": {\n                                        \"vmSize\": \"Large\"\n                                    },\n                                    \"osProfile\": {\n                                        \"linuxOperatingSystemProfile\": {\n                                            \"username\": \"[parameters('sshUserName')]\",\n                                            \"password\": \"[parameters('sshPassword')]\"\n                                        }\n                                    },\n                                    \"scriptActions\": [\n                                        {\n                                            \"name\": \"installR\",\n                                            \"uri\": \"https://hdiconfigactions.blob.core.windows.net/linuxrconfigactionv01/r-installer-v01.sh\",\n                                            \"parameters\": \"\"\n                                        }\n                                    ]\n                                },\n                                {\n                                    \"name\": \"workernode\",\n                                    \"targetInstanceCount\": \"[parameters('clusterWorkerNodeCount')]\",\n                                    \"hardwareProfile\": {\n                                        \"vmSize\": \"Large\"\n                                    },\n                                    \"osProfile\": {\n                                        \"linuxOperatingSystemProfile\": {\n                                            \"username\": \"[parameters('sshUserName')]\",\n                                            \"password\": \"[parameters('sshPassword')]\"\n                                        }\n                                    },\n                                    \"scriptActions\": [\n                                        {\n                                            \"name\": \"installR\",\n                                            \"uri\": \"https://hdiconfigactions.blob.core.windows.net/linuxrconfigactionv01/r-installer-v01.sh\",\n                                            \"parameters\": \"\"\n                                        }\n                                    ]\n                                }\n                            ]\n                        }\n                    }\n                }\n            ],\n            \"outputs\": {\n                \"cluster\":{\n                    \"type\" : \"object\",\n                    \"value\" : \"[reference(resourceId('Microsoft.HDInsight/clusters',parameters('clusterName')))]\"\n                }\n            }\n        }\n\n2. Start Azure PowerShell and Log in to your Azure account. After providing your credentials, the command returns information about your account.\n\n        Add-AzureRmAccount\n\n        Id                             Type       ...\n        --                             ----\n        someone@example.com            User       ...\n\n3. If you have multiple subscriptions, provide the subscription id you wish to use for deployment.\n\n        Select-AzureRmSubscription -SubscriptionID <YourSubscriptionId>\n\n    > [AZURE.NOTE] You can use `Get-AzureRmSubscription` to get a list of all subscriptions associated with your account, which includes the subscription Id for each one.\n\n5. If you do not have an existing resource group, create a new resource group. Provide the name of the resource group and location that you need for your solution. A summary of the new resource group is returned.\n\n        New-AzureRmResourceGroup -Name myresourcegroup -Location \"West US\"\n\n        ResourceGroupName : myresourcegroup\n        Location          : westus\n        ProvisioningState : Succeeded\n        Tags              :\n        Permissions       :\n                            Actions  NotActions\n                            =======  ==========\n                            *\n        ResourceId        : /subscriptions/######/resourceGroups/ExampleResourceGroup\n\n\n6. To create a new deployment for your resource group, run the **New-AzureRmResourceGroupDeployment** command and provide the necessary parameters. The parameters will include a name for your deployment, the name of your resource group, and the path or URL to the template you created. If your template requires any parameters, you must pass those parameters as well. In this case, the script action to install R on the cluster does not require any parameters.\n\n\n        New-AzureRmResourceGroupDeployment -Name mydeployment -ResourceGroupName myresourcegroup -TemplateFile <PathOrLinkToTemplate>\n\n\n    You will be prompted to provide values for the parameters defined in the template.\n\n7. When the resource group has been deployed, you will see a summary of the deployment.\n\n          DeploymentName    : mydeployment\n          ResourceGroupName : myresourcegroup\n          ProvisioningState : Succeeded\n          Timestamp         : 8/17/2015 7:00:27 PM\n          Mode              : Incremental\n          ...\n\n8. If your deployment fails, you can use the following cmdlets to get information about the failures.\n\n        Get-AzureRmResourceGroupDeployment -ResourceGroupName myresourcegroup -ProvisioningState Failed\n\n## Use a Script Action from Azure PowerShell\n\nIn this section, we use the [Add-AzureRmHDInsightScriptAction](https://msdn.microsoft.com/library/mt603527.aspx) cmdlet to invoke scripts by using Script Action to customize a cluster. Before proceeding, make sure you have installed and configured Azure PowerShell. For information about configuring a workstation to run HDInsight PowerShell cmdlets, see [Install and configure Azure PowerShell](../powershell-install-configure.md).\n\nPerform the following steps:\n\n1. Open the Azure PowerShell console and declare the following variables:\n\n        # PROVIDE VALUES FOR THESE VARIABLES\n        $subscriptionId = \"<SubscriptionId>\"        # ID of the Azure subscription\n        $clusterName = \"<HDInsightClusterName>\"         # HDInsight cluster name\n        $storageAccountName = \"<StorageAccountName>\"    # Azure storage account that hosts the default container\n        $storageAccountKey = \"<StorageAccountKey>\"      # Key for the storage account\n        $containerName = $clusterName\n        $location = \"<MicrosoftDataCenter>\"             # Location of the HDInsight cluster. It must be in the same data center as the storage account.\n        $clusterNodes = <ClusterSizeInNumbers>          # The number of nodes in the HDInsight cluster.\n        $resourceGroupName = \"<ResourceGroupName>\"      # The resource group that the HDInsight cluster will be created in\n\n2. Specify the configuration values (such as nodes in the cluster) and the default storage to be used.\n\n        # SPECIFY THE CONFIGURATION OPTIONS\n        Select-AzureRmSubscription -SubscriptionId $subscriptionId\n        $config = New-AzureRmHDInsightClusterConfig\n        $config.DefaultStorageAccountName=\"$storageAccountName.blob.core.windows.net\"\n        $config.DefaultStorageAccountKey=$storageAccountKey\n\n3. Use **Add-AzureRmHDInsightScriptAction** cmdlet to invoke the script. The following example uses a script that installs R on the cluster:\n\n        # INVOKE THE SCRIPT USING THE SCRIPT ACTION FOR HEADNODE AND WORKERNODE\n        $config = Add-AzureRmHDInsightScriptAction -Config $config -Name \"Install R\"  -NodeType HeadNode -Uri https://hdiconfigactions.blob.core.windows.net/linuxrconfigactionv01/r-installer-v01.sh\n        $config = Add-AzureRmHDInsightScriptAction -Config $config -Name \"Install R\"  -NodeType WorkerNode -Uri https://hdiconfigactions.blob.core.windows.net/linuxrconfigactionv01/r-installer-v01.sh\n\n    The **Add-AzureRmHDInsightScriptAction** cmdlet takes the following parameters:\n\n    | Parameter | Definition |\n    | --------- | ---------- |\n    | Config | Configuration object to which script action information is added. |\n    | Name | Name of the script action. |\n    | NodeType | Specifies the node on which the customization script is run. The valid values are **HeadNode** (to install on the head node), **WorkerNode** (to install on all the data nodes), or **ZookeeperNode** (to install on the zookeeper node). |\n    | Parameters | Parameters required by the script. |\n    | Uri | Specifies the URI to the script that is executed. |\n\n4. Set the admin/HTTPS user for the cluster:\n\n        $httpCreds = get-credential\n        \n    When prompted, enter 'admin' as the name, and provide a password.\n\n5. Set the SSH credentials:\n\n        $sshCreds = get-credential\n    \n    When prompted, enter the SSH user name and password. If you want to secure the SSH account with a certificate instead of a password, use a blank password and set `$sshPublicKey` to the contents of the certificate public key you wish to use. For example:\n    \n        $sshPublicKey = Get-Content .\\path\\to\\public.key -Raw\n    \n4. Finally, create the cluster:\n        \n        New-AzureRmHDInsightCluster -config $config -clustername $clusterName -DefaultStorageContainer $containerName -Location $location -ResourceGroupName $resourceGroupName -ClusterSizeInNodes $clusterNodes -HttpCredential $httpCreds -SshCredential $sshCreds -OSType Linux\n    \n    If you are using a public key to secure your SSH account, you must also specify `-SshPublicKey $sshPublicKey` as a parameter.\n\nIt can take several minutes before the cluster is created.\n\n## Use a Script Action from the HDInsight .NET SDK\n\nThe HDInsight .NET SDK provides client libraries that makes it easier to work with HDInsight from a .NET application. For a code sample, see [Create Linux-based clusters in HDInsight using the .NET SDK](hdinsight-hadoop-create-linux-clusters-dotnet-sdk.md#use-script-action).\n\n\n## Troubleshooting\n\nYou can use Ambari web UI to view information logged by scripts during cluster creation. However, if the cluster creation failed due to an error in the script, the logs are also available in the default storage account associated with the cluster. This section provides information on how to retrieve the logs using both these options.\n\n### Using the Ambari Web UI\n\n1. In your browser, navigate to https://CLUSTERNAME.azurehdinsight.net. Replace CLUSTERNAME with the name of your HDInsight cluster.\n\n    When prompted, enter the admin account name (admin) and password for the cluster. You may have to re-enter the admin credentials in a web form.\n\n2. From the bar at the top of the page, select the __ops__ entry. This will show a list of current and previous operations performed on the cluster through Ambari.\n\n    ![Ambari web UI bar with ops selected](./media/hdinsight-hadoop-customize-cluster-linux/ambari-nav.png)\n\n3. Find the entries that have __run\\_customscriptaction__ in the __Operations__ column. These are created when the Script Actions are ran.\n\n    ![Screenshot of operations](./media/hdinsight-hadoop-customize-cluster-linux/ambariscriptaction.png)\n\n    Select this entry, and drill down through the links to view the STDOUT and STDERR output generated when the script was ran on the cluster.\n\n### Access logs from the default storage account\n\nIf the cluster creation failed due to an error in script action, the script action logs can still be accessed directly from the default storage account associated with the cluster.\n\n* The storage logs are available at `\\STORAGE_ACOCUNT_NAME\\DEFAULT_CONTAINER_NAME\\custom-scriptaction-logs\\CLUSTER_NAME\\DATE`. \n\n    ![Screenshot of operations](./media/hdinsight-hadoop-customize-cluster-linux/script_action_logs_in_storage.png)\n\n    Under this, the logs are organized separately for headnode, workdernode, and zookeeper nodes. Some examples are:\n    * **Headnode** - `<uniqueidentifier>AmbariDb-hn0-<generated_value>.cloudapp.net`\n    * **Worker node** - `<uniqueidentifier>AmbariDb-wn0-<generated_value>.cloudapp.net`\n    * **Zookeeper node** - `<uniqueidentifier>AmbariDb-zk0-<generated_value>.cloudapp.net`\n\n* All stdout and stderr of the corresponding host is uploaded to the storage account. There is one **output-\\*.txt** and **errors-\\*.txt** for each script action. The output-*.txt file contains information about the URI of the script that got run on the host. For example\n\n        'Start downloading script locally: ', u'https://hdiconfigactions.blob.core.windows.net/linuxrconfigactionv01/r-installer-v01.sh'\n\n* It's possible that you repeatedly create a script action cluster with the same name. In such case, you can distinguish the relevant logs based on the DATE folder name. For example, the folder structure for a cluster (mycluster) created on different dates will be:\n    * `\\STORAGE_ACOCUNT_NAME\\DEFAULT_CONTAINER_NAME\\custom-scriptaction-logs\\mycluster\\2015-10-04`\n    * `\\STORAGE_ACOCUNT_NAME\\DEFAULT_CONTAINER_NAME\\custom-scriptaction-logs\\mycluster\\2015-10-05`\n\n* If you create a script action cluster with the same name on the same day, you can use the unique prefix to identify the relevant log files.\n\n* If you create a cluster at the end of the day, it's possible that the log files span across two days. In such cases, you will see two different date folders for the same cluster.\n\n* Uploading log files to the default container can take up to 5 mins, especially for large clusters. So, if you want to access the logs, you should not immediately delete the cluster if a script action fails.\n\n\n## Support for open-source software used on HDInsight clusters\n\nThe Microsoft Azure HDInsight service is a flexible platform that enables you to build big-data applications in the cloud by using an ecosystem of open-source technologies formed around Hadoop. Microsoft Azure provides a general level of support for open-source technologies, as discussed in the **Support Scope** section of the [Azure Support FAQ website](https://azure.microsoft.com/support/faq/). The HDInsight service provides an additional level of support for some of the components, as described below.\n\nThere are two types of open-source components that are available in the HDInsight service:\n\n- **Built-in components** - These components are pre-installed on HDInsight clusters and provide core functionality of the cluster. For example, YARN ResourceManager, the Hive query language (HiveQL), and the Mahout library belong to this category. A full list of cluster components is available in [What's new in the Hadoop cluster versions provided by HDInsight?](hdinsight-component-versioning.md).\n\n- **Custom components** - You, as a user of the cluster, can install or use in your workload any component available in the community or created by you.\n\n> [AZURE.WARNING] Components provided with the HDInsight cluster are fully supported and Microsoft Support will help to isolate and resolve issues related to these components.\n>\n> Custom components receive commercially reasonable support to help you to further troubleshoot the issue. This might result in resolving the issue OR asking you to engage available channels for the open source technologies where deep expertise for that technology is found. For example, there are many community sites that can be used, like: [MSDN forum for HDInsight](https://social.msdn.microsoft.com/Forums/azure/en-US/home?forum=hdinsight), [http://stackoverflow.com](http://stackoverflow.com). Also Apache projects have project sites on [http://apache.org](http://apache.org), for example: [Hadoop](http://hadoop.apache.org/), [Spark](http://spark.apache.org/).\n\nThe HDInsight service provides several ways to use custom components. Regardless of how a component is used or installed on the cluster, the same level of support applies. Below is a list of the most common ways that custom components can be used on HDInsight clusters:\n\n1. Job submission - Hadoop or other types of jobs that execute or use custom components can be submitted to the cluster.\n\n2. Cluster customization - During cluster creation, you can specify additional settings and custom components that will be installed on the cluster nodes.\n\n3. Samples - For popular custom components, Microsoft and others may provide samples of how these components can be used on the HDInsight clusters. These samples are provided without support.\n\n## Next steps\n\nSee the following for information and examples on creating and using scripts to customize a cluster:\n\n- [Develop Script Action scripts for HDInsight](hdinsight-hadoop-script-actions-linux.md)\n- [Install and use Spark on HDInsight clusters](hdinsight-hadoop-spark-install-linux.md)\n- [Install and use R on HDInsight clusters](hdinsight-hadoop-r-scripts-linux.md)\n- [Install and use Solr on HDInsight clusters](hdinsight-hadoop-solr-install-linux.md)\n- [Install and use Giraph on HDInsight clusters](hdinsight-hadoop-giraph-install-linux.md)\n\n\n\n[img-hdi-cluster-states]: ./media/hdinsight-hadoop-customize-cluster-linux/HDI-Cluster-state.png \"Stages during cluster creation\"\n"
}