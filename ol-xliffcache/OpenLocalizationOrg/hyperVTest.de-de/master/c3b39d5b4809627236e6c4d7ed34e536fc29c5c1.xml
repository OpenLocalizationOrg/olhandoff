{
  "nodes": [
    {
      "pos": [
        28,
        92
      ],
      "content": "Evaluate model performance in Machine Learning | Microsoft Azure"
    },
    {
      "pos": [
        112,
        181
      ],
      "content": "Explains how to evaluate model performance in Azure Machine Learning."
    },
    {
      "pos": [
        527,
        586
      ],
      "content": "How to evaluate model performance in Azure Machine Learning"
    },
    {
      "pos": [
        588,
        818
      ],
      "content": "This topic demonstrates how to evaluate the performance of a model in Azure Machine Learning Studio and provides a brief explanation of the metrics available for this task. Three common supervised learning scenarios are presented:",
      "nodes": [
        {
          "content": "This topic demonstrates how to evaluate the performance of a model in Azure Machine Learning Studio and provides a brief explanation of the metrics available for this task.",
          "pos": [
            0,
            172
          ]
        },
        {
          "content": "Three common supervised learning scenarios are presented:",
          "pos": [
            173,
            230
          ]
        }
      ]
    },
    {
      "pos": [
        823,
        833
      ],
      "content": "regression"
    },
    {
      "pos": [
        836,
        857
      ],
      "content": "binary classification"
    },
    {
      "pos": [
        861,
        886
      ],
      "content": "multiclass classification"
    },
    {
      "pos": [
        983,
        1171
      ],
      "content": "Evaluating the performance of a model is one of the core stages in the data science process. It indicates how successful the scoring (predictions) of a dataset has been by a trained model.",
      "nodes": [
        {
          "content": "Evaluating the performance of a model is one of the core stages in the data science process.",
          "pos": [
            0,
            92
          ]
        },
        {
          "content": "It indicates how successful the scoring (predictions) of a dataset has been by a trained model.",
          "pos": [
            93,
            188
          ]
        }
      ]
    },
    {
      "pos": [
        1174,
        1501
      ],
      "content": "Azure Machine Learning supports model evaluation through two of its main machine learning modules: [Evaluate Model][evaluate-model] and [Cross-Validate Model][cross-validate-model]. These modules allow you to see how your model performs in terms of a number of metrics that are commonly used in machine learning and statistics.",
      "nodes": [
        {
          "content": "Azure Machine Learning supports model evaluation through two of its main machine learning modules: [Evaluate Model][evaluate-model] and [Cross-Validate Model][cross-validate-model].",
          "pos": [
            0,
            181
          ]
        },
        {
          "content": "These modules allow you to see how your model performs in terms of a number of metrics that are commonly used in machine learning and statistics.",
          "pos": [
            182,
            327
          ]
        }
      ]
    },
    {
      "pos": [
        1505,
        1536
      ],
      "content": "Evaluation vs. Cross Validation"
    },
    {
      "pos": [
        1539,
        1731
      ],
      "content": "Evaluation and cross validation are standard ways to measure the performance of your model. They both generate evaluation metrics that you can inspect or compare against those of other models.",
      "nodes": [
        {
          "content": "Evaluation and cross validation are standard ways to measure the performance of your model.",
          "pos": [
            0,
            91
          ]
        },
        {
          "content": "They both generate evaluation metrics that you can inspect or compare against those of other models.",
          "pos": [
            92,
            192
          ]
        }
      ]
    },
    {
      "pos": [
        1733,
        2244
      ],
      "content": "[Evaluate Model][evaluate-model] expects a scored dataset as input (or 2 in case you would like to compare the performance of 2 different models). This means that you need to train your model using the [Train Model][train-model] module and make predictions on some dataset using the [Score Model][score-model] module, before you can evaluate the results. The evaluation is the based on the scored labels/probabilities along with the true labels, all of which are output by the [Score Model][score-model] module.",
      "nodes": [
        {
          "content": "[Evaluate Model][evaluate-model] expects a scored dataset as input (or 2 in case you would like to compare the performance of 2 different models).",
          "pos": [
            0,
            146
          ]
        },
        {
          "content": "This means that you need to train your model using the [Train Model][train-model] module and make predictions on some dataset using the [Score Model][score-model] module, before you can evaluate the results.",
          "pos": [
            147,
            354
          ]
        },
        {
          "content": "The evaluation is the based on the scored labels/probabilities along with the true labels, all of which are output by the [Score Model][score-model] module.",
          "pos": [
            355,
            511
          ]
        }
      ]
    },
    {
      "pos": [
        2246,
        2871
      ],
      "content": "Alternatively, you can use cross validation to perform a number of train-score-evaluate operations (10 folds) automatically on different subsets of the input data. The input data is split into 10 parts, where one is reserved for testing, and the other 9 for training. This process is repeated 10 times and the evaluation metrics are averaged. This helps in determining how well a model would generalize to new datasets. The [Cross-Validate Model][cross-validate-model] module takes in an untrained model and some labeled dataset and outputs the evaluation results of each of the 10 folds, in addition to the averaged results.",
      "nodes": [
        {
          "content": "Alternatively, you can use cross validation to perform a number of train-score-evaluate operations (10 folds) automatically on different subsets of the input data.",
          "pos": [
            0,
            163
          ]
        },
        {
          "content": "The input data is split into 10 parts, where one is reserved for testing, and the other 9 for training.",
          "pos": [
            164,
            267
          ]
        },
        {
          "content": "This process is repeated 10 times and the evaluation metrics are averaged.",
          "pos": [
            268,
            342
          ]
        },
        {
          "content": "This helps in determining how well a model would generalize to new datasets.",
          "pos": [
            343,
            419
          ]
        },
        {
          "content": "The [Cross-Validate Model][cross-validate-model] module takes in an untrained model and some labeled dataset and outputs the evaluation results of each of the 10 folds, in addition to the averaged results.",
          "pos": [
            420,
            625
          ]
        }
      ]
    },
    {
      "pos": [
        2873,
        3099
      ],
      "content": "In the following sections, we will build simple regression and classification models and evaluate their performance, using both the [Evaluate Model][evaluate-model] and the [Cross-Validate Model][cross-validate-model] modules."
    },
    {
      "pos": [
        3101,
        3888
      ],
      "content": "##Evaluating a Regression Model##\nAssume we want to predict a car’s price using some features such as dimensions, horsepower, engine specs, and so on. This is a typical regression problem, where the target variable (<bpt id=\"p1\">*</bpt>price<ept id=\"p1\">*</ept>) is a continuous numeric value. We can fit a simple linear regression model that, given the feature values of a certain car, can predict the price of that car. This regression model can be used to score the same dataset we trained on. Once we have the predicted prices for all of the cars, we can evaluate the performance of the model by looking at how much the predictions deviate from the actual prices on average. To illustrate this, we use the <bpt id=\"p2\">*</bpt>Automobile price data (Raw) dataset<ept id=\"p2\">*</ept><ph id=\"ph3\"/> available in the <bpt id=\"p3\">**</bpt>Saved Datasets<ept id=\"p3\">**</ept><ph id=\"ph4\"/> section in Azure Machine Learning Studio.",
      "nodes": [
        {
          "content": "Evaluating a Regression Model##\nAssume we want to predict a car’s price using some features such as dimensions, horsepower, engine specs, and so on.",
          "pos": [
            2,
            150
          ]
        },
        {
          "content": "This is a typical regression problem, where the target variable (<bpt id=\"p1\">*</bpt>price<ept id=\"p1\">*</ept>) is a continuous numeric value.",
          "pos": [
            151,
            293
          ]
        },
        {
          "content": "We can fit a simple linear regression model that, given the feature values of a certain car, can predict the price of that car.",
          "pos": [
            294,
            421
          ]
        },
        {
          "content": "This regression model can be used to score the same dataset we trained on.",
          "pos": [
            422,
            496
          ]
        },
        {
          "content": "Once we have the predicted prices for all of the cars, we can evaluate the performance of the model by looking at how much the predictions deviate from the actual prices on average.",
          "pos": [
            497,
            678
          ]
        },
        {
          "content": "To illustrate this, we use the <bpt id=\"p2\">*</bpt>Automobile price data (Raw) dataset<ept id=\"p2\">*</ept><ph id=\"ph3\"/> available in the <bpt id=\"p3\">**</bpt>Saved Datasets<ept id=\"p3\">**</ept><ph id=\"ph4\"/> section in Azure Machine Learning Studio.",
          "pos": [
            679,
            929
          ]
        }
      ]
    },
    {
      "pos": [
        3894,
        3917
      ],
      "content": "Creating the Experiment"
    },
    {
      "pos": [
        3921,
        3998
      ],
      "content": "Add the following modules to your workspace in Azure Machine Learning Studio:"
    },
    {
      "pos": [
        4002,
        4029
      ],
      "content": "Automobile price data (Raw)"
    },
    {
      "pos": [
        4032,
        4070
      ],
      "content": "[Linear Regression][linear-regression]"
    },
    {
      "pos": [
        4073,
        4099
      ],
      "content": "[Train Model][train-model]"
    },
    {
      "pos": [
        4102,
        4128
      ],
      "content": "[Score Model][score-model]"
    },
    {
      "pos": [
        4131,
        4163
      ],
      "content": "[Evaluate Model][evaluate-model]"
    },
    {
      "pos": [
        4166,
        4288
      ],
      "content": "Connect the ports as shown below in Figure 1 and set the Label column of the [Train Model][train-model] module to <bpt id=\"p4\">*</bpt>price<ept id=\"p4\">*</ept>."
    },
    {
      "pos": [
        4291,
        4380
      ],
      "content": "<ph id=\"ph5\">![</ph>Evaluating a Regression Model<ph id=\"ph6\">](media/machine-learning-evaluate-model-performance/1.png)</ph>"
    },
    {
      "pos": [
        4382,
        4422
      ],
      "content": "Figure 1. Evaluating a Regression Model.",
      "nodes": [
        {
          "content": "Figure 1.",
          "pos": [
            0,
            9
          ]
        },
        {
          "content": "Evaluating a Regression Model.",
          "pos": [
            10,
            40
          ]
        }
      ]
    },
    {
      "pos": [
        4424,
        4831
      ],
      "content": "###Inspecting the Evaluation Results###\nAfter running the experiment, you can click on the output port of the [Evaluate Model][evaluate-model] module and select <bpt id=\"p5\">*</bpt>Visualize<ept id=\"p5\">*</ept><ph id=\"ph7\"/> to see the evaluation results. The evaluation metrics available for regression models are: <bpt id=\"p6\">*</bpt>Mean Absolute Error<ept id=\"p6\">*</ept>, <bpt id=\"p7\">*</bpt>Root Mean Absolute Error<ept id=\"p7\">*</ept>, <bpt id=\"p8\">*</bpt>Relative Absolute Error<ept id=\"p8\">*</ept>, <bpt id=\"p9\">*</bpt>Relative Squared Error<ept id=\"p9\">*</ept>, and the <bpt id=\"p10\">*</bpt>Coefficient of Determination<ept id=\"p10\">*</ept>.",
      "nodes": [
        {
          "content": "Inspecting the Evaluation Results###\nAfter running the experiment, you can click on the output port of the [Evaluate Model][evaluate-model] module and select <bpt id=\"p5\">*</bpt>Visualize<ept id=\"p5\">*</ept><ph id=\"ph7\"/> to see the evaluation results.",
          "pos": [
            3,
            255
          ]
        },
        {
          "content": "The evaluation metrics available for regression models are: <bpt id=\"p6\">*</bpt>Mean Absolute Error<ept id=\"p6\">*</ept>, <bpt id=\"p7\">*</bpt>Root Mean Absolute Error<ept id=\"p7\">*</ept>, <bpt id=\"p8\">*</bpt>Relative Absolute Error<ept id=\"p8\">*</ept>, <bpt id=\"p9\">*</bpt>Relative Squared Error<ept id=\"p9\">*</ept>, and the <bpt id=\"p10\">*</bpt>Coefficient of Determination<ept id=\"p10\">*</ept>.",
          "pos": [
            256,
            651
          ]
        }
      ]
    },
    {
      "pos": [
        4833,
        5447
      ],
      "content": "The term \"error\" here represents the difference between the predicted value and the true value. The absolute value or the square of this difference are usually computed to capture the total magnitude of error across all instances, as the difference between the predicted and true value could be negative in some cases. The error metrics measure the predictive performance of a regression model in terms of the mean deviation of its predictions from the true values. Lower error values mean the model is more accurate in making predictions. An overall error metric of 0 means that the model fits the data perfectly.",
      "nodes": [
        {
          "content": "The term \"error\" here represents the difference between the predicted value and the true value.",
          "pos": [
            0,
            95
          ]
        },
        {
          "content": "The absolute value or the square of this difference are usually computed to capture the total magnitude of error across all instances, as the difference between the predicted and true value could be negative in some cases.",
          "pos": [
            96,
            318
          ]
        },
        {
          "content": "The error metrics measure the predictive performance of a regression model in terms of the mean deviation of its predictions from the true values.",
          "pos": [
            319,
            465
          ]
        },
        {
          "content": "Lower error values mean the model is more accurate in making predictions.",
          "pos": [
            466,
            539
          ]
        },
        {
          "content": "An overall error metric of 0 means that the model fits the data perfectly.",
          "pos": [
            540,
            614
          ]
        }
      ]
    },
    {
      "pos": [
        5449,
        5740
      ],
      "content": "The coefficient of determination, which is also known as R squared, is also a standard way of measuring how well the model fits the data. It can be interpreted as the proportion of variation explained by the model. A higher proportion is better in this case, where 1 indicates a perfect fit.",
      "nodes": [
        {
          "content": "The coefficient of determination, which is also known as R squared, is also a standard way of measuring how well the model fits the data.",
          "pos": [
            0,
            137
          ]
        },
        {
          "content": "It can be interpreted as the proportion of variation explained by the model.",
          "pos": [
            138,
            214
          ]
        },
        {
          "content": "A higher proportion is better in this case, where 1 indicates a perfect fit.",
          "pos": [
            215,
            291
          ]
        }
      ]
    },
    {
      "pos": [
        5743,
        5839
      ],
      "content": "<ph id=\"ph8\">![</ph>Linear Regression Evaluation Metrics<ph id=\"ph9\">](media/machine-learning-evaluate-model-performance/2.png)</ph>"
    },
    {
      "pos": [
        5841,
        5888
      ],
      "content": "Figure 2. Linear Regression Evaluation Metrics.",
      "nodes": [
        {
          "content": "Figure 2.",
          "pos": [
            0,
            9
          ]
        },
        {
          "content": "Linear Regression Evaluation Metrics.",
          "pos": [
            10,
            47
          ]
        }
      ]
    },
    {
      "pos": [
        5890,
        6341
      ],
      "content": "###Using Cross Validation###\nAs mentioned earlier, you can perform repeated training, scoring and evaluations automatically using the [Cross-Validate Model][cross-validate-model] module. All you need in this case is a dataset, an untrained model, and a [Cross-Validate Model][cross-validate-model] module (see figure below). Note that you need to set the label column to <bpt id=\"p11\">*</bpt>price<ept id=\"p11\">*</ept><ph id=\"ph10\"/> in the [Cross-Validate Model][cross-validate-model] module’s properties.",
      "nodes": [
        {
          "content": "Using Cross Validation###\nAs mentioned earlier, you can perform repeated training, scoring and evaluations automatically using the [Cross-Validate Model][cross-validate-model] module.",
          "pos": [
            3,
            186
          ]
        },
        {
          "content": "All you need in this case is a dataset, an untrained model, and a [Cross-Validate Model][cross-validate-model] module (see figure below).",
          "pos": [
            187,
            324
          ]
        },
        {
          "content": "Note that you need to set the label column to <bpt id=\"p11\">*</bpt>price<ept id=\"p11\">*</ept><ph id=\"ph10\"/> in the [Cross-Validate Model][cross-validate-model] module’s properties.",
          "pos": [
            325,
            506
          ]
        }
      ]
    },
    {
      "pos": [
        6343,
        6438
      ],
      "content": "<ph id=\"ph11\">![</ph>Cross-Validating a Regression Model<ph id=\"ph12\">](media/machine-learning-evaluate-model-performance/3.png)</ph>"
    },
    {
      "pos": [
        6440,
        6486
      ],
      "content": "Figure 3. Cross-Validating a Regression Model.",
      "nodes": [
        {
          "content": "Figure 3.",
          "pos": [
            0,
            9
          ]
        },
        {
          "content": "Cross-Validating a Regression Model.",
          "pos": [
            10,
            46
          ]
        }
      ]
    },
    {
      "pos": [
        6488,
        6789
      ],
      "content": "After running the experiment, you can inspect the evaluation results by clicking on the right output port of the [Cross-Validate Model][cross-validate-model] module. This will provide a detailed view of the metrics for each iteration (fold), and the averaged results of each of the metrics (Figure 4).",
      "nodes": [
        {
          "content": "After running the experiment, you can inspect the evaluation results by clicking on the right output port of the [Cross-Validate Model][cross-validate-model] module.",
          "pos": [
            0,
            165
          ]
        },
        {
          "content": "This will provide a detailed view of the metrics for each iteration (fold), and the averaged results of each of the metrics (Figure 4).",
          "pos": [
            166,
            301
          ]
        }
      ]
    },
    {
      "pos": [
        6792,
        6898
      ],
      "content": "<ph id=\"ph13\">![</ph>Cross-Validation Results of a Regression Model<ph id=\"ph14\">](media/machine-learning-evaluate-model-performance/4.png)</ph>"
    },
    {
      "pos": [
        6900,
        6957
      ],
      "content": "Figure 4. Cross-Validation Results of a Regression Model.",
      "nodes": [
        {
          "content": "Figure 4.",
          "pos": [
            0,
            9
          ]
        },
        {
          "content": "Cross-Validation Results of a Regression Model.",
          "pos": [
            10,
            57
          ]
        }
      ]
    },
    {
      "pos": [
        6959,
        7991
      ],
      "content": "##Evaluating a Binary Classification Model##\nIn a binary classification scenario, the target variable has only two possible outcomes, for example: {0, 1} or {false, true}, {negative, positive}. Assume you are given a dataset of adult employees with some demographic and employment variables, and that you are asked to predict the income level, a binary variable with the values {“&lt;=50K”, “&gt;50K”}. In other words, the negative class represents the employees who make less than or equal to 50K per year, and the positive class represents all other employees. As in the regression scenario, we would train a model, score some data, and evaluate the results. The main difference here is the choice of metrics Azure Machine Learning computes and outputs. To illustrate the income level prediction scenario, we will use the <bpt id=\"p12\">[</bpt>Adult<ept id=\"p12\">](http://archive.ics.uci.edu/ml/datasets/Adult)</ept><ph id=\"ph15\"/> dataset to create an Azure Machine Learning experiment and evaluate the performance of a two-class logistic regression model, a commonly used binary classifier.",
      "nodes": [
        {
          "content": "Evaluating a Binary Classification Model##\nIn a binary classification scenario, the target variable has only two possible outcomes, for example: {0, 1} or {false, true}, {negative, positive}. Assum",
          "pos": [
            2,
            199
          ]
        },
        {
          "content": "e you are given a dataset of adult employees with some demographic and employment variables, and that you are asked to predict the income level, a binary variable with the values {“&lt;=50K”, “&gt;50K”}.",
          "pos": [
            199,
            402
          ]
        },
        {
          "content": "In other words, the negative class represents the employees who make less than or equal to 50K per year, and the positive class represents all other employees.",
          "pos": [
            403,
            562
          ]
        },
        {
          "content": "As in the regression scenario, we would train a model, score some data, and evaluate the results.",
          "pos": [
            563,
            660
          ]
        },
        {
          "content": "The main difference here is the choice of metrics Azure Machine Learning computes and outputs.",
          "pos": [
            661,
            755
          ]
        },
        {
          "content": "To illustrate the income level prediction scenario, we will use the <bpt id=\"p12\">[</bpt>Adult<ept id=\"p12\">](http://archive.ics.uci.edu/ml/datasets/Adult)</ept><ph id=\"ph15\"/> dataset to create an Azure Machine Learning experiment and evaluate the performance of a two-class logistic regression model, a commonly used binary classifier.",
          "pos": [
            756,
            1093
          ]
        }
      ]
    },
    {
      "pos": [
        7996,
        8019
      ],
      "content": "Creating the Experiment"
    },
    {
      "pos": [
        8023,
        8100
      ],
      "content": "Add the following modules to your workspace in Azure Machine Learning Studio:"
    },
    {
      "pos": [
        8104,
        8153
      ],
      "content": "Adult Census Income Binary Classification dataset"
    },
    {
      "pos": [
        8156,
        8218
      ],
      "content": "[Two-Class Logistic Regression][two-class-logistic-regression]"
    },
    {
      "pos": [
        8221,
        8247
      ],
      "content": "[Train Model][train-model]"
    },
    {
      "pos": [
        8250,
        8276
      ],
      "content": "[Score Model][score-model]"
    },
    {
      "pos": [
        8279,
        8311
      ],
      "content": "[Evaluate Model][evaluate-model]"
    },
    {
      "pos": [
        8313,
        8436
      ],
      "content": "Connect the ports as shown below in Figure 5 and set the Label column of the [Train Model][train-model] module to <bpt id=\"p13\">*</bpt>income<ept id=\"p13\">*</ept>."
    },
    {
      "pos": [
        8438,
        8538
      ],
      "content": "<ph id=\"ph16\">![</ph>Evaluating a Binary Classification Model<ph id=\"ph17\">](media/machine-learning-evaluate-model-performance/5.png)</ph>"
    },
    {
      "pos": [
        8540,
        8591
      ],
      "content": "Figure 5. Evaluating a Binary Classification Model.",
      "nodes": [
        {
          "content": "Figure 5.",
          "pos": [
            0,
            9
          ]
        },
        {
          "content": "Evaluating a Binary Classification Model.",
          "pos": [
            10,
            51
          ]
        }
      ]
    },
    {
      "pos": [
        8593,
        9136
      ],
      "content": "###Inspecting the Evaluation Results###\nAfter running the experiment, you can click on the output port of the [Evaluate Model][evaluate-model] module and select <bpt id=\"p14\">*</bpt>Visualize<ept id=\"p14\">*</ept><ph id=\"ph18\"/> to see the evaluation results (Figure 7). The evaluation metrics available for binary classification models are: <bpt id=\"p15\">*</bpt>Accuracy<ept id=\"p15\">*</ept>, <bpt id=\"p16\">*</bpt>Precision<ept id=\"p16\">*</ept>, <bpt id=\"p17\">*</bpt>Recall<ept id=\"p17\">*</ept>, <bpt id=\"p18\">*</bpt>F1 Score<ept id=\"p18\">*</ept>, and <bpt id=\"p19\">*</bpt>AUC<ept id=\"p19\">*</ept>. In addition, the module outputs a confusion matrix showing the number of true positives, false negatives, false positives, and true negatives, as well as <bpt id=\"p20\">*</bpt>ROC<ept id=\"p20\">*</ept>, <bpt id=\"p21\">*</bpt>Precision/Recall<ept id=\"p21\">*</ept>, and <bpt id=\"p22\">*</bpt>Lift<ept id=\"p22\">*</ept><ph id=\"ph19\"/> curves.",
      "nodes": [
        {
          "content": "Inspecting the Evaluation Results###\nAfter running the experiment, you can click on the output port of the [Evaluate Model][evaluate-model] module and select <bpt id=\"p14\">*</bpt>Visualize<ept id=\"p14\">*</ept><ph id=\"ph18\"/> to see the evaluation results (Figure 7).",
          "pos": [
            3,
            269
          ]
        },
        {
          "content": "The evaluation metrics available for binary classification models are: <bpt id=\"p15\">*</bpt>Accuracy<ept id=\"p15\">*</ept>, <bpt id=\"p16\">*</bpt>Precision<ept id=\"p16\">*</ept>, <bpt id=\"p17\">*</bpt>Recall<ept id=\"p17\">*</ept>, <bpt id=\"p18\">*</bpt>F1 Score<ept id=\"p18\">*</ept>, and <bpt id=\"p19\">*</bpt>AUC<ept id=\"p19\">*</ept>.",
          "pos": [
            270,
            598
          ]
        },
        {
          "content": "In addition, the module outputs a confusion matrix showing the number of true positives, false negatives, false positives, and true negatives, as well as <bpt id=\"p20\">*</bpt>ROC<ept id=\"p20\">*</ept>, <bpt id=\"p21\">*</bpt>Precision/Recall<ept id=\"p21\">*</ept>, and <bpt id=\"p22\">*</bpt>Lift<ept id=\"p22\">*</ept><ph id=\"ph19\"/> curves.",
          "pos": [
            599,
            933
          ]
        }
      ]
    },
    {
      "pos": [
        9138,
        9947
      ],
      "content": "Accuracy is simply the proportion of correctly classified instances. It is usually the first metric you look at when evaluating a classifier. However, when the test data is unbalanced (where most of the instances belong to one of the classes), or you are more interested in the performance on either one of the classes, accuracy doesn’t really capture the effectiveness of a classifier. In the income level classification scenario, assume you are testing on some data where 99% of the instances represent people who earn less than or equal to 50K per year. It is possible to achieve a 0.99 accuracy by predicting the class “&lt;=50K” for all instances. The classifier in this case appears to be doing a good job overall, but in reality, it fails to classify any of the high-income individuals (the 1%) correctly.",
      "nodes": [
        {
          "content": "Accuracy is simply the proportion of correctly classified instances. It",
          "pos": [
            0,
            71
          ]
        },
        {
          "content": "is usually the first metric you look at when evaluating a classifier. Ho",
          "pos": [
            72,
            144
          ]
        },
        {
          "content": "wever, when the test data is unbalanced (where most of the instances belong to one of the classes), or you are more interested in the performance on either one of the classes, accuracy doesn’t really capture the effectiveness of a classifier. In",
          "pos": [
            144,
            389
          ]
        },
        {
          "content": "the income level classification scenario, assume you are testing on some data where 99% of the instances represent people who earn less than or equal to 50K per year. It",
          "pos": [
            390,
            559
          ]
        },
        {
          "content": "is possible to achieve a 0.99 accuracy by predicting the class “&lt;=50K” for all instances.",
          "pos": [
            560,
            652
          ]
        },
        {
          "content": "The classifier in this case appears to be doing a good job overall, but in reality, it fails to classify any of the high-income individuals (the 1%) correctly.",
          "pos": [
            653,
            812
          ]
        }
      ]
    },
    {
      "pos": [
        9949,
        11118
      ],
      "content": "For that reason, it is helpful to compute additional metrics that capture more specific aspects of the evaluation. Before going into the details of such metrics, it is important to understand the confusion matrix of a binary classification evaluation. The class labels in the training set can take on only 2 possible values, which we usually refer to as positive or negative. The positive and negative instances that a classifier predicts correctly are called true positives (TP) and true negatives (TN), respectively. Similarly, the incorrectly classified instances are called false positives (FP) and false negatives (FN). The confusion matrix is simply a table showing the number of instances that fall under each of these 4 categories. Azure Machine Learning automatically decides which of the two classes in the dataset is the positive class. If the class labels are Boolean or integers, then the ‘true’ or ‘1’ labeled instances are assigned the positive class. If the labels are strings, as in the case of the income dataset, the labels are sorted alphabetically and the first level is chosen to be the negative class while the second level is the positive class.",
      "nodes": [
        {
          "content": "For that reason, it is helpful to compute additional metrics that capture more specific aspects of the evaluation.",
          "pos": [
            0,
            114
          ]
        },
        {
          "content": "Before going into the details of such metrics, it is important to understand the confusion matrix of a binary classification evaluation.",
          "pos": [
            115,
            251
          ]
        },
        {
          "content": "The class labels in the training set can take on only 2 possible values, which we usually refer to as positive or negative.",
          "pos": [
            252,
            375
          ]
        },
        {
          "content": "The positive and negative instances that a classifier predicts correctly are called true positives (TP) and true negatives (TN), respectively.",
          "pos": [
            376,
            518
          ]
        },
        {
          "content": "Similarly, the incorrectly classified instances are called false positives (FP) and false negatives (FN).",
          "pos": [
            519,
            624
          ]
        },
        {
          "content": "The confusion matrix is simply a table showing the number of instances that fall under each of these 4 categories.",
          "pos": [
            625,
            739
          ]
        },
        {
          "content": "Azure Machine Learning automatically decides which of the two classes in the dataset is the positive class.",
          "pos": [
            740,
            847
          ]
        },
        {
          "content": "If the class labels are Boolean or integers, then the ‘true’ or ‘1’ labeled instances are assigned the positive class.",
          "pos": [
            848,
            966
          ]
        },
        {
          "content": "If the labels are strings, as in the case of the income dataset, the labels are sorted alphabetically and the first level is chosen to be the negative class while the second level is the positive class.",
          "pos": [
            967,
            1169
          ]
        }
      ]
    },
    {
      "pos": [
        11120,
        11219
      ],
      "content": "<ph id=\"ph20\">![</ph>Binary Classification Confusion Matrix<ph id=\"ph21\">](media/machine-learning-evaluate-model-performance/6a.png)</ph>"
    },
    {
      "pos": [
        11221,
        11270
      ],
      "content": "Figure 6. Binary Classification Confusion Matrix.",
      "nodes": [
        {
          "content": "Figure 6.",
          "pos": [
            0,
            9
          ]
        },
        {
          "content": "Binary Classification Confusion Matrix.",
          "pos": [
            10,
            49
          ]
        }
      ]
    },
    {
      "pos": [
        11272,
        12474
      ],
      "content": "Going back to the income classification problem, we would want to ask several evaluation questions that help us understand the performance of the classifier used. A very natural question is: ‘Out of the individuals whom the model predicted to be earning &gt;50K (TP+FP), how many were classified correctly (TP)?’ This question can be answered by looking at the <bpt id=\"p23\">**</bpt>Precision<ept id=\"p23\">**</ept><ph id=\"ph22\"/> of the model, which is the proportion of positives that are classified correctly: TP/(TP+FP). Another common question is “Out of all the high earning employees with income &gt;50k (TP+FN), how many did the classifier classify correctly (TP)”. This is actually the <bpt id=\"p24\">**</bpt>Recall<ept id=\"p24\">**</ept>, or the true positive rate: TP/(TP+FN) of the classifier. You might notice that there is an obvious trade-off between precision and recall. For example, given a relatively balanced dataset, a classifier that predicts mostly positive instances, would have a high recall, but a rather low precision as many of the negative instances would be misclassified resulting in a large number of false positives. To see a plot of how these two metrics vary, you can click on the ‘PRECISION/RECALL’ curve in the evaluation result output page (top left part of Figure 7).",
      "nodes": [
        {
          "content": "Going back to the income classification problem, we would want to ask several evaluation questions that help us understand the performance of the classifier used. A",
          "pos": [
            0,
            164
          ]
        },
        {
          "content": "very natural question is: ‘Out of the individuals whom the model predicted to be earning &gt;50K (TP+FP), how many were classified correctly (TP)?’",
          "pos": [
            165,
            312
          ]
        },
        {
          "content": "This question can be answered by looking at the <bpt id=\"p23\">**</bpt>Precision<ept id=\"p23\">**</ept><ph id=\"ph22\"/> of the model, which is the proportion of positives that are classified correctly: TP/(TP+FP). An",
          "pos": [
            313,
            526
          ]
        },
        {
          "content": "other common question is “Out of all the high earning employees with income &gt;50k (TP+FN), how many did the classifier classify correctly (TP)”.",
          "pos": [
            526,
            672
          ]
        },
        {
          "content": "This is actually the <bpt id=\"p24\">**</bpt>Recall<ept id=\"p24\">**</ept>, or the true positive rate: TP/(TP+FN) of the classifier.",
          "pos": [
            673,
            802
          ]
        },
        {
          "content": "You might notice that there is an obvious trade-off between precision and recall.",
          "pos": [
            803,
            884
          ]
        },
        {
          "content": "For example, given a relatively balanced dataset, a classifier that predicts mostly positive instances, would have a high recall, but a rather low precision as many of the negative instances would be misclassified resulting in a large number of false positives.",
          "pos": [
            885,
            1146
          ]
        },
        {
          "content": "To see a plot of how these two metrics vary, you can click on the ‘PRECISION/RECALL’ curve in the evaluation result output page (top left part of Figure 7).",
          "pos": [
            1147,
            1303
          ]
        }
      ]
    },
    {
      "pos": [
        12476,
        12628
      ],
      "content": "<ph id=\"ph23\">![</ph>Binary Classification Evaluation Results<ph id=\"ph24\">](media/machine-learning-evaluate-model-performance/7.png)</ph>\nFigure 7. Binary Classification Evaluation Results.",
      "nodes": [
        {
          "content": "<ph id=\"ph23\">![</ph>Binary Classification Evaluation Results<ph id=\"ph24\">](media/machine-learning-evaluate-model-performance/7.png)</ph>\nFigure 7.",
          "pos": [
            0,
            148
          ]
        },
        {
          "content": "Binary Classification Evaluation Results.",
          "pos": [
            149,
            190
          ]
        }
      ]
    },
    {
      "pos": [
        12630,
        13070
      ],
      "content": "Another related metric that is often used is the <bpt id=\"p25\">**</bpt>F1 Score<ept id=\"p25\">**</ept>, which takes both precision and recall into consideration. It is the harmonic mean of these 2 metrics and is computed as such: F1 = 2 (precision x recall) / (precision + recall). The F1 score is a good way to summarize the evaluation in a single number, but it’s always a good practice to look at both precision and recall together to better understand how a classifier behaves.",
      "nodes": [
        {
          "content": "Another related metric that is often used is the <bpt id=\"p25\">**</bpt>F1 Score<ept id=\"p25\">**</ept>, which takes both precision and recall into consideration.",
          "pos": [
            0,
            160
          ]
        },
        {
          "content": "It is the harmonic mean of these 2 metrics and is computed as such: F1 = 2 (precision x recall) / (precision + recall).",
          "pos": [
            161,
            280
          ]
        },
        {
          "content": "The F1 score is a good way to summarize the evaluation in a single number, but it’s always a good practice to look at both precision and recall together to better understand how a classifier behaves.",
          "pos": [
            281,
            480
          ]
        }
      ]
    },
    {
      "pos": [
        13072,
        13588
      ],
      "content": "In addition, one can inspect the true positive rate vs. the false positive rate in the <bpt id=\"p26\">**</bpt>Receiver Operating Characteristic (ROC)<ept id=\"p26\">**</ept><ph id=\"ph25\"/> curve and the corresponding <bpt id=\"p27\">**</bpt>Area Under the Curve (AUC)<ept id=\"p27\">**</ept><ph id=\"ph26\"/> value. The closer this curve is to the upper left corner, the better the classifier’s performance is (that is maximizing the true positive rate while minimizing the false positive rate). Curves that are close to the diagonal of the plot, result from classifiers that tend to make predictions that are close to random guessing.",
      "nodes": [
        {
          "content": "In addition, one can inspect the true positive rate vs. the false positive rate in the <bpt id=\"p26\">**</bpt>Receiver Operating Characteristic (ROC)<ept id=\"p26\">**</ept><ph id=\"ph25\"/> curve and the corresponding <bpt id=\"p27\">**</bpt>Area Under the Curve (AUC)<ept id=\"p27\">**</ept><ph id=\"ph26\"/> value.",
          "pos": [
            0,
            306
          ]
        },
        {
          "content": "The closer this curve is to the upper left corner, the better the classifier’s performance is (that is maximizing the true positive rate while minimizing the false positive rate).",
          "pos": [
            307,
            486
          ]
        },
        {
          "content": "Curves that are close to the diagonal of the plot, result from classifiers that tend to make predictions that are close to random guessing.",
          "pos": [
            487,
            626
          ]
        }
      ]
    },
    {
      "pos": [
        13590,
        14262
      ],
      "content": "###Using Cross Validation###\nAs in the regression example, we can perform cross validation to repeatedly train, score and evaluate different subsets of the data automatically. Similarly, we can use the [Cross-Validate Model][cross-validate-model] module, an untrained logistic regression model, and a dataset. The label column must be set to <bpt id=\"p28\">*</bpt>income<ept id=\"p28\">*</ept><ph id=\"ph27\"/> in the [Cross-Validate Model][cross-validate-model] module’s properties. After running the experiment and clicking on the right output port of the [Cross-Validate Model][cross-validate-model] module, we can see the binary classification metric values for each fold, in addition to the mean and standard deviation of each.",
      "nodes": [
        {
          "content": "Using Cross Validation###\nAs in the regression example, we can perform cross validation to repeatedly train, score and evaluate different subsets of the data automatically.",
          "pos": [
            3,
            175
          ]
        },
        {
          "content": "Similarly, we can use the [Cross-Validate Model][cross-validate-model] module, an untrained logistic regression model, and a dataset.",
          "pos": [
            176,
            309
          ]
        },
        {
          "content": "The label column must be set to <bpt id=\"p28\">*</bpt>income<ept id=\"p28\">*</ept><ph id=\"ph27\"/> in the [Cross-Validate Model][cross-validate-model] module’s properties.",
          "pos": [
            310,
            478
          ]
        },
        {
          "content": "After running the experiment and clicking on the right output port of the [Cross-Validate Model][cross-validate-model] module, we can see the binary classification metric values for each fold, in addition to the mean and standard deviation of each.",
          "pos": [
            479,
            727
          ]
        }
      ]
    },
    {
      "pos": [
        14266,
        14372
      ],
      "content": "<ph id=\"ph28\">![</ph>Cross-Validating a Binary Classification Model<ph id=\"ph29\">](media/machine-learning-evaluate-model-performance/8.png)</ph>"
    },
    {
      "pos": [
        14374,
        14431
      ],
      "content": "Figure 8. Cross-Validating a Binary Classification Model.",
      "nodes": [
        {
          "content": "Figure 8.",
          "pos": [
            0,
            9
          ]
        },
        {
          "content": "Cross-Validating a Binary Classification Model.",
          "pos": [
            10,
            57
          ]
        }
      ]
    },
    {
      "pos": [
        14433,
        14540
      ],
      "content": "<ph id=\"ph30\">![</ph>Cross-Validation Results of a Binary Classifier<ph id=\"ph31\">](media/machine-learning-evaluate-model-performance/9.png)</ph>"
    },
    {
      "pos": [
        14542,
        14600
      ],
      "content": "Figure 9. Cross-Validation Results of a Binary Classifier.",
      "nodes": [
        {
          "content": "Figure 9.",
          "pos": [
            0,
            9
          ]
        },
        {
          "content": "Cross-Validation Results of a Binary Classifier.",
          "pos": [
            10,
            58
          ]
        }
      ]
    },
    {
      "pos": [
        14602,
        15325
      ],
      "content": "##Evaluating a Multiclass Classification Model##\nIn this experiment we will use the popular <bpt id=\"p29\">[</bpt>Iris<ept id=\"p29\">](http://archive.ics.uci.edu/ml/datasets/Iris \"Iris\")</ept><ph id=\"ph32\"/> dataset which contains instances of 3 different types (classes) of the iris plant. There are 4 feature values (sepal length/width and petal length/width) for each instance. In the previous experiments we trained and tested the models using the same datasets. Here, we will use the [Split][split] module to create 2 subsets of the data, train on the first, and score and evaluate on the second. \n<ph id=\"ph33\"/>The Iris dataset is publicly available on the <bpt id=\"p30\">[</bpt>UCI Machine Learning Repository<ept id=\"p30\">](http://archive.ics.uci.edu/ml/index.html)</ept>, and can be downloaded using a [Reader][reader] module.",
      "nodes": [
        {
          "content": "Evaluating a Multiclass Classification Model##\nIn this experiment we will use the popular <bpt id=\"p29\">[</bpt>Iris<ept id=\"p29\">](http://archive.ics.uci.edu/ml/datasets/Iris \"Iris\")</ept><ph id=\"ph32\"/> dataset which contains instances of 3 different types (classes) of the iris plant.",
          "pos": [
            2,
            288
          ]
        },
        {
          "content": "There are 4 feature values (sepal length/width and petal length/width) for each instance.",
          "pos": [
            289,
            378
          ]
        },
        {
          "content": "In the previous experiments we trained and tested the models using the same datasets.",
          "pos": [
            379,
            464
          ]
        },
        {
          "content": "Here, we will use the [Split][split] module to create 2 subsets of the data, train on the first, and score and evaluate on the second.",
          "pos": [
            465,
            599
          ]
        },
        {
          "content": "<ph id=\"ph33\"/>The Iris dataset is publicly available on the <bpt id=\"p30\">[</bpt>UCI Machine Learning Repository<ept id=\"p30\">](http://archive.ics.uci.edu/ml/index.html)</ept>, and can be downloaded using a [Reader][reader] module.",
          "pos": [
            601,
            833
          ]
        }
      ]
    },
    {
      "pos": [
        15330,
        15353
      ],
      "content": "Creating the Experiment"
    },
    {
      "pos": [
        15357,
        15434
      ],
      "content": "Add the following modules to your workspace in Azure Machine Learning Studio:"
    },
    {
      "pos": [
        15438,
        15454
      ],
      "content": "[Reader][reader]"
    },
    {
      "pos": [
        15457,
        15513
      ],
      "content": "[Multiclass Decision Forest][multiclass-decision-forest]"
    },
    {
      "pos": [
        15516,
        15530
      ],
      "content": "[Split][split]"
    },
    {
      "pos": [
        15533,
        15559
      ],
      "content": "[Train Model][train-model]"
    },
    {
      "pos": [
        15562,
        15588
      ],
      "content": "[Score Model][score-model]"
    },
    {
      "pos": [
        15591,
        15623
      ],
      "content": "[Evaluate Model][evaluate-model]"
    },
    {
      "pos": [
        15625,
        15671
      ],
      "content": "Connect the ports as shown below in Figure 10."
    },
    {
      "pos": [
        15673,
        15835
      ],
      "content": "Set the Label column index of the [Train Model][train-model] module to 5. The dataset has no header row but we know that the class labels are in the fifth column.",
      "nodes": [
        {
          "content": "Set the Label column index of the [Train Model][train-model] module to 5.",
          "pos": [
            0,
            73
          ]
        },
        {
          "content": "The dataset has no header row but we know that the class labels are in the fifth column.",
          "pos": [
            74,
            162
          ]
        }
      ]
    },
    {
      "pos": [
        15837,
        16021
      ],
      "content": "Click on the [Reader][reader] module and set the <bpt id=\"p31\">*</bpt>Data source<ept id=\"p31\">*</ept><ph id=\"ph34\"/> property to <bpt id=\"p32\">*</bpt>Web URL via HTTP<ept id=\"p32\">*</ept>, and the <bpt id=\"p33\">*</bpt>URL<ept id=\"p33\">*</ept><ph id=\"ph35\"/> to http://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data."
    },
    {
      "pos": [
        16023,
        16124
      ],
      "content": "Set the fraction of instances to be used for training in the [Split][split] module (0.7 for example)."
    },
    {
      "pos": [
        16127,
        16222
      ],
      "content": "<ph id=\"ph36\">![</ph>Evaluating a Multiclass Classifier<ph id=\"ph37\">](media/machine-learning-evaluate-model-performance/10.png)</ph>"
    },
    {
      "pos": [
        16224,
        16269
      ],
      "content": "Figure 10. Evaluating a Multiclass Classifier",
      "nodes": [
        {
          "content": "Figure 10.",
          "pos": [
            0,
            10
          ]
        },
        {
          "content": "Evaluating a Multiclass Classifier",
          "pos": [
            11,
            45
          ]
        }
      ]
    },
    {
      "pos": [
        16274,
        16307
      ],
      "content": "Inspecting the Evaluation Results"
    },
    {
      "pos": [
        16311,
        16552
      ],
      "content": "Run the experiment and click on the output port of [Evaluate Model][evaluate-model]. The evaluation results are presented in the form of a confusion matrix, in this case. The matrix shows the actual vs. predicted instances for all 3 classes.",
      "nodes": [
        {
          "content": "Run the experiment and click on the output port of [Evaluate Model][evaluate-model].",
          "pos": [
            0,
            84
          ]
        },
        {
          "content": "The evaluation results are presented in the form of a confusion matrix, in this case.",
          "pos": [
            85,
            170
          ]
        },
        {
          "content": "The matrix shows the actual vs. predicted instances for all 3 classes.",
          "pos": [
            171,
            241
          ]
        }
      ]
    },
    {
      "pos": [
        16555,
        16660
      ],
      "content": "<ph id=\"ph38\">![</ph>Multiclass Classification Evaluation Results<ph id=\"ph39\">](media/machine-learning-evaluate-model-performance/11.png)</ph>"
    },
    {
      "pos": [
        16662,
        16718
      ],
      "content": "Figure 11. Multiclass Classification Evaluation Results.",
      "nodes": [
        {
          "content": "Figure 11.",
          "pos": [
            0,
            10
          ]
        },
        {
          "content": "Multiclass Classification Evaluation Results.",
          "pos": [
            11,
            56
          ]
        }
      ]
    },
    {
      "pos": [
        16723,
        16745
      ],
      "content": "Using Cross Validation"
    },
    {
      "pos": [
        16749,
        17833
      ],
      "content": "As mentioned earlier, you can perform repeated training, scoring and evaluations automatically using the [Cross-Validate Model][cross-validate-model] module. You would need a dataset, an untrained model, and a [Cross-Validate Model][cross-validate-model] module (see figure below). Again you need to set the label column of the [Cross-Validate Model][cross-validate-model] module (column index 5 in this case). After running the experiment and clicking the right output port of the [Cross-Validate Model][cross-validate-model], you can inspect the metric values for each fold as well as the mean and standard deviation. The metrics displayed here are the similar to the ones discussed in the binary classification case. However, note that in multiclass classification, computing the true positives/negatives and false positives/negatives is done by counting on a per-class basis, as there is no overall positive or negative class. For example, when computing the precision or recall of the ‘Iris-setosa’ class, it is assumed that this is the positive class and all others as negative.",
      "nodes": [
        {
          "content": "As mentioned earlier, you can perform repeated training, scoring and evaluations automatically using the [Cross-Validate Model][cross-validate-model] module.",
          "pos": [
            0,
            157
          ]
        },
        {
          "content": "You would need a dataset, an untrained model, and a [Cross-Validate Model][cross-validate-model] module (see figure below).",
          "pos": [
            158,
            281
          ]
        },
        {
          "content": "Again you need to set the label column of the [Cross-Validate Model][cross-validate-model] module (column index 5 in this case).",
          "pos": [
            282,
            410
          ]
        },
        {
          "content": "After running the experiment and clicking the right output port of the [Cross-Validate Model][cross-validate-model], you can inspect the metric values for each fold as well as the mean and standard deviation.",
          "pos": [
            411,
            619
          ]
        },
        {
          "content": "The metrics displayed here are the similar to the ones discussed in the binary classification case.",
          "pos": [
            620,
            719
          ]
        },
        {
          "content": "However, note that in multiclass classification, computing the true positives/negatives and false positives/negatives is done by counting on a per-class basis, as there is no overall positive or negative class.",
          "pos": [
            720,
            930
          ]
        },
        {
          "content": "For example, when computing the precision or recall of the ‘Iris-setosa’ class, it is assumed that this is the positive class and all others as negative.",
          "pos": [
            931,
            1084
          ]
        }
      ]
    },
    {
      "pos": [
        17836,
        17947
      ],
      "content": "<ph id=\"ph40\">![</ph>Cross-Validating a Multiclass Classification Model<ph id=\"ph41\">](media/machine-learning-evaluate-model-performance/12.png)</ph>"
    },
    {
      "pos": [
        17949,
        18011
      ],
      "content": "Figure 12. Cross-Validating a Multiclass Classification Model.",
      "nodes": [
        {
          "content": "Figure 12.",
          "pos": [
            0,
            10
          ]
        },
        {
          "content": "Cross-Validating a Multiclass Classification Model.",
          "pos": [
            11,
            62
          ]
        }
      ]
    },
    {
      "pos": [
        18014,
        18136
      ],
      "content": "<ph id=\"ph42\">![</ph>Cross-Validation Results of a Multiclass Classification Model<ph id=\"ph43\">](media/machine-learning-evaluate-model-performance/13.png)</ph>"
    },
    {
      "pos": [
        18138,
        18211
      ],
      "content": "Figure 13. Cross-Validation Results of a Multiclass Classification Model.",
      "nodes": [
        {
          "content": "Figure 13.",
          "pos": [
            0,
            10
          ]
        },
        {
          "content": "Cross-Validation Results of a Multiclass Classification Model.",
          "pos": [
            11,
            73
          ]
        }
      ]
    },
    {
      "pos": [
        18241,
        19126
      ],
      "content": "[cross-validate-model]: https://msdn.microsoft.com/library/azure/75fb875d-6b86-4d46-8bcc-74261ade5826/\n[evaluate-model]: https://msdn.microsoft.com/library/azure/927d65ac-3b50-4694-9903-20f6c1672089/\n[linear-regression]: https://msdn.microsoft.com/library/azure/31960a6f-789b-4cf7-88d6-2e1152c0bd1a/\n[multiclass-decision-forest]: https://msdn.microsoft.com/library/azure/5e70108d-2e44-45d9-86e8-94f37c68fe86/\n[reader]: https://msdn.microsoft.com/library/azure/4e1b0fe6-aded-4b3f-a36f-39b8862b9004/\n[score-model]: https://msdn.microsoft.com/library/azure/401b4f92-e724-4d5a-be81-d5b0ff9bdb33/\n[split]: https://msdn.microsoft.com/library/azure/70530644-c97a-4ab6-85f7-88bf30a8be5f/\n[train-model]: https://msdn.microsoft.com/library/azure/5cc7053e-aa30-450d-96c0-dae4be720977/\n[two-class-logistic-regression]: https://msdn.microsoft.com/library/azure/b0fd7660-eeed-43c5-9487-20d9cc79ed5d/"
    }
  ],
  "content": "<properties \n    pageTitle=\"Evaluate model performance in Machine Learning | Microsoft Azure\" \n    description=\"Explains how to evaluate model performance in Azure Machine Learning.\" \n    services=\"machine-learning\"\n    documentationCenter=\"\" \n    authors=\"garyericson\" \n    manager=\"paulettm\" \n    editor=\"cgronlun\"/>\n\n<tags \n    ms.service=\"machine-learning\" \n    ms.workload=\"data-services\" \n    ms.tgt_pltfrm=\"na\" \n    ms.devlang=\"na\" \n    ms.topic=\"article\" \n    ms.date=\"12/04/2015\" \n    ms.author=\"bradsev;garye\" />\n\n\n# How to evaluate model performance in Azure Machine Learning\n\nThis topic demonstrates how to evaluate the performance of a model in Azure Machine Learning Studio and provides a brief explanation of the metrics available for this task. Three common supervised learning scenarios are presented: \n\n* regression\n* binary classification \n* multiclass classification\n\n[AZURE.INCLUDE [machine-learning-free-trial](../../includes/machine-learning-free-trial.md)]\n\n\nEvaluating the performance of a model is one of the core stages in the data science process. It indicates how successful the scoring (predictions) of a dataset has been by a trained model. \n\nAzure Machine Learning supports model evaluation through two of its main machine learning modules: [Evaluate Model][evaluate-model] and [Cross-Validate Model][cross-validate-model]. These modules allow you to see how your model performs in terms of a number of metrics that are commonly used in machine learning and statistics.\n\n##Evaluation vs. Cross Validation##\nEvaluation and cross validation are standard ways to measure the performance of your model. They both generate evaluation metrics that you can inspect or compare against those of other models.\n\n[Evaluate Model][evaluate-model] expects a scored dataset as input (or 2 in case you would like to compare the performance of 2 different models). This means that you need to train your model using the [Train Model][train-model] module and make predictions on some dataset using the [Score Model][score-model] module, before you can evaluate the results. The evaluation is the based on the scored labels/probabilities along with the true labels, all of which are output by the [Score Model][score-model] module.\n\nAlternatively, you can use cross validation to perform a number of train-score-evaluate operations (10 folds) automatically on different subsets of the input data. The input data is split into 10 parts, where one is reserved for testing, and the other 9 for training. This process is repeated 10 times and the evaluation metrics are averaged. This helps in determining how well a model would generalize to new datasets. The [Cross-Validate Model][cross-validate-model] module takes in an untrained model and some labeled dataset and outputs the evaluation results of each of the 10 folds, in addition to the averaged results.\n\nIn the following sections, we will build simple regression and classification models and evaluate their performance, using both the [Evaluate Model][evaluate-model] and the [Cross-Validate Model][cross-validate-model] modules.\n\n##Evaluating a Regression Model##\nAssume we want to predict a car’s price using some features such as dimensions, horsepower, engine specs, and so on. This is a typical regression problem, where the target variable (*price*) is a continuous numeric value. We can fit a simple linear regression model that, given the feature values of a certain car, can predict the price of that car. This regression model can be used to score the same dataset we trained on. Once we have the predicted prices for all of the cars, we can evaluate the performance of the model by looking at how much the predictions deviate from the actual prices on average. To illustrate this, we use the *Automobile price data (Raw) dataset* available in the **Saved Datasets** section in Azure Machine Learning Studio.\n \n###Creating the Experiment###\nAdd the following modules to your workspace in Azure Machine Learning Studio:\n\n- Automobile price data (Raw)\n- [Linear Regression][linear-regression]\n- [Train Model][train-model]\n- [Score Model][score-model]\n- [Evaluate Model][evaluate-model]\n\n\nConnect the ports as shown below in Figure 1 and set the Label column of the [Train Model][train-model] module to *price*.\n \n![Evaluating a Regression Model](media/machine-learning-evaluate-model-performance/1.png)\n\nFigure 1. Evaluating a Regression Model.\n\n###Inspecting the Evaluation Results###\nAfter running the experiment, you can click on the output port of the [Evaluate Model][evaluate-model] module and select *Visualize* to see the evaluation results. The evaluation metrics available for regression models are: *Mean Absolute Error*, *Root Mean Absolute Error*, *Relative Absolute Error*, *Relative Squared Error*, and the *Coefficient of Determination*.\n\nThe term \"error\" here represents the difference between the predicted value and the true value. The absolute value or the square of this difference are usually computed to capture the total magnitude of error across all instances, as the difference between the predicted and true value could be negative in some cases. The error metrics measure the predictive performance of a regression model in terms of the mean deviation of its predictions from the true values. Lower error values mean the model is more accurate in making predictions. An overall error metric of 0 means that the model fits the data perfectly.\n\nThe coefficient of determination, which is also known as R squared, is also a standard way of measuring how well the model fits the data. It can be interpreted as the proportion of variation explained by the model. A higher proportion is better in this case, where 1 indicates a perfect fit.\n \n![Linear Regression Evaluation Metrics](media/machine-learning-evaluate-model-performance/2.png)\n\nFigure 2. Linear Regression Evaluation Metrics.\n\n###Using Cross Validation###\nAs mentioned earlier, you can perform repeated training, scoring and evaluations automatically using the [Cross-Validate Model][cross-validate-model] module. All you need in this case is a dataset, an untrained model, and a [Cross-Validate Model][cross-validate-model] module (see figure below). Note that you need to set the label column to *price* in the [Cross-Validate Model][cross-validate-model] module’s properties.\n\n![Cross-Validating a Regression Model](media/machine-learning-evaluate-model-performance/3.png)\n\nFigure 3. Cross-Validating a Regression Model.\n\nAfter running the experiment, you can inspect the evaluation results by clicking on the right output port of the [Cross-Validate Model][cross-validate-model] module. This will provide a detailed view of the metrics for each iteration (fold), and the averaged results of each of the metrics (Figure 4).\n \n![Cross-Validation Results of a Regression Model](media/machine-learning-evaluate-model-performance/4.png)\n\nFigure 4. Cross-Validation Results of a Regression Model.\n\n##Evaluating a Binary Classification Model##\nIn a binary classification scenario, the target variable has only two possible outcomes, for example: {0, 1} or {false, true}, {negative, positive}. Assume you are given a dataset of adult employees with some demographic and employment variables, and that you are asked to predict the income level, a binary variable with the values {“<=50K”, “>50K”}. In other words, the negative class represents the employees who make less than or equal to 50K per year, and the positive class represents all other employees. As in the regression scenario, we would train a model, score some data, and evaluate the results. The main difference here is the choice of metrics Azure Machine Learning computes and outputs. To illustrate the income level prediction scenario, we will use the [Adult](http://archive.ics.uci.edu/ml/datasets/Adult) dataset to create an Azure Machine Learning experiment and evaluate the performance of a two-class logistic regression model, a commonly used binary classifier.\n\n###Creating the Experiment###\nAdd the following modules to your workspace in Azure Machine Learning Studio:\n\n- Adult Census Income Binary Classification dataset\n- [Two-Class Logistic Regression][two-class-logistic-regression]\n- [Train Model][train-model]\n- [Score Model][score-model]\n- [Evaluate Model][evaluate-model]\n\nConnect the ports as shown below in Figure 5 and set the Label column of the [Train Model][train-model] module to *income*.\n\n![Evaluating a Binary Classification Model](media/machine-learning-evaluate-model-performance/5.png)\n\nFigure 5. Evaluating a Binary Classification Model.\n\n###Inspecting the Evaluation Results###\nAfter running the experiment, you can click on the output port of the [Evaluate Model][evaluate-model] module and select *Visualize* to see the evaluation results (Figure 7). The evaluation metrics available for binary classification models are: *Accuracy*, *Precision*, *Recall*, *F1 Score*, and *AUC*. In addition, the module outputs a confusion matrix showing the number of true positives, false negatives, false positives, and true negatives, as well as *ROC*, *Precision/Recall*, and *Lift* curves.\n\nAccuracy is simply the proportion of correctly classified instances. It is usually the first metric you look at when evaluating a classifier. However, when the test data is unbalanced (where most of the instances belong to one of the classes), or you are more interested in the performance on either one of the classes, accuracy doesn’t really capture the effectiveness of a classifier. In the income level classification scenario, assume you are testing on some data where 99% of the instances represent people who earn less than or equal to 50K per year. It is possible to achieve a 0.99 accuracy by predicting the class “<=50K” for all instances. The classifier in this case appears to be doing a good job overall, but in reality, it fails to classify any of the high-income individuals (the 1%) correctly.\n\nFor that reason, it is helpful to compute additional metrics that capture more specific aspects of the evaluation. Before going into the details of such metrics, it is important to understand the confusion matrix of a binary classification evaluation. The class labels in the training set can take on only 2 possible values, which we usually refer to as positive or negative. The positive and negative instances that a classifier predicts correctly are called true positives (TP) and true negatives (TN), respectively. Similarly, the incorrectly classified instances are called false positives (FP) and false negatives (FN). The confusion matrix is simply a table showing the number of instances that fall under each of these 4 categories. Azure Machine Learning automatically decides which of the two classes in the dataset is the positive class. If the class labels are Boolean or integers, then the ‘true’ or ‘1’ labeled instances are assigned the positive class. If the labels are strings, as in the case of the income dataset, the labels are sorted alphabetically and the first level is chosen to be the negative class while the second level is the positive class.\n\n![Binary Classification Confusion Matrix](media/machine-learning-evaluate-model-performance/6a.png)\n\nFigure 6. Binary Classification Confusion Matrix.\n\nGoing back to the income classification problem, we would want to ask several evaluation questions that help us understand the performance of the classifier used. A very natural question is: ‘Out of the individuals whom the model predicted to be earning >50K (TP+FP), how many were classified correctly (TP)?’ This question can be answered by looking at the **Precision** of the model, which is the proportion of positives that are classified correctly: TP/(TP+FP). Another common question is “Out of all the high earning employees with income >50k (TP+FN), how many did the classifier classify correctly (TP)”. This is actually the **Recall**, or the true positive rate: TP/(TP+FN) of the classifier. You might notice that there is an obvious trade-off between precision and recall. For example, given a relatively balanced dataset, a classifier that predicts mostly positive instances, would have a high recall, but a rather low precision as many of the negative instances would be misclassified resulting in a large number of false positives. To see a plot of how these two metrics vary, you can click on the ‘PRECISION/RECALL’ curve in the evaluation result output page (top left part of Figure 7).\n\n![Binary Classification Evaluation Results](media/machine-learning-evaluate-model-performance/7.png)\nFigure 7. Binary Classification Evaluation Results.\n\nAnother related metric that is often used is the **F1 Score**, which takes both precision and recall into consideration. It is the harmonic mean of these 2 metrics and is computed as such: F1 = 2 (precision x recall) / (precision + recall). The F1 score is a good way to summarize the evaluation in a single number, but it’s always a good practice to look at both precision and recall together to better understand how a classifier behaves.\n\nIn addition, one can inspect the true positive rate vs. the false positive rate in the **Receiver Operating Characteristic (ROC)** curve and the corresponding **Area Under the Curve (AUC)** value. The closer this curve is to the upper left corner, the better the classifier’s performance is (that is maximizing the true positive rate while minimizing the false positive rate). Curves that are close to the diagonal of the plot, result from classifiers that tend to make predictions that are close to random guessing.\n\n###Using Cross Validation###\nAs in the regression example, we can perform cross validation to repeatedly train, score and evaluate different subsets of the data automatically. Similarly, we can use the [Cross-Validate Model][cross-validate-model] module, an untrained logistic regression model, and a dataset. The label column must be set to *income* in the [Cross-Validate Model][cross-validate-model] module’s properties. After running the experiment and clicking on the right output port of the [Cross-Validate Model][cross-validate-model] module, we can see the binary classification metric values for each fold, in addition to the mean and standard deviation of each. \n \n![Cross-Validating a Binary Classification Model](media/machine-learning-evaluate-model-performance/8.png)\n\nFigure 8. Cross-Validating a Binary Classification Model.\n\n![Cross-Validation Results of a Binary Classifier](media/machine-learning-evaluate-model-performance/9.png)\n\nFigure 9. Cross-Validation Results of a Binary Classifier.\n\n##Evaluating a Multiclass Classification Model##\nIn this experiment we will use the popular [Iris](http://archive.ics.uci.edu/ml/datasets/Iris \"Iris\") dataset which contains instances of 3 different types (classes) of the iris plant. There are 4 feature values (sepal length/width and petal length/width) for each instance. In the previous experiments we trained and tested the models using the same datasets. Here, we will use the [Split][split] module to create 2 subsets of the data, train on the first, and score and evaluate on the second. \nThe Iris dataset is publicly available on the [UCI Machine Learning Repository](http://archive.ics.uci.edu/ml/index.html), and can be downloaded using a [Reader][reader] module.\n\n###Creating the Experiment###\nAdd the following modules to your workspace in Azure Machine Learning Studio:\n\n- [Reader][reader]\n- [Multiclass Decision Forest][multiclass-decision-forest]\n- [Split][split]\n- [Train Model][train-model]\n- [Score Model][score-model]\n- [Evaluate Model][evaluate-model]\n\nConnect the ports as shown below in Figure 10.\n\nSet the Label column index of the [Train Model][train-model] module to 5. The dataset has no header row but we know that the class labels are in the fifth column.\n\nClick on the [Reader][reader] module and set the *Data source* property to *Web URL via HTTP*, and the *URL* to http://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data.\n\nSet the fraction of instances to be used for training in the [Split][split] module (0.7 for example).\n \n![Evaluating a Multiclass Classifier](media/machine-learning-evaluate-model-performance/10.png)\n\nFigure 10. Evaluating a Multiclass Classifier\n\n###Inspecting the Evaluation Results###\nRun the experiment and click on the output port of [Evaluate Model][evaluate-model]. The evaluation results are presented in the form of a confusion matrix, in this case. The matrix shows the actual vs. predicted instances for all 3 classes.\n \n![Multiclass Classification Evaluation Results](media/machine-learning-evaluate-model-performance/11.png)\n\nFigure 11. Multiclass Classification Evaluation Results.\n\n###Using Cross Validation###\nAs mentioned earlier, you can perform repeated training, scoring and evaluations automatically using the [Cross-Validate Model][cross-validate-model] module. You would need a dataset, an untrained model, and a [Cross-Validate Model][cross-validate-model] module (see figure below). Again you need to set the label column of the [Cross-Validate Model][cross-validate-model] module (column index 5 in this case). After running the experiment and clicking the right output port of the [Cross-Validate Model][cross-validate-model], you can inspect the metric values for each fold as well as the mean and standard deviation. The metrics displayed here are the similar to the ones discussed in the binary classification case. However, note that in multiclass classification, computing the true positives/negatives and false positives/negatives is done by counting on a per-class basis, as there is no overall positive or negative class. For example, when computing the precision or recall of the ‘Iris-setosa’ class, it is assumed that this is the positive class and all others as negative.\n \n![Cross-Validating a Multiclass Classification Model](media/machine-learning-evaluate-model-performance/12.png)\n\nFigure 12. Cross-Validating a Multiclass Classification Model.\n\n\n![Cross-Validation Results of a Multiclass Classification Model](media/machine-learning-evaluate-model-performance/13.png)\n\nFigure 13. Cross-Validation Results of a Multiclass Classification Model.\n\n\n<!-- Module References -->\n[cross-validate-model]: https://msdn.microsoft.com/library/azure/75fb875d-6b86-4d46-8bcc-74261ade5826/\n[evaluate-model]: https://msdn.microsoft.com/library/azure/927d65ac-3b50-4694-9903-20f6c1672089/\n[linear-regression]: https://msdn.microsoft.com/library/azure/31960a6f-789b-4cf7-88d6-2e1152c0bd1a/\n[multiclass-decision-forest]: https://msdn.microsoft.com/library/azure/5e70108d-2e44-45d9-86e8-94f37c68fe86/\n[reader]: https://msdn.microsoft.com/library/azure/4e1b0fe6-aded-4b3f-a36f-39b8862b9004/\n[score-model]: https://msdn.microsoft.com/library/azure/401b4f92-e724-4d5a-be81-d5b0ff9bdb33/\n[split]: https://msdn.microsoft.com/library/azure/70530644-c97a-4ab6-85f7-88bf30a8be5f/\n[train-model]: https://msdn.microsoft.com/library/azure/5cc7053e-aa30-450d-96c0-dae4be720977/\n[two-class-logistic-regression]: https://msdn.microsoft.com/library/azure/b0fd7660-eeed-43c5-9487-20d9cc79ed5d/\n "
}