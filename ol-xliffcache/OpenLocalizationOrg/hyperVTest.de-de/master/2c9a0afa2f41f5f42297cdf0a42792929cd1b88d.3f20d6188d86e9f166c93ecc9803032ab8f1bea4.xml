{"nodes":[{"pos":[0,100],"content":"ms.ContentId: B9414110-BEFD-423F-9AD8-AFD5EE612CDA title: Step 8: Experiment with Windows PowerShell","source":"ms.ContentId: B9414110-BEFD-423F-9AD8-AFD5EE612CDA\ntitle: Step 8: Experiment with Windows PowerShell"},{"content":"Step 8: Experiment with Windows PowerShell","pos":[104,146]},{"content":"Test update to see if new XLIF contains everything.","pos":[148,199]},{"content":"Now that you have walked through the basics of deploying Hyper-V, creating virtual machines and managing these virtual machines, let’s explore how you can automate many of these activities with PowerShell.","pos":[200,405]},{"content":"Return a list of Hyper-V commands","pos":[411,444]},{"pos":[450,505],"content":"Click on the Windows start button, type <bpt id=\"p1\">**</bpt>PowerShell<ept id=\"p1\">**</ept>.","source":"Click on the Windows start button, type **PowerShell**."},{"content":"Run the following command to display a searchable list of PowerShell commands available with the Hyper-V PowerShell Module.","pos":[510,633]},{"content":"You get something like this:","pos":[699,727]},{"content":"To learn more about a particular PowerShell command use <ph id=\"ph1\">`get-help`</ph>.","pos":[763,830],"source":"To learn more about a particular PowerShell command use `get-help`."},{"content":"For instance running the following command will return information about the <ph id=\"ph1\">`get-vm`</ph> Hyper-V command.","pos":[831,933],"source":" For instance running the following command will return information about the `get-vm` Hyper-V command."},{"content":"The output shows you how to structure the command, what the required and optional parameters are, and the aliases that you can use.","pos":[972,1103]},{"content":"Return a list of virtual machines","pos":[1136,1169]},{"pos":[1171,1233],"content":"Use the <ph id=\"ph1\">`get-vm`</ph> command to return a list of virtual machines.","source":"Use the `get-vm` command to return a list of virtual machines."},{"content":"In PowerShell, run the following command:","pos":[1238,1279]},{"content":"This displays something like this:","pos":[1309,1343]},{"content":"To return a list of only powered on virtual machines add a filter to the <ph id=\"ph1\">`get-vm`</ph> command.","pos":[1372,1462],"source":"To return a list of only powered on virtual machines add a filter to the `get-vm` command."},{"content":"A filter can be added by using the where-object command.","pos":[1463,1519]},{"content":"For more information on filtering see the <bpt id=\"p1\">[</bpt>Using the Where-Object<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/ee177028.aspx)</ept> documentation.","pos":[1520,1660],"source":" For more information on filtering see the [Using the Where-Object](https://technet.microsoft.com/en-us/library/ee177028.aspx) documentation."},{"content":"To list all virtual machines in a powered off state, run the following command.","pos":[1730,1809]},{"content":"This command is a copy of the command from step 2 with the filter changed from ‘Running’ to ‘Off’.","pos":[1810,1908]},{"content":"Start and shut down virtual machines","pos":[1972,2008]},{"content":"To start a particular virtual machine, run the following command with name of the virtual machine:","pos":[2013,2111]},{"content":"To start all currently powered off virtual machines, get a list of those machines and pipe the list to the 'start-vm' command:","pos":[2176,2302]},{"content":"To shut down all running virtual machines, run this:","pos":[2376,2428]},{"content":"Create a VM checkpoint","pos":[2508,2530]},{"content":"To create a checkpoint using PowerShell, select the virtual machine using the <ph id=\"ph1\">`get-vm`</ph> command and pipe this to the <ph id=\"ph2\">`checkpoint-vm`</ph> command.","pos":[2532,2672],"source":"To create a checkpoint using PowerShell, select the virtual machine using the `get-vm` command and pipe this to the `checkpoint-vm` command."},{"content":"Finally give the checkpoint a name using <ph id=\"ph1\">`-snapshotname`</ph>.","pos":[2673,2730],"source":" Finally give the checkpoint a name using `-snapshotname`."},{"content":"The complete command will look like the following:","pos":[2731,2781]},{"content":"For example, here is a checkpoint with the name DEMOCP:","pos":[2877,2932]},{"content":"Create a new virtual machine","pos":[2965,2993]},{"content":"The following example shows how to create a new virtual machine in the PowerShell Integrated Scripting Environment (ISE).","pos":[2995,3116]},{"content":"This is a simple example and could be expanded on to include additional PowerShell features and more advanced VM deployments.","pos":[3117,3242]},{"pos":[3247,3314],"content":"To open the PowerShell ISE click on start, type <bpt id=\"p1\">**</bpt>PowerShell ISE<ept id=\"p1\">**</ept>.","source":"To open the PowerShell ISE click on start, type **PowerShell ISE**."},{"content":"Run the following code to create a virtual machine.","pos":[3318,3369]},{"content":"See the <bpt id=\"p1\">[</bpt>New-VM<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/hh848537.aspx)</ept> documentation for detailed information on the New-VM command.","pos":[3370,3507],"source":" See the [New-VM](https://technet.microsoft.com/en-us/library/hh848537.aspx) documentation for detailed information on the New-VM command."},{"content":"Wrap up and References","pos":[3864,3886]},{"content":"This document has shown some simple steps to explorer the Hyper-V PowerShell module as well as some sample scenarios.","pos":[3888,4005]},{"content":"For more information on the Hyper-V PowerShell module, see the <bpt id=\"p1\">[</bpt>Hyper-V Cmdlets in Windows PowerShell reference<ept id=\"p1\">](https://technet.microsoft.com/%5Clibrary/Hh848559.aspx)</ept>.","pos":[4006,4175],"source":" For more information on the Hyper-V PowerShell module, see the [Hyper-V Cmdlets in Windows PowerShell reference](https://technet.microsoft.com/%5Clibrary/Hh848559.aspx)."}],"content":"ms.ContentId: B9414110-BEFD-423F-9AD8-AFD5EE612CDA\ntitle: Step 8: Experiment with Windows PowerShell\n\n# Step 8: Experiment with Windows PowerShell\n\nTest update to see if new XLIF contains everything. Now that you have walked through the basics of deploying Hyper-V, creating virtual machines and managing these virtual machines, let’s explore how you can automate many of these activities with PowerShell.\n\n### Return a list of Hyper-V commands\n\n1.  Click on the Windows start button, type **PowerShell**.\n2.  Run the following command to display a searchable list of PowerShell commands available with the Hyper-V PowerShell Module.\n\n ```powershell\nget-command –module hyper-v | out-gridview\n```\n  You get something like this:\n\n  ![](media\\command_grid.png)\n\n3. To learn more about a particular PowerShell command use `get-help`. For instance running the following command will return information about the `get-vm` Hyper-V command.\n\n  ```powershell\nget-help get-vm\n```\n The output shows you how to structure the command, what the required and optional parameters are, and the aliases that you can use.\n\n ![](media\\get_help.png)\n\n\n### Return a list of virtual machines\n\nUse the `get-vm` command to return a list of virtual machines.\n\n1. In PowerShell, run the following command:\n \n ```powershell\nget-vm\n```\n This displays something like this:\n\n ![](media\\get_vm.png)\n\n2. To return a list of only powered on virtual machines add a filter to the `get-vm` command. A filter can be added by using the where-object command. For more information on filtering see the [Using the Where-Object](https://technet.microsoft.com/en-us/library/ee177028.aspx) documentation.   \n\n ```powershell\n get-vm | where {$_.State –eq ‘Running’}\n ```\n3.  To list all virtual machines in a powered off state, run the following command. This command is a copy of the command from step 2 with the filter changed from ‘Running’ to ‘Off’.\n\n ```powershell\n get-vm | where {$_.State –eq ‘Off’}\n ```\n\n### Start and shut down virtual machines\n\n1. To start a particular virtual machine, run the following command with name of the virtual machine:\n\n ```powershell\n Start-vm –Name <virtual machine name>\n ```\n\n2. To start all currently powered off virtual machines, get a list of those machines and pipe the list to the 'start-vm' command:\n\n  ```powershell\n get-vm | where {$_.State –eq ‘Off’} | start-vm\n ```\n3. To shut down all running virtual machines, run this:\n \n  ```powershell\n get-vm | where {$_.State –eq ‘Running’} | stop-vm\n ```\n\n### Create a VM checkpoint\n\nTo create a checkpoint using PowerShell, select the virtual machine using the `get-vm` command and pipe this to the `checkpoint-vm` command. Finally give the checkpoint a name using `-snapshotname`. The complete command will look like the following:\n\n ```powershell\n get-vm -Name <VM Name> | checkpoint-vm -snapshotname <name for snapshot>\n ```\nFor example, here is a checkpoint with the name DEMOCP:\n \n ![](media\\POSH_CP2.png)\n\n### Create a new virtual machine\n\nThe following example shows how to create a new virtual machine in the PowerShell Integrated Scripting Environment (ISE). This is a simple example and could be expanded on to include additional PowerShell features and more advanced VM deployments.\n\n1. To open the PowerShell ISE click on start, type **PowerShell ISE**.\n2. Run the following code to create a virtual machine. See the [New-VM](https://technet.microsoft.com/en-us/library/hh848537.aspx) documentation for detailed information on the New-VM command.\n\n  ```powershell\n $VMName = \"VMNAME\"\n\n $VM = @{\n     Name = $VMName \n     MemoryStartupBytes = 2147483648\n     Generation = 2\n     NewVHDPath = \"C:\\Virtual Machines\\$VMName\\$VMName.vhdx\"\n     NewVHDSizeBytes = 53687091200\n     BootDevice = \"VHD\"\n     Path = \"C:\\Virtual Machines\\$VMName \"\n     SwitchName = (get-vmswitch).Name[0]\n }\n\n New-VM @VM\n  ```\n\n## Wrap up and References\n\nThis document has shown some simple steps to explorer the Hyper-V PowerShell module as well as some sample scenarios. For more information on the Hyper-V PowerShell module, see the [Hyper-V Cmdlets in Windows PowerShell reference](https://technet.microsoft.com/%5Clibrary/Hh848559.aspx).  \n \n"}