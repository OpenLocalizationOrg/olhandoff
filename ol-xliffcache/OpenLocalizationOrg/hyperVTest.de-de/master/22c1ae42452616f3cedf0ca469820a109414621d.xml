{
  "nodes": [
    {
      "pos": [
        27,
        85
      ],
      "content": "Connect Excel to Hadoop with Power Query | Microsoft Azure"
    },
    {
      "pos": [
        104,
        243
      ],
      "content": "Learn how to take advantage of business intelligence components and use Power Query for Excel to access data stored in Hadoop on HDInsight."
    },
    {
      "pos": [
        567,
        611
      ],
      "content": "Connect Excel to Hadoop by using Power Query"
    },
    {
      "pos": [
        613,
        1121
      ],
      "content": "One key feature of the Microsoft big-data solution is the integration of Microsoft business intelligence (BI) components with Hadoop clusters in Azure HDInsight. A primary example of this integration is the ability to connect Excel to the Azure Storage account that contains the data associated with your Hadoop cluster by using the Microsoft Power Query for Excel add-in. This article walks you through how to set up and use Power Query to query data associated with a Hadoop cluster managed with HDInsight.",
      "nodes": [
        {
          "content": "One key feature of the Microsoft big-data solution is the integration of Microsoft business intelligence (BI) components with Hadoop clusters in Azure HDInsight.",
          "pos": [
            0,
            161
          ]
        },
        {
          "content": "A primary example of this integration is the ability to connect Excel to the Azure Storage account that contains the data associated with your Hadoop cluster by using the Microsoft Power Query for Excel add-in.",
          "pos": [
            162,
            372
          ]
        },
        {
          "content": "This article walks you through how to set up and use Power Query to query data associated with a Hadoop cluster managed with HDInsight.",
          "pos": [
            373,
            508
          ]
        }
      ]
    },
    {
      "pos": [
        1125,
        1285
      ],
      "content": "<ph id=\"ph2\">[AZURE.NOTE]</ph><ph id=\"ph3\"/> While the steps in this article can be used with either a Linux or Windows-based HDInsight cluster, Windows is required for the client workstation."
    },
    {
      "pos": [
        1291,
        1304
      ],
      "content": "Prerequisites"
    },
    {
      "pos": [
        1306,
        1365
      ],
      "content": "Before you begin this article, you must have the following:"
    },
    {
      "pos": [
        1369,
        1475
      ],
      "content": "<bpt id=\"p1\">**</bpt>An HDInsight cluster<ept id=\"p1\">**</ept>. To configure one, see <bpt id=\"p2\">[</bpt>Get started with Azure HDInsight<ept id=\"p2\">][hdinsight-get-started]</ept>.",
      "nodes": [
        {
          "content": "<bpt id=\"p1\">**</bpt>An HDInsight cluster<ept id=\"p1\">**</ept>.",
          "pos": [
            0,
            63
          ]
        },
        {
          "content": "To configure one, see <bpt id=\"p2\">[</bpt>Get started with Azure HDInsight<ept id=\"p2\">][hdinsight-get-started]</ept>.",
          "pos": [
            64,
            182
          ]
        }
      ]
    },
    {
      "pos": [
        1478,
        1575
      ],
      "content": "<bpt id=\"p3\">**</bpt>A workstation<ept id=\"p3\">**</ept><ph id=\"ph4\"/> that is running Windows 7, Windows Server 2008 R2, or a later operating system."
    },
    {
      "pos": [
        1578,
        1689
      ],
      "content": "<bpt id=\"p4\">**</bpt>Office 2013 Professional Plus, Office 365 ProPlus, Excel 2013 Standalone, or Office 2010 Professional Plus<ept id=\"p4\">**</ept>."
    },
    {
      "pos": [
        1695,
        1714
      ],
      "content": "Install Power Query"
    },
    {
      "pos": [
        1716,
        2002
      ],
      "content": "Power Query can be used to import data from a variety of sources into Microsoft Excel, where it can power BI tools like PowerPivot and Power View. In particular, Power Query can import data that has been output or that has been generated by a Hadoop job running on an HDInsight cluster.",
      "nodes": [
        {
          "content": "Power Query can be used to import data from a variety of sources into Microsoft Excel, where it can power BI tools like PowerPivot and Power View.",
          "pos": [
            0,
            146
          ]
        },
        {
          "content": "In particular, Power Query can import data that has been output or that has been generated by a Hadoop job running on an HDInsight cluster.",
          "pos": [
            147,
            286
          ]
        }
      ]
    },
    {
      "pos": [
        2004,
        2118
      ],
      "content": "Download Microsoft Power Query for Excel from the <bpt id=\"p5\">[</bpt>Microsoft Download Center<ept id=\"p5\">][powerquery-download]</ept><ph id=\"ph5\"/> and install it."
    },
    {
      "pos": [
        2123,
        2155
      ],
      "content": "Import HDInsight data into Excel"
    },
    {
      "pos": [
        2157,
        2361
      ],
      "content": "The Power Query add-in for Excel makes it easy to import data from your HDInsight cluster into Excel, where BI tools such as PowerPivot and Power Map can be used to inspect, analyze, and present the data."
    },
    {
      "pos": [
        2363,
        2407
      ],
      "content": "<bpt id=\"p6\">**</bpt>To import data from an HDInsight cluster<ept id=\"p6\">**</ept>"
    },
    {
      "pos": [
        2412,
        2423
      ],
      "content": "Open Excel."
    },
    {
      "pos": [
        2428,
        2456
      ],
      "content": "Create a new blank workbook."
    },
    {
      "pos": [
        2461,
        2565
      ],
      "content": "Click the <bpt id=\"p7\">**</bpt>Power Query<ept id=\"p7\">**</ept><ph id=\"ph6\"/> menu, click <bpt id=\"p8\">**</bpt>From Azure<ept id=\"p8\">**</ept>, and then click <bpt id=\"p9\">**</bpt>From Microsoft Azure HDInsight<ept id=\"p9\">**</ept>."
    },
    {
      "pos": [
        2571,
        2637
      ],
      "content": "<ph id=\"ph7\">![</ph>HDI.PowerQuery.SelectHdiSource<ph id=\"ph8\">][image-hdi-powerquery-hdi-source]</ph>"
    },
    {
      "pos": [
        2643,
        2934
      ],
      "content": "<bpt id=\"p10\">**</bpt>Note:<ept id=\"p10\">**</ept><ph id=\"ph9\"/> If you don't see the <bpt id=\"p11\">**</bpt>Power Query<ept id=\"p11\">**</ept><ph id=\"ph10\"/> menu, go to <bpt id=\"p12\">**</bpt>File<ept id=\"p12\">**</ept><ph id=\"ph11\"/> &gt; <bpt id=\"p13\">**</bpt>Options<ept id=\"p13\">**</ept><ph id=\"ph12\"/> &gt; <bpt id=\"p14\">**</bpt>Add-Ins<ept id=\"p14\">**</ept>, and select <bpt id=\"p15\">**</bpt>COM Add-ins<ept id=\"p15\">**</ept><ph id=\"ph13\"/> from the drop-down <bpt id=\"p16\">**</bpt>Manage<ept id=\"p16\">**</ept><ph id=\"ph14\"/> box at the bottom of the page. Select the <bpt id=\"p17\">**</bpt>Go...<ept id=\"p17\">**</ept><ph id=\"ph15\"/> button and verify that the box for the Power Query for Excel add-in has been checked.",
      "nodes": [
        {
          "content": "<bpt id=\"p10\">**</bpt>Note:<ept id=\"p10\">**</ept><ph id=\"ph9\"/> If you don't see the <bpt id=\"p11\">**</bpt>Power Query<ept id=\"p11\">**</ept><ph id=\"ph10\"/> menu, go to <bpt id=\"p12\">**</bpt>File<ept id=\"p12\">**</ept><ph id=\"ph11\"/> &gt; <bpt id=\"p13\">**</bpt>Options<ept id=\"p13\">**</ept><ph id=\"ph12\"/> &gt; <bpt id=\"p14\">**</bpt>Add-Ins<ept id=\"p14\">**</ept>, and select <bpt id=\"p15\">**</bpt>COM Add-ins<ept id=\"p15\">**</ept><ph id=\"ph13\"/> from the drop-down <bpt id=\"p16\">**</bpt>Manage<ept id=\"p16\">**</ept><ph id=\"ph14\"/> box at the bottom of the page.",
          "pos": [
            0,
            559
          ]
        },
        {
          "content": "Select the <bpt id=\"p17\">**</bpt>Go...<ept id=\"p17\">**</ept><ph id=\"ph15\"/> button and verify that the box for the Power Query for Excel add-in has been checked.",
          "pos": [
            560,
            721
          ]
        }
      ]
    },
    {
      "pos": [
        2940,
        3038
      ],
      "content": "<bpt id=\"p18\">**</bpt>Note:<ept id=\"p18\">**</ept><ph id=\"ph16\"/> Power Query also allows you to import data from HDFS by clicking <bpt id=\"p19\">**</bpt>From Other Sources<ept id=\"p19\">**</ept>."
    },
    {
      "pos": [
        3043,
        3387
      ],
      "content": "For <bpt id=\"p20\">**</bpt>Account Name<ept id=\"p20\">**</ept>, enter the name of the Azure Blob storage account associated with your cluster, and then click <bpt id=\"p21\">**</bpt>OK<ept id=\"p21\">**</ept>. This can be the <bpt id=\"p22\">[</bpt>default storage account<ept id=\"p22\">](hdinsight-administer-use-management-portal.md#find-the-default-storage-account)</ept><ph id=\"ph17\"/> or a linked storage account.  The format is <bpt id=\"p23\">*</bpt>https://<ph id=\"ph18\">&lt;StorageAccountName&gt;</ph>.blob.core.windows.net/<ept id=\"p23\">*</ept>.",
      "nodes": [
        {
          "content": "For <bpt id=\"p20\">**</bpt>Account Name<ept id=\"p20\">**</ept>, enter the name of the Azure Blob storage account associated with your cluster, and then click <bpt id=\"p21\">**</bpt>OK<ept id=\"p21\">**</ept>.",
          "pos": [
            0,
            203
          ]
        },
        {
          "content": "This can be the <bpt id=\"p22\">[</bpt>default storage account<ept id=\"p22\">](hdinsight-administer-use-management-portal.md#find-the-default-storage-account)</ept><ph id=\"ph17\"/> or a linked storage account.",
          "pos": [
            204,
            409
          ]
        },
        {
          "content": "The format is <bpt id=\"p23\">*</bpt>https://<ph id=\"ph18\">&lt;StorageAccountName&gt;</ph>.blob.core.windows.net/<ept id=\"p23\">*</ept>.",
          "pos": [
            411,
            544
          ]
        }
      ]
    },
    {
      "pos": [
        3392,
        3546
      ],
      "content": "For <bpt id=\"p24\">**</bpt>Account Key<ept id=\"p24\">**</ept>, enter the key for the Blob storage account, and then click <bpt id=\"p25\">**</bpt>Save<ept id=\"p25\">**</ept>. (You need to do this only the first time you access this store.)",
      "nodes": [
        {
          "content": "For <bpt id=\"p24\">**</bpt>Account Key<ept id=\"p24\">**</ept>, enter the key for the Blob storage account, and then click <bpt id=\"p25\">**</bpt>Save<ept id=\"p25\">**</ept>.",
          "pos": [
            0,
            169
          ]
        },
        {
          "content": "(You need to do this only the first time you access this store.)",
          "pos": [
            170,
            234
          ]
        }
      ]
    },
    {
      "pos": [
        3551,
        3724
      ],
      "content": "In the <bpt id=\"p26\">**</bpt>Navigator<ept id=\"p26\">**</ept><ph id=\"ph19\"/> pane on the left of the Query Editor, double-click the Blob storage container name. By default, the container name is the same name as the cluster name.",
      "nodes": [
        {
          "content": "In the <bpt id=\"p26\">**</bpt>Navigator<ept id=\"p26\">**</ept><ph id=\"ph19\"/> pane on the left of the Query Editor, double-click the Blob storage container name.",
          "pos": [
            0,
            159
          ]
        },
        {
          "content": "By default, the container name is the same name as the cluster name.",
          "pos": [
            160,
            228
          ]
        }
      ]
    },
    {
      "pos": [
        3729,
        3989
      ],
      "content": "Locate <bpt id=\"p27\">**</bpt>HiveSampleData.txt<ept id=\"p27\">**</ept><ph id=\"ph20\"/> in the <bpt id=\"p28\">**</bpt>Name<ept id=\"p28\">**</ept><ph id=\"ph21\"/> column (the folder path is <bpt id=\"p29\">**</bpt>../hive/warehouse/hivesampletable/<ept id=\"p29\">**</ept>), and then click <bpt id=\"p30\">**</bpt>Binary<ept id=\"p30\">**</ept><ph id=\"ph22\"/> on the left of HiveSampleData.txt. HiveSampleData.txt comes with all the cluster. Optionally, you can use your own file.",
      "nodes": [
        {
          "content": "Locate <bpt id=\"p27\">**</bpt>HiveSampleData.txt<ept id=\"p27\">**</ept><ph id=\"ph20\"/> in the <bpt id=\"p28\">**</bpt>Name<ept id=\"p28\">**</ept><ph id=\"ph21\"/> column (the folder path is <bpt id=\"p29\">**</bpt>../hive/warehouse/hivesampletable/<ept id=\"p29\">**</ept>), and then click <bpt id=\"p30\">**</bpt>Binary<ept id=\"p30\">**</ept><ph id=\"ph22\"/> on the left of HiveSampleData.txt.",
          "pos": [
            0,
            379
          ]
        },
        {
          "content": "HiveSampleData.txt comes with all the cluster.",
          "pos": [
            380,
            426
          ]
        },
        {
          "content": "Optionally, you can use your own file.",
          "pos": [
            427,
            465
          ]
        }
      ]
    },
    {
      "pos": [
        3995,
        4056
      ],
      "content": "<ph id=\"ph23\">![</ph>HDI.PowerQuery.ImportData<ph id=\"ph24\">][image-hdi-powerquery-importdata]</ph>"
    },
    {
      "pos": [
        4061,
        4194
      ],
      "content": "If you want, you can rename the column names. When you are ready, click <bpt id=\"p31\">**</bpt>Close &amp; Load<ept id=\"p31\">**</ept>.  The data has been loaded to your workbook:",
      "nodes": [
        {
          "content": "If you want, you can rename the column names.",
          "pos": [
            0,
            45
          ]
        },
        {
          "content": "When you are ready, click <bpt id=\"p31\">**</bpt>Close &amp; Load<ept id=\"p31\">**</ept>.",
          "pos": [
            46,
            133
          ]
        },
        {
          "content": "The data has been loaded to your workbook:",
          "pos": [
            135,
            177
          ]
        }
      ]
    },
    {
      "pos": [
        4200,
        4268
      ],
      "content": "<ph id=\"ph25\">![</ph>HDI.PowerQuery.ImportedTable<ph id=\"ph26\">][image-hdi-powerquery-imported-table]</ph>"
    },
    {
      "pos": [
        4273,
        4283
      ],
      "content": "Next steps"
    },
    {
      "pos": [
        4285,
        4547
      ],
      "content": "In this article, you learned how to use Power Query to retrieve data from HDInsight into Excel. Similarly, you can retrieve data from HDInsight into Azure SQL Database. It is also possible to upload data into HDInsight. To learn more, see the following articles:",
      "nodes": [
        {
          "content": "In this article, you learned how to use Power Query to retrieve data from HDInsight into Excel.",
          "pos": [
            0,
            95
          ]
        },
        {
          "content": "Similarly, you can retrieve data from HDInsight into Azure SQL Database.",
          "pos": [
            96,
            168
          ]
        },
        {
          "content": "It is also possible to upload data into HDInsight.",
          "pos": [
            169,
            219
          ]
        },
        {
          "content": "To learn more, see the following articles:",
          "pos": [
            220,
            262
          ]
        }
      ]
    },
    {
      "pos": [
        4551,
        4631
      ],
      "content": "<bpt id=\"p32\">[</bpt>Connect Excel to HDInsight with the Microsoft Hive ODBC Driver<ept id=\"p32\">][hdinsight-ODBC]</ept>"
    },
    {
      "pos": [
        4634,
        4683
      ],
      "content": "<bpt id=\"p33\">[</bpt>Upload Data to HDInsight<ept id=\"p33\">][hdinsight-upload-data]</ept>"
    }
  ],
  "content": "<properties\n    pageTitle=\"Connect Excel to Hadoop with Power Query | Microsoft Azure\"\n    description=\"Learn how to take advantage of business intelligence components and use Power Query for Excel to access data stored in Hadoop on HDInsight.\"\n    services=\"hdinsight\"\n    documentationCenter=\"\"\n    tags=\"azure-portal\"\n    authors=\"mumian\"\n    manager=\"paulettm\"\n    editor=\"cgronlun\"/>\n\n<tags\n    ms.service=\"hdinsight\"\n    ms.workload=\"big-data\"\n    ms.tgt_pltfrm=\"na\"\n    ms.devlang=\"na\"\n    ms.topic=\"article\"\n    ms.date=\"01/28/2016\"\n    ms.author=\"jgao\"/>\n\n\n#Connect Excel to Hadoop by using Power Query\n\nOne key feature of the Microsoft big-data solution is the integration of Microsoft business intelligence (BI) components with Hadoop clusters in Azure HDInsight. A primary example of this integration is the ability to connect Excel to the Azure Storage account that contains the data associated with your Hadoop cluster by using the Microsoft Power Query for Excel add-in. This article walks you through how to set up and use Power Query to query data associated with a Hadoop cluster managed with HDInsight.\n\n> [AZURE.NOTE] While the steps in this article can be used with either a Linux or Windows-based HDInsight cluster, Windows is required for the client workstation.\n\n### Prerequisites\n\nBefore you begin this article, you must have the following:\n\n- **An HDInsight cluster**. To configure one, see [Get started with Azure HDInsight][hdinsight-get-started].\n- **A workstation** that is running Windows 7, Windows Server 2008 R2, or a later operating system.\n- **Office 2013 Professional Plus, Office 365 ProPlus, Excel 2013 Standalone, or Office 2010 Professional Plus**.\n\n\n## Install Power Query\n\nPower Query can be used to import data from a variety of sources into Microsoft Excel, where it can power BI tools like PowerPivot and Power View. In particular, Power Query can import data that has been output or that has been generated by a Hadoop job running on an HDInsight cluster.\n\nDownload Microsoft Power Query for Excel from the [Microsoft Download Center][powerquery-download] and install it.\n\n## Import HDInsight data into Excel\n\nThe Power Query add-in for Excel makes it easy to import data from your HDInsight cluster into Excel, where BI tools such as PowerPivot and Power Map can be used to inspect, analyze, and present the data.\n\n**To import data from an HDInsight cluster**\n\n1. Open Excel.\n\n2. Create a new blank workbook.\n\n3. Click the **Power Query** menu, click **From Azure**, and then click **From Microsoft Azure HDInsight**.\n\n    ![HDI.PowerQuery.SelectHdiSource][image-hdi-powerquery-hdi-source]\n\n    **Note:** If you don't see the **Power Query** menu, go to **File** > **Options** > **Add-Ins**, and select **COM Add-ins** from the drop-down **Manage** box at the bottom of the page. Select the **Go...** button and verify that the box for the Power Query for Excel add-in has been checked.\n\n    **Note:** Power Query also allows you to import data from HDFS by clicking **From Other Sources**.\n\n3. For **Account Name**, enter the name of the Azure Blob storage account associated with your cluster, and then click **OK**. This can be the [default storage account](hdinsight-administer-use-management-portal.md#find-the-default-storage-account) or a linked storage account.  The format is *https://<StorageAccountName>.blob.core.windows.net/*.\n\n4. For **Account Key**, enter the key for the Blob storage account, and then click **Save**. (You need to do this only the first time you access this store.)\n\n5. In the **Navigator** pane on the left of the Query Editor, double-click the Blob storage container name. By default, the container name is the same name as the cluster name.\n\n6. Locate **HiveSampleData.txt** in the **Name** column (the folder path is **../hive/warehouse/hivesampletable/**), and then click **Binary** on the left of HiveSampleData.txt. HiveSampleData.txt comes with all the cluster. Optionally, you can use your own file.\n\n    ![HDI.PowerQuery.ImportData][image-hdi-powerquery-importdata]\n\n7. If you want, you can rename the column names. When you are ready, click **Close & Load**.  The data has been loaded to your workbook:\n\n    ![HDI.PowerQuery.ImportedTable][image-hdi-powerquery-imported-table]\n\n## Next steps\n\nIn this article, you learned how to use Power Query to retrieve data from HDInsight into Excel. Similarly, you can retrieve data from HDInsight into Azure SQL Database. It is also possible to upload data into HDInsight. To learn more, see the following articles:\n\n* [Connect Excel to HDInsight with the Microsoft Hive ODBC Driver][hdinsight-ODBC]\n* [Upload Data to HDInsight][hdinsight-upload-data]\n\n[hdinsight-ODBC]: hdinsight-connect-excel-hive-ODBC-driver.md\n[hdinsight-get-started]: hdinsight-hadoop-linux-tutorial-get-started.md\n[hdinsight-upload-data]: hdinsight-upload-data.md\n\n[image-hdi-powerquery-hdi-source]: ./media/hdinsight-connect-excel-power-query/HDI.PowerQuery.SelectHdiSource.png\n[image-hdi-powerquery-importdata]: ./media/hdinsight-connect-excel-power-query/HDI.PowerQuery.ImportData.png\n[image-hdi-powerquery-imported-table]: ./media/hdinsight-connect-excel-power-query/HDI.PowerQuery.ImportedTable.PNG\n\n[powerquery-download]: http://go.microsoft.com/fwlink/?LinkID=286689\n"
}