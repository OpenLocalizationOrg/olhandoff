ms。ContentId: 34D5925A-D724-4552-9403-C2703A973234
タイトル: を移行して、仮想マシンのアップグレード

#移行し、仮想マシンのアップグレード

Hyper-V では、Windows 8.1 またはそれ以前で作成された Windows 10 ホストにバーチャル マシンを移動する場合、仮想マシンの構成バージョンを手動で更新するまでに、新しい仮想マシンの機能を使用できません。


構成のバージョンをアップグレードするには、仮想マシンをシャット ダウンしには、HYPER-V Manager でのバーチャル マシン構成のアップグレード] をクリックします。
管理者特権を開くことも Windows PowerShell コマンド プロンプト、および種類。


 '' PowerShell
更新 VmVersion <vmname> | <vmobject>
```



## How do I check the configuration version of the virtual machines running on Hyper-V? 

To find the configuration version, open an elevated Windows PowerShell command prompt, and run the following command:

**Get-VM * | Format-Table Name, Version**

The PowerShell command produces the following sample output:
```
名前状態 CPUUsage(%)MemoryAssigned(M) 稼働時間のステータスのバージョン

5.0 が正常に動作するアトランティス 0 1024年を実行している 00:04:20.5910000

6.2 が正常に動作する SGC 0 538 に、VM で実行されている 00:02:44.8350000
```


##構成のバージョンにアップグレードしないとすると、どうなりますか。

以前のバージョンの HYPER-V で作成した仮想マシンがあれば、[VM のバージョンを更新するまでこれらのバーチャル マシンをいくつかの機能可能性があります機能しません。

最低限の VM の構成が HYPER-V の新機能のバージョン:

| **機能名**| **仮想マシンの最小バージョン**| |
| :------------------------------------- | -----------------: ||
| ホット アド/リムーブのメモリ| 6.0| |
| ホット アド/リムーブのネットワーク アダプター| 5.0| |
| Linux vm のセキュア ブート| 6.0| |
| 実稼働のチェックポイント| 6.0| |
| PowerShell のダイレクト| 6.2| |
| 仮想のトラステッド プラットフォーム モジュール (vTPM)| 6.2| |
| 仮想マシンのグループ化| 6.2| |


##仮想マシンの構成のバージョン

移動するか、または Windows の 10 の Windows 8.1 を実行しているホストから HYPER-V を実行しているホストに仮想マシンをインポートするときに、バーチャル マシンの構成ファイルが自動的にアップグレードではありません。
これにより、仮想マシンは、Windows 8.1 を実行するホストに移動します。
仮想マシンの構成バージョンを手動で更新するまでは、新しい仮想マシンの機能へのアクセスを必要はありません。


仮想マシンの構成のバージョンでは、HYPER-V のバージョンのバーチャル マシンの構成が保存された状態では、およびスナップショットと互換性があるファイルを表します。
バーチャル マシンの構成バージョン 5 には、Windows 8.1 と互換性があると、Windows 8.1 と Windows の 10 の両方で実行できます。
バージョン 6 の構成を持つ仮想マシンを使用して、Windows 10 互換性があり、Windows 8.1 では動作しません。

場合によっては、すべての仮想マシンを同時にアップグレードする必要はありません。
必要な場合に、特定の仮想マシンをアップグレードすることができます。
ただし、各仮想マシンの構成のバージョンを手動で更新するまでは、新しい仮想マシンの機能へのアクセスを必要はありません。




----------------

** 重要な **

•、仮想マシンの構成バージョンをアップグレードした後は、Windows 8.1 を実行しているホストに、仮想マシンを移動することはできません。

• が 5 のバージョンに 6 のバージョンから仮想マシンの構成のバージョンをダウン グレードすることはできません。

• を仮想マシンの構成をアップグレードするバーチャル マシンをオフにする必要があります。

• アップグレード後、仮想マシンでは、新しい構成ファイルの形式を使用します。
詳細については、新しいバーチャル マシン構成ファイルの形式を参照してください。

--------






##どのようなエラーは、仮想マシンのバージョンをアップグレードするとどうなりますか。

手動でにアップグレードすると、仮想マシンの構成バージョン バージョン 6.x、仮想マシンの構成とチェックポイント ファイルを格納するために使用されるファイルの構造を変更します。


アップグレード後の仮想マシンでは、仮想マシンの構成データの読み書きの効率を上げるために設計された、新しい構成ファイル形式を使用します。
アップグレードでは、記憶域の障害発生時のデータの破損が発生する可能性も減少します。


次の表には、バイナリ ファイルの場所とアップグレード済みのバーチャル マシンの拡張機能の情報が一覧表示します。



| **バーチャル マシンの構成とチェックポイント ファイル (バージョン 6.x)**| **説明**| |
|:---------------|:----------------||
| **仮想マシンの構成**| 構成情報については、.vmcx 拡張機能を使用するバイナリ ファイル形式で格納されます。| |
| **仮想マシンの実行時の状態**| 実行時データの状態は、.vmrs 拡張機能を使用するバイナリ ファイル形式で格納されます。| |
| **仮想マシンのバーチャル ハード ディスク**| 仮想マシンの仮想ハード ディスク ファイルです。.Vhd または .vhdx ファイルの拡張機能を使用します。| |
| **自動の仮想ハード ディスク ファイル**| バーチャル マシンのチェックポイントで使用する差分ディスク ファイルです。.Avhdx ファイル拡張機能を使用します。| |
| **チェックポイント ファイル**| チェックポイントは、複数のチェックポイント ファイルに格納されます。各チェックポイントでは、構成ファイルと実行時の状態のファイルを作成します。チェックポイント ファイルは、.vmrs と .vmcx ファイルの拡張機能を使用します。実稼働のチェックポイントと標準のチェックポイントもこれらの新しいファイル形式が使用されます。| |
仮想マシンの構成をアップグレードした後、バージョン 6.x ことはできませんバージョンからダウン グレードする 6.x バージョン 5 にします。


仮想マシンの構成をアップグレードする、仮想マシンをオフにする必要があります。

次の表は、新しいまたはアップグレード後の仮想マシンの既定の場所を一覧表示します。

| **バーチャル マシンのファイル (バージョン 6.x)**| **説明**| |
|:-----|:-----||
| **バーチャル マシン構成ファイル**| C:\ProgramData\Microsoft\Windows\Hyper-V\Virtual マシン| |
| **バーチャル マシンの実行時の状態のファイル**| C:\ProgramData\Microsoft\Windows\Hyper-V\Virtual マシン| |
| **チェックポイント ファイル (.vmrs、.vmcx)**| C:\ProgramData\Microsoft\Windows\Snapshots| |
| **バーチャル ハード ディスク ファイル (.vhd/.vhdx)**| C:\Users\Public\Documents\Hyper-V\Virtual ハード_ディスク| |
| **自動の仮想ハード ディスク ファイル (.avhdx)**| C:\Users\Public\Documents\Hyper-V\Virtual ハード_ディスク| |







