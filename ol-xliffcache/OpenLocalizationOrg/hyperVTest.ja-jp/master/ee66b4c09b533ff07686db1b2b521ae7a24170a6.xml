{
  "nodes": [
    {
      "pos": [
        26,
        105
      ],
      "content": "Use SSH keys with Hadoop on Linux-based clusters from Windows | Microsoft Azure"
    },
    {
      "pos": [
        123,
        285
      ],
      "content": "Learn how to create and use SSH keys to authenticate to Linux-based HDInsight clusters. Connect clusters from Windows-based clients by using the PuTTY SSH client.",
      "nodes": [
        {
          "content": "Learn how to create and use SSH keys to authenticate to Linux-based HDInsight clusters.",
          "pos": [
            0,
            87
          ]
        },
        {
          "content": "Connect clusters from Windows-based clients by using the PuTTY SSH client.",
          "pos": [
            88,
            162
          ]
        }
      ]
    },
    {
      "pos": [
        602,
        659
      ],
      "content": "Use SSH with Linux-based Hadoop on HDInsight from Windows"
    },
    {
      "pos": [
        663,
        679
      ],
      "content": "[AZURE.SELECTOR]"
    },
    {
      "pos": [
        682,
        734
      ],
      "content": "<bpt id=\"p1\">[</bpt>Windows<ept id=\"p1\">](hdinsight-hadoop-linux-use-ssh-windows.md)</ept>"
    },
    {
      "pos": [
        737,
        796
      ],
      "content": "<bpt id=\"p2\">[</bpt>Linux, Unix, OS X<ept id=\"p2\">](hdinsight-hadoop-linux-use-ssh-unix.md)</ept>"
    },
    {
      "pos": [
        798,
        1094
      ],
      "content": "<bpt id=\"p3\">[</bpt>Secure Shell (SSH)<ept id=\"p3\">](https://en.wikipedia.org/wiki/Secure_Shell)</ept><ph id=\"ph2\"/> allows you to remotely perform operations on your Liux-based HDInsight clusters using a command-line interface. This document provides information on connecting to HDInsight from Windows-based clients by using the PuTTY SSH client.",
      "nodes": [
        {
          "content": "<bpt id=\"p3\">[</bpt>Secure Shell (SSH)<ept id=\"p3\">](https://en.wikipedia.org/wiki/Secure_Shell)</ept><ph id=\"ph2\"/> allows you to remotely perform operations on your Liux-based HDInsight clusters using a command-line interface.",
          "pos": [
            0,
            228
          ]
        },
        {
          "content": "This document provides information on connecting to HDInsight from Windows-based clients by using the PuTTY SSH client.",
          "pos": [
            229,
            348
          ]
        }
      ]
    },
    {
      "pos": [
        1098,
        1347
      ],
      "content": "<ph id=\"ph3\">[AZURE.NOTE]</ph><ph id=\"ph4\"/> The steps in this article assume you are using a Windows-based client. If you are using a Linux, Unix, or OS X client, see <bpt id=\"p4\">[</bpt>Use SSH with Linux-based Hadoop on HDInsight from Linux, Unix, or OS X<ept id=\"p4\">](hdinsight-hadoop-linux-use-ssh-unix.md)</ept>.",
      "nodes": [
        {
          "content": "<ph id=\"ph3\">[AZURE.NOTE]</ph><ph id=\"ph4\"/> The steps in this article assume you are using a Windows-based client.",
          "pos": [
            0,
            115
          ]
        },
        {
          "content": "If you are using a Linux, Unix, or OS X client, see <bpt id=\"p4\">[</bpt>Use SSH with Linux-based Hadoop on HDInsight from Linux, Unix, or OS X<ept id=\"p4\">](hdinsight-hadoop-linux-use-ssh-unix.md)</ept>.",
          "pos": [
            116,
            319
          ]
        }
      ]
    },
    {
      "pos": [
        1351,
        1364
      ],
      "content": "Prerequisites"
    },
    {
      "pos": [
        1368,
        1588
      ],
      "content": "<bpt id=\"p5\">**</bpt>PuTTY<ept id=\"p5\">**</ept><ph id=\"ph5\"/> and <bpt id=\"p6\">**</bpt>PuTTYGen<ept id=\"p6\">**</ept><ph id=\"ph6\"/> for Windows-based clients. These utilities are available from <bpt id=\"p7\">[</bpt>http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html<ept id=\"p7\">](http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html)</ept>.",
      "nodes": [
        {
          "content": "<bpt id=\"p5\">**</bpt>PuTTY<ept id=\"p5\">**</ept><ph id=\"ph5\"/> and <bpt id=\"p6\">**</bpt>PuTTYGen<ept id=\"p6\">**</ept><ph id=\"ph6\"/> for Windows-based clients.",
          "pos": [
            0,
            157
          ]
        },
        {
          "content": "These utilities are available from <bpt id=\"p7\">[</bpt>http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html<ept id=\"p7\">](http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html)</ept>.",
          "pos": [
            158,
            362
          ]
        }
      ]
    },
    {
      "pos": [
        1592,
        1633
      ],
      "content": "A modern web browser that supports HTML5."
    },
    {
      "pos": [
        1635,
        1637
      ],
      "content": "OR"
    },
    {
      "pos": [
        1641,
        1705
      ],
      "content": "<bpt id=\"p8\">[</bpt>Azure CLI for Mac, Linux and Windows<ept id=\"p8\">](../xplat-cli-install.md)</ept>."
    },
    {
      "pos": [
        1709,
        1721
      ],
      "content": "What is SSH?"
    },
    {
      "pos": [
        1723,
        2017
      ],
      "content": "SSH is a utility for logging in to, and remotely executing, commands on a remote server. With Linux-based HDInsight, SSH establishes an encrypted connection to the cluster head node and provides a command line that you use to type in commands. Commands are then executed directly on the server.",
      "nodes": [
        {
          "content": "SSH is a utility for logging in to, and remotely executing, commands on a remote server.",
          "pos": [
            0,
            88
          ]
        },
        {
          "content": "With Linux-based HDInsight, SSH establishes an encrypted connection to the cluster head node and provides a command line that you use to type in commands.",
          "pos": [
            89,
            243
          ]
        },
        {
          "content": "Commands are then executed directly on the server.",
          "pos": [
            244,
            294
          ]
        }
      ]
    },
    {
      "pos": [
        2022,
        2035
      ],
      "content": "SSH user name"
    },
    {
      "pos": [
        2037,
        2402
      ],
      "content": "An SSH user name is the name you use to authenticate to the HDInsight cluster. When you specify an SSH user name during cluster creation, this user is created on all nodes in the cluster. Once the cluster is created, you can use this user name to connect to the HDInsight cluster head nodes. From the head nodes, you can then connect to the individual worker nodes.",
      "nodes": [
        {
          "content": "An SSH user name is the name you use to authenticate to the HDInsight cluster.",
          "pos": [
            0,
            78
          ]
        },
        {
          "content": "When you specify an SSH user name during cluster creation, this user is created on all nodes in the cluster.",
          "pos": [
            79,
            187
          ]
        },
        {
          "content": "Once the cluster is created, you can use this user name to connect to the HDInsight cluster head nodes.",
          "pos": [
            188,
            291
          ]
        },
        {
          "content": "From the head nodes, you can then connect to the individual worker nodes.",
          "pos": [
            292,
            365
          ]
        }
      ]
    },
    {
      "pos": [
        2407,
        2433
      ],
      "content": "SSH password or Public key"
    },
    {
      "pos": [
        2435,
        2646
      ],
      "content": "An SSH user can use either a password or public key for authentication. A password is just a string of text you make up, while a public key is part of a cryptographic key pair generated to uniquely identify you.",
      "nodes": [
        {
          "content": "An SSH user can use either a password or public key for authentication.",
          "pos": [
            0,
            71
          ]
        },
        {
          "content": "A password is just a string of text you make up, while a public key is part of a cryptographic key pair generated to uniquely identify you.",
          "pos": [
            72,
            211
          ]
        }
      ]
    },
    {
      "pos": [
        2648,
        2967
      ],
      "content": "A key is more secure than a password, however it requires additional steps to generate the key and you must maintain the files containing the key in a secure location. If anyone gains access to the key files, they gain access to your account. Or if you lose the key files, you will not be able to login to your account.",
      "nodes": [
        {
          "content": "A key is more secure than a password, however it requires additional steps to generate the key and you must maintain the files containing the key in a secure location.",
          "pos": [
            0,
            167
          ]
        },
        {
          "content": "If anyone gains access to the key files, they gain access to your account.",
          "pos": [
            168,
            242
          ]
        },
        {
          "content": "Or if you lose the key files, you will not be able to login to your account.",
          "pos": [
            243,
            319
          ]
        }
      ]
    },
    {
      "pos": [
        2969,
        3244
      ],
      "content": "A key pair consists of a public key (which is sent to the HDInsight server,) and a private key (which is kept on your client machine.) When you connect to the HDInsight server using SSH, the SSH client will use the private key on your machine to authenticate with the server."
    },
    {
      "pos": [
        3248,
        3265
      ],
      "content": "Create an SSH key"
    },
    {
      "pos": [
        3267,
        3405
      ],
      "content": "Use the following information if you plan on using SSH keys with your cluster. If you plan on using a password, you can skip this section.",
      "nodes": [
        {
          "content": "Use the following information if you plan on using SSH keys with your cluster.",
          "pos": [
            0,
            78
          ]
        },
        {
          "content": "If you plan on using a password, you can skip this section.",
          "pos": [
            79,
            138
          ]
        }
      ]
    },
    {
      "pos": [
        3410,
        3424
      ],
      "content": "Open PuTTYGen."
    },
    {
      "pos": [
        3429,
        3512
      ],
      "content": "For <bpt id=\"p9\">**</bpt>Type of key to generate<ept id=\"p9\">**</ept>, select <bpt id=\"p10\">**</bpt>SSH-2 RSA<ept id=\"p10\">**</ept>, and then click <bpt id=\"p11\">**</bpt>Generate<ept id=\"p11\">**</ept>."
    },
    {
      "pos": [
        3518,
        3600
      ],
      "content": "<ph id=\"ph7\">![</ph>PuTTYGen interface<ph id=\"ph8\">](./media/hdinsight-hadoop-linux-use-ssh-windows/puttygen.png)</ph>"
    },
    {
      "pos": [
        3605,
        3756
      ],
      "content": "Move the mouse around in the area below the progress bar, until the bar fills. Moving the mouse generates random data that is used to generate the key.",
      "nodes": [
        {
          "content": "Move the mouse around in the area below the progress bar, until the bar fills.",
          "pos": [
            0,
            78
          ]
        },
        {
          "content": "Moving the mouse generates random data that is used to generate the key.",
          "pos": [
            79,
            151
          ]
        }
      ]
    },
    {
      "pos": [
        3762,
        3852
      ],
      "content": "<ph id=\"ph9\">![</ph>moving the mouse around<ph id=\"ph10\">](./media/hdinsight-hadoop-linux-use-ssh-windows/movingmouse.png)</ph>"
    },
    {
      "pos": [
        3858,
        3924
      ],
      "content": "Once the key has been generated, the public key will be displayed."
    },
    {
      "pos": [
        3929,
        4074
      ],
      "content": "For added security, you can enter a passphrase in the <bpt id=\"p12\">**</bpt>Key passphrase<ept id=\"p12\">**</ept><ph id=\"ph11\"/> field, and then type the same value in the <bpt id=\"p13\">**</bpt>Confirm passphrase<ept id=\"p13\">**</ept><ph id=\"ph12\"/> field."
    },
    {
      "pos": [
        4080,
        4149
      ],
      "content": "<ph id=\"ph13\">![</ph>passphrase<ph id=\"ph14\">](./media/hdinsight-hadoop-linux-use-ssh-windows/key.png)</ph>"
    },
    {
      "pos": [
        4157,
        4307
      ],
      "content": "<ph id=\"ph15\">[AZURE.NOTE]</ph><ph id=\"ph16\"/> We strongly recommend that you use a secure passphrase for the key. However, if you forget the passphrase, there is no way to recover it.",
      "nodes": [
        {
          "content": "<ph id=\"ph15\">[AZURE.NOTE]</ph><ph id=\"ph16\"/> We strongly recommend that you use a secure passphrase for the key.",
          "pos": [
            0,
            114
          ]
        },
        {
          "content": "However, if you forget the passphrase, there is no way to recover it.",
          "pos": [
            115,
            184
          ]
        }
      ]
    },
    {
      "pos": [
        4312,
        4451
      ],
      "content": "Click <bpt id=\"p14\">**</bpt>Save private key<ept id=\"p14\">**</ept><ph id=\"ph17\"/> to save the key to a <bpt id=\"p15\">**</bpt>.ppk<ept id=\"p15\">**</ept><ph id=\"ph18\"/> file. This key will be used to authenticate to your Linux-based HDInsight cluster.",
      "nodes": [
        {
          "content": "Click <bpt id=\"p14\">**</bpt>Save private key<ept id=\"p14\">**</ept><ph id=\"ph17\"/> to save the key to a <bpt id=\"p15\">**</bpt>.ppk<ept id=\"p15\">**</ept><ph id=\"ph18\"/> file.",
          "pos": [
            0,
            172
          ]
        },
        {
          "content": "This key will be used to authenticate to your Linux-based HDInsight cluster.",
          "pos": [
            173,
            249
          ]
        }
      ]
    },
    {
      "pos": [
        4459,
        4583
      ],
      "content": "<ph id=\"ph19\">[AZURE.NOTE]</ph><ph id=\"ph20\"/> You should store this key in a secure location, as it can be used to access your Linux-based HDInsight cluster."
    },
    {
      "pos": [
        4588,
        4762
      ],
      "content": "Click <bpt id=\"p16\">**</bpt>Save public key<ept id=\"p16\">**</ept><ph id=\"ph21\"/> to save the key as a <bpt id=\"p17\">**</bpt>.txt<ept id=\"p17\">**</ept><ph id=\"ph22\"/> file. This allows you to reuse the public key in the future when you create additional Linux-based HDInsight clusters.",
      "nodes": [
        {
          "content": "Click <bpt id=\"p16\">**</bpt>Save public key<ept id=\"p16\">**</ept><ph id=\"ph21\"/> to save the key as a <bpt id=\"p17\">**</bpt>.txt<ept id=\"p17\">**</ept><ph id=\"ph22\"/> file.",
          "pos": [
            0,
            171
          ]
        },
        {
          "content": "This allows you to reuse the public key in the future when you create additional Linux-based HDInsight clusters.",
          "pos": [
            172,
            284
          ]
        }
      ]
    },
    {
      "pos": [
        4770,
        4965
      ],
      "content": "<ph id=\"ph23\">[AZURE.NOTE]</ph><ph id=\"ph24\"/> The public key is also displayed at the top of PuTTYGen. You can right-click this field, copy the value, and then paste it into a form when creating a cluster using the Azure Portal.",
      "nodes": [
        {
          "content": "<ph id=\"ph23\">[AZURE.NOTE]</ph><ph id=\"ph24\"/> The public key is also displayed at the top of PuTTYGen.",
          "pos": [
            0,
            103
          ]
        },
        {
          "content": "You can right-click this field, copy the value, and then paste it into a form when creating a cluster using the Azure Portal.",
          "pos": [
            104,
            229
          ]
        }
      ]
    },
    {
      "pos": [
        4969,
        5007
      ],
      "content": "Create a Linux-based HDInsight cluster"
    },
    {
      "pos": [
        5009,
        5197
      ],
      "content": "When creating a Linux-based HDInsight cluster, you must provide the public key created previously. From Windows-based clients, there are two ways to create a Linux-based HDInsight cluster:",
      "nodes": [
        {
          "content": "When creating a Linux-based HDInsight cluster, you must provide the public key created previously.",
          "pos": [
            0,
            98
          ]
        },
        {
          "content": "From Windows-based clients, there are two ways to create a Linux-based HDInsight cluster:",
          "pos": [
            99,
            188
          ]
        }
      ]
    },
    {
      "pos": [
        5201,
        5266
      ],
      "content": "<bpt id=\"p18\">**</bpt>Azure Portal<ept id=\"p18\">**</ept><ph id=\"ph25\"/> - Uses a web-based portal to create the cluster."
    },
    {
      "pos": [
        5270,
        5362
      ],
      "content": "<bpt id=\"p19\">**</bpt>Azure CLI for Mac, Linux and Windows<ept id=\"p19\">**</ept><ph id=\"ph26\"/> - Uses command-line commands to create the cluster."
    },
    {
      "pos": [
        5364,
        5578
      ],
      "content": "Each of these methods will require the public key. For complete information on creating a Linux-based HDInsight cluster, see <bpt id=\"p20\">[</bpt>Provision Linux-based HDInsight clusters<ept id=\"p20\">](hdinsight-hadoop-provision-linux-clusters.md)</ept>.",
      "nodes": [
        {
          "content": "Each of these methods will require the public key.",
          "pos": [
            0,
            50
          ]
        },
        {
          "content": "For complete information on creating a Linux-based HDInsight cluster, see <bpt id=\"p20\">[</bpt>Provision Linux-based HDInsight clusters<ept id=\"p20\">](hdinsight-hadoop-provision-linux-clusters.md)</ept>.",
          "pos": [
            51,
            254
          ]
        }
      ]
    },
    {
      "pos": [
        5583,
        5595
      ],
      "content": "Azure Portal"
    },
    {
      "pos": [
        5597,
        5779
      ],
      "content": "When using the <bpt id=\"p21\">[</bpt>Azure Portal<ept id=\"p21\">][preview-portal]</ept><ph id=\"ph27\"/> to create a Linux-based HDInsight cluster, you must enter an <bpt id=\"p22\">**</bpt>SSH Username<ept id=\"p22\">**</ept>, and select to enter a <bpt id=\"p23\">**</bpt>PASSWORD<ept id=\"p23\">**</ept><ph id=\"ph28\"/> or <bpt id=\"p24\">**</bpt>SSH PUBLIC KEY<ept id=\"p24\">**</ept>."
    },
    {
      "pos": [
        5781,
        6072
      ],
      "content": "If you select <bpt id=\"p25\">**</bpt>SSH PUBLIC KEY<ept id=\"p25\">**</ept>, you can either paste the public key (displayed in the <bpt id=\"p26\">__</bpt>Public key for pasting into OpenSSH authorized\\_keys file<ept id=\"p26\">__</ept><ph id=\"ph29\"/> field in PuttyGen,) into the <bpt id=\"p27\">__</bpt>SSH PublicKey<ept id=\"p27\">__</ept><ph id=\"ph30\"/> field, or select <bpt id=\"p28\">__</bpt>Select a file<ept id=\"p28\">__</ept><ph id=\"ph31\"/> to browse and select the file that contains the public key."
    },
    {
      "pos": [
        6074,
        6172
      ],
      "content": "<ph id=\"ph32\">![</ph>Image of form asking for public key<ph id=\"ph33\">](./media/hdinsight-hadoop-linux-use-ssh-windows/ssh-key.png)</ph>"
    },
    {
      "pos": [
        6174,
        6288
      ],
      "content": "This creates a login for the specified user, and enables either password authentication or SSH key authentication."
    },
    {
      "pos": [
        6293,
        6349
      ],
      "content": "Azure Command-Line Interface for Mac, Linux, and Windows"
    },
    {
      "pos": [
        6351,
        6509
      ],
      "content": "You can use the <bpt id=\"p29\">[</bpt>Azure CLI for Mac, Linux and Windows<ept id=\"p29\">](../xplat-cli-install.md)</ept><ph id=\"ph34\"/> to create a new cluster by using the <ph id=\"ph35\">`azure hdinsight cluster create`</ph><ph id=\"ph36\"/> command."
    },
    {
      "pos": [
        6511,
        6673
      ],
      "content": "For more information on using this command, see <bpt id=\"p30\">[</bpt>Provision Hadoop Linux clusters in HDInsight using custom options<ept id=\"p30\">](hdinsight-hadoop-provision-linux-clusters.md)</ept>."
    },
    {
      "pos": [
        6677,
        6719
      ],
      "content": "Connect to a Linux-based HDInsight cluster"
    },
    {
      "pos": [
        6724,
        6735
      ],
      "content": "Open PuTTY."
    },
    {
      "pos": [
        6741,
        6817
      ],
      "content": "<ph id=\"ph37\">![</ph>putty interface<ph id=\"ph38\">](./media/hdinsight-hadoop-linux-use-ssh-windows/putty.png)</ph>"
    },
    {
      "pos": [
        6822,
        6989
      ],
      "content": "If you provided an SSH key when you created your user account, you must perform the following step to select the private key to use when authenticating to the cluster:"
    },
    {
      "pos": [
        6995,
        7154
      ],
      "content": "In <bpt id=\"p31\">**</bpt>Category<ept id=\"p31\">**</ept>, expand <bpt id=\"p32\">**</bpt>Connection<ept id=\"p32\">**</ept>, expand <bpt id=\"p33\">**</bpt>SSH<ept id=\"p33\">**</ept>, and select <bpt id=\"p34\">**</bpt>Auth<ept id=\"p34\">**</ept>. Finally, click <bpt id=\"p35\">**</bpt>Browse<ept id=\"p35\">**</ept><ph id=\"ph39\"/> and select the .ppk file that contains your private key.",
      "nodes": [
        {
          "content": "In <bpt id=\"p31\">**</bpt>Category<ept id=\"p31\">**</ept>, expand <bpt id=\"p32\">**</bpt>Connection<ept id=\"p32\">**</ept>, expand <bpt id=\"p33\">**</bpt>SSH<ept id=\"p33\">**</ept>, and select <bpt id=\"p34\">**</bpt>Auth<ept id=\"p34\">**</ept>.",
          "pos": [
            0,
            236
          ]
        },
        {
          "content": "Finally, click <bpt id=\"p35\">**</bpt>Browse<ept id=\"p35\">**</ept><ph id=\"ph39\"/> and select the .ppk file that contains your private key.",
          "pos": [
            237,
            374
          ]
        }
      ]
    },
    {
      "pos": [
        7160,
        7259
      ],
      "content": "<ph id=\"ph40\">![</ph>putty interface, select private key<ph id=\"ph41\">](./media/hdinsight-hadoop-linux-use-ssh-windows/puttykey.png)</ph>"
    },
    {
      "pos": [
        7264,
        7572
      ],
      "content": "In <bpt id=\"p36\">**</bpt>Category<ept id=\"p36\">**</ept>, select <bpt id=\"p37\">**</bpt>Session<ept id=\"p37\">**</ept>. From the <bpt id=\"p38\">**</bpt>Basic options for your PuTTY session<ept id=\"p38\">**</ept><ph id=\"ph42\"/> screen, enter the SSH address of your HDInsight server in the <bpt id=\"p39\">**</bpt>Host name (or IP address)<ept id=\"p39\">**</ept><ph id=\"ph43\"/> field. The SSH address is your cluster name, then <bpt id=\"p40\">**</bpt>-ssh.azurehdinsight.net<ept id=\"p40\">**</ept>. For example, <bpt id=\"p41\">**</bpt>mycluster-ssh.azurehdinsight.net<ept id=\"p41\">**</ept>.",
      "nodes": [
        {
          "content": "In <bpt id=\"p36\">**</bpt>Category<ept id=\"p36\">**</ept>, select <bpt id=\"p37\">**</bpt>Session<ept id=\"p37\">**</ept>.",
          "pos": [
            0,
            116
          ]
        },
        {
          "content": "From the <bpt id=\"p38\">**</bpt>Basic options for your PuTTY session<ept id=\"p38\">**</ept><ph id=\"ph42\"/> screen, enter the SSH address of your HDInsight server in the <bpt id=\"p39\">**</bpt>Host name (or IP address)<ept id=\"p39\">**</ept><ph id=\"ph43\"/> field.",
          "pos": [
            117,
            375
          ]
        },
        {
          "content": "The SSH address is your cluster name, then <bpt id=\"p40\">**</bpt>-ssh.azurehdinsight.net<ept id=\"p40\">**</ept>.",
          "pos": [
            376,
            487
          ]
        },
        {
          "content": "For example, <bpt id=\"p41\">**</bpt>mycluster-ssh.azurehdinsight.net<ept id=\"p41\">**</ept>.",
          "pos": [
            488,
            578
          ]
        }
      ]
    },
    {
      "pos": [
        7578,
        7686
      ],
      "content": "<ph id=\"ph44\">![</ph>putty interface with ssh address entered<ph id=\"ph45\">](./media/hdinsight-hadoop-linux-use-ssh-windows/puttyaddress.png)</ph>"
    },
    {
      "pos": [
        7691,
        7885
      ],
      "content": "To save the connection information for future use, enter a name for this connection under <bpt id=\"p42\">**</bpt>Saved Sessions<ept id=\"p42\">**</ept>, and then click <bpt id=\"p43\">**</bpt>Save<ept id=\"p43\">**</ept>. The connection will be added to the list of saved sessions.",
      "nodes": [
        {
          "content": "To save the connection information for future use, enter a name for this connection under <bpt id=\"p42\">**</bpt>Saved Sessions<ept id=\"p42\">**</ept>, and then click <bpt id=\"p43\">**</bpt>Save<ept id=\"p43\">**</ept>.",
          "pos": [
            0,
            214
          ]
        },
        {
          "content": "The connection will be added to the list of saved sessions.",
          "pos": [
            215,
            274
          ]
        }
      ]
    },
    {
      "pos": [
        7890,
        7931
      ],
      "content": "Click <bpt id=\"p44\">**</bpt>Open<ept id=\"p44\">**</ept><ph id=\"ph46\"/> to connect to the cluster."
    },
    {
      "pos": [
        7939,
        8122
      ],
      "content": "<ph id=\"ph47\">[AZURE.NOTE]</ph><ph id=\"ph48\"/> If this is the first time you have connected to the cluster, you will receive a security alert. This is normal. Select <bpt id=\"p45\">**</bpt>Yes<ept id=\"p45\">**</ept><ph id=\"ph49\"/> to cache the server's RSA2 key to continue.",
      "nodes": [
        {
          "content": "<ph id=\"ph47\">[AZURE.NOTE]</ph><ph id=\"ph48\"/> If this is the first time you have connected to the cluster, you will receive a security alert.",
          "pos": [
            0,
            142
          ]
        },
        {
          "content": "This is normal.",
          "pos": [
            143,
            158
          ]
        },
        {
          "content": "Select <bpt id=\"p45\">**</bpt>Yes<ept id=\"p45\">**</ept><ph id=\"ph49\"/> to cache the server's RSA2 key to continue.",
          "pos": [
            159,
            272
          ]
        }
      ]
    },
    {
      "pos": [
        8127,
        8283
      ],
      "content": "When prompted, enter the user that you entered when you created the cluster. If you provided a password for the user, you will be prompted to enter it also.",
      "nodes": [
        {
          "content": "When prompted, enter the user that you entered when you created the cluster.",
          "pos": [
            0,
            76
          ]
        },
        {
          "content": "If you provided a password for the user, you will be prompted to enter it also.",
          "pos": [
            77,
            156
          ]
        }
      ]
    },
    {
      "pos": [
        8287,
        8604
      ],
      "content": "<ph id=\"ph50\">[AZURE.NOTE]</ph><ph id=\"ph51\"/> The above steps assume you are using port 22, which will connect to head node 0 on the HDInsight cluster. If you use port 23, you will connect to head node 1. For more information on the head nodes, see <bpt id=\"p46\">[</bpt>Availability and reliability of Hadoop clusters in HDInsight<ept id=\"p46\">](hdinsight-high-availability-linux.md)</ept>.",
      "nodes": [
        {
          "content": "<ph id=\"ph50\">[AZURE.NOTE]</ph><ph id=\"ph51\"/> The above steps assume you are using port 22, which will connect to head node 0 on the HDInsight cluster.",
          "pos": [
            0,
            152
          ]
        },
        {
          "content": "If you use port 23, you will connect to head node 1.",
          "pos": [
            153,
            205
          ]
        },
        {
          "content": "For more information on the head nodes, see <bpt id=\"p46\">[</bpt>Availability and reliability of Hadoop clusters in HDInsight<ept id=\"p46\">](hdinsight-high-availability-linux.md)</ept>.",
          "pos": [
            206,
            391
          ]
        }
      ]
    },
    {
      "pos": [
        8609,
        8632
      ],
      "content": "Connect to worker nodes"
    },
    {
      "pos": [
        8634,
        8774
      ],
      "content": "The worker nodes are not directly accessible from outside the Azure datacenter, but they can be accessed from the cluster head node via SSH."
    },
    {
      "pos": [
        8776,
        8977
      ],
      "content": "If you provided an SSH key when you created your user account, you must perform the following steps to use the private key when authenticating to the cluster if you want to connect to the worker nodes."
    },
    {
      "pos": [
        8982,
        9184
      ],
      "content": "Install Pageant from <bpt id=\"p47\">[</bpt>http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html<ept id=\"p47\">](http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html)</ept>. This utility is used to cache SSH keys for PuTTY.",
      "nodes": [
        {
          "content": "Install Pageant from <bpt id=\"p47\">[</bpt>http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html<ept id=\"p47\">](http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html)</ept>.",
          "pos": [
            0,
            192
          ]
        },
        {
          "content": "This utility is used to cache SSH keys for PuTTY.",
          "pos": [
            193,
            242
          ]
        }
      ]
    },
    {
      "pos": [
        9189,
        9294
      ],
      "content": "Run Pageant. It will minimize to an icon in the status tray. Right-click the icon and select <bpt id=\"p48\">**</bpt>Add Key<ept id=\"p48\">**</ept>.",
      "nodes": [
        {
          "content": "Run Pageant.",
          "pos": [
            0,
            12
          ]
        },
        {
          "content": "It will minimize to an icon in the status tray.",
          "pos": [
            13,
            60
          ]
        },
        {
          "content": "Right-click the icon and select <bpt id=\"p48\">**</bpt>Add Key<ept id=\"p48\">**</ept>.",
          "pos": [
            61,
            145
          ]
        }
      ]
    },
    {
      "pos": [
        9300,
        9372
      ],
      "content": "<ph id=\"ph52\">![</ph>adding key<ph id=\"ph53\">](./media/hdinsight-hadoop-linux-use-ssh-windows/addkey.png)</ph>"
    },
    {
      "pos": [
        9377,
        9570
      ],
      "content": "When the browse dialog appears, select the .ppk file that contains the key, and then click <bpt id=\"p49\">**</bpt>Open<ept id=\"p49\">**</ept>. This adds the key to Pageant, which will provide it to PuTTY when connecting to the cluster.",
      "nodes": [
        {
          "content": "When the browse dialog appears, select the .ppk file that contains the key, and then click <bpt id=\"p49\">**</bpt>Open<ept id=\"p49\">**</ept>.",
          "pos": [
            0,
            140
          ]
        },
        {
          "content": "This adds the key to Pageant, which will provide it to PuTTY when connecting to the cluster.",
          "pos": [
            141,
            233
          ]
        }
      ]
    },
    {
      "pos": [
        9578,
        9731
      ],
      "content": "<ph id=\"ph54\">[AZURE.IMPORTANT]</ph><ph id=\"ph55\"/> If you used an SSH key to secure your account, you must complete the previous steps before you will be able to connect to worker nodes."
    },
    {
      "pos": [
        9736,
        9747
      ],
      "content": "Open PuTTY."
    },
    {
      "pos": [
        9752,
        9884
      ],
      "content": "If you use an SSH key to authenticate, in the <bpt id=\"p50\">**</bpt>Category<ept id=\"p50\">**</ept><ph id=\"ph56\"/> section, expand <bpt id=\"p51\">**</bpt>Connection<ept id=\"p51\">**</ept>, expand <bpt id=\"p52\">**</bpt>SSH<ept id=\"p52\">**</ept>, and then select <bpt id=\"p53\">**</bpt>Auth<ept id=\"p53\">**</ept>."
    },
    {
      "pos": [
        9890,
        10122
      ],
      "content": "In the <bpt id=\"p54\">**</bpt>Authentication parameters<ept id=\"p54\">**</ept><ph id=\"ph57\"/> section, enable <bpt id=\"p55\">**</bpt>Allow agent forwarding<ept id=\"p55\">**</ept>. This allows PuTTY to automatically pass the certificate authentication through the connection to the cluster head node when connecting to worker nodes.",
      "nodes": [
        {
          "content": "In the <bpt id=\"p54\">**</bpt>Authentication parameters<ept id=\"p54\">**</ept><ph id=\"ph57\"/> section, enable <bpt id=\"p55\">**</bpt>Allow agent forwarding<ept id=\"p55\">**</ept>.",
          "pos": [
            0,
            175
          ]
        },
        {
          "content": "This allows PuTTY to automatically pass the certificate authentication through the connection to the cluster head node when connecting to worker nodes.",
          "pos": [
            176,
            327
          ]
        }
      ]
    },
    {
      "pos": [
        10128,
        10221
      ],
      "content": "<ph id=\"ph58\">![</ph>allow agent forwarding<ph id=\"ph59\">](./media/hdinsight-hadoop-linux-use-ssh-windows/allowforwarding.png)</ph>"
    },
    {
      "pos": [
        10226,
        10423
      ],
      "content": "Connect to the cluster as documented earlier. If you use an SSH key for authentication, you do not need to select the key - the SSH key added to Pageant will be used to authenticate to the cluster.",
      "nodes": [
        {
          "content": "Connect to the cluster as documented earlier.",
          "pos": [
            0,
            45
          ]
        },
        {
          "content": "If you use an SSH key for authentication, you do not need to select the key - the SSH key added to Pageant will be used to authenticate to the cluster.",
          "pos": [
            46,
            197
          ]
        }
      ]
    },
    {
      "pos": [
        10428,
        10664
      ],
      "content": "After the connection has been established, use the following to retrieve a list of the nodes in your cluster. Replace <bpt id=\"p56\">*</bpt>ADMINPASSWORD<ept id=\"p56\">*</ept><ph id=\"ph60\"/> with the password for your cluster admin account. Replace <bpt id=\"p57\">*</bpt>CLUSTERNAME<ept id=\"p57\">*</ept><ph id=\"ph61\"/> with the name of your cluster.",
      "nodes": [
        {
          "content": "After the connection has been established, use the following to retrieve a list of the nodes in your cluster.",
          "pos": [
            0,
            109
          ]
        },
        {
          "content": "Replace <bpt id=\"p56\">*</bpt>ADMINPASSWORD<ept id=\"p56\">*</ept><ph id=\"ph60\"/> with the password for your cluster admin account.",
          "pos": [
            110,
            238
          ]
        },
        {
          "content": "Replace <bpt id=\"p57\">*</bpt>CLUSTERNAME<ept id=\"p57\">*</ept><ph id=\"ph61\"/> with the name of your cluster.",
          "pos": [
            239,
            346
          ]
        }
      ]
    },
    {
      "pos": [
        10763,
        11013
      ],
      "content": "This will return information in JSON format for the nodes in the cluster, including <ph id=\"ph62\">`host_name`</ph>, which contains the fully qualified domain name (FQDN) for each node. The following is an example of a <ph id=\"ph63\">`host_name`</ph><ph id=\"ph64\"/> entry returned by the <bpt id=\"p58\">**</bpt>curl<ept id=\"p58\">**</ept><ph id=\"ph65\"/> command:",
      "nodes": [
        {
          "content": "This will return information in JSON format for the nodes in the cluster, including <ph id=\"ph62\">`host_name`</ph>, which contains the fully qualified domain name (FQDN) for each node.",
          "pos": [
            0,
            184
          ]
        },
        {
          "content": "The following is an example of a <ph id=\"ph63\">`host_name`</ph><ph id=\"ph64\"/> entry returned by the <bpt id=\"p58\">**</bpt>curl<ept id=\"p58\">**</ept><ph id=\"ph65\"/> command:",
          "pos": [
            185,
            358
          ]
        }
      ]
    },
    {
      "pos": [
        11126,
        11278
      ],
      "content": "Once you have a list of the worker nodes you want to connect to, use the following command from the PuTTY session to open a connection to a worker node:"
    },
    {
      "pos": [
        11311,
        11498
      ],
      "content": "Replace <bpt id=\"p59\">*</bpt>USERNAME<ept id=\"p59\">*</ept><ph id=\"ph66\"/> with your SSH user name and <bpt id=\"p60\">*</bpt>FQDN<ept id=\"p60\">*</ept><ph id=\"ph67\"/> with the FQDN for the worker node. For example, <ph id=\"ph68\">`workernode0.workernode-0-e2f35e63355b4f15a31c460b6d4e1230.j1.internal.cloudapp.net`</ph>.",
      "nodes": [
        {
          "content": "Replace <bpt id=\"p59\">*</bpt>USERNAME<ept id=\"p59\">*</ept><ph id=\"ph66\"/> with your SSH user name and <bpt id=\"p60\">*</bpt>FQDN<ept id=\"p60\">*</ept><ph id=\"ph67\"/> with the FQDN for the worker node.",
          "pos": [
            0,
            198
          ]
        },
        {
          "content": "For example, <ph id=\"ph68\">`workernode0.workernode-0-e2f35e63355b4f15a31c460b6d4e1230.j1.internal.cloudapp.net`</ph>.",
          "pos": [
            199,
            316
          ]
        }
      ]
    },
    {
      "pos": [
        11506,
        11699
      ],
      "content": "<ph id=\"ph69\">[AZURE.NOTE]</ph><ph id=\"ph70\"/> If you use a password to authentication your SSH session, you will be prompted to enter the password again. If you use an SSH key, the connection should finish without any prompts.",
      "nodes": [
        {
          "content": "<ph id=\"ph69\">[AZURE.NOTE]</ph><ph id=\"ph70\"/> If you use a password to authentication your SSH session, you will be prompted to enter the password again.",
          "pos": [
            0,
            154
          ]
        },
        {
          "content": "If you use an SSH key, the connection should finish without any prompts.",
          "pos": [
            155,
            227
          ]
        }
      ]
    },
    {
      "pos": [
        11704,
        11969
      ],
      "content": "Once the session has been established, the prompt for your PuTTY session will change from <ph id=\"ph71\">`username@hn0-clustername`</ph><ph id=\"ph72\"/> to <ph id=\"ph73\">`username@wn0-clustername`</ph><ph id=\"ph74\"/> to indicate that you are connected to the worker node. Any commands you run at this point will run on the worker node.",
      "nodes": [
        {
          "content": "Once the session has been established, the prompt for your PuTTY session will change from <ph id=\"ph71\">`username@hn0-clustername`</ph><ph id=\"ph72\"/> to <ph id=\"ph73\">`username@wn0-clustername`</ph><ph id=\"ph74\"/> to indicate that you are connected to the worker node.",
          "pos": [
            0,
            269
          ]
        },
        {
          "content": "Any commands you run at this point will run on the worker node.",
          "pos": [
            270,
            333
          ]
        }
      ]
    },
    {
      "pos": [
        11975,
        12163
      ],
      "content": "Once you have finished performing actions on the worker node, use the <ph id=\"ph75\">`exit`</ph><ph id=\"ph76\"/> command to close the session to the worker node. This will return you to the <ph id=\"ph77\">`username@hn0-clustername`</ph><ph id=\"ph78\"/> prompt.",
      "nodes": [
        {
          "content": "Once you have finished performing actions on the worker node, use the <ph id=\"ph75\">`exit`</ph><ph id=\"ph76\"/> command to close the session to the worker node.",
          "pos": [
            0,
            159
          ]
        },
        {
          "content": "This will return you to the <ph id=\"ph77\">`username@hn0-clustername`</ph><ph id=\"ph78\"/> prompt.",
          "pos": [
            160,
            256
          ]
        }
      ]
    },
    {
      "pos": [
        12167,
        12184
      ],
      "content": "Add more accounts"
    },
    {
      "pos": [
        12186,
        12264
      ],
      "content": "If you need to add more accounts to your cluster, perform the following steps:"
    },
    {
      "pos": [
        12269,
        12360
      ],
      "content": "Generate a new public key and private key for the new user account as described previously."
    },
    {
      "pos": [
        12365,
        12445
      ],
      "content": "From an SSH session to the cluster, add the new user with the following command:"
    },
    {
      "pos": [
        12504,
        12582
      ],
      "content": "This will create a new user account, but will disable password authentication."
    },
    {
      "pos": [
        12587,
        12666
      ],
      "content": "Create the directory and files to hold the key by using the following commands:"
    },
    {
      "pos": [
        12829,
        12993
      ],
      "content": "When the nano editor opens, copy and paste in the contents of the public key for the new user account. Finally, use <bpt id=\"p61\">**</bpt>Ctrl-X<ept id=\"p61\">**</ept><ph id=\"ph79\"/> to save the file and exit the editor.",
      "nodes": [
        {
          "content": "When the nano editor opens, copy and paste in the contents of the public key for the new user account.",
          "pos": [
            0,
            102
          ]
        },
        {
          "content": "Finally, use <bpt id=\"p61\">**</bpt>Ctrl-X<ept id=\"p61\">**</ept><ph id=\"ph79\"/> to save the file and exit the editor.",
          "pos": [
            103,
            219
          ]
        }
      ]
    },
    {
      "pos": [
        12999,
        13096
      ],
      "content": "<ph id=\"ph80\">![</ph>image of nano editor with example key<ph id=\"ph81\">](./media/hdinsight-hadoop-linux-use-ssh-windows/nano.png)</ph>"
    },
    {
      "pos": [
        13101,
        13203
      ],
      "content": "Use the following command to change ownership of the .ssh folder and contents to the new user account:"
    },
    {
      "pos": [
        13276,
        13371
      ],
      "content": "You should now be able to authenticate to the server with the new user account and private key."
    },
    {
      "pos": [
        13373,
        13375
      ],
      "content": "##"
    },
    {
      "pos": [
        13394,
        13407
      ],
      "content": "SSH tunneling"
    },
    {
      "pos": [
        13409,
        13616
      ],
      "content": "SSH can be used to tunnel local requests, such as web requests, to the HDInsight cluster. The request will then be routed to the requested resource as if it had originated on the HDInsight cluster head node.",
      "nodes": [
        {
          "content": "SSH can be used to tunnel local requests, such as web requests, to the HDInsight cluster.",
          "pos": [
            0,
            89
          ]
        },
        {
          "content": "The request will then be routed to the requested resource as if it had originated on the HDInsight cluster head node.",
          "pos": [
            90,
            207
          ]
        }
      ]
    },
    {
      "pos": [
        13620,
        13821
      ],
      "content": "<ph id=\"ph82\">[AZURE.IMPORTANT]</ph><ph id=\"ph83\"/> An SSH tunnel is a requirement for accessing the web UI for some Hadoop services. For example, both the Job History UI or Resource Manager UI can only be accessed using an SSH tunnel.",
      "nodes": [
        {
          "content": "<ph id=\"ph82\">[AZURE.IMPORTANT]</ph><ph id=\"ph83\"/> An SSH tunnel is a requirement for accessing the web UI for some Hadoop services.",
          "pos": [
            0,
            133
          ]
        },
        {
          "content": "For example, both the Job History UI or Resource Manager UI can only be accessed using an SSH tunnel.",
          "pos": [
            134,
            235
          ]
        }
      ]
    },
    {
      "pos": [
        13823,
        14033
      ],
      "content": "For more information on creating and using an SSH tunnel, see <bpt id=\"p62\">[</bpt>Use SSH Tunneling to access Ambari web UI, ResourceManager, JobHistory, NameNode, Oozie, and other web UI's<ept id=\"p62\">](hdinsight-linux-ambari-ssh-tunnel.md)</ept>."
    },
    {
      "pos": [
        14037,
        14047
      ],
      "content": "Next steps"
    },
    {
      "pos": [
        14049,
        14166
      ],
      "content": "Now that you understand how to authenticate by using an SSH key, learn how to use MapReduce with Hadoop on HDInsight."
    },
    {
      "pos": [
        14170,
        14218
      ],
      "content": "<bpt id=\"p63\">[</bpt>Use Hive with HDInsight<ept id=\"p63\">](hdinsight-use-hive.md)</ept>"
    },
    {
      "pos": [
        14222,
        14268
      ],
      "content": "<bpt id=\"p64\">[</bpt>Use Pig with HDInsight<ept id=\"p64\">](hdinsight-use-pig.md)</ept>"
    },
    {
      "pos": [
        14272,
        14335
      ],
      "content": "<bpt id=\"p65\">[</bpt>Use MapReduce jobs with HDInsight<ept id=\"p65\">](hdinsight-use-mapreduce.md)</ept>"
    }
  ],
  "content": "<properties\n   pageTitle=\"Use SSH keys with Hadoop on Linux-based clusters from Windows | Microsoft Azure\"\n   description=\"Learn how to create and use SSH keys to authenticate to Linux-based HDInsight clusters. Connect clusters from Windows-based clients by using the PuTTY SSH client.\"\n   services=\"hdinsight\"\n   documentationCenter=\"\"\n   authors=\"Blackmist\"\n   manager=\"paulettm\"\n   editor=\"cgronlun\"\n    tags=\"azure-portal\"/>\n\n<tags\n   ms.service=\"hdinsight\"\n   ms.devlang=\"na\"\n   ms.topic=\"article\"\n   ms.tgt_pltfrm=\"na\"\n   ms.workload=\"big-data\"\n   ms.date=\"01/22/2016\"\n   ms.author=\"larryfr\"/>\n\n#Use SSH with Linux-based Hadoop on HDInsight from Windows\n\n> [AZURE.SELECTOR]\n- [Windows](hdinsight-hadoop-linux-use-ssh-windows.md)\n- [Linux, Unix, OS X](hdinsight-hadoop-linux-use-ssh-unix.md)\n\n[Secure Shell (SSH)](https://en.wikipedia.org/wiki/Secure_Shell) allows you to remotely perform operations on your Liux-based HDInsight clusters using a command-line interface. This document provides information on connecting to HDInsight from Windows-based clients by using the PuTTY SSH client.\n\n> [AZURE.NOTE] The steps in this article assume you are using a Windows-based client. If you are using a Linux, Unix, or OS X client, see [Use SSH with Linux-based Hadoop on HDInsight from Linux, Unix, or OS X](hdinsight-hadoop-linux-use-ssh-unix.md).\n\n##Prerequisites\n\n* **PuTTY** and **PuTTYGen** for Windows-based clients. These utilities are available from [http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html](http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html).\n\n* A modern web browser that supports HTML5.\n\nOR\n\n* [Azure CLI for Mac, Linux and Windows](../xplat-cli-install.md).\n\n##What is SSH?\n\nSSH is a utility for logging in to, and remotely executing, commands on a remote server. With Linux-based HDInsight, SSH establishes an encrypted connection to the cluster head node and provides a command line that you use to type in commands. Commands are then executed directly on the server.\n\n###SSH user name\n\nAn SSH user name is the name you use to authenticate to the HDInsight cluster. When you specify an SSH user name during cluster creation, this user is created on all nodes in the cluster. Once the cluster is created, you can use this user name to connect to the HDInsight cluster head nodes. From the head nodes, you can then connect to the individual worker nodes.\n\n###SSH password or Public key\n\nAn SSH user can use either a password or public key for authentication. A password is just a string of text you make up, while a public key is part of a cryptographic key pair generated to uniquely identify you.\n\nA key is more secure than a password, however it requires additional steps to generate the key and you must maintain the files containing the key in a secure location. If anyone gains access to the key files, they gain access to your account. Or if you lose the key files, you will not be able to login to your account.\n\nA key pair consists of a public key (which is sent to the HDInsight server,) and a private key (which is kept on your client machine.) When you connect to the HDInsight server using SSH, the SSH client will use the private key on your machine to authenticate with the server.\n\n##Create an SSH key\n\nUse the following information if you plan on using SSH keys with your cluster. If you plan on using a password, you can skip this section.\n\n1. Open PuTTYGen.\n\n2. For **Type of key to generate**, select **SSH-2 RSA**, and then click **Generate**.\n\n    ![PuTTYGen interface](./media/hdinsight-hadoop-linux-use-ssh-windows/puttygen.png)\n\n3. Move the mouse around in the area below the progress bar, until the bar fills. Moving the mouse generates random data that is used to generate the key.\n\n    ![moving the mouse around](./media/hdinsight-hadoop-linux-use-ssh-windows/movingmouse.png)\n\n    Once the key has been generated, the public key will be displayed.\n\n4. For added security, you can enter a passphrase in the **Key passphrase** field, and then type the same value in the **Confirm passphrase** field.\n\n    ![passphrase](./media/hdinsight-hadoop-linux-use-ssh-windows/key.png)\n\n    > [AZURE.NOTE] We strongly recommend that you use a secure passphrase for the key. However, if you forget the passphrase, there is no way to recover it.\n\n5. Click **Save private key** to save the key to a **.ppk** file. This key will be used to authenticate to your Linux-based HDInsight cluster.\n\n    > [AZURE.NOTE] You should store this key in a secure location, as it can be used to access your Linux-based HDInsight cluster.\n\n6. Click **Save public key** to save the key as a **.txt** file. This allows you to reuse the public key in the future when you create additional Linux-based HDInsight clusters.\n\n    > [AZURE.NOTE] The public key is also displayed at the top of PuTTYGen. You can right-click this field, copy the value, and then paste it into a form when creating a cluster using the Azure Portal.\n\n##Create a Linux-based HDInsight cluster\n\nWhen creating a Linux-based HDInsight cluster, you must provide the public key created previously. From Windows-based clients, there are two ways to create a Linux-based HDInsight cluster:\n\n* **Azure Portal** - Uses a web-based portal to create the cluster.\n\n* **Azure CLI for Mac, Linux and Windows** - Uses command-line commands to create the cluster.\n\nEach of these methods will require the public key. For complete information on creating a Linux-based HDInsight cluster, see [Provision Linux-based HDInsight clusters](hdinsight-hadoop-provision-linux-clusters.md).\n\n###Azure Portal\n\nWhen using the [Azure Portal][preview-portal] to create a Linux-based HDInsight cluster, you must enter an **SSH Username**, and select to enter a **PASSWORD** or **SSH PUBLIC KEY**.\n\nIf you select **SSH PUBLIC KEY**, you can either paste the public key (displayed in the __Public key for pasting into OpenSSH authorized\\_keys file__ field in PuttyGen,) into the __SSH PublicKey__ field, or select __Select a file__ to browse and select the file that contains the public key.\n\n![Image of form asking for public key](./media/hdinsight-hadoop-linux-use-ssh-windows/ssh-key.png)\n\nThis creates a login for the specified user, and enables either password authentication or SSH key authentication.\n\n###Azure Command-Line Interface for Mac, Linux, and Windows\n\nYou can use the [Azure CLI for Mac, Linux and Windows](../xplat-cli-install.md) to create a new cluster by using the `azure hdinsight cluster create` command.\n\nFor more information on using this command, see [Provision Hadoop Linux clusters in HDInsight using custom options](hdinsight-hadoop-provision-linux-clusters.md).\n\n##Connect to a Linux-based HDInsight cluster\n\n1. Open PuTTY.\n\n    ![putty interface](./media/hdinsight-hadoop-linux-use-ssh-windows/putty.png)\n\n2. If you provided an SSH key when you created your user account, you must perform the following step to select the private key to use when authenticating to the cluster:\n\n    In **Category**, expand **Connection**, expand **SSH**, and select **Auth**. Finally, click **Browse** and select the .ppk file that contains your private key.\n\n    ![putty interface, select private key](./media/hdinsight-hadoop-linux-use-ssh-windows/puttykey.png)\n\n3. In **Category**, select **Session**. From the **Basic options for your PuTTY session** screen, enter the SSH address of your HDInsight server in the **Host name (or IP address)** field. The SSH address is your cluster name, then **-ssh.azurehdinsight.net**. For example, **mycluster-ssh.azurehdinsight.net**.\n\n    ![putty interface with ssh address entered](./media/hdinsight-hadoop-linux-use-ssh-windows/puttyaddress.png)\n\n4. To save the connection information for future use, enter a name for this connection under **Saved Sessions**, and then click **Save**. The connection will be added to the list of saved sessions.\n\n5. Click **Open** to connect to the cluster.\n\n    > [AZURE.NOTE] If this is the first time you have connected to the cluster, you will receive a security alert. This is normal. Select **Yes** to cache the server's RSA2 key to continue.\n\n6. When prompted, enter the user that you entered when you created the cluster. If you provided a password for the user, you will be prompted to enter it also.\n\n> [AZURE.NOTE] The above steps assume you are using port 22, which will connect to head node 0 on the HDInsight cluster. If you use port 23, you will connect to head node 1. For more information on the head nodes, see [Availability and reliability of Hadoop clusters in HDInsight](hdinsight-high-availability-linux.md).\n\n###Connect to worker nodes\n\nThe worker nodes are not directly accessible from outside the Azure datacenter, but they can be accessed from the cluster head node via SSH.\n\nIf you provided an SSH key when you created your user account, you must perform the following steps to use the private key when authenticating to the cluster if you want to connect to the worker nodes.\n\n1. Install Pageant from [http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html](http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html). This utility is used to cache SSH keys for PuTTY.\n\n2. Run Pageant. It will minimize to an icon in the status tray. Right-click the icon and select **Add Key**.\n\n    ![adding key](./media/hdinsight-hadoop-linux-use-ssh-windows/addkey.png)\n\n3. When the browse dialog appears, select the .ppk file that contains the key, and then click **Open**. This adds the key to Pageant, which will provide it to PuTTY when connecting to the cluster.\n\n    > [AZURE.IMPORTANT] If you used an SSH key to secure your account, you must complete the previous steps before you will be able to connect to worker nodes.\n\n4. Open PuTTY.\n\n5. If you use an SSH key to authenticate, in the **Category** section, expand **Connection**, expand **SSH**, and then select **Auth**.\n\n    In the **Authentication parameters** section, enable **Allow agent forwarding**. This allows PuTTY to automatically pass the certificate authentication through the connection to the cluster head node when connecting to worker nodes.\n\n    ![allow agent forwarding](./media/hdinsight-hadoop-linux-use-ssh-windows/allowforwarding.png)\n\n6. Connect to the cluster as documented earlier. If you use an SSH key for authentication, you do not need to select the key - the SSH key added to Pageant will be used to authenticate to the cluster.\n\n7. After the connection has been established, use the following to retrieve a list of the nodes in your cluster. Replace *ADMINPASSWORD* with the password for your cluster admin account. Replace *CLUSTERNAME* with the name of your cluster.\n\n        curl --user admin:ADMINPASSWORD https://CLUSTERNAME.azurehdinsight.net/api/v1/hosts\n\n    This will return information in JSON format for the nodes in the cluster, including `host_name`, which contains the fully qualified domain name (FQDN) for each node. The following is an example of a `host_name` entry returned by the **curl** command:\n\n        \"host_name\" : \"workernode0.workernode-0-e2f35e63355b4f15a31c460b6d4e1230.j1.internal.cloudapp.net\"\n\n8. Once you have a list of the worker nodes you want to connect to, use the following command from the PuTTY session to open a connection to a worker node:\n\n        ssh USERNAME@FQDN\n\n    Replace *USERNAME* with your SSH user name and *FQDN* with the FQDN for the worker node. For example, `workernode0.workernode-0-e2f35e63355b4f15a31c460b6d4e1230.j1.internal.cloudapp.net`.\n\n    > [AZURE.NOTE] If you use a password to authentication your SSH session, you will be prompted to enter the password again. If you use an SSH key, the connection should finish without any prompts.\n\n9. Once the session has been established, the prompt for your PuTTY session will change from `username@hn0-clustername` to `username@wn0-clustername` to indicate that you are connected to the worker node. Any commands you run at this point will run on the worker node.\n\n10. Once you have finished performing actions on the worker node, use the `exit` command to close the session to the worker node. This will return you to the `username@hn0-clustername` prompt.\n\n##Add more accounts\n\nIf you need to add more accounts to your cluster, perform the following steps:\n\n1. Generate a new public key and private key for the new user account as described previously.\n\n2. From an SSH session to the cluster, add the new user with the following command:\n\n        sudo adduser --disabled-password <username>\n\n    This will create a new user account, but will disable password authentication.\n\n3. Create the directory and files to hold the key by using the following commands:\n\n        sudo mkdir -p /home/<username>/.ssh\n        sudo touch /home/<username>/.ssh/authorized_keys\n        sudo nano /home/<username>/.ssh/authorized_keys\n\n4. When the nano editor opens, copy and paste in the contents of the public key for the new user account. Finally, use **Ctrl-X** to save the file and exit the editor.\n\n    ![image of nano editor with example key](./media/hdinsight-hadoop-linux-use-ssh-windows/nano.png)\n\n5. Use the following command to change ownership of the .ssh folder and contents to the new user account:\n\n        sudo chown -hR <username>:<username> /home/<username>/.ssh\n\n6. You should now be able to authenticate to the server with the new user account and private key.\n\n##<a id=\"tunnel\"></a>SSH tunneling\n\nSSH can be used to tunnel local requests, such as web requests, to the HDInsight cluster. The request will then be routed to the requested resource as if it had originated on the HDInsight cluster head node.\n\n> [AZURE.IMPORTANT] An SSH tunnel is a requirement for accessing the web UI for some Hadoop services. For example, both the Job History UI or Resource Manager UI can only be accessed using an SSH tunnel.\n\nFor more information on creating and using an SSH tunnel, see [Use SSH Tunneling to access Ambari web UI, ResourceManager, JobHistory, NameNode, Oozie, and other web UI's](hdinsight-linux-ambari-ssh-tunnel.md).\n\n##Next steps\n\nNow that you understand how to authenticate by using an SSH key, learn how to use MapReduce with Hadoop on HDInsight.\n\n* [Use Hive with HDInsight](hdinsight-use-hive.md)\n\n* [Use Pig with HDInsight](hdinsight-use-pig.md)\n\n* [Use MapReduce jobs with HDInsight](hdinsight-use-mapreduce.md)\n\n[preview-portal]: https://portal.azure.com/\n"
}