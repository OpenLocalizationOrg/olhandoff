<markdown_skeleton_root>
  <block_element>
    <ArrayOfMarkdownBlockBase xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="ef78dd27-15b6-44f8-ad96-a2bab7be6335"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>fd372ff6-e51e-4680-812e-1c8e3046b1d4</SegmentId>
            <InternalNormalItem
              internal_item_id="b09bc6a5-511c-4c4c-9383-8691b8a6f83b"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="5630882a-5077-49ec-ae3a-6f2c43cf084f"
        item_type="Header"
        item_footer="footer_not_set">
        <header_type>Star</header_type>
        <header_level>1</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="9363201f-d033-4de0-b430-8c105e49e361"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>8abad20a-4e43-4b3b-bd29-ad43a60558e4</SegmentId>
            <InternalNormalItem
              internal_item_id="7f2cc1e9-1b83-4f05-b65d-83f7c6e37aab"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="d99a74f8-f2c7-4df2-898f-ee95c1af8ab6"
        item_type="Header"
        item_footer="footer_not_set">
        <header_type>Star</header_type>
        <header_level>3</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownListBlock"
        item_id="76c00ba2-44ab-4c81-960a-83700a81c2a6"
        item_type="List"
        item_footer="">
        <inner_list_items>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="30fa6661-3d88-4646-ab5f-8c3b447d4a10"
              item_type="NormalParagraph"
              item_footer="footer_not_set">
              <paragraph_segments>
                <MarkdownSegment>
                  <SegmentId>dac63b47-7af7-49dd-8bc3-97582cb72bf5</SegmentId>
                  <InternalNormalItem
                    internal_item_id="13322026-12c1-4dac-a894-763300c7c0bc"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                  <MarkdownInternalBoldItem
                    internal_item_id="597cdbff-4d1d-4ae6-bf62-29c9ea147252"
                    internal_item_type="Bold">
                    <internal_items />
                    <internal_itatic_bold_item_type>Star</internal_itatic_bold_item_type>
                  </MarkdownInternalBoldItem>
                  <InternalNormalItem
                    internal_item_id="aeed5498-cc7f-4a78-980b-5dc926e89080"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>1.  </Identifier>
          </ListItem>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="4bbe96c8-e019-4ee2-95df-040a3fa54f8c"
              item_type="NormalParagraph"
              item_footer="footer_not_set">
              <paragraph_segments>
                <MarkdownSegment>
                  <SegmentId>aab579b9-30ae-4940-a550-464d8a0ecab0</SegmentId>
                  <InternalNormalItem
                    internal_item_id="562d9636-1238-4564-98ef-be814d65895c"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>2.  </Identifier>
          </ListItem>
        </inner_list_items>
        <ListType>Number</ListType>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="a9367df5-e535-4380-930f-173ced7acf6b"
        item_type="FencedCodeBlock"
        item_footer="footer_not_set">
        <codeblock_wraper> ```</codeblock_wraper>
        <code_block>get-command –module hyper-v | out-gridview
```
  You get something like this:

  ![](media\command_grid.png)

3. To learn more about a particular PowerShell command use `get-help`. For instance running the following command will return information about the `get-vm` Hyper-V command.

  ```powershell
get-help get-vm
```
 The output shows you how to structure the command, what the required and optional parameters are, and the aliases that you can use.

 ![](media\get_help.png)


### Return a list of virtual machines

Use the `get-vm` command to return a list of virtual machines.

1. In PowerShell, run the following command:

 ```powershell
get-vm
```
 This displays something like this:

 ![](media\get_vm.png)

2. To return a list of only powered on virtual machines add a filter to the `get-vm` command. A filter can be added by using the where-object command. For more information on filtering see the [Using the Where-Object](https://technet.microsoft.com/en-us/library/ee177028.aspx) documentation.   

 ```powershell
 get-vm | where {$_.State –eq ‘Running’}
</code_block>
        <fenced_code_lang>powershell</fenced_code_lang>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownListBlock"
        item_id="be005533-5a19-4238-a02a-c5511d8e641a"
        item_type="List"
        item_footer="">
        <inner_list_items>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="6b16a317-92de-4790-bad6-a5d273af4056"
              item_type="NormalParagraph"
              item_footer="footer_not_set">
              <paragraph_segments>
                <MarkdownSegment>
                  <SegmentId>61b7df40-3f9d-47a1-b45c-d75389ebc764</SegmentId>
                  <InternalNormalItem
                    internal_item_id="fc77dd31-ac02-4ec9-a69a-e3053ef2d817"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
                <MarkdownSegment>
                  <SegmentId>250498ef-68c7-4e20-a632-4b93bcf18ca3</SegmentId>
                  <InternalNormalItem
                    internal_item_id="4a00f48d-53da-4a4b-83c7-1f600179e08c"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>3.  </Identifier>
          </ListItem>
        </inner_list_items>
        <ListType>Number</ListType>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="df351ca5-36cd-4601-8f12-1f7b43147172"
        item_type="FencedCodeBlock"
        item_footer="">
        <codeblock_wraper> ```</codeblock_wraper>
        <code_block> get-vm | where {$_.State –eq ‘Off’}
</code_block>
        <fenced_code_lang>powershell</fenced_code_lang>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="b82efc81-b8b8-4191-9ea5-56f2fa9b662a"
        item_type="Header"
        item_footer="footer_not_set">
        <header_type>Star</header_type>
        <header_level>3</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownListBlock"
        item_id="4744aba2-5023-4073-81b1-4bf1b31f6cf0"
        item_type="List"
        item_footer="">
        <inner_list_items>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="587dbfb4-390a-4e8f-aa6b-ab0901cd5787"
              item_type="NormalParagraph"
              item_footer="footer_not_set">
              <paragraph_segments>
                <MarkdownSegment>
                  <SegmentId>85b9676a-2962-42b4-9619-8ce5159f2354</SegmentId>
                  <InternalNormalItem
                    internal_item_id="489ab7e5-d342-45be-876c-8c661a576972"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>1. </Identifier>
          </ListItem>
        </inner_list_items>
        <ListType>Number</ListType>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="afd74e2f-0c86-41a6-8ccf-265a79216cc9"
        item_type="FencedCodeBlock"
        item_footer="">
        <codeblock_wraper> ```</codeblock_wraper>
        <code_block> Start-vm –Name &lt;virtual machine name&gt;
</code_block>
        <fenced_code_lang>powershell</fenced_code_lang>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownListBlock"
        item_id="75cfed6d-05f8-4d1c-b303-5ee561970020"
        item_type="List"
        item_footer="">
        <inner_list_items>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="ebb9fd88-941a-46c0-add4-6ff087b30aba"
              item_type="NormalParagraph"
              item_footer="footer_not_set">
              <paragraph_segments>
                <MarkdownSegment>
                  <SegmentId>41234b55-c87d-460e-9980-7bd5c54afc97</SegmentId>
                  <InternalNormalItem
                    internal_item_id="f9c6f6ea-21af-4355-b521-7c41cf06aabd"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>2. </Identifier>
          </ListItem>
        </inner_list_items>
        <ListType>Number</ListType>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="75f41f88-c6e5-469f-a167-2eda6bf8e9cc"
        item_type="FencedCodeBlock"
        item_footer="">
        <codeblock_wraper>  ```</codeblock_wraper>
        <code_block> get-vm | where {$_.State –eq ‘Off’} | start-vm
 ```
3. To shut down all running virtual machines, run this:

  ```powershell
 get-vm | where {$_.State –eq ‘Running’} | stop-vm
 ```

### Create a VM checkpoint

To create a checkpoint using PowerShell, select the virtual machine using the `get-vm` command and pipe this to the `checkpoint-vm` command. Finally give the checkpoint a name using `-snapshotname`. The complete command will look like the following:

 ```powershell
 get-vm -Name &lt;VM Name&gt; | checkpoint-vm -snapshotname &lt;name for snapshot&gt;
 ```
For example, here is a checkpoint with the name DEMOCP:

 ![](media\POSH_CP2.png)

### Create a new virtual machine

The following example shows how to create a new virtual machine in the PowerShell Integrated Scripting Environment (ISE). This is a simple example and could be expanded on to include additional PowerShell features and more advanced VM deployments.

1. To open the PowerShell ISE click on start, type **PowerShell ISE**.
2. Run the following code to create a virtual machine. See the [New-VM](https://technet.microsoft.com/en-us/library/hh848537.aspx) documentation for detailed information on the New-VM command.

  ```powershell
 $VMName = "VMNAME"

 $VM = @{
     Name = $VMName 
     MemoryStartupBytes = 2147483648
     Generation = 2
     NewVHDPath = "C:\Virtual Machines\$VMName\$VMName.vhdx"
     NewVHDSizeBytes = 53687091200
     BootDevice = "VHD"
     Path = "C:\Virtual Machines\$VMName "
     SwitchName = (get-vmswitch).Name[0]
 }

 New-VM @VM
</code_block>
        <fenced_code_lang>powershell</fenced_code_lang>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="25edf205-3e19-47dd-a5fa-bbd85d5fb969"
        item_type="Header"
        item_footer="footer_not_set">
        <header_type>Star</header_type>
        <header_level>2</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="7e26341c-302e-4045-bc70-32509a9a398b"
        item_type="NormalParagraph"
        item_footer="&#xA;&#xA;&#xA;&#xA;">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>d4f64db6-4dbd-426a-9161-5b3508d7b706</SegmentId>
            <InternalNormalItem
              internal_item_id="7e79da2a-5fd1-4ec5-8ed3-6939253bbfee"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment>
            <SegmentId>8fa726ea-eddf-4d21-b306-aca6ee3398ba</SegmentId>
            <InternalNormalItem
              internal_item_id="e4535795-9a2b-4723-9a00-7067be40c358"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
            <LinkItem
              internal_item_id="5630a986-dea8-432b-9320-df96d8d0c8c8"
              internal_item_type="Link">
              <internal_items />
              <internal_link_type>Inline</internal_link_type>
              <internal_link_text>Hyper-V Cmdlets in Windows PowerShell reference</internal_link_text>
              <internal_link_url>https://technet.microsoft.com/%5Clibrary/Hh848559.aspx</internal_link_url>
              <internal_link_title />
            </LinkItem>
            <InternalNormalItem
              internal_item_id="7f7f29f7-ad09-40ab-bb17-769ba5824a41"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
    </ArrayOfMarkdownBlockBase>
  </block_element>
  <references>
    <ArrayOfMarkdownLinkedReference xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
  </references>
</markdown_skeleton_root>