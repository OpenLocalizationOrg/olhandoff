<?xml version="1.0" encoding="utf-8"?>
<xliff version="1.2" xmlns="urn:oasis:names:tc:xliff:document:1.2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:oasis:names:tc:xliff:document:1.2 xliff-core-1.2-transitional.xsd">
  <file datatype="xml" source-language="en-us" target-language="zh-tw" original="1/5/2016 3:36:17 PM" tool-id="MarkdownTransformer" product-name="N/A" product-version="N/A" build-num="1">
    <header>
      <xliffext:olfilehash xmlns:xliffext="urn:microsoft:content:schema:xliffextensions">f64cbea29a1e9998b8ade46d69c1ef1c584bd633</xliffext:olfilehash>
      <tool tool-id="MarkdownTransformer" tool-name="MarkdownToXliff" tool-version="1.0" tool-company="Microsoft" />
    </header>
    <body>
      <group extype="content">
        <group id="101">
          <trans-unit id="101" xml:space="preserve">
            <source>Writing a custom DSC resource with MOF</source>
            <target state="new">Writing a custom DSC resource with MOF</target>
          </trans-unit>
          <trans-unit id="102" xml:space="preserve">
            <source>Applies To: Windows PowerShell 4.0, Windows PowerShell 5.0</source>
            <target state="new">Applies To: Windows PowerShell 4.0, Windows PowerShell 5.0</target>
          </trans-unit>
          <trans-unit id="103" xml:space="preserve">
            <source>In this topic, we will define the schema for a Windows PowerShell Desired State Configuration (DSC) custom resource in a MOF file, and implement the resource in a Windows PowerShell script file.</source>
            <target state="new">In this topic, we will define the schema for a Windows PowerShell Desired State Configuration (DSC) custom resource in a MOF file, and implement the resource in a Windows PowerShell script file.</target>
          </trans-unit>
          <trans-unit id="104" xml:space="preserve">
            <source>This custom resource is for creating and maintaining a web site.</source>
            <target state="new">This custom resource is for creating and maintaining a web site.</target>
          </trans-unit>
          <trans-unit id="105" xml:space="preserve">
            <source>Creating the MOF schema</source>
            <target state="new">Creating the MOF schema</target>
          </trans-unit>
          <trans-unit id="106" xml:space="preserve">
            <source>The schema defines the properties of your resource that can be configured by a DSC configuration script.</source>
            <target state="new">The schema defines the properties of your resource that can be configured by a DSC configuration script.</target>
          </trans-unit>
          <trans-unit id="107" xml:space="preserve">
            <source>Folder structure for a MOF resource</source>
            <target state="new">Folder structure for a MOF resource</target>
          </trans-unit>
          <trans-unit id="108" xml:space="preserve">
            <source>To implement a DSC custom resource with a MOF schema, create the following folder structure.</source>
            <target state="new">To implement a DSC custom resource with a MOF schema, create the following folder structure.</target>
          </trans-unit>
          <trans-unit id="109" xml:space="preserve">
            <source>The MOF schema is defined in the file Demo_IISWebsite.schema.mof, and the resource script is defined in Demo_IISWebsite.ps1.</source>
            <target state="new">The MOF schema is defined in the file Demo_IISWebsite.schema.mof, and the resource script is defined in Demo_IISWebsite.ps1.</target>
          </trans-unit>
          <trans-unit id="110" xml:space="preserve">
            <source>Optionally, you can create a module manifest (psd1) file.</source>
            <target state="new">Optionally, you can create a module manifest (psd1) file.</target>
          </trans-unit>
          <trans-unit id="111" xml:space="preserve">
            <source>Note that it is necessary to create a folder named DSCResources under the top-level folder, and that the folder for each resource must have the same name as the resource.</source>
            <target state="new">Note that it is necessary to create a folder named DSCResources under the top-level folder, and that the folder for each resource must have the same name as the resource.</target>
          </trans-unit>
          <trans-unit id="112" xml:space="preserve">
            <source>The contents of the MOF file</source>
            <target state="new">The contents of the MOF file</target>
          </trans-unit>
          <trans-unit id="113" xml:space="preserve">
            <source>Following is an example MOF file that can be used for a custom website resource.</source>
            <target state="new">Following is an example MOF file that can be used for a custom website resource.</target>
          </trans-unit>
          <trans-unit id="114" xml:space="preserve">
            <source>To follow this example, save this schema to a file, and call the file <bpt id="2">&lt;em&gt;</bpt>Demo_IISWebsite.schema.mof<ept id="2">&lt;/em&gt;</ept>.</source>
            <target state="new">To follow this example, save this schema to a file, and call the file <bpt id="2">&lt;em&gt;</bpt>Demo_IISWebsite.schema.mof<ept id="2">&lt;/em&gt;</ept>.</target>
          </trans-unit>
          <trans-unit id="115" xml:space="preserve">
            <source>Note the following about the previous code:</source>
            <target state="new">Note the following about the previous code:</target>
          </trans-unit>
          <trans-unit id="116" xml:space="preserve">
            <source><bpt id="1">&lt;code&gt;</bpt>FriendlyName<ept id="1">&lt;/code&gt;</ept> defines the name you can use to refer to this custom resource in DSC configuration scripts.</source>
            <target state="new"><bpt id="1">&lt;code&gt;</bpt>FriendlyName<ept id="1">&lt;/code&gt;</ept> defines the name you can use to refer to this custom resource in DSC configuration scripts.</target>
          </trans-unit>
          <trans-unit id="117" xml:space="preserve">
            <source>In this example, <bpt id="2">&lt;code&gt;</bpt>Website<ept id="2">&lt;/code&gt;</ept> is equivalent to the friendly name <bpt id="4">&lt;code&gt;</bpt>Archive<ept id="4">&lt;/code&gt;</ept> for the built-in Archive resource.</source>
            <target state="new">In this example, <bpt id="2">&lt;code&gt;</bpt>Website<ept id="2">&lt;/code&gt;</ept> is equivalent to the friendly name <bpt id="4">&lt;code&gt;</bpt>Archive<ept id="4">&lt;/code&gt;</ept> for the built-in Archive resource.</target>
          </trans-unit>
          <trans-unit id="118" xml:space="preserve">
            <source>The class you define for your custom resource must derive from <bpt id="2">&lt;code&gt;</bpt>OMI_BaseResource<ept id="2">&lt;/code&gt;</ept>.</source>
            <target state="new">The class you define for your custom resource must derive from <bpt id="2">&lt;code&gt;</bpt>OMI_BaseResource<ept id="2">&lt;/code&gt;</ept>.</target>
          </trans-unit>
          <trans-unit id="119" xml:space="preserve">
            <source>The type qualifier, <bpt id="2">&lt;code&gt;</bpt>[Key]<ept id="2">&lt;/code&gt;</ept>, on a property indicates that this property will uniquely identify the resource instance.</source>
            <target state="new">The type qualifier, <bpt id="2">&lt;code&gt;</bpt>[Key]<ept id="2">&lt;/code&gt;</ept>, on a property indicates that this property will uniquely identify the resource instance.</target>
          </trans-unit>
          <trans-unit id="120" xml:space="preserve">
            <source>A <bpt id="2">&lt;code&gt;</bpt>[Key]<ept id="2">&lt;/code&gt;</ept> property is also required.</source>
            <target state="new">A <bpt id="2">&lt;code&gt;</bpt>[Key]<ept id="2">&lt;/code&gt;</ept> property is also required.</target>
          </trans-unit>
          <trans-unit id="121" xml:space="preserve">
            <source>The <bpt id="2">&lt;code&gt;</bpt>[Required]<ept id="2">&lt;/code&gt;</ept> qualifier indicates that the property is required (a value must be specified in any configuration script that uses this resource).</source>
            <target state="new">The <bpt id="2">&lt;code&gt;</bpt>[Required]<ept id="2">&lt;/code&gt;</ept> qualifier indicates that the property is required (a value must be specified in any configuration script that uses this resource).</target>
          </trans-unit>
          <trans-unit id="122" xml:space="preserve">
            <source>The <bpt id="2">&lt;code&gt;</bpt>[write]<ept id="2">&lt;/code&gt;</ept> qualifier indicates that this property is optional when using the custom resource in a configuration script.</source>
            <target state="new">The <bpt id="2">&lt;code&gt;</bpt>[write]<ept id="2">&lt;/code&gt;</ept> qualifier indicates that this property is optional when using the custom resource in a configuration script.</target>
          </trans-unit>
          <trans-unit id="123" xml:space="preserve">
            <source>The <bpt id="2">&lt;code&gt;</bpt>[read]<ept id="2">&lt;/code&gt;</ept> qualifier indicates that a property cannot be set by a configuration, and is for reporting purposes only.</source>
            <target state="new">The <bpt id="2">&lt;code&gt;</bpt>[read]<ept id="2">&lt;/code&gt;</ept> qualifier indicates that a property cannot be set by a configuration, and is for reporting purposes only.</target>
          </trans-unit>
          <trans-unit id="124" xml:space="preserve">
            <source><bpt id="1">&lt;code&gt;</bpt>Values<ept id="1">&lt;/code&gt;</ept> restricts the values that can be assigned to the property to the list of values defined in <bpt id="3">&lt;code&gt;</bpt>ValueMap<ept id="3">&lt;/code&gt;</ept>.</source>
            <target state="new"><bpt id="1">&lt;code&gt;</bpt>Values<ept id="1">&lt;/code&gt;</ept> restricts the values that can be assigned to the property to the list of values defined in <bpt id="3">&lt;code&gt;</bpt>ValueMap<ept id="3">&lt;/code&gt;</ept>.</target>
          </trans-unit>
          <trans-unit id="125" xml:space="preserve">
            <source>For more information, see <bpt id="2CapsExtId1">&lt;link&gt;</bpt><bpt id="2CapsExtId2">&lt;linkText&gt;</bpt>ValueMap and Value Qualifiers<ept id="2CapsExtId2">&lt;/linkText&gt;</ept><bpt id="2CapsExtId3">&lt;title&gt;</bpt><ept id="2CapsExtId3">&lt;/title&gt;</ept><ept id="2CapsExtId1">&lt;/link&gt;</ept>.</source>
            <target state="new">For more information, see <bpt id="2CapsExtId1">&lt;link&gt;</bpt><bpt id="2CapsExtId2">&lt;linkText&gt;</bpt>ValueMap and Value Qualifiers<ept id="2CapsExtId2">&lt;/linkText&gt;</ept><bpt id="2CapsExtId3">&lt;title&gt;</bpt><ept id="2CapsExtId3">&lt;/title&gt;</ept><ept id="2CapsExtId1">&lt;/link&gt;</ept>.</target>
          </trans-unit>
          <trans-unit id="126" xml:space="preserve">
            <source>Including a property called <bpt id="2">&lt;code&gt;</bpt>Ensure<ept id="2">&lt;/code&gt;</ept> in your resource is recommended as a way to maintain a consistent style with built-in DSC resources.</source>
            <target state="new">Including a property called <bpt id="2">&lt;code&gt;</bpt>Ensure<ept id="2">&lt;/code&gt;</ept> in your resource is recommended as a way to maintain a consistent style with built-in DSC resources.</target>
          </trans-unit>
          <trans-unit id="127" xml:space="preserve">
            <source>Name the schema file for your custom resource as follows: <bpt id="2">&lt;code&gt;</bpt>classname.schema.mof<ept id="2">&lt;/code&gt;</ept>, where <bpt id="4">&lt;code&gt;</bpt>classname<ept id="4">&lt;/code&gt;</ept> is the identifier that follows the <bpt id="6">&lt;code&gt;</bpt>class<ept id="6">&lt;/code&gt;</ept> keyword in your schema definition.</source>
            <target state="new">Name the schema file for your custom resource as follows: <bpt id="2">&lt;code&gt;</bpt>classname.schema.mof<ept id="2">&lt;/code&gt;</ept>, where <bpt id="4">&lt;code&gt;</bpt>classname<ept id="4">&lt;/code&gt;</ept> is the identifier that follows the <bpt id="6">&lt;code&gt;</bpt>class<ept id="6">&lt;/code&gt;</ept> keyword in your schema definition.</target>
          </trans-unit>
          <trans-unit id="128" xml:space="preserve">
            <source>Writing the resource script</source>
            <target state="new">Writing the resource script</target>
          </trans-unit>
          <trans-unit id="129" xml:space="preserve">
            <source>The resource script implements the logic of the resource. In this module, you must include three functions called <bpt id="2">&lt;strong&gt;</bpt>Get-TargetResource<ept id="2">&lt;/strong&gt;</ept>, <bpt id="4">&lt;strong&gt;</bpt>Set-TargetResource<ept id="4">&lt;/strong&gt;</ept>, and <bpt id="6">&lt;strong&gt;</bpt>Test-TargetResource<ept id="6">&lt;/strong&gt;</ept>. All three functions must take a parameter set that is identical to the set of properties defined in the MOF schema that you created for your resource. In this document, this set of properties is referred to as the “resource properties.” Store these three functions in a file called <bpt id="8">&lt;html&gt;</bpt><ept id="8">&lt;/html&gt;</ept>.psm1. In the following example, the functions are stored in a file called Demo_IISWebsite.psm1.</source>
            <target state="new">The resource script implements the logic of the resource. In this module, you must include three functions called <bpt id="2">&lt;strong&gt;</bpt>Get-TargetResource<ept id="2">&lt;/strong&gt;</ept>, <bpt id="4">&lt;strong&gt;</bpt>Set-TargetResource<ept id="4">&lt;/strong&gt;</ept>, and <bpt id="6">&lt;strong&gt;</bpt>Test-TargetResource<ept id="6">&lt;/strong&gt;</ept>. All three functions must take a parameter set that is identical to the set of properties defined in the MOF schema that you created for your resource. In this document, this set of properties is referred to as the “resource properties.” Store these three functions in a file called <bpt id="8">&lt;html&gt;</bpt><ept id="8">&lt;/html&gt;</ept>.psm1. In the following example, the functions are stored in a file called Demo_IISWebsite.psm1.</target>
          </trans-unit>
          <trans-unit id="130" xml:space="preserve">
            <source><bpt id="1">&lt;strong&gt;</bpt>Note<ept id="1">&lt;/strong&gt;</ept>: When you run the same configuration script on your resource more than once, you should receive no errors and the resource should remain in the same state as running the script once.</source>
            <target state="new"><bpt id="1">&lt;strong&gt;</bpt>Note<ept id="1">&lt;/strong&gt;</ept>: When you run the same configuration script on your resource more than once, you should receive no errors and the resource should remain in the same state as running the script once.</target>
          </trans-unit>
          <trans-unit id="131" xml:space="preserve">
            <source>To accomplish this, ensure that your <bpt id="2">&lt;strong&gt;</bpt>Get-TargetResource<ept id="2">&lt;/strong&gt;</ept> and <bpt id="4">&lt;strong&gt;</bpt>Test-TargetResource<ept id="4">&lt;/strong&gt;</ept> functions leave the resource unchanged, and that invoking the <bpt id="6">&lt;strong&gt;</bpt>Set-TargetResource<ept id="6">&lt;/strong&gt;</ept> function more than once in a sequence with the same parameter values is always equivalent to invoking it once.</source>
            <target state="new">To accomplish this, ensure that your <bpt id="2">&lt;strong&gt;</bpt>Get-TargetResource<ept id="2">&lt;/strong&gt;</ept> and <bpt id="4">&lt;strong&gt;</bpt>Test-TargetResource<ept id="4">&lt;/strong&gt;</ept> functions leave the resource unchanged, and that invoking the <bpt id="6">&lt;strong&gt;</bpt>Set-TargetResource<ept id="6">&lt;/strong&gt;</ept> function more than once in a sequence with the same parameter values is always equivalent to invoking it once.</target>
          </trans-unit>
          <trans-unit id="132" xml:space="preserve">
            <source>In the <bpt id="2">&lt;strong&gt;</bpt>Get-TargetResource<ept id="2">&lt;/strong&gt;</ept> function implementation, use the key resource property values that are provided as parameters to check the status of the specified resource instance.</source>
            <target state="new">In the <bpt id="2">&lt;strong&gt;</bpt>Get-TargetResource<ept id="2">&lt;/strong&gt;</ept> function implementation, use the key resource property values that are provided as parameters to check the status of the specified resource instance.</target>
          </trans-unit>
          <trans-unit id="133" xml:space="preserve">
            <source>This function must return a hash table that lists all the resource properties as keys and the actual values of these properties as the corresponding values.</source>
            <target state="new">This function must return a hash table that lists all the resource properties as keys and the actual values of these properties as the corresponding values.</target>
          </trans-unit>
          <trans-unit id="134" xml:space="preserve">
            <source>The following code provides an example.</source>
            <target state="new">The following code provides an example.</target>
          </trans-unit>
          <trans-unit id="135" xml:space="preserve">
            <source>Depending on the values that are specified for the resource properties in the configuration script, the <bpt id="2">&lt;strong&gt;</bpt>Set-TargetResource<ept id="2">&lt;/strong&gt;</ept> must do one of the following:</source>
            <target state="new">Depending on the values that are specified for the resource properties in the configuration script, the <bpt id="2">&lt;strong&gt;</bpt>Set-TargetResource<ept id="2">&lt;/strong&gt;</ept> must do one of the following:</target>
          </trans-unit>
          <trans-unit id="136" xml:space="preserve">
            <source>Create a new website</source>
            <target state="new">Create a new website</target>
          </trans-unit>
          <trans-unit id="137" xml:space="preserve">
            <source>Update an existing website</source>
            <target state="new">Update an existing website</target>
          </trans-unit>
          <trans-unit id="138" xml:space="preserve">
            <source>Delete an existing website</source>
            <target state="new">Delete an existing website</target>
          </trans-unit>
          <trans-unit id="139" xml:space="preserve">
            <source>The following example illustrates this.</source>
            <target state="new">The following example illustrates this.</target>
          </trans-unit>
          <trans-unit id="140" xml:space="preserve">
            <source>Finally, the <bpt id="2">&lt;strong&gt;</bpt>Test-TargetResource<ept id="2">&lt;/strong&gt;</ept> function must take the same parameter set as <bpt id="4">&lt;strong&gt;</bpt>Get-TargetResource<ept id="4">&lt;/strong&gt;</ept> and <bpt id="6">&lt;strong&gt;</bpt>Set-TargetResource<ept id="6">&lt;/strong&gt;</ept>.</source>
            <target state="new">Finally, the <bpt id="2">&lt;strong&gt;</bpt>Test-TargetResource<ept id="2">&lt;/strong&gt;</ept> function must take the same parameter set as <bpt id="4">&lt;strong&gt;</bpt>Get-TargetResource<ept id="4">&lt;/strong&gt;</ept> and <bpt id="6">&lt;strong&gt;</bpt>Set-TargetResource<ept id="6">&lt;/strong&gt;</ept>.</target>
          </trans-unit>
          <trans-unit id="141" xml:space="preserve">
            <source>In your implementation of <bpt id="2">&lt;strong&gt;</bpt>Test-TargetResource<ept id="2">&lt;/strong&gt;</ept>, check the status of the resource instance that is specified in the key parameters.</source>
            <target state="new">In your implementation of <bpt id="2">&lt;strong&gt;</bpt>Test-TargetResource<ept id="2">&lt;/strong&gt;</ept>, check the status of the resource instance that is specified in the key parameters.</target>
          </trans-unit>
          <trans-unit id="142" xml:space="preserve">
            <source>If the actual status of the resource instance does not match the values specified in the parameter set, return <bpt id="2">&lt;strong&gt;</bpt>$false<ept id="2">&lt;/strong&gt;</ept>.</source>
            <target state="new">If the actual status of the resource instance does not match the values specified in the parameter set, return <bpt id="2">&lt;strong&gt;</bpt>$false<ept id="2">&lt;/strong&gt;</ept>.</target>
          </trans-unit>
          <trans-unit id="143" xml:space="preserve">
            <source>Otherwise, return <bpt id="2">&lt;strong&gt;</bpt>$true<ept id="2">&lt;/strong&gt;</ept>.</source>
            <target state="new">Otherwise, return <bpt id="2">&lt;strong&gt;</bpt>$true<ept id="2">&lt;/strong&gt;</ept>.</target>
          </trans-unit>
          <trans-unit id="144" xml:space="preserve">
            <source>The following code implements the <bpt id="2">&lt;strong&gt;</bpt>Test-TargetResource<ept id="2">&lt;/strong&gt;</ept> function.</source>
            <target state="new">The following code implements the <bpt id="2">&lt;strong&gt;</bpt>Test-TargetResource<ept id="2">&lt;/strong&gt;</ept> function.</target>
          </trans-unit>
          <trans-unit id="145" xml:space="preserve">
            <source><bpt id="1">&lt;strong&gt;</bpt>Note<ept id="1">&lt;/strong&gt;</ept>: For easier debugging, use the <bpt id="3">&lt;strong&gt;</bpt>Write-Verbose<ept id="3">&lt;/strong&gt;</ept> cmdlet in your implementation of the previous three functions.</source>
            <target state="new"><bpt id="1">&lt;strong&gt;</bpt>Note<ept id="1">&lt;/strong&gt;</ept>: For easier debugging, use the <bpt id="3">&lt;strong&gt;</bpt>Write-Verbose<ept id="3">&lt;/strong&gt;</ept> cmdlet in your implementation of the previous three functions.</target>
          </trans-unit>
          <trans-unit id="146" xml:space="preserve">
            <source>This cmdlet writes text to the verbose message stream.</source>
            <target state="new">This cmdlet writes text to the verbose message stream.</target>
          </trans-unit>
          <trans-unit id="147" xml:space="preserve">
            <source>By default, the verbose message stream is not displayed, but you can display it by changing the value of the <bpt id="2">&lt;strong&gt;</bpt>$VerbosePreference<ept id="2">&lt;/strong&gt;</ept> variable or by using the <bpt id="4">&lt;strong&gt;</bpt>Verbose<ept id="4">&lt;/strong&gt;</ept> parameter in the DSC cmdlets = new.</source>
            <target state="new">By default, the verbose message stream is not displayed, but you can display it by changing the value of the <bpt id="2">&lt;strong&gt;</bpt>$VerbosePreference<ept id="2">&lt;/strong&gt;</ept> variable or by using the <bpt id="4">&lt;strong&gt;</bpt>Verbose<ept id="4">&lt;/strong&gt;</ept> parameter in the DSC cmdlets = new.</target>
          </trans-unit>
          <trans-unit id="148" xml:space="preserve">
            <source>Creating the module manifest</source>
            <target state="new">Creating the module manifest</target>
          </trans-unit>
          <trans-unit id="149" xml:space="preserve">
            <source>Finally, use the <bpt id="2">&lt;strong&gt;</bpt>New-ModuleManifest<ept id="2">&lt;/strong&gt;</ept> cmdlet to define a <bpt id="4">&lt;html&gt;</bpt><ept id="4">&lt;/html&gt;</ept>.psd1 file for your custom resource module. When you invoke this cmdlet, reference the script module (.psm1) file described in the previous section. Include <bpt id="6">&lt;strong&gt;</bpt>Get-TargetResource<ept id="6">&lt;/strong&gt;</ept>, <bpt id="8">&lt;strong&gt;</bpt>Set-TargetResource<ept id="8">&lt;/strong&gt;</ept>, and <bpt id="10">&lt;strong&gt;</bpt>Test-TargetResource<ept id="10">&lt;/strong&gt;</ept> in the list of functions to export. Following is an example manifest file.</source>
            <target state="new">Finally, use the <bpt id="2">&lt;strong&gt;</bpt>New-ModuleManifest<ept id="2">&lt;/strong&gt;</ept> cmdlet to define a <bpt id="4">&lt;html&gt;</bpt><ept id="4">&lt;/html&gt;</ept>.psd1 file for your custom resource module. When you invoke this cmdlet, reference the script module (.psm1) file described in the previous section. Include <bpt id="6">&lt;strong&gt;</bpt>Get-TargetResource<ept id="6">&lt;/strong&gt;</ept>, <bpt id="8">&lt;strong&gt;</bpt>Set-TargetResource<ept id="8">&lt;/strong&gt;</ept>, and <bpt id="10">&lt;strong&gt;</bpt>Test-TargetResource<ept id="10">&lt;/strong&gt;</ept> in the list of functions to export. Following is an example manifest file.</target>
          </trans-unit>
        </group>
      </group>
    </body>
  </file>
</xliff>