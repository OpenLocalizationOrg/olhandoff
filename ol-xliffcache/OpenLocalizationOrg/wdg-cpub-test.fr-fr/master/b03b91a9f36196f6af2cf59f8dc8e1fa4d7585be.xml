{
  "nodes": [
    {
      "content": "title: 'Get the user's location'",
      "pos": [
        4,
        36
      ]
    },
    {
      "content": "description: Find the user's location and respond to changes in location.",
      "pos": [
        37,
        110
      ]
    },
    {
      "content": "Access to the user's location is managed by privacy settings in the Settings app.",
      "pos": [
        111,
        192
      ]
    },
    {
      "content": "This topic also shows how to check if your app has permission to access the user's location.",
      "pos": [
        193,
        285
      ]
    },
    {
      "content": "ms.assetid: 24DC9A41-8CC1-48B0-BC6D-24BF571AFCC8",
      "pos": [
        286,
        334
      ]
    },
    {
      "content": "Get the user's location",
      "pos": [
        342,
        365
      ]
    },
    {
      "content": "\\[ Updated for UWP apps on Windows 10.",
      "pos": [
        368,
        406
      ]
    },
    {
      "content": "For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept> \\]",
      "pos": [
        407,
        502
      ]
    },
    {
      "content": "Find the user's location and respond to changes in location.",
      "pos": [
        505,
        565
      ]
    },
    {
      "content": "Access to the user's location is managed by privacy settings in the Settings app.",
      "pos": [
        566,
        647
      ]
    },
    {
      "content": "This topic also shows how to check if your app has permission to access the user's location.",
      "pos": [
        648,
        740
      ]
    },
    {
      "pos": [
        742,
        944
      ],
      "content": "<bpt id=\"p1\">**</bpt>Tip<ept id=\"p1\">**</ept> To learn more about accessing the user's location in your app, download the following sample from the <bpt id=\"p2\">[</bpt>Windows-universal-samples repo<ept id=\"p2\">](http://go.microsoft.com/fwlink/p/?LinkId=619979)</ept> on GitHub."
    },
    {
      "content": "Universal Windows Platform (UWP) map sample",
      "pos": [
        951,
        994
      ]
    },
    {
      "content": "Enable the location capability",
      "pos": [
        1049,
        1079
      ]
    },
    {
      "pos": [
        1086,
        1186
      ],
      "content": "In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, double-click <bpt id=\"p2\">**</bpt>package.appxmanifest<ept id=\"p2\">**</ept> and select the <bpt id=\"p3\">**</bpt>Capabilities<ept id=\"p3\">**</ept> tab."
    },
    {
      "content": "In the <bpt id=\"p1\">**</bpt>Capabilities<ept id=\"p1\">**</ept> list, select the <bpt id=\"p2\">**</bpt>Capabilities<ept id=\"p2\">**</ept> tab.",
      "pos": [
        1191,
        1253
      ]
    },
    {
      "content": "This adds the <ph id=\"ph1\">`Location`</ph> device capability to the package manifest file.",
      "pos": [
        1254,
        1326
      ]
    },
    {
      "content": "Get the current location",
      "pos": [
        1502,
        1526
      ]
    },
    {
      "pos": [
        1529,
        1717
      ],
      "content": "This section describes how to detect the user's geographic location using APIs in the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Windows.Devices.Geolocation<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br225603)</ept> namespace."
    },
    {
      "content": "Step 1: Request access to the user's location",
      "pos": [
        1723,
        1768
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>Important<ept id=\"p1\">**</ept> You must request access to the user's location by using the <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>RequestAccessAsync<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/dn859152)</ept> method before attempting to access the user's location.",
      "pos": [
        1770,
        1982
      ]
    },
    {
      "content": "You must call the <bpt id=\"p1\">**</bpt>RequestAccessAsync<ept id=\"p1\">**</ept> method from the UI thread and your app must be in the foreground.",
      "pos": [
        1983,
        2089
      ]
    },
    {
      "content": "Your app will not be able to access the user's location information until after the user grants permission to your app.",
      "pos": [
        2090,
        2209
      ]
    },
    {
      "content": "The <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>RequestAccessAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn859152)</ept> method prompts the user for permission to access their location.",
      "pos": [
        2323,
        2474
      ]
    },
    {
      "content": "The user is only prompted once (per app).",
      "pos": [
        2475,
        2516
      ]
    },
    {
      "content": "After the first time they grant or deny permission, this method no longer prompts the user for permission.",
      "pos": [
        2517,
        2623
      ]
    },
    {
      "content": "To help the user change location permissions after they've been prompted, we recommend that you provide a link to the location settings as demonstrated later in this topic.",
      "pos": [
        2624,
        2796
      ]
    },
    {
      "content": "Step 2: Get the user's location and register for changes in location permissions",
      "pos": [
        2802,
        2882
      ]
    },
    {
      "content": "The <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GetGeopositionAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh973536)</ept> method performs a one-time reading of the current location.",
      "pos": [
        2884,
        3031
      ]
    },
    {
      "content": "Here, a <bpt id=\"p1\">**</bpt>switch<ept id=\"p1\">**</ept> statement is used with <bpt id=\"p2\">**</bpt>accessStatus<ept id=\"p2\">**</ept> (from the previous example) to act only when access to the user's location is allowed.",
      "pos": [
        3032,
        3177
      ]
    },
    {
      "content": "If access to the user's location is allowed, the code creates a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Geolocator<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br225534)</ept> object, registers for changes in location permissions, and requests the user's location.",
      "pos": [
        3178,
        3405
      ]
    },
    {
      "content": "Step 3: Handle changes in location permissions",
      "pos": [
        4618,
        4664
      ]
    },
    {
      "content": "The <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Geolocator<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br225534)</ept> object triggers the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>StatusChanged<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br225542)</ept> event to indicate that the user's location settings changed.",
      "pos": [
        4666,
        4903
      ]
    },
    {
      "content": "That event passes the corresponding status via the argument's <bpt id=\"p1\">**</bpt>Status<ept id=\"p1\">**</ept> property (of type <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>PositionStatus<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/br225599)</ept>).",
      "pos": [
        4904,
        5075
      ]
    },
    {
      "content": "Note that this method is not called from the UI thread and the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Dispatcher<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208211)</ept> object invokes the UI changes.",
      "pos": [
        5076,
        5244
      ]
    },
    {
      "content": "Respond to location updates",
      "pos": [
        8001,
        8028
      ]
    },
    {
      "content": "This section describes how to use the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>PositionChanged<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br225540)</ept> event to receive updates of the user's location over a period of time.",
      "pos": [
        8031,
        8219
      ]
    },
    {
      "content": "Because the user could revoke access to location at any time, it's important call <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>RequestAccessAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn859152)</ept> and use the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>StatusChanged<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br225542)</ept> event as shown in the previous section.",
      "pos": [
        8220,
        8514
      ]
    },
    {
      "pos": [
        8516,
        8725
      ],
      "content": "This section assumes that you've already enabled the location capability and called <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>RequestAccessAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn859152)</ept> from the UI thread of your foreground app."
    },
    {
      "content": "Step 1: Define the report interval and register for location updates",
      "pos": [
        8731,
        8799
      ]
    },
    {
      "content": "In this example, a <bpt id=\"p1\">**</bpt>switch<ept id=\"p1\">**</ept> statement is used with <bpt id=\"p2\">**</bpt>accessStatus<ept id=\"p2\">**</ept> (from the previous example) to act only when access to the user's location is allowed.",
      "pos": [
        8801,
        8957
      ]
    },
    {
      "content": "If access to the user's location is allowed, the code creates a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Geolocator<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br225534)</ept> object, specifies the tracking type, and registers for location updates.",
      "pos": [
        8958,
        9169
      ]
    },
    {
      "pos": [
        9171,
        9461
      ],
      "content": "The <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Geolocator<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br225534)</ept> object can trigger the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>PositionChanged<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br225540)</ept> event based on a change in position (distance-based tracking) or a change in time (periodic-based tracking)."
    },
    {
      "pos": [
        9467,
        9595
      ],
      "content": "For distance-based tracking, set the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>MovementThreshold<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br225539)</ept> property."
    },
    {
      "pos": [
        9600,
        9725
      ],
      "content": "For periodic-based tracking, set the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ReportInterval<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br225541)</ept> property."
    },
    {
      "content": "If neither property is set, a position is returned every 1 second (equivalent to <ph id=\"ph1\">`ReportInterval = 1000`</ph>).",
      "pos": [
        9727,
        9833
      ]
    },
    {
      "content": "Here, a 2 second (<ph id=\"ph1\">`ReportInterval = 2000`</ph>) report interval is used.",
      "pos": [
        9834,
        9901
      ]
    },
    {
      "content": "Step 2: Handle location updates",
      "pos": [
        11204,
        11235
      ]
    },
    {
      "content": "The <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Geolocator<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br225534)</ept> object triggers the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>PositionChanged<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br225540)</ept> event to indicate that the user's location changed or time has passed, depending on how you've configured it.",
      "pos": [
        11237,
        11525
      ]
    },
    {
      "content": "That event passes the corresponding location via the argument's <bpt id=\"p1\">**</bpt>Position<ept id=\"p1\">**</ept> property (of type <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>Geoposition<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/br225543)</ept>).",
      "pos": [
        11526,
        11698
      ]
    },
    {
      "content": "In this example, the method is not called from the UI thread and the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Dispatcher<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208211)</ept> object invokes the UI changes.",
      "pos": [
        11699,
        11873
      ]
    },
    {
      "content": "Change the location privacy settings",
      "pos": [
        12206,
        12242
      ]
    },
    {
      "content": "If the location privacy settings don't allow your app to access the user's location, we recommend that you provide a convenient link to the <bpt id=\"p1\">**</bpt>location privacy settings<ept id=\"p1\">**</ept> in the <bpt id=\"p2\">**</bpt>Settings<ept id=\"p2\">**</ept> app.",
      "pos": [
        12245,
        12439
      ]
    },
    {
      "content": "In this example, a Hyperlink control is used navigate to the <ph id=\"ph1\">`ms-settings:privacy-location`</ph> URI.",
      "pos": [
        12440,
        12536
      ]
    },
    {
      "content": "Alternatively, your app can call the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>LaunchUriAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh701476)</ept> method to launch the <bpt id=\"p3\">**</bpt>Settings<ept id=\"p3\">**</ept> app from code.",
      "pos": [
        13054,
        13218
      ]
    },
    {
      "content": "For more info, see <bpt id=\"p1\">[</bpt>Launch the Windows Settings app<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/mt228342)</ept>.",
      "pos": [
        13219,
        13330
      ]
    },
    {
      "content": "Troubleshoot your app",
      "pos": [
        13462,
        13483
      ]
    },
    {
      "content": "Before your app can access the user's location, <bpt id=\"p1\">**</bpt>Location<ept id=\"p1\">**</ept> must be enabled on the device.",
      "pos": [
        13486,
        13577
      ]
    },
    {
      "content": "In the <bpt id=\"p1\">**</bpt>Settings<ept id=\"p1\">**</ept> app, check that the following <bpt id=\"p2\">**</bpt>location privacy settings<ept id=\"p2\">**</ept> are turned on:",
      "pos": [
        13578,
        13672
      ]
    },
    {
      "content": "Location for this device...",
      "pos": [
        13680,
        13707
      ]
    },
    {
      "content": "is turned <bpt id=\"p1\">**</bpt>on<ept id=\"p1\">**</ept> (not applicable in Windows 10 Mobile)",
      "pos": [
        13710,
        13764
      ]
    },
    {
      "pos": [
        13769,
        13830
      ],
      "content": "The location services setting, <bpt id=\"p1\">**</bpt>Location<ept id=\"p1\">**</ept>, is turned <bpt id=\"p2\">**</bpt>on<ept id=\"p2\">**</ept>"
    },
    {
      "pos": [
        13835,
        13910
      ],
      "content": "Under <bpt id=\"p1\">**</bpt>Choose apps that can use your location<ept id=\"p1\">**</ept>, your app is set to <bpt id=\"p2\">**</bpt>on<ept id=\"p2\">**</ept>"
    },
    {
      "content": "Related topics",
      "pos": [
        13915,
        13929
      ]
    },
    {
      "content": "UWP geolocation sample",
      "pos": [
        13934,
        13956
      ]
    },
    {
      "content": "Design guidelines for geofencing",
      "pos": [
        14010,
        14042
      ]
    },
    {
      "content": "Design guidelines for location-aware apps",
      "pos": [
        14105,
        14146
      ]
    }
  ],
  "content": "---\ntitle: 'Get the user's location'\ndescription: Find the user's location and respond to changes in location. Access to the user's location is managed by privacy settings in the Settings app. This topic also shows how to check if your app has permission to access the user's location.\nms.assetid: 24DC9A41-8CC1-48B0-BC6D-24BF571AFCC8\n---\n\n# Get the user's location\n\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\n\nFind the user's location and respond to changes in location. Access to the user's location is managed by privacy settings in the Settings app. This topic also shows how to check if your app has permission to access the user's location.\n\n**Tip** To learn more about accessing the user's location in your app, download the following sample from the [Windows-universal-samples repo](http://go.microsoft.com/fwlink/p/?LinkId=619979) on GitHub.\n\n-   [Universal Windows Platform (UWP) map sample](http://go.microsoft.com/fwlink/p/?LinkId=619977)\n\n## Enable the location capability\n\n\n1.  In **Solution Explorer**, double-click **package.appxmanifest** and select the **Capabilities** tab.\n2.  In the **Capabilities** list, select the **Capabilities** tab. This adds the `Location` device capability to the package manifest file.\n\n```XML\n  <Capabilities>\n    <!-- DeviceCapability elements must follow Capability elements (if present) -->\n    <DeviceCapability Name=\"location\"/>\n  </Capabilities>\n```\n\n## Get the current location\n\n\nThis section describes how to detect the user's geographic location using APIs in the [**Windows.Devices.Geolocation**](https://msdn.microsoft.com/library/windows/apps/br225603) namespace.\n\n### Step 1: Request access to the user's location\n\n**Important** You must request access to the user's location by using the [**RequestAccessAsync**](https://msdn.microsoft.com/library/windows/apps/dn859152) method before attempting to access the user's location. You must call the **RequestAccessAsync** method from the UI thread and your app must be in the foreground. Your app will not be able to access the user's location information until after the user grants permission to your app.\n\n```csharp\nusing Windows.Devices.Geolocation;\n...\nvar accessStatus = await Geolocator.RequestAccessAsync();\n```\n\nThe [**RequestAccessAsync**](https://msdn.microsoft.com/library/windows/apps/dn859152) method prompts the user for permission to access their location. The user is only prompted once (per app). After the first time they grant or deny permission, this method no longer prompts the user for permission. To help the user change location permissions after they've been prompted, we recommend that you provide a link to the location settings as demonstrated later in this topic.\n\n### Step 2: Get the user's location and register for changes in location permissions\n\nThe [**GetGeopositionAsync**](https://msdn.microsoft.com/library/windows/apps/hh973536) method performs a one-time reading of the current location. Here, a **switch** statement is used with **accessStatus** (from the previous example) to act only when access to the user's location is allowed. If access to the user's location is allowed, the code creates a [**Geolocator**](https://msdn.microsoft.com/library/windows/apps/br225534) object, registers for changes in location permissions, and requests the user's location.\n\n```csharp\nswitch (accessStatus)\n{\n    case GeolocationAccessStatus.Allowed:\n        _rootPage.NotifyUser(\"Waiting for update...\", NotifyType.StatusMessage);\n\n        // If DesiredAccuracy or DesiredAccuracyInMeters are not set (or value is 0), DesiredAccuracy.Default is used.\n        Geolocator geolocator = new Geolocator { DesiredAccuracyInMeters = _desireAccuracyInMetersValue };\n\n        // Subscribe to the StatusChanged event to get updates of location status changes.\n        _geolocator.StatusChanged += OnStatusChanged;\n                        \n        // Carry out the operation.\n        Geoposition pos = await geolocator.GetGeopositionAsync();\n\n        UpdateLocationData(pos);\n        _rootPage.NotifyUser(\"Location updated.\", NotifyType.StatusMessage);\n        break;\n\n    case GeolocationAccessStatus.Denied:\n        _rootPage.NotifyUser(\"Access to location is denied.\", NotifyType.ErrorMessage);\n        LocationDisabledMessage.Visibility = Visibility.Visible;\n        UpdateLocationData(null);\n        break;\n\n    case GeolocationAccessStatus.Unspecified:\n        _rootPage.NotifyUser(\"Unspecified error.\", NotifyType.ErrorMessage);\n        UpdateLocationData(null);\n        break;\n}\n```\n\n### Step 3: Handle changes in location permissions\n\nThe [**Geolocator**](https://msdn.microsoft.com/library/windows/apps/br225534) object triggers the [**StatusChanged**](https://msdn.microsoft.com/library/windows/apps/br225542) event to indicate that the user's location settings changed. That event passes the corresponding status via the argument's **Status** property (of type [**PositionStatus**](https://msdn.microsoft.com/library/windows/apps/br225599)). Note that this method is not called from the UI thread and the [**Dispatcher**](https://msdn.microsoft.com/library/windows/apps/br208211) object invokes the UI changes.\n\n```csharp\nusing Windows.UI.Core;\n...\nasync private void OnStatusChanged(Geolocator sender, StatusChangedEventArgs e)\n{\n    await Dispatcher.RunAsync(CoreDispatcherPriority.Normal, () =>\n    {\n        // Show the location setting message only if status is disabled.\n        LocationDisabledMessage.Visibility = Visibility.Collapsed;\n\n        switch (e.Status)\n        {\n            case PositionStatus.Ready:\n                // Location platform is providing valid data.\n                ScenarioOutput_Status.Text = \"Ready\";\n                _rootPage.NotifyUser(\"Location platform is ready.\", NotifyType.StatusMessage);\n                break;\n\n            case PositionStatus.Initializing:\n                // Location platform is attempting to acquire a fix. \n                ScenarioOutput_Status.Text = \"Initializing\";\n                _rootPage.NotifyUser(\"Location platform is attempting to obtain a position.\", NotifyType.StatusMessage);\n                break;\n\n            case PositionStatus.NoData:\n                // Location platform could not obtain location data.\n                ScenarioOutput_Status.Text = \"No data\";\n                _rootPage.NotifyUser(\"Not able to determine the location.\", NotifyType.ErrorMessage);\n                break;\n\n            case PositionStatus.Disabled:\n                // The permission to access location data is denied by the user or other policies.\n                ScenarioOutput_Status.Text = \"Disabled\";\n                _rootPage.NotifyUser(\"Access to location is denied.\", NotifyType.ErrorMessage);\n\n                // Show message to the user to go to location settings.\n                LocationDisabledMessage.Visibility = Visibility.Visible;\n\n                // Clear any cached location data.\n                UpdateLocationData(null);\n                break;\n\n            case PositionStatus.NotInitialized:\n                // The location platform is not initialized. This indicates that the application \n                // has not made a request for location data.\n                ScenarioOutput_Status.Text = \"Not initialized\";\n                _rootPage.NotifyUser(\"No request for location is made yet.\", NotifyType.StatusMessage);\n                break;\n\n            case PositionStatus.NotAvailable:\n                // The location platform is not available on this version of the OS.\n                ScenarioOutput_Status.Text = \"Not available\";\n                _rootPage.NotifyUser(\"Location is not available on this version of the OS.\", NotifyType.ErrorMessage);\n                break;\n\n            default:\n                ScenarioOutput_Status.Text = \"Unknown\";\n                _rootPage.NotifyUser(string.Empty, NotifyType.StatusMessage);\n                break;\n        }\n    });\n}\n```\n\n## Respond to location updates\n\n\nThis section describes how to use the [**PositionChanged**](https://msdn.microsoft.com/library/windows/apps/br225540) event to receive updates of the user's location over a period of time. Because the user could revoke access to location at any time, it's important call [**RequestAccessAsync**](https://msdn.microsoft.com/library/windows/apps/dn859152) and use the [**StatusChanged**](https://msdn.microsoft.com/library/windows/apps/br225542) event as shown in the previous section.\n\nThis section assumes that you've already enabled the location capability and called [**RequestAccessAsync**](https://msdn.microsoft.com/library/windows/apps/dn859152) from the UI thread of your foreground app.\n\n### Step 1: Define the report interval and register for location updates\n\nIn this example, a **switch** statement is used with **accessStatus** (from the previous example) to act only when access to the user's location is allowed. If access to the user's location is allowed, the code creates a [**Geolocator**](https://msdn.microsoft.com/library/windows/apps/br225534) object, specifies the tracking type, and registers for location updates.\n\nThe [**Geolocator**](https://msdn.microsoft.com/library/windows/apps/br225534) object can trigger the [**PositionChanged**](https://msdn.microsoft.com/library/windows/apps/br225540) event based on a change in position (distance-based tracking) or a change in time (periodic-based tracking).\n\n-   For distance-based tracking, set the [**MovementThreshold**](https://msdn.microsoft.com/library/windows/apps/br225539) property.\n-   For periodic-based tracking, set the [**ReportInterval**](https://msdn.microsoft.com/library/windows/apps/br225541) property.\n\nIf neither property is set, a position is returned every 1 second (equivalent to `ReportInterval = 1000`). Here, a 2 second (`ReportInterval = 2000`) report interval is used.\n```csharp\nusing Windows.Devices.Geolocation;\n...\nvar accessStatus = await Geolocator.RequestAccessAsync();\n\nswitch (accessStatus)\n{\n    case GeolocationAccessStatus.Allowed:\n        // Create Geolocator and define perodic-based tracking (2 second interval).\n        _geolocator = new Geolocator { ReportInterval = 2000 };\n\n        // Subscribe to the PositionChanged event to get location updates.\n        _geolocator.PositionChanged += OnPositionChanged;\n\n        // Subscribe to StatusChanged event to get updates of location status changes.\n        _geolocator.StatusChanged += OnStatusChanged;\n                    \n        _rootPage.NotifyUser(\"Waiting for update...\", NotifyType.StatusMessage);\n        LocationDisabledMessage.Visibility = Visibility.Collapsed;\n        StartTrackingButton.IsEnabled = false;\n        StopTrackingButton.IsEnabled = true;\n        break;\n\n    case GeolocationAccessStatus.Denied:\n        _rootPage.NotifyUser(\"Access to location is denied.\", NotifyType.ErrorMessage);\n        LocationDisabledMessage.Visibility = Visibility.Visible;\n        break;\n\n    case GeolocationAccessStatus.Unspecified:\n        _rootPage.NotifyUser(\"Unspecificed error!\", NotifyType.ErrorMessage);\n        LocationDisabledMessage.Visibility = Visibility.Collapsed;\n        break;\n}\n```\n\n### Step 2: Handle location updates\n\nThe [**Geolocator**](https://msdn.microsoft.com/library/windows/apps/br225534) object triggers the [**PositionChanged**](https://msdn.microsoft.com/library/windows/apps/br225540) event to indicate that the user's location changed or time has passed, depending on how you've configured it. That event passes the corresponding location via the argument's **Position** property (of type [**Geoposition**](https://msdn.microsoft.com/library/windows/apps/br225543)). In this example, the method is not called from the UI thread and the [**Dispatcher**](https://msdn.microsoft.com/library/windows/apps/br208211) object invokes the UI changes.\n\n```csharp\nusing Windows.UI.Core;\n...\nasync private void OnPositionChanged(Geolocator sender, PositionChangedEventArgs e)\n{\n    await Dispatcher.RunAsync(CoreDispatcherPriority.Normal, () =>\n    {\n        _rootPage.NotifyUser(\"Location updated.\", NotifyType.StatusMessage);\n        UpdateLocationData(e.Position);\n    });\n}\n```\n\n## Change the location privacy settings\n\n\nIf the location privacy settings don't allow your app to access the user's location, we recommend that you provide a convenient link to the **location privacy settings** in the **Settings** app. In this example, a Hyperlink control is used navigate to the `ms-settings:privacy-location` URI.\n\n```xaml\n<!--Set Visibility to Visible when access to location is denied -->  \n<TextBlock x:Name=\"LocationDisabledMessage\" FontStyle=\"Italic\" \n                 Visibility=\"Collapsed\" Margin=\"0,15,0,0\" TextWrapping=\"Wrap\" >\n          <Run Text=\"This app is not able to access Location. Go to \" />\n              <Hyperlink NavigateUri=\"ms-settings:privacy-location\">\n                  <Run Text=\"Settings\" />\n              </Hyperlink>\n          <Run Text=\" to check the location privacy settings.\"/>\n</TextBlock>\n```\n\nAlternatively, your app can call the [**LaunchUriAsync**](https://msdn.microsoft.com/library/windows/apps/hh701476) method to launch the **Settings** app from code. For more info, see [Launch the Windows Settings app](https://msdn.microsoft.com/library/windows/apps/mt228342).\n\n```csharp\nusing Windows.System;\n...\nbool result = await Launcher.LaunchUriAsync(new Uri(\"ms-settings:privacy-location\"));\n```\n\n## Troubleshoot your app\n\n\nBefore your app can access the user's location, **Location** must be enabled on the device. In the **Settings** app, check that the following **location privacy settings** are turned on:\n\n-   **Location for this device...** is turned **on** (not applicable in Windows 10 Mobile)\n-   The location services setting, **Location**, is turned **on**\n-   Under **Choose apps that can use your location**, your app is set to **on**\n\n## Related topics\n\n* [UWP geolocation sample](http://go.microsoft.com/fwlink/p/?linkid=533278)\n* [Design guidelines for geofencing](https://msdn.microsoft.com/library/windows/apps/dn631756)\n* [Design guidelines for location-aware apps](https://msdn.microsoft.com/library/windows/apps/hh465148)\n\n\n"
}