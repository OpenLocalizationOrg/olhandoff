{"nodes":[{"content":"description: Shows how to launch the compose email dialog to allow the user to send an email message.","pos":[4,105]},{"content":"You can pre-populate the fields of the email with data before showing the dialog.","pos":[106,187]},{"content":"The message will not be sent until the user taps the send button.","pos":[188,253]},{"content":"title: Send email ms.assetid: 74511E90-9438-430E-B2DE-24E196A111E5 keywords: 'contacts, email, send","pos":[254,353]},{"content":"Send email","pos":[361,371]},{"content":"\\[ Updated for UWP apps on Windows 10.","pos":[373,411]},{"content":"For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept> \\]","pos":[412,507]},{"content":"Shows how to launch the compose email dialog to allow the user to send an email message.","pos":[510,598]},{"content":"You can pre-populate the fields of the email with data before showing the dialog.","pos":[599,680]},{"content":"The message will not be sent until the user taps the send button.","pos":[681,746]},{"content":"In this article","pos":[750,765]},{"content":"Launch the compose email dialog","pos":[774,805]},{"content":"Summary and next steps","pos":[846,868]},{"content":"Related topics","pos":[900,914]},{"content":"Launch the compose email dialog","pos":[937,968]},{"content":"Create a new <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>EmailMessage<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/Dn631270)</ept> object and set the data that you want to be pre-populated in the compose email dialog.","pos":[970,1146]},{"content":"Call <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ShowComposeNewEmailAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/Dn631269)</ept> to show the dialog.","pos":[1147,1260]},{"content":"Summary and next steps","pos":[2253,2275]},{"content":"This topic has shown you how to launch the compose email dialog.","pos":[2277,2341]},{"content":"For information on selecting contacts to use as recipients for an email message, see <bpt id=\"p1\">[</bpt>Select contacts<ept id=\"p1\">](selecting-contacts.md)</ept>.","pos":[2342,2468]},{"content":"See <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>PickSingleFileAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/JJ635275)</ept> to select a file to use as an email attachment.","pos":[2469,2604]},{"content":"Related topics","pos":[2609,2623]},{"content":"Selecting contacts","pos":[2628,2646]},{"content":"How to continue your Windows Phone app after calling a file picker","pos":[2674,2740]}],"content":"---\ndescription: Shows how to launch the compose email dialog to allow the user to send an email message. You can pre-populate the fields of the email with data before showing the dialog. The message will not be sent until the user taps the send button.\ntitle: Send email\nms.assetid: 74511E90-9438-430E-B2DE-24E196A111E5\nkeywords: 'contacts, email, send\n---\n\n# Send email\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\n\nShows how to launch the compose email dialog to allow the user to send an email message. You can pre-populate the fields of the email with data before showing the dialog. The message will not be sent until the user taps the send button.\n\n**In this article**\n\n-   [Launch the compose email dialog](#launch-the-compose-email-dialog)\n-   [Summary and next steps](#summary-and-next-steps)\n-   [Related topics](#related-topics)\n\n## Launch the compose email dialog\n\nCreate a new [**EmailMessage**](https://msdn.microsoft.com/library/windows/apps/Dn631270) object and set the data that you want to be pre-populated in the compose email dialog. Call [**ShowComposeNewEmailAsync**](https://msdn.microsoft.com/library/windows/apps/Dn631269) to show the dialog.\n\n``` cs\nprivate async void ComposeEmail(Windows.ApplicationModel.Contacts.Contact recipient, \n    string messageBody, \n    StorageFile attachmentFile)\n{\n    var emailMessage = new Windows.ApplicationModel.Email.EmailMessage();\n    emailMessage.Body = messageBody;\n\n    if (attachmentFile != null)\n    {\n        var stream = Windows.Storage.Streams.RandomAccessStreamReference.CreateFromFile(attachmentFile);\n\n        var attachment = new Windows.ApplicationModel.Email.EmailAttachment(\n            attachmentFile.Name,\n            stream);\n\n        emailMessage.Attachments.Add(attachment);\n    }\n\n    var email = recipient.Emails.FirstOrDefault&lt;Windows.ApplicationModel.Contacts.ContactEmail&gt;();\n    if (email != null)\n    {\n        var emailRecipient = new Windows.ApplicationModel.Email.EmailRecipient(email.Address);\n        emailMessage.To.Add(emailRecipient);\n    }\n\n    await Windows.ApplicationModel.Email.EmailManager.ShowComposeNewEmailAsync(emailMessage);\n        \n}\n```\n\n## Summary and next steps\n\nThis topic has shown you how to launch the compose email dialog. For information on selecting contacts to use as recipients for an email message, see [Select contacts](selecting-contacts.md). See [**PickSingleFileAsync**](https://msdn.microsoft.com/library/windows/apps/JJ635275) to select a file to use as an email attachment.\n\n## Related topics\n\n* [Selecting contacts](selecting-contacts.md)\n* [How to continue your Windows Phone app after calling a file picker](https://msdn.microsoft.com/library/windows/apps/xaml/Dn614994)\n \n\n \n\n\n\n\n"}