{"nodes":[{"content":"Configuring the Local Configuration Manager","pos":[2,45]},{"content":"Applies To: Windows PowerShell 5.0","pos":[49,83]},{"content":"The Local Configuration Manager (LCM) is the engine of Windows PowerShell Desired State Configuration (DSC).","pos":[85,193]},{"content":"The LCM runs on every target node, and is responsible for parsing and enacting configurations that are sent to the node.","pos":[194,314]},{"content":"It is also responsible for a number of other aspects of DSC, including the following.","pos":[315,400]},{"content":"Determining refresh mode (push or pull).","pos":[404,444]},{"content":"Specifying how often a node pulls and enacts configurations.","pos":[447,507]},{"content":"Associating the node with pull servers.","pos":[510,549]},{"content":"Specifying partial configurations.","pos":[552,586]},{"content":"You use a special type of configuration to configure the LCM to specify each of these behaviors.","pos":[588,684]},{"content":"The following sections describe how to configure the LCM.","pos":[685,742]},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>: This topic applies to the LCM introduced in Windows PowerShell 5.0.","pos":[746,823]},{"content":"For information about configuring the LCM in Windows PowerShell 4.0, see Windows PowerShell 4.0 Desired State Configuration Local Configuration Manager.","pos":[824,976]},{"content":"Writing and enacting an LCM configuration","pos":[981,1022]},{"content":"To configure the LCM, you create and run a special type of configuration.","pos":[1024,1097]},{"content":"To specify an LCM configuration, you use the DscLocalConfigurationManager attribute.","pos":[1098,1182]},{"content":"The following shows a simple configuration that sets the LCM to push mode.","pos":[1183,1257]},{"content":"You call and run the configuration to create the configuration MOF, just as you would a normal configuration (for information on creating the configuration MOF, see Get Started with Windows PowerShell Desired State Configuration).","pos":[1441,1671]},{"content":"Unlike normal configurations, you do not enact an LCM configuration by calling the <bpt id=\"p1\">[</bpt>Start-DscConfiguration<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/dn521623.aspx)</ept> cmdlet.","pos":[1672,1846]},{"content":"Instead, you call the Set-DscLocalConfigurationManager cmdlet, supplying the path to the configuration MOF as a parameter.","pos":[1847,1969]},{"content":"After you enact the configuration, you can see the properties of the LCM by calling the <bpt id=\"p1\">[</bpt>Get-DscLocalConfigurationManager<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/dn407378.aspx)</ept> cmdlet.","pos":[1970,2159]},{"content":"An LCM configuration can contain blocks only for a limited set of resources.","pos":[2161,2237]},{"content":"In the previous example, the only resource called is <bpt id=\"p1\">**</bpt>Settings<ept id=\"p1\">**</ept>.","pos":[2238,2304]},{"content":"The other available resources are:","pos":[2305,2339]},{"pos":[2343,2424],"content":"<bpt id=\"p1\">**</bpt>ConfigurationRepositoryWeb<ept id=\"p1\">**</ept>: specifies an HTTP pull server for configurations."},{"pos":[2428,2510],"content":"<bpt id=\"p1\">**</bpt>ConfigurationRepositoryShare<ept id=\"p1\">**</ept>: specifies an SMB pull server for configurations."},{"pos":[2513,2582],"content":"<bpt id=\"p1\">**</bpt>ResourceRepositoryWeb<ept id=\"p1\">**</ept>: specifies an HTTP pull server for modules."},{"pos":[2585,2655],"content":"<bpt id=\"p1\">**</bpt>ResourceRepositoryShare<ept id=\"p1\">**</ept>: specifies an SMB pull server for modules."},{"pos":[2658,2735],"content":"<bpt id=\"p1\">**</bpt>ReportServerWeb<ept id=\"p1\">**</ept>: specifies an HTTP pull server to which reports are sent."},{"pos":[2738,2797],"content":"<bpt id=\"p1\">**</bpt>PartialConfiguration<ept id=\"p1\">**</ept>: specifies partial configurations."},{"content":"Basic settings","pos":[2802,2816]},{"content":"Other than specifying pull servers and partial configurations, all of the properties of the LCM are configured in a <bpt id=\"p1\">**</bpt>Settings<ept id=\"p1\">**</ept> block.","pos":[2818,2953]},{"content":"The following properties are available in a <bpt id=\"p1\">**</bpt>Settings<ept id=\"p1\">**</ept> block.","pos":[2954,3017]},{"content":"Property","pos":[3022,3030]},{"content":"Type","pos":[3035,3039]},{"content":"Description","pos":[3044,3055]},{"content":"ConfigurationModeFrequencyMins","pos":[3080,3110]},{"content":"UInt32","pos":[3112,3118]},{"content":"How often, in minutes, the current configuration is checked and applied.","pos":[3120,3192]},{"content":"This property is ignored if the ConfigurationMode property is set to ApplyOnly.","pos":[3193,3272]},{"content":"The default value is 15.","pos":[3273,3297]},{"content":"<bpt id=\"p1\">__</bpt>Note<ept id=\"p1\">__</ept>: Either the value of this property must be a multiple of the value of the <bpt id=\"p2\">__</bpt>RefreshFrequencyMins<ept id=\"p2\">__</ept> property, or the value of the <bpt id=\"p3\">__</bpt>RefreshFrequencyMins<ept id=\"p3\">__</ept> property must be a multiple of the value of this property.","pos":[3298,3519]},{"content":"RebootNodeIfNeeded","pos":[3524,3542]},{"content":"bool","pos":[3544,3548]},{"content":"Set this to <bpt id=\"p1\">__</bpt>$true<ept id=\"p1\">__</ept> to automatically reboot the node after a configuration that requires reboot is applied.","pos":[3550,3659]},{"content":"Otherwise, you will have to manually reboot the node for any configuration that requires it.","pos":[3660,3752]},{"content":"The default value is <bpt id=\"p1\">__</bpt>$false<ept id=\"p1\">__</ept>.","pos":[3753,3785]},{"content":"ConfigurationMode","pos":[3790,3807]},{"content":"string","pos":[3809,3815]},{"content":"Specifies how the LCM actually applies the configuration to the target nodes.","pos":[3818,3895]},{"content":"It can take the following values: <bpt id=\"p1\">__</bpt>\"ApplyOnly\"<ept id=\"p1\">__</ept>: DSC applies the configuration and does nothing further unless a new configuration is pushed to the target node or when a new configuration is pulled from a server.","pos":[3896,4110]},{"content":"After initial application of a new configuration, DSC does not check for drift from a previously configured state.","pos":[4111,4225]},{"content":"<bpt id=\"p1\">__</bpt>\"ApplyAndMonitor\"<ept id=\"p1\">__</ept>: This is the default value.","pos":[4226,4275]},{"content":"The LCM applies any new configurations.","pos":[4276,4315]},{"content":"After initial application of a new configuration, if the target node drifts from the desired state, DSC reports the discrepancy in logs <bpt id=\"p1\">__</bpt>\"ApplyAndAutoCorrect\"<ept id=\"p1\">__</ept>: DSC applies any new configurations.","pos":[4316,4514]},{"content":"After initial application of a new configuration, if the target node drifts from the desired state, DSC reports the discrepancy in logs, and then re-applies the current configuration.","pos":[4515,4698]},{"content":"ActionAfterReboot","pos":[4703,4720]},{"content":"string","pos":[4722,4728]},{"content":"Specifies what happens after a reboot during the application of a configuration.","pos":[4730,4810]},{"content":"The possible values are as follows: <bpt id=\"p1\">__</bpt>\"ContuinueConfiguration\"<ept id=\"p1\">__</ept>: Continue applying the current configuration.<bpt id=\"p2\">__</bpt>\"StopConfiguraiton\"<ept id=\"p2\">__</ept>: Stop the current configuration.","pos":[4811,4977]},{"content":"RefreshMode","pos":[4982,4993]},{"content":"string","pos":[4995,5001]},{"content":"Specifies how the LCM gets configurations.","pos":[5003,5045]},{"content":"The possible values are as follows: <bpt id=\"p1\">__</bpt>\"Disabled\"<ept id=\"p1\">__</ept>: DSC configurations are disabled for this node.","pos":[5046,5144]},{"content":"<bpt id=\"p1\">__</bpt>\"Push\"<ept id=\"p1\">__</ept>: Configurations are initiated by calling the Start-DscConfiguration cmdlet.","pos":[5145,5231]},{"content":"The configuration is applied immediately to the node.","pos":[5232,5285]},{"content":"This is the default value.","pos":[5286,5312]},{"content":"<bpt id=\"p1\">__</bpt>Pull:<ept id=\"p1\">__</ept> The node is configured to regularly check for configurations from a pull server.","pos":[5313,5403]},{"content":"If this property is set to Pull, you must specify a pull server in a <bpt id=\"p1\">__</bpt>ConfigurationRepositoryWeb<ept id=\"p1\">__</ept> or <bpt id=\"p2\">__</bpt>ConfigurationRepositoryShare<ept id=\"p2\">__</ept> block.","pos":[5404,5546]},{"content":"For more information about pull servers, see <bpt id=\"p1\">[</bpt>Setting up a DSC pull server<ept id=\"p1\">](pullServer.md)</ept>.","pos":[5547,5638]},{"content":"CertificateID","pos":[5643,5656]},{"content":"string","pos":[5658,5664]},{"content":"A GUID that specifies a certificate used to secure credentials for access to the configuration.","pos":[5666,5761]},{"content":"For more information see <bpt id=\"p1\">[</bpt>Want to secure credentials in Windows PowerShell Desired State Configuration<ept id=\"p1\">](http://blogs.msdn.com/b/powershell/archive/2014/01/31/want-to-secure-credentials-in-windows-powershell-desired-state-configuration.aspx)</ept>?.","pos":[5762,6004]},{"content":"ConfigurationID","pos":[6009,6024]},{"content":"string","pos":[6026,6032]},{"content":"A GUID that identifies the configuration file to get from a pull server in pull mode.","pos":[6034,6119]},{"content":"The node will pull configurations on the pull sever if the name of the configuration MOF is named ConfigurationID.mof.","pos":[6120,6238]},{"content":"<bpt id=\"p1\">__</bpt>Note:<ept id=\"p1\">__</ept> If you set this property, registering the node with a pull server by using <bpt id=\"p2\">__</bpt>RegistryKeys<ept id=\"p2\">__</ept> and does not work.","pos":[6239,6359]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Setting up a pull client with configuration names<ept id=\"p1\">](pullClientConfigNames.md)</ept>.","pos":[6360,6464]},{"content":"RefreshFrequencyMins","pos":[6469,6489]},{"content":"Uint32","pos":[6491,6497]},{"content":"The time interval, in minutes, at which the LCM checks a pull server to get updated configurations.","pos":[6499,6598]},{"content":"This value is ignored if the LCM is not configured in pull mode.","pos":[6599,6663]},{"content":"The default value is 30.","pos":[6664,6688]},{"content":"<bpt id=\"p1\">__</bpt>Note:<ept id=\"p1\">__</ept>  Either the value of this property must be a multiple of the value of the <bpt id=\"p2\">__</bpt>ConfigurationModeFrequencyMins<ept id=\"p2\">__</ept> property, or the value of the <bpt id=\"p3\">__</bpt>ConfigurationModeFrequencyMins<ept id=\"p3\">__</ept> property must be a multiple of the value of this property.","pos":[6689,6931]},{"content":"AllowModlueOverwrite","pos":[6936,6956]},{"content":"bool","pos":[6958,6962]},{"content":"<bpt id=\"p1\">__</bpt>$TRUE<ept id=\"p1\">__</ept> if new configurations downloaded from the configuration server are allowed to overwrite the old ones on the target node.","pos":[6964,7094]},{"content":"Otherwise, $FALSE.","pos":[7095,7113]},{"content":"DebugMode","pos":[7118,7127]},{"content":"bool","pos":[7129,7133]},{"content":"If set to <bpt id=\"p1\">__</bpt>$TRUE<ept id=\"p1\">__</ept>, this causes the LCM to reload any DSC resources, even if they have been previously cached.","pos":[7135,7246]},{"content":"Set to $FALSE to use cached resources.","pos":[7247,7285]},{"content":"Typically you would set this property to <bpt id=\"p1\">__</bpt>$TRUE<ept id=\"p1\">__</ept> while debugging a resource, and to <bpt id=\"p2\">__</bpt>$FALSE<ept id=\"p2\">__</ept> for production.","pos":[7286,7398]},{"content":"The default value is <bpt id=\"p1\">__</bpt>$FALSE<ept id=\"p1\">__</ept>.","pos":[7399,7431]},{"content":"ConfigurationDownloadManagers","pos":[7436,7465]},{"content":"CimInstance[]","pos":[7467,7480]},{"content":"Obsolete.","pos":[7482,7491]},{"content":"Use <bpt id=\"p1\">__</bpt>ConfigurationRepositoryWeb<ept id=\"p1\">__</ept> and <bpt id=\"p2\">__</bpt>ConfigurationRepositoryShare<ept id=\"p2\">__</ept> blocks to define configuration pull servers.","pos":[7492,7608]},{"content":"ResourceModuleManagers","pos":[7613,7635]},{"content":"CimInstance[]","pos":[7637,7650]},{"content":"Obsolete.","pos":[7652,7661]},{"content":"Use <bpt id=\"p1\">__</bpt>ResourceRepositoryWeb<ept id=\"p1\">__</ept> and <bpt id=\"p2\">__</bpt>ResourceRepositoryShare<ept id=\"p2\">__</ept> blocks to define resource pull servers.","pos":[7662,7763]},{"content":"ReportManagers","pos":[7768,7782]},{"content":"CimInstance[]","pos":[7784,7797]},{"content":"Obsolete.","pos":[7799,7808]},{"content":"Use <bpt id=\"p1\">__</bpt>ReportServerWeb<ept id=\"p1\">__</ept> blocks to define report pull servers.","pos":[7809,7870]},{"content":"PartialConfigurations","pos":[7875,7896]},{"content":"CimInstance","pos":[7898,7909]},{"content":"Not implemented.","pos":[7911,7927]},{"content":"Do not use.","pos":[7928,7939]},{"content":"StatusRetentionTimeInDays","pos":[7944,7969]},{"content":"UInt32","pos":[7972,7978]},{"content":"The number of days the LCM keeps the status of the current configuration.","pos":[7980,8053]},{"content":"Pull servers","pos":[8060,8072]},{"content":"A pull server is either an OData web service or an SMB share that is used as a central location for DSC files.","pos":[8074,8184]},{"content":"LCM configuration supports defining the following types of pull servers:","pos":[8185,8257]},{"content":"<bpt id=\"p1\">**</bpt>Configuration server<ept id=\"p1\">**</ept>: A repository for DSC configurations.","pos":[8261,8323]},{"content":"Define configuration severs by using <bpt id=\"p1\">**</bpt>ConfigurationRepositoryWeb<ept id=\"p1\">**</ept> (for web-based servers) and <bpt id=\"p2\">**</bpt>ConfigurationRepositoryShare<ept id=\"p2\">**</ept> (for SMB-based servers) blocks.","pos":[8324,8484]},{"content":"Resource server—A repository for DSC resources, packaged as PowerShell modules.","pos":[8487,8566]},{"content":"Define resource severs by using <bpt id=\"p1\">**</bpt>ResourceRepositoryWeb<ept id=\"p1\">**</ept> (for web-based servers) and <bpt id=\"p2\">**</bpt>ResourceRepositoryShare<ept id=\"p2\">**</ept> (for SMB-based servers) blocks.","pos":[8567,8712]},{"content":"Report server—A service that DSC sends report data to.","pos":[8715,8769]},{"content":"Define report servers by using <bpt id=\"p1\">**</bpt>ReportServerWeb<ept id=\"p1\">**</ept> blocks.","pos":[8770,8828]},{"content":"A report server must be a web service.","pos":[8829,8867]},{"pos":[8869,8976],"content":"For information about setting up and using pull servers, see <bpt id=\"p1\">[</bpt>Setting up a DSC pull server<ept id=\"p1\">](pullServer.md)</ept>."},{"content":"Configuration server blocks","pos":[8981,9008]},{"content":"To define a web-based configuration sever, you create a <bpt id=\"p1\">**</bpt>ConfigurationRepositoryWeb<ept id=\"p1\">**</ept> block.","pos":[9010,9103]},{"content":"A <bpt id=\"p1\">**</bpt>ConfigurationRepositoryWeb<ept id=\"p1\">**</ept> defines the following properties.","pos":[9104,9170]},{"content":"Property","pos":[9173,9181]},{"content":"Type","pos":[9182,9186]},{"content":"Description","pos":[9187,9198]},{"content":"AllowUnsecureConnection","pos":[9216,9239]},{"content":"bool","pos":[9240,9244]},{"content":"Set to <bpt id=\"p1\">**</bpt>$TRUE<ept id=\"p1\">**</ept> to allow connections from the node to the server without authentication.","pos":[9245,9334]},{"content":"Set to <bpt id=\"p1\">**</bpt>$FALSE<ept id=\"p1\">**</ept> to require authentication.","pos":[9335,9379]},{"content":"CertificateID","pos":[9382,9395]},{"content":"string","pos":[9396,9402]},{"content":"A GUID that represents the certificate used to authenticate to the server.","pos":[9403,9477]},{"content":"ConfigurationNames","pos":[9480,9498]},{"content":"String[]","pos":[9499,9507]},{"content":"An array of names of configurations to be pulled by the target node.","pos":[9508,9576]},{"content":"These are used only if the node is registered with the pull server by using a <bpt id=\"p1\">**</bpt>RegistrationKey<ept id=\"p1\">**</ept>.","pos":[9577,9675]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Setting up a pull client with configuration names<ept id=\"p1\">](pullClientConfigNames.md)</ept>.","pos":[9676,9780]},{"content":"RegistrationKey","pos":[9783,9798]},{"content":"string","pos":[9799,9805]},{"content":"A GUID that registers the node with the pull server.","pos":[9806,9858]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Setting up a pull client with configuration names<ept id=\"p1\">](pullClientConfigNames.md)</ept>.","pos":[9859,9963]},{"content":"ServerURL","pos":[9966,9975]},{"content":"string","pos":[9976,9982]},{"content":"The URL of the configuration server.","pos":[9983,10019]},{"content":"To define an SMB-based configuration server, you create a <bpt id=\"p1\">**</bpt>ConfigurationRepositoryShare<ept id=\"p1\">**</ept> block.","pos":[10022,10119]},{"content":"A <bpt id=\"p1\">**</bpt>ConfigurationRepositoryShare<ept id=\"p1\">**</ept> defines the following properties.","pos":[10120,10188]},{"content":"Property","pos":[10191,10199]},{"content":"Type","pos":[10200,10204]},{"content":"Description","pos":[10205,10216]},{"content":"Credential","pos":[10233,10243]},{"content":"MSFT_Credential","pos":[10244,10259]},{"content":"The credential used to authenticate to the SMB share.","pos":[10260,10313]},{"content":"SourcePath","pos":[10316,10326]},{"content":"string","pos":[10327,10333]},{"content":"The path of the SMB share.","pos":[10334,10360]},{"content":"Resource server blocks","pos":[10366,10388]},{"content":"To define a web-based resource sever, you create a <bpt id=\"p1\">**</bpt>ResourceRepositoryWeb<ept id=\"p1\">**</ept> block.","pos":[10390,10473]},{"content":"A <bpt id=\"p1\">**</bpt>ResourceRepositoryWeb<ept id=\"p1\">**</ept> defines the following properties.","pos":[10474,10535]},{"content":"Property","pos":[10538,10546]},{"content":"Type","pos":[10547,10551]},{"content":"Description","pos":[10552,10563]},{"content":"AllowUnsecureConnection","pos":[10580,10603]},{"content":"bool","pos":[10604,10608]},{"content":"Set to <bpt id=\"p1\">**</bpt>$TRUE<ept id=\"p1\">**</ept> to allow connections from the node to the server without authentication.","pos":[10609,10698]},{"content":"Set to <bpt id=\"p1\">**</bpt>$FALSE<ept id=\"p1\">**</ept> to require authentication.","pos":[10699,10743]},{"content":"CertificateID","pos":[10746,10759]},{"content":"string","pos":[10760,10766]},{"content":"A GUID that represents the certificate used to authenticate to the server.","pos":[10767,10841]},{"content":"RegistrationKey","pos":[10844,10859]},{"content":"string","pos":[10860,10866]},{"content":"A GUID that identifies the node to the pull server.","pos":[10867,10918]},{"content":"For more information, see How to register a node with a DSC pull server.","pos":[10919,10991]},{"content":"ServerURL","pos":[10994,11003]},{"content":"string","pos":[11004,11010]},{"content":"The URL of the configuration server.","pos":[11011,11047]},{"content":"To define an SMB-based resource server, you create a <bpt id=\"p1\">**</bpt>ResourceRepositoryShare<ept id=\"p1\">**</ept> block.","pos":[11051,11138]},{"content":"<bpt id=\"p1\">**</bpt>ResourceRepositoryShare<ept id=\"p1\">**</ept> defines the following properties.","pos":[11139,11200]},{"content":"Property","pos":[11203,11211]},{"content":"Type","pos":[11212,11216]},{"content":"Description","pos":[11217,11228]},{"content":"Credential","pos":[11245,11255]},{"content":"MSFT_Credential","pos":[11256,11271]},{"content":"The credential used to authenticate to the SMB share.","pos":[11272,11325]},{"content":"SourcePath","pos":[11328,11338]},{"content":"string","pos":[11339,11345]},{"content":"The path of the SMB share.","pos":[11346,11372]},{"content":"Report server blocks","pos":[11378,11398]},{"content":"A report server must be an OData web service.","pos":[11400,11445]},{"content":"To define a report server, you create a <bpt id=\"p1\">**</bpt>ReportServerWeb<ept id=\"p1\">**</ept> block.","pos":[11446,11512]},{"content":"<bpt id=\"p1\">**</bpt>ReportServerWeb<ept id=\"p1\">**</ept> defines the following properties.","pos":[11513,11566]},{"content":"Property","pos":[11569,11577]},{"content":"Type","pos":[11578,11582]},{"content":"Description","pos":[11583,11594]},{"content":"AllowUnsecureConnection","pos":[11612,11635]},{"content":"bool","pos":[11636,11640]},{"content":"Set to <bpt id=\"p1\">**</bpt>$TRUE<ept id=\"p1\">**</ept> to allow connections from the node to the server without authentication.","pos":[11641,11730]},{"content":"Set to <bpt id=\"p1\">**</bpt>$FALSE<ept id=\"p1\">**</ept> to require authentication.","pos":[11731,11775]},{"content":"CertificateID","pos":[11778,11791]},{"content":"string","pos":[11792,11798]},{"content":"A GUID that represents the certificate used to authenticate to the server.","pos":[11799,11873]},{"content":"RegistrationKey","pos":[11876,11891]},{"content":"string","pos":[11892,11898]},{"content":"A GUID that identifies the node to the pull server.","pos":[11899,11950]},{"content":"For more information, see How to register a node with a DSC pull server.","pos":[11951,12023]},{"content":"ServerURL","pos":[12026,12035]},{"content":"string","pos":[12036,12042]},{"content":"The URL of the configuration server.","pos":[12043,12079]},{"content":"Partial configurations","pos":[12085,12107]},{"content":"To define a partial configuration, you create a <bpt id=\"p1\">**</bpt>PartialConfiguration<ept id=\"p1\">**</ept> block.","pos":[12109,12188]},{"content":"For more information about partial configurations, see <bpt id=\"p1\">[</bpt>DSC Partial configurations<ept id=\"p1\">](partialConfigs.md)</ept>.","pos":[12189,12292]},{"content":"<bpt id=\"p1\">**</bpt>PartialConfiguration<ept id=\"p1\">**</ept> defines the following properties.","pos":[12293,12351]},{"content":"Property","pos":[12354,12362]},{"content":"Type","pos":[12363,12367]},{"content":"Description","pos":[12368,12379]},{"content":"ConfigurationSource","pos":[12397,12416]},{"content":"string[]","pos":[12417,12425]},{"pos":[12426,12615],"content":"An array of names of configuration servers, previously defined in <bpt id=\"p1\">**</bpt>ConfiguratoinRepositoryWeb<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>ConfigurationRepositoryShare<ept id=\"p2\">**</ept> blocks, where the partial configuration is pulled from."},{"content":"DependsOn","pos":[12618,12627]},{"content":"string{}","pos":[12628,12636]},{"content":"A list of names of other configurations that must be completed before this partial configuration is applied.","pos":[12637,12745]},{"content":"Description","pos":[12748,12759]},{"content":"string","pos":[12760,12766]},{"content":"Text used to describe the partial configuration.","pos":[12767,12815]},{"content":"ExclusiveResources","pos":[12818,12836]},{"content":"string[]","pos":[12837,12845]},{"content":"An array of resources exclusive to this partial configuration.","pos":[12846,12908]},{"content":"RefreshMode","pos":[12911,12922]},{"content":"string","pos":[12923,12929]},{"content":"Specifies how DCS gets this partial configuration..","pos":[12930,12981]},{"content":"The possible values are as follows: <bpt id=\"p1\">**</bpt>Disabled<ept id=\"p1\">**</ept>: This partial configuration is disabled.","pos":[12982,13071]},{"content":"<bpt id=\"p1\">**</bpt>Push<ept id=\"p1\">**</ept>: The partial configuration is pushed to the node by calling the <bpt id=\"p2\">[</bpt>Publish-DscConfiguration<ept id=\"p2\">](https://technet.microsoft.com/en-us/library/mt517875.aspx)</ept> cmdlet.","pos":[13072,13238]},{"content":"After all partial configurations for the node are either pushed or pulled from a server, the configuration can be started by calling <ph id=\"ph1\">`Start-DscConfiguration –UseExisting`</ph>.","pos":[13239,13410]},{"content":"This is the default value.","pos":[13411,13437]},{"content":"<bpt id=\"p1\">**</bpt>Pull<ept id=\"p1\">**</ept>: The node is configured to regularly check for the partial configuration from a pull server.","pos":[13438,13539]},{"content":"If this property is set to \"Pull\", you must specify a pull server by setting the <bpt id=\"p1\">**</bpt>ConfigurationSource<ept id=\"p1\">**</ept> property.","pos":[13540,13654]},{"content":"For more information about pull servers, see <bpt id=\"p1\">[</bpt>Setting up a DSC pull server<ept id=\"p1\">](pullServer.md)</ept>.","pos":[13655,13746]},{"content":"ResourceModlueSource","pos":[13749,13769]},{"content":"string[]","pos":[13770,13778]},{"content":"An array of the names of resource servers from which to download required resources for this partial configuration.","pos":[13779,13894]},{"content":"These names must refer to resource servers previously defined in <bpt id=\"p1\">**</bpt>ResourceRepositoryWeb<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>ResourceRepositoryShare<ept id=\"p2\">**</ept> blocks.","pos":[13895,14025]},{"content":"See Also","pos":[14031,14039]},{"content":"Concepts","pos":[14046,14054]},{"pos":[14055,14263],"content":"Get Started with Windows PowerShell Desired State Configuration <bpt id=\"p1\">[</bpt>Setting up a DSC pull server<ept id=\"p1\">](pullServer.md)</ept><ph id=\"ph1\"> \n</ph><bpt id=\"p2\">[</bpt>Windows PowerShell 4.0 Desired State Configuration Local Configuration Manager<ept id=\"p2\">](metaConfig4.md)</ept>"},{"content":"Other Resources","pos":[14270,14285]},{"pos":[14286,14458],"content":"<bpt id=\"p1\">[</bpt>Set-DscLocalConfigurationManager<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/dn521621.aspx)</ept><ph id=\"ph1\"> \n</ph><bpt id=\"p2\">[</bpt>Setting up a pull client with configuration names<ept id=\"p2\">](pullClientConfigNames.md)</ept>"}],"content":"# Configuring the Local Configuration Manager\n\n> Applies To: Windows PowerShell 5.0\n\nThe Local Configuration Manager (LCM) is the engine of Windows PowerShell Desired State Configuration (DSC). The LCM runs on every target node, and is responsible for parsing and enacting configurations that are sent to the node. It is also responsible for a number of other aspects of DSC, including the following.\n\n* Determining refresh mode (push or pull).\n* Specifying how often a node pulls and enacts configurations.\n* Associating the node with pull servers.\n* Specifying partial configurations.\n\nYou use a special type of configuration to configure the LCM to specify each of these behaviors. The following sections describe how to configure the LCM.\n\n> **Note**: This topic applies to the LCM introduced in Windows PowerShell 5.0. For information about configuring the LCM in Windows PowerShell 4.0, see Windows PowerShell 4.0 Desired State Configuration Local Configuration Manager.\n\n## Writing and enacting an LCM configuration\n\nTo configure the LCM, you create and run a special type of configuration. To specify an LCM configuration, you use the DscLocalConfigurationManager attribute. The following shows a simple configuration that sets the LCM to push mode.\n\n```powershell\n[DSCLocalConfigurationManager()]\nconfiguration LCMConfig\n{\n    Node localhost\n    {\n        Settings\n        {\n            RefreshMode = 'Push'\n        }\n    }\n} \n```\n\nYou call and run the configuration to create the configuration MOF, just as you would a normal configuration (for information on creating the configuration MOF, see Get Started with Windows PowerShell Desired State Configuration). Unlike normal configurations, you do not enact an LCM configuration by calling the [Start-DscConfiguration](https://technet.microsoft.com/en-us/library/dn521623.aspx) cmdlet. Instead, you call the Set-DscLocalConfigurationManager cmdlet, supplying the path to the configuration MOF as a parameter. After you enact the configuration, you can see the properties of the LCM by calling the [Get-DscLocalConfigurationManager](https://technet.microsoft.com/en-us/library/dn407378.aspx) cmdlet.\n\nAn LCM configuration can contain blocks only for a limited set of resources. In the previous example, the only resource called is **Settings**. The other available resources are:\n\n* **ConfigurationRepositoryWeb**: specifies an HTTP pull server for configurations. \n* **ConfigurationRepositoryShare**: specifies an SMB pull server for configurations.\n* **ResourceRepositoryWeb**: specifies an HTTP pull server for modules.\n* **ResourceRepositoryShare**: specifies an SMB pull server for modules.\n* **ReportServerWeb**: specifies an HTTP pull server to which reports are sent.\n* **PartialConfiguration**: specifies partial configurations.\n\n## Basic settings\n\nOther than specifying pull servers and partial configurations, all of the properties of the LCM are configured in a **Settings** block. The following properties are available in a **Settings** block.\n\n|  Property  |  Type  |  Description   | \n|--- |--- |---| \n| ConfigurationModeFrequencyMins| UInt32| How often, in minutes, the current configuration is checked and applied. This property is ignored if the ConfigurationMode property is set to ApplyOnly. The default value is 15. __Note__: Either the value of this property must be a multiple of the value of the __RefreshFrequencyMins__ property, or the value of the __RefreshFrequencyMins__ property must be a multiple of the value of this property.| \n| RebootNodeIfNeeded| bool| Set this to __$true__ to automatically reboot the node after a configuration that requires reboot is applied. Otherwise, you will have to manually reboot the node for any configuration that requires it. The default value is __$false__.| \n| ConfigurationMode| string | Specifies how the LCM actually applies the configuration to the target nodes. It can take the following values: __\"ApplyOnly\"__: DSC applies the configuration and does nothing further unless a new configuration is pushed to the target node or when a new configuration is pulled from a server. After initial application of a new configuration, DSC does not check for drift from a previously configured state. __\"ApplyAndMonitor\"__: This is the default value. The LCM applies any new configurations. After initial application of a new configuration, if the target node drifts from the desired state, DSC reports the discrepancy in logs __\"ApplyAndAutoCorrect\"__: DSC applies any new configurations. After initial application of a new configuration, if the target node drifts from the desired state, DSC reports the discrepancy in logs, and then re-applies the current configuration.| \n| ActionAfterReboot| string| Specifies what happens after a reboot during the application of a configuration. The possible values are as follows: __\"ContuinueConfiguration\"__: Continue applying the current configuration.__\"StopConfiguraiton\"__: Stop the current configuration.| \n| RefreshMode| string| Specifies how the LCM gets configurations. The possible values are as follows: __\"Disabled\"__: DSC configurations are disabled for this node. __\"Push\"__: Configurations are initiated by calling the Start-DscConfiguration cmdlet. The configuration is applied immediately to the node. This is the default value. __Pull:__ The node is configured to regularly check for configurations from a pull server. If this property is set to Pull, you must specify a pull server in a __ConfigurationRepositoryWeb__ or __ConfigurationRepositoryShare__ block. For more information about pull servers, see [Setting up a DSC pull server](pullServer.md).| \n| CertificateID| string| A GUID that specifies a certificate used to secure credentials for access to the configuration. For more information see [Want to secure credentials in Windows PowerShell Desired State Configuration](http://blogs.msdn.com/b/powershell/archive/2014/01/31/want-to-secure-credentials-in-windows-powershell-desired-state-configuration.aspx)?.| \n| ConfigurationID| string| A GUID that identifies the configuration file to get from a pull server in pull mode. The node will pull configurations on the pull sever if the name of the configuration MOF is named ConfigurationID.mof. __Note:__ If you set this property, registering the node with a pull server by using __RegistryKeys__ and does not work. For more information, see [Setting up a pull client with configuration names](pullClientConfigNames.md).| \n| RefreshFrequencyMins| Uint32| The time interval, in minutes, at which the LCM checks a pull server to get updated configurations. This value is ignored if the LCM is not configured in pull mode. The default value is 30. __Note:__  Either the value of this property must be a multiple of the value of the __ConfigurationModeFrequencyMins__ property, or the value of the __ConfigurationModeFrequencyMins__ property must be a multiple of the value of this property.| \n| AllowModlueOverwrite| bool| __$TRUE__ if new configurations downloaded from the configuration server are allowed to overwrite the old ones on the target node. Otherwise, $FALSE.| \n| DebugMode| bool| If set to __$TRUE__, this causes the LCM to reload any DSC resources, even if they have been previously cached. Set to $FALSE to use cached resources. Typically you would set this property to __$TRUE__ while debugging a resource, and to __$FALSE__ for production. The default value is __$FALSE__.| \n| ConfigurationDownloadManagers| CimInstance[]| Obsolete. Use __ConfigurationRepositoryWeb__ and __ConfigurationRepositoryShare__ blocks to define configuration pull servers.| \n| ResourceModuleManagers| CimInstance[]| Obsolete. Use __ResourceRepositoryWeb__ and __ResourceRepositoryShare__ blocks to define resource pull servers.| \n| ReportManagers| CimInstance[]| Obsolete. Use __ReportServerWeb__ blocks to define report pull servers.| \n| PartialConfigurations| CimInstance| Not implemented. Do not use.| \n| StatusRetentionTimeInDays | UInt32| The number of days the LCM keeps the status of the current configuration.| \n\n## Pull servers\n\nA pull server is either an OData web service or an SMB share that is used as a central location for DSC files. LCM configuration supports defining the following types of pull servers:\n\n* **Configuration server**: A repository for DSC configurations. Define configuration severs by using **ConfigurationRepositoryWeb** (for web-based servers) and **ConfigurationRepositoryShare** (for SMB-based servers) blocks.\n* Resource server—A repository for DSC resources, packaged as PowerShell modules. Define resource severs by using **ResourceRepositoryWeb** (for web-based servers) and **ResourceRepositoryShare** (for SMB-based servers) blocks.\n* Report server—A service that DSC sends report data to. Define report servers by using **ReportServerWeb** blocks. A report server must be a web service.\n\nFor information about setting up and using pull servers, see [Setting up a DSC pull server](pullServer.md).\n\n## Configuration server blocks\n\nTo define a web-based configuration sever, you create a **ConfigurationRepositoryWeb** block. A **ConfigurationRepositoryWeb** defines the following properties.\n\n|Property|Type|Description|\n|---|---|---| \n|AllowUnsecureConnection|bool|Set to **$TRUE** to allow connections from the node to the server without authentication. Set to **$FALSE** to require authentication.|\n|CertificateID|string|A GUID that represents the certificate used to authenticate to the server.|\n|ConfigurationNames|String[]|An array of names of configurations to be pulled by the target node. These are used only if the node is registered with the pull server by using a **RegistrationKey**. For more information, see [Setting up a pull client with configuration names](pullClientConfigNames.md).|\n|RegistrationKey|string|A GUID that registers the node with the pull server. For more information, see [Setting up a pull client with configuration names](pullClientConfigNames.md).|\n|ServerURL|string|The URL of the configuration server.|\n\nTo define an SMB-based configuration server, you create a **ConfigurationRepositoryShare** block. A **ConfigurationRepositoryShare** defines the following properties.\n\n|Property|Type|Description|\n|---|---|---|\n|Credential|MSFT_Credential|The credential used to authenticate to the SMB share.|\n|SourcePath|string|The path of the SMB share.|\n\n## Resource server blocks\n\nTo define a web-based resource sever, you create a **ResourceRepositoryWeb** block. A **ResourceRepositoryWeb** defines the following properties.\n\n|Property|Type|Description|\n|---|---|---|\n|AllowUnsecureConnection|bool|Set to **$TRUE** to allow connections from the node to the server without authentication. Set to **$FALSE** to require authentication.|\n|CertificateID|string|A GUID that represents the certificate used to authenticate to the server.|\n|RegistrationKey|string|A GUID that identifies the node to the pull server. For more information, see How to register a node with a DSC pull server.|\n|ServerURL|string|The URL of the configuration server.|\n \nTo define an SMB-based resource server, you create a **ResourceRepositoryShare** block. **ResourceRepositoryShare** defines the following properties.\n\n|Property|Type|Description|\n|---|---|---|\n|Credential|MSFT_Credential|The credential used to authenticate to the SMB share.|\n|SourcePath|string|The path of the SMB share.|\n\n## Report server blocks\n\nA report server must be an OData web service. To define a report server, you create a **ReportServerWeb** block. **ReportServerWeb** defines the following properties.\n\n|Property|Type|Description|\n|---|---|---| \n|AllowUnsecureConnection|bool|Set to **$TRUE** to allow connections from the node to the server without authentication. Set to **$FALSE** to require authentication.|\n|CertificateID|string|A GUID that represents the certificate used to authenticate to the server.|\n|RegistrationKey|string|A GUID that identifies the node to the pull server. For more information, see How to register a node with a DSC pull server.|\n|ServerURL|string|The URL of the configuration server.|\n\n## Partial configurations\n\nTo define a partial configuration, you create a **PartialConfiguration** block. For more information about partial configurations, see [DSC Partial configurations](partialConfigs.md). **PartialConfiguration** defines the following properties.\n\n|Property|Type|Description|\n|---|---|---| \n|ConfigurationSource|string[]|An array of names of configuration servers, previously defined in **ConfiguratoinRepositoryWeb** and **ConfigurationRepositoryShare** blocks, where the partial configuration is pulled from.|\n|DependsOn|string{}|A list of names of other configurations that must be completed before this partial configuration is applied.|\n|Description|string|Text used to describe the partial configuration.|\n|ExclusiveResources|string[]|An array of resources exclusive to this partial configuration.|\n|RefreshMode|string|Specifies how DCS gets this partial configuration.. The possible values are as follows: **Disabled**: This partial configuration is disabled. **Push**: The partial configuration is pushed to the node by calling the [Publish-DscConfiguration](https://technet.microsoft.com/en-us/library/mt517875.aspx) cmdlet. After all partial configurations for the node are either pushed or pulled from a server, the configuration can be started by calling `Start-DscConfiguration –UseExisting`. This is the default value. **Pull**: The node is configured to regularly check for the partial configuration from a pull server. If this property is set to \"Pull\", you must specify a pull server by setting the **ConfigurationSource** property. For more information about pull servers, see [Setting up a DSC pull server](pullServer.md).|\n|ResourceModlueSource|string[]|An array of the names of resource servers from which to download required resources for this partial configuration. These names must refer to resource servers previously defined in **ResourceRepositoryWeb** and **ResourceRepositoryShare** blocks.|\n\n## See Also \n\n### Concepts\nGet Started with Windows PowerShell Desired State Configuration \n[Setting up a DSC pull server](pullServer.md) \n[Windows PowerShell 4.0 Desired State Configuration Local Configuration Manager](metaConfig4.md) \n\n### Other Resources\n[Set-DscLocalConfigurationManager](https://technet.microsoft.com/en-us/library/dn521621.aspx) \n[Setting up a pull client with configuration names](pullClientConfigNames.md) \n"}