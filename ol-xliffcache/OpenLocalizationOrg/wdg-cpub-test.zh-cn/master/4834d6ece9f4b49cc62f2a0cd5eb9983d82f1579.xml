{
  "nodes": [
    {
      "content": "ms.assetid: AE98C22B-A071-4206-ABBB-C0F0FB7EF33C",
      "pos": [
        4,
        52
      ]
    },
    {
      "content": "description: This article describes how to add playback of adaptive streaming multimedia content to a Universal Windows Platform (UWP) apps.",
      "pos": [
        53,
        193
      ]
    },
    {
      "content": "This feature currently supports playback of Http Live Streaming (HLS) and Dynamic Streaming over HTTP (DASH) content.",
      "pos": [
        194,
        311
      ]
    },
    {
      "content": "title: Adaptive Streaming",
      "pos": [
        312,
        337
      ]
    },
    {
      "content": "Adaptive Streaming",
      "pos": [
        345,
        363
      ]
    },
    {
      "content": "\\[ Updated for UWP apps on Windows 10.",
      "pos": [
        365,
        403
      ]
    },
    {
      "content": "For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept> \\]",
      "pos": [
        404,
        499
      ]
    },
    {
      "content": "This article describes how to add playback of adaptive streaming multimedia content to a Universal Windows Platform (UWP) apps.",
      "pos": [
        501,
        628
      ]
    },
    {
      "content": "This feature currently supports playback of Http Live Streaming (HLS) and Dynamic Streaming over HTTP (DASH) content.",
      "pos": [
        629,
        746
      ]
    },
    {
      "content": "Simple adaptive streaming with MediaElement",
      "pos": [
        751,
        794
      ]
    },
    {
      "pos": [
        796,
        962
      ],
      "content": "To display adaptive streaming multimedia in a XAML-based app, add a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>MediaElement<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br242926)</ept> control to your page."
    },
    {
      "pos": [
        964,
        1066
      ],
      "content": "[!code-xml<bpt id=\"p1\">[</bpt>MediaElementXAML<ept id=\"p1\">](./code/AdaptiveStreaming_Win10/cs/MainPage.xaml#SnippetMediaElementXAML)</ept>]"
    },
    {
      "pos": [
        1068,
        1222
      ],
      "content": "Set the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Source<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br227420)</ept> property of the <bpt id=\"p3\">**</bpt>MediaElement<ept id=\"p3\">**</ept> to the URI of a DASH or HLS manifest file."
    },
    {
      "pos": [
        1224,
        1324
      ],
      "content": "[!code-cs<bpt id=\"p1\">[</bpt>ManifestSource<ept id=\"p1\">](./code/AdaptiveStreaming_Win10/cs/MainPage.xaml.cs#SnippetManifestSource)</ept>]"
    },
    {
      "content": "Adaptive streaming with AdaptiveMediaSource",
      "pos": [
        1329,
        1372
      ]
    },
    {
      "pos": [
        1374,
        1728
      ],
      "content": "If your app requires more advanced adaptive streaming features, such as providing custom HTTP headers, monitoring the current download and playback bitrates, or adjusting the ratios that determine when the system switches bitrates of the adaptive stream, use the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>AdaptiveMediaSource<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn946912)</ept> object."
    },
    {
      "pos": [
        1730,
        1882
      ],
      "content": "The adaptive streaming APIs are found in the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Windows.Media.Streaming.Adaptive<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn931279)</ept> namespace."
    },
    {
      "pos": [
        1884,
        2000
      ],
      "content": "[!code-cs<bpt id=\"p1\">[</bpt>AdaptiveStreamingUsing<ept id=\"p1\">](./code/AdaptiveStreaming_Win10/cs/MainPage.xaml.cs#SnippetAdaptiveStreamingUsing)</ept>]"
    },
    {
      "content": "Initialize the <bpt id=\"p1\">**</bpt>AdaptiveMediaSource<ept id=\"p1\">**</ept> with the URI of an adaptive streaming manifest file by calling <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>CreateFromUriAsync<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/dn931261)</ept>.",
      "pos": [
        2002,
        2187
      ]
    },
    {
      "content": "The <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>AdaptiveMediaSourceCreationStatus<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn946917)</ept> value returned from this method lets you know if the media source was created successfully.",
      "pos": [
        2188,
        2381
      ]
    },
    {
      "content": "If so, you can set the object as the stream source for your <bpt id=\"p1\">**</bpt>MediaElement<ept id=\"p1\">**</ept> by calling <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>SetMediaStreamSource<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/dn299029)</ept>.",
      "pos": [
        2382,
        2555
      ]
    },
    {
      "content": "In this example, the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>AvailableBitrates<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn931257)</ept> property is queried to determine the maximum supported bitrate for this stream, and then that value is set as the inital bitrate.",
      "pos": [
        2556,
        2788
      ]
    },
    {
      "content": "This example also registers handlers for the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>DownloadRequested<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn931272)</ept>, <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>DownloadBitrateChanged<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn931269)</ept>, and <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>PlaybackBitrateChanged<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/dn931278)</ept> events which are discussed later in this article.",
      "pos": [
        2789,
        3145
      ]
    },
    {
      "pos": [
        3147,
        3245
      ],
      "content": "[!code-cs<bpt id=\"p1\">[</bpt>InitializeAMS<ept id=\"p1\">](./code/AdaptiveStreaming_Win10/cs/MainPage.xaml.cs#SnippetInitializeAMS)</ept>]"
    },
    {
      "pos": [
        3247,
        3512
      ],
      "content": "If you need to set custom HTTP headers for getting the manifest file, you can create an <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>HttpClient<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn298639)</ept> object, set the desired headers, and then pass the object into the overload of <bpt id=\"p3\">**</bpt>CreateFromUriAsync<ept id=\"p3\">**</ept>."
    },
    {
      "pos": [
        3514,
        3640
      ],
      "content": "[!code-cs<bpt id=\"p1\">[</bpt>InitializeAMSWithHttpClient<ept id=\"p1\">](./code/AdaptiveStreaming_Win10/cs/MainPage.xaml.cs#SnippetInitializeAMSWithHttpClient)</ept>]"
    },
    {
      "content": "The <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>DownloadRequested<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn931272)</ept> event is raised when the system is about to retrieve a resource from the server.",
      "pos": [
        3642,
        3808
      ]
    },
    {
      "content": "The <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>AdaptiveMediaSourceDownloadRequestedEventArgs<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn946935)</ept> passed into the event handler exposes properties that provide information about the resource being requested such as the type and URI of the resource.",
      "pos": [
        3809,
        4073
      ]
    },
    {
      "content": "You can use the <bpt id=\"p1\">**</bpt>DownloadRequested<ept id=\"p1\">**</ept> event handler to modify the resource request by updating the properties of the <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>AdaptiveMediaSourceDownloadResult<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/dn946942)</ept> object provided by the event args.",
      "pos": [
        4075,
        4324
      ]
    },
    {
      "content": "In the example below, the URI from which the resource will be retrieved is modified by updating the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ResourceUri<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn931250)</ept> properties of the result object.",
      "pos": [
        4325,
        4533
      ]
    },
    {
      "content": "You can override the content of the requested resource by setting the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Buffer<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn946943)</ept> or <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>InputStream<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn931249)</ept> properties of the result object.",
      "pos": [
        4535,
        4787
      ]
    },
    {
      "content": "In the example below, the contents of the manifest resource are replaced by setting the <bpt id=\"p1\">**</bpt>Buffer<ept id=\"p1\">**</ept> property.",
      "pos": [
        4788,
        4896
      ]
    },
    {
      "content": "Note that if you are updating the resource request with data that is obtained asynchronously, such as retrieving data from a remote server or asynchronous user authentication, you must call <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>AdaptiveMediaSourceDownloadRequestedEventArgs.GetDeferral<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn946936)</ept> to get a deferral and then call <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>Complete<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn946934)</ept> when the operation is complete to signal the system that the download request operation can continue.",
      "pos": [
        4897,
        5415
      ]
    },
    {
      "pos": [
        5417,
        5529
      ],
      "content": "[!code-cs<bpt id=\"p1\">[</bpt>AMSDownloadRequested<ept id=\"p1\">](./code/AdaptiveStreaming_Win10/cs/MainPage.xaml.cs#SnippetAMSDownloadRequested)</ept>]"
    },
    {
      "content": "The <bpt id=\"p1\">**</bpt>AdaptiveMediaSource<ept id=\"p1\">**</ept> object provides events that allow you to react when the download or playback bitrates change.",
      "pos": [
        5531,
        5652
      ]
    },
    {
      "content": "In this example, the current bitrates are simply updated in the UI.",
      "pos": [
        5653,
        5720
      ]
    },
    {
      "content": "Note that you can modify the ratios that determine when the system switches bitrates of the adaptive stream.",
      "pos": [
        5721,
        5829
      ]
    },
    {
      "content": "For more information, see the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>AdvancedSettings<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/mt628697)</ept> property.",
      "pos": [
        5830,
        5950
      ]
    },
    {
      "pos": [
        5952,
        6056
      ],
      "content": "[!code-cs<bpt id=\"p1\">[</bpt>AMSBitrateEvents<ept id=\"p1\">](./code/AdaptiveStreaming_Win10/cs/MainPage.xaml.cs#SnippetAMSBitrateEvents)</ept>]"
    }
  ],
  "content": "---\nms.assetid: AE98C22B-A071-4206-ABBB-C0F0FB7EF33C\ndescription: This article describes how to add playback of adaptive streaming multimedia content to a Universal Windows Platform (UWP) apps. This feature currently supports playback of Http Live Streaming (HLS) and Dynamic Streaming over HTTP (DASH) content.\ntitle: Adaptive Streaming\n---\n\n# Adaptive Streaming\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\nThis article describes how to add playback of adaptive streaming multimedia content to a Universal Windows Platform (UWP) apps. This feature currently supports playback of Http Live Streaming (HLS) and Dynamic Streaming over HTTP (DASH) content.\n\n## Simple adaptive streaming with MediaElement\n\nTo display adaptive streaming multimedia in a XAML-based app, add a [**MediaElement**](https://msdn.microsoft.com/library/windows/apps/br242926) control to your page.\n\n[!code-xml[MediaElementXAML](./code/AdaptiveStreaming_Win10/cs/MainPage.xaml#SnippetMediaElementXAML)]\n\nSet the [**Source**](https://msdn.microsoft.com/library/windows/apps/br227420) property of the **MediaElement** to the URI of a DASH or HLS manifest file.\n\n[!code-cs[ManifestSource](./code/AdaptiveStreaming_Win10/cs/MainPage.xaml.cs#SnippetManifestSource)]\n\n## Adaptive streaming with AdaptiveMediaSource\n\nIf your app requires more advanced adaptive streaming features, such as providing custom HTTP headers, monitoring the current download and playback bitrates, or adjusting the ratios that determine when the system switches bitrates of the adaptive stream, use the [**AdaptiveMediaSource**](https://msdn.microsoft.com/library/windows/apps/dn946912) object.\n\nThe adaptive streaming APIs are found in the [**Windows.Media.Streaming.Adaptive**](https://msdn.microsoft.com/library/windows/apps/dn931279) namespace.\n\n[!code-cs[AdaptiveStreamingUsing](./code/AdaptiveStreaming_Win10/cs/MainPage.xaml.cs#SnippetAdaptiveStreamingUsing)]\n\nInitialize the **AdaptiveMediaSource** with the URI of an adaptive streaming manifest file by calling [**CreateFromUriAsync**](https://msdn.microsoft.com/library/windows/apps/dn931261). The [**AdaptiveMediaSourceCreationStatus**](https://msdn.microsoft.com/library/windows/apps/dn946917) value returned from this method lets you know if the media source was created successfully. If so, you can set the object as the stream source for your **MediaElement** by calling [**SetMediaStreamSource**](https://msdn.microsoft.com/library/windows/apps/dn299029). In this example, the [**AvailableBitrates**](https://msdn.microsoft.com/library/windows/apps/dn931257) property is queried to determine the maximum supported bitrate for this stream, and then that value is set as the inital bitrate. This example also registers handlers for the [**DownloadRequested**](https://msdn.microsoft.com/library/windows/apps/dn931272), [**DownloadBitrateChanged**](https://msdn.microsoft.com/library/windows/apps/dn931269), and [**PlaybackBitrateChanged**](https://msdn.microsoft.com/library/windows/apps/dn931278) events which are discussed later in this article.\n\n[!code-cs[InitializeAMS](./code/AdaptiveStreaming_Win10/cs/MainPage.xaml.cs#SnippetInitializeAMS)]\n\nIf you need to set custom HTTP headers for getting the manifest file, you can create an [**HttpClient**](https://msdn.microsoft.com/library/windows/apps/dn298639) object, set the desired headers, and then pass the object into the overload of **CreateFromUriAsync**.\n\n[!code-cs[InitializeAMSWithHttpClient](./code/AdaptiveStreaming_Win10/cs/MainPage.xaml.cs#SnippetInitializeAMSWithHttpClient)]\n\nThe [**DownloadRequested**](https://msdn.microsoft.com/library/windows/apps/dn931272) event is raised when the system is about to retrieve a resource from the server. The [**AdaptiveMediaSourceDownloadRequestedEventArgs**](https://msdn.microsoft.com/library/windows/apps/dn946935) passed into the event handler exposes properties that provide information about the resource being requested such as the type and URI of the resource.\n\nYou can use the **DownloadRequested** event handler to modify the resource request by updating the properties of the [**AdaptiveMediaSourceDownloadResult**](https://msdn.microsoft.com/library/windows/apps/dn946942) object provided by the event args. In the example below, the URI from which the resource will be retrieved is modified by updating the [**ResourceUri**](https://msdn.microsoft.com/library/windows/apps/dn931250) properties of the result object.\n\nYou can override the content of the requested resource by setting the [**Buffer**](https://msdn.microsoft.com/library/windows/apps/dn946943) or [**InputStream**](https://msdn.microsoft.com/library/windows/apps/dn931249) properties of the result object. In the example below, the contents of the manifest resource are replaced by setting the **Buffer** property. Note that if you are updating the resource request with data that is obtained asynchronously, such as retrieving data from a remote server or asynchronous user authentication, you must call [**AdaptiveMediaSourceDownloadRequestedEventArgs.GetDeferral**](https://msdn.microsoft.com/library/windows/apps/dn946936) to get a deferral and then call [**Complete**](https://msdn.microsoft.com/library/windows/apps/dn946934) when the operation is complete to signal the system that the download request operation can continue.\n\n[!code-cs[AMSDownloadRequested](./code/AdaptiveStreaming_Win10/cs/MainPage.xaml.cs#SnippetAMSDownloadRequested)]\n\nThe **AdaptiveMediaSource** object provides events that allow you to react when the download or playback bitrates change. In this example, the current bitrates are simply updated in the UI. Note that you can modify the ratios that determine when the system switches bitrates of the adaptive stream. For more information, see the [**AdvancedSettings**](https://msdn.microsoft.com/library/windows/apps/mt628697) property.\n\n[!code-cs[AMSBitrateEvents](./code/AdaptiveStreaming_Win10/cs/MainPage.xaml.cs#SnippetAMSBitrateEvents)]\n\n \n\n \n\n\n\n\n"
}