{
  "nodes": [
    {
      "content": "Windows PowerShell 4.0 Desired State Configuration Local Configuration Manager (LCM)",
      "pos": [
        2,
        86
      ]
    },
    {
      "content": "Applies To: Windows PowerShell 4.0, Windows PowerShell 5.0",
      "pos": [
        89,
        147
      ]
    },
    {
      "content": "Local Configuration Manager is the Windows PowerShell Desired State Configuration (DSC) engine.",
      "pos": [
        149,
        244
      ]
    },
    {
      "content": "It runs on all target nodes, and it is responsible for calling the configuration resources that are included in a DSC configuration script.",
      "pos": [
        245,
        384
      ]
    },
    {
      "content": "This topic lists the properties of Local Configuration Manager and describes how you can modify the Local Configuration Manager settings on a target node.",
      "pos": [
        385,
        539
      ]
    },
    {
      "content": "Local Configuration Manager properties",
      "pos": [
        544,
        582
      ]
    },
    {
      "content": "The following lists the Local Configuration Manager properties that you can set or retrieve.",
      "pos": [
        583,
        675
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>AllowModuleOverwrite<ept id=\"p1\">**</ept>: Controls whether new configurations downloaded from the configuration server are allowed to overwrite the old ones on the target node.",
      "pos": [
        680,
        840
      ]
    },
    {
      "content": "Possible values are True and False.",
      "pos": [
        841,
        876
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>CertificateID<ept id=\"p1\">**</ept>: GUID a certificate used to secure credentials for access to the configuration.",
      "pos": [
        879,
        976
      ]
    },
    {
      "content": "For more information see <bpt id=\"p1\">[</bpt>Want to secure credentials in Windows PowerShell Desired State Configuration?<ept id=\"p1\">](http://blogs.msdn.com/b/powershell/archive/2014/01/31/want-to-secure-credentials-in-windows-powershell-desired-state-configuration.aspx)</ept>.",
      "pos": [
        977,
        1219
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>ConfigurationID<ept id=\"p1\">**</ept>: Indicates a GUID which is used to get a particular configuration file from a server set up as a “pull” server.",
      "pos": [
        1222,
        1353
      ]
    },
    {
      "content": "The GUID ensures that the correct configuration file is accessed.",
      "pos": [
        1354,
        1419
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>ConfigurationMode<ept id=\"p1\">**</ept>: Specifies how the Local Configuration Manager actually applies the configuration to the target nodes.",
      "pos": [
        1422,
        1546
      ]
    },
    {
      "content": "It can take the following values:",
      "pos": [
        1547,
        1580
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>ApplyOnly<ept id=\"p1\">**</ept>: With this option, DSC applies the configuration and does nothing further unless a new configuration is detected, either by you sending a new configuration directly to the target node (“push”) or if you have configured a “pull” server and DSC discovers a new configuration when it checks with the “pull” server.",
      "pos": [
        1587,
        1912
      ]
    },
    {
      "content": "If the target node’s configuration drifts, no action is taken.",
      "pos": [
        1913,
        1975
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>ApplyAndMonitor<ept id=\"p1\">**</ept>: With this option (which is the default), DSC applies any new configurations, whether sent by you directly to the target node or discovered on a “pull” server.",
      "pos": [
        1982,
        2161
      ]
    },
    {
      "content": "Thereafter, if the configuration of the target node drifts from the configuration file, DSC reports the discrepancy in logs.",
      "pos": [
        2162,
        2286
      ]
    },
    {
      "content": "For more about DSC logging, see <bpt id=\"p1\">[</bpt>Using Event Logs to Diagnose Errors in Desired State Configuration<ept id=\"p1\">](http://blogs.msdn.com/b/powershell/archive/2014/01/03/using-event-logs-to-diagnose-errors-in-desired-state-configuration.aspx)</ept>.",
      "pos": [
        2287,
        2515
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>ApplyAndAutoCorrect<ept id=\"p1\">**</ept>: With this option, DSC applies any new configurations, whether sent by you directly to the target node or discovered on a “pull” server.",
      "pos": [
        2522,
        2682
      ]
    },
    {
      "content": "Thereafter, if the configuration of the target node drifts from the configuration file, DSC reports the discrepancy in logs, and then attempts to adjust the target node configuration to bring in compliance with the configuration file.",
      "pos": [
        2683,
        2917
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>ConfigurationModeFrequencyMins<ept id=\"p1\">**</ept>: Represents the frequency (in minutes) at which the background application of DSC attempts to implement the current configuration on the target node.",
      "pos": [
        2920,
        3104
      ]
    },
    {
      "content": "The default value is 15.",
      "pos": [
        3105,
        3129
      ]
    },
    {
      "content": "This value can be set in conjunction with RefreshMode.",
      "pos": [
        3130,
        3184
      ]
    },
    {
      "content": "When RefreshMode is set to PULL, the target node contacts the configuration server at an interval set by RefreshFrequencyMins and downloads the current configuration.",
      "pos": [
        3185,
        3351
      ]
    },
    {
      "content": "Regardless of the RefreshMode value, at the interval set by ConfigurationModeFrequencyMins, the consistency engine applies the latest configuration that was downloaded to the target node.",
      "pos": [
        3352,
        3539
      ]
    },
    {
      "content": "RefreshFrequencyMins should be set to an integer multiple of ConfigurationModeFrequencyMins.",
      "pos": [
        3540,
        3632
      ]
    },
    {
      "pos": [
        3635,
        3779
      ],
      "content": "<bpt id=\"p1\">**</bpt>Credential<ept id=\"p1\">**</ept>: Indicates credentials (as with Get-Credential) required to access remote resources, such as to contact the configuration server."
    },
    {
      "pos": [
        3782,
        3892
      ],
      "content": "<bpt id=\"p1\">**</bpt>DownloadManagerCustomData<ept id=\"p1\">**</ept>: Represents an array that contains custom data specific to the download manager."
    },
    {
      "pos": [
        3895,
        3988
      ],
      "content": "<bpt id=\"p1\">**</bpt>DownloadManagerName<ept id=\"p1\">**</ept>: Indicates the name of the configuration and module download manager."
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>RebootNodeIfNeeded<ept id=\"p1\">**</ept>: Certain configuration changes on a target node might require it to be restarted for the changes to be applied.",
      "pos": [
        3991,
        4125
      ]
    },
    {
      "content": "With the value <bpt id=\"p1\">**</bpt>True<ept id=\"p1\">**</ept>, this property will restart the node as soon as the configuration has been completely applies, without further warning.",
      "pos": [
        4126,
        4269
      ]
    },
    {
      "content": "If <bpt id=\"p1\">**</bpt>False<ept id=\"p1\">**</ept> (the default value), the configuration will be completed, but the node must be restarted manually for the changes to take effect.",
      "pos": [
        4270,
        4412
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>RefreshFrequencyMins<ept id=\"p1\">**</ept>: Used when you have set up a “pull” server.",
      "pos": [
        4415,
        4483
      ]
    },
    {
      "content": "Represents the frequency (in minutes) at which the Local Configuration Manager contacts a “pull” server to download the current configuration.",
      "pos": [
        4484,
        4626
      ]
    },
    {
      "content": "This value can be set in conjunction with ConfigurationModeFrequencyMins.",
      "pos": [
        4627,
        4700
      ]
    },
    {
      "content": "When RefreshMode is set to PULL, the target node contacts the “pull” server at an interval set by RefreshFrequencyMins and downloads the current configuration.",
      "pos": [
        4701,
        4860
      ]
    },
    {
      "content": "At the interval set by ConfigurationModeFrequencyMins, the consistency engine then applies the latest configuration that was downloaded to the target node.",
      "pos": [
        4861,
        5016
      ]
    },
    {
      "content": "If RefreshFrequencyMins is not set to an integer multiple of ConfigurationModeFrequencyMins, the system will round it up.",
      "pos": [
        5017,
        5138
      ]
    },
    {
      "content": "The default value is 30.",
      "pos": [
        5139,
        5163
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>RefreshMode<ept id=\"p1\">**</ept>: Possible values are <bpt id=\"p2\">**</bpt>Push<ept id=\"p2\">**</ept> (the default) and <bpt id=\"p3\">**</bpt>Pull<ept id=\"p3\">**</ept>.",
      "pos": [
        5166,
        5239
      ]
    },
    {
      "content": "In the “push” configuration, you must place a configuration file on each target node, using any client computer.",
      "pos": [
        5240,
        5352
      ]
    },
    {
      "content": "In the “pull” mode, you must set up a “pull” server for Local Configuration Manager to contact and access the configuration files.",
      "pos": [
        5353,
        5483
      ]
    },
    {
      "content": "Example of updating Local Configuration Manager settings",
      "pos": [
        5489,
        5545
      ]
    },
    {
      "pos": [
        5547,
        5754
      ],
      "content": "You can update the Local Configuration Manager settings of a target node by including a <bpt id=\"p1\">**</bpt>LocalConfigurationManager<ept id=\"p1\">**</ept> block inside the node block in a configuration script, as shown in the following example."
    },
    {
      "content": "Running the script in the previous example generates a MOF file that specifies and stores the desired settings.",
      "pos": [
        6684,
        6795
      ]
    },
    {
      "content": "To apply the settings, you can use the <bpt id=\"p1\">**</bpt>Set-DscLocalConfigurationManager<ept id=\"p1\">**</ept> cmdlet, as shown in the following example.",
      "pos": [
        6796,
        6914
      ]
    },
    {
      "pos": [
        6998,
        7178
      ],
      "content": "<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>: For the <bpt id=\"p2\">**</bpt>Path<ept id=\"p2\">**</ept> parameter, you must specify the same path that you specified for the <bpt id=\"p3\">**</bpt>OutputPath<ept id=\"p3\">**</ept> parameter when you invoked the configuration in the previous example."
    },
    {
      "content": "To see the current Local Configuration Manager settings, you can use the <bpt id=\"p1\">**</bpt>Get-DscLocalConfigurationManager<ept id=\"p1\">**</ept> cmdlet.",
      "pos": [
        7180,
        7297
      ]
    },
    {
      "content": "If you invoke this cmdlet with no parameters, by default it will get the Local Configuration Manager settings for the node on which you run it.",
      "pos": [
        7298,
        7441
      ]
    },
    {
      "content": "To specify another node, use the <bpt id=\"p1\">**</bpt>CimSession<ept id=\"p1\">**</ept> parameter with this cmdlet.",
      "pos": [
        7442,
        7517
      ]
    }
  ],
  "content": "# Windows PowerShell 4.0 Desired State Configuration Local Configuration Manager (LCM)\n\n>Applies To: Windows PowerShell 4.0, Windows PowerShell 5.0\n\nLocal Configuration Manager is the Windows PowerShell Desired State Configuration (DSC) engine. It runs on all target nodes, and it is responsible for calling the configuration resources that are included in a DSC configuration script. This topic lists the properties of Local Configuration Manager and describes how you can modify the Local Configuration Manager settings on a target node.\n\n## Local Configuration Manager properties\nThe following lists the Local Configuration Manager properties that you can set or retrieve.\n \n* **AllowModuleOverwrite**: Controls whether new configurations downloaded from the configuration server are allowed to overwrite the old ones on the target node. Possible values are True and False.\n* **CertificateID**: GUID a certificate used to secure credentials for access to the configuration. For more information see [Want to secure credentials in Windows PowerShell Desired State Configuration?](http://blogs.msdn.com/b/powershell/archive/2014/01/31/want-to-secure-credentials-in-windows-powershell-desired-state-configuration.aspx).\n* **ConfigurationID**: Indicates a GUID which is used to get a particular configuration file from a server set up as a “pull” server. The GUID ensures that the correct configuration file is accessed.\n* **ConfigurationMode**: Specifies how the Local Configuration Manager actually applies the configuration to the target nodes. It can take the following values:\n    - **ApplyOnly**: With this option, DSC applies the configuration and does nothing further unless a new configuration is detected, either by you sending a new configuration directly to the target node (“push”) or if you have configured a “pull” server and DSC discovers a new configuration when it checks with the “pull” server. If the target node’s configuration drifts, no action is taken.\n    - **ApplyAndMonitor**: With this option (which is the default), DSC applies any new configurations, whether sent by you directly to the target node or discovered on a “pull” server. Thereafter, if the configuration of the target node drifts from the configuration file, DSC reports the discrepancy in logs. For more about DSC logging, see [Using Event Logs to Diagnose Errors in Desired State Configuration](http://blogs.msdn.com/b/powershell/archive/2014/01/03/using-event-logs-to-diagnose-errors-in-desired-state-configuration.aspx).\n    - **ApplyAndAutoCorrect**: With this option, DSC applies any new configurations, whether sent by you directly to the target node or discovered on a “pull” server. Thereafter, if the configuration of the target node drifts from the configuration file, DSC reports the discrepancy in logs, and then attempts to adjust the target node configuration to bring in compliance with the configuration file.\n* **ConfigurationModeFrequencyMins**: Represents the frequency (in minutes) at which the background application of DSC attempts to implement the current configuration on the target node. The default value is 15. This value can be set in conjunction with RefreshMode. When RefreshMode is set to PULL, the target node contacts the configuration server at an interval set by RefreshFrequencyMins and downloads the current configuration. Regardless of the RefreshMode value, at the interval set by ConfigurationModeFrequencyMins, the consistency engine applies the latest configuration that was downloaded to the target node. RefreshFrequencyMins should be set to an integer multiple of ConfigurationModeFrequencyMins.\n* **Credential**: Indicates credentials (as with Get-Credential) required to access remote resources, such as to contact the configuration server.\n* **DownloadManagerCustomData**: Represents an array that contains custom data specific to the download manager.\n* **DownloadManagerName**: Indicates the name of the configuration and module download manager.\n* **RebootNodeIfNeeded**: Certain configuration changes on a target node might require it to be restarted for the changes to be applied. With the value **True**, this property will restart the node as soon as the configuration has been completely applies, without further warning. If **False** (the default value), the configuration will be completed, but the node must be restarted manually for the changes to take effect.\n* **RefreshFrequencyMins**: Used when you have set up a “pull” server. Represents the frequency (in minutes) at which the Local Configuration Manager contacts a “pull” server to download the current configuration. This value can be set in conjunction with ConfigurationModeFrequencyMins. When RefreshMode is set to PULL, the target node contacts the “pull” server at an interval set by RefreshFrequencyMins and downloads the current configuration. At the interval set by ConfigurationModeFrequencyMins, the consistency engine then applies the latest configuration that was downloaded to the target node. If RefreshFrequencyMins is not set to an integer multiple of ConfigurationModeFrequencyMins, the system will round it up. The default value is 30.\n* **RefreshMode**: Possible values are **Push** (the default) and **Pull**. In the “push” configuration, you must place a configuration file on each target node, using any client computer. In the “pull” mode, you must set up a “pull” server for Local Configuration Manager to contact and access the configuration files.\n\n### Example of updating Local Configuration Manager settings\n\nYou can update the Local Configuration Manager settings of a target node by including a **LocalConfigurationManager** block inside the node block in a configuration script, as shown in the following example.\n\n```powershell\nConfiguration ExampleConfig\n{\n    Node “Server001”\n    {\n        LocalConfigurationManager\n        {\n            ConfigurationID = \"646e48cb-3082-4a12-9fd9-f71b9a562d4e\"\n            ConfigurationModeFrequencyMins = 45\n            ConfigurationMode = \"ApplyAndAutocorrect\"\n            RefreshMode = \"Pull\"\n            RefreshFrequencyMins = 90\n            DownloadManagerName = \"WebDownloadManager\"\n            DownloadManagerCustomData = (@{ServerUrl=\"https://$PullServer/psdscpullserver.svc\"})\n            CertificateID = \"71AA68562316FE3F73536F1096B85D66289ED60E\"\n            Credential = $cred\n            RebootNodeIfNeeded = $true\n            AllowModuleOverwrite = $false\n        }\n# One or more resource blocks can be added here\n    }\n}\n\n# The following line invokes the configuration and creates a file called Server001.meta.mof at the specified path\nExampleConfig -OutputPath \"c:\\users\\public\\dsc\"  \n```\n\nRunning the script in the previous example generates a MOF file that specifies and stores the desired settings. To apply the settings, you can use the **Set-DscLocalConfigurationManager** cmdlet, as shown in the following example.\n\n```powershell\nSet-DscLocalConfigurationManager -Path \"c:\\users\\public\\dsc\"\n```\n\n> **Note**: For the **Path** parameter, you must specify the same path that you specified for the **OutputPath** parameter when you invoked the configuration in the previous example.\n\nTo see the current Local Configuration Manager settings, you can use the **Get-DscLocalConfigurationManager** cmdlet. If you invoke this cmdlet with no parameters, by default it will get the Local Configuration Manager settings for the node on which you run it. To specify another node, use the **CimSession** parameter with this cmdlet."
}