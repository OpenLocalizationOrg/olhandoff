{
  "nodes": [
    {
      "content": "Manage Role Based Access Control (RBAC) with Azure CLI | Microsoft Azure",
      "pos": [
        27,
        99
      ]
    },
    {
      "content": "Learn how to manage role-based access (RBAC) with the Azure command line interface by listing roles and role actions, assigning roles to the subscription and application scopes.",
      "pos": [
        118,
        295
      ]
    },
    {
      "content": "Manage Role Based Access Control (RBAC) with the Azure Command Line Interface (CLI)",
      "pos": [
        604,
        687
      ]
    },
    {
      "content": "[AZURE.SELECTOR]",
      "pos": [
        714,
        730
      ]
    },
    {
      "content": "PowerShell",
      "pos": [
        734,
        744
      ]
    },
    {
      "content": "Azure CLI",
      "pos": [
        804,
        813
      ]
    },
    {
      "content": "List RBAC roles",
      "pos": [
        873,
        888
      ]
    },
    {
      "content": "List all available roles",
      "pos": [
        893,
        917
      ]
    },
    {
      "content": "To list all available roles use:",
      "pos": [
        918,
        950
      ]
    },
    {
      "pos": [
        977,
        1039
      ],
      "content": "The following example shows the list of <bpt id=\"p1\">*</bpt>all available roles<ept id=\"p1\">*</ept>."
    },
    {
      "content": "List actions of a role",
      "pos": [
        1131,
        1153
      ]
    },
    {
      "content": "To list the actions of a role use:",
      "pos": [
        1154,
        1188
      ]
    },
    {
      "pos": [
        1228,
        1329
      ],
      "content": "The following example shows the actions of the <bpt id=\"p1\">*</bpt>Contributor<ept id=\"p1\">*</ept> and <bpt id=\"p2\">*</bpt>Virtual Machine Contributor<ept id=\"p2\">*</ept> roles."
    },
    {
      "content": "List access",
      "pos": [
        1421,
        1432
      ]
    },
    {
      "content": "List role assignments effective on a resource group",
      "pos": [
        1437,
        1488
      ]
    },
    {
      "content": "To list role assignments effective on a resource group  use:",
      "pos": [
        1489,
        1549
      ]
    },
    {
      "pos": [
        1622,
        1723
      ],
      "content": "The following example shows the role assignments effective on the <bpt id=\"p1\">*</bpt>pharma-sales-projecforcast<ept id=\"p1\">*</ept> group."
    },
    {
      "content": "List role assignments to a user, including ones assigned to a user's groups",
      "pos": [
        1828,
        1903
      ]
    },
    {
      "pos": [
        1905,
        2006
      ],
      "content": "The following example shows the role assignments effective on the <bpt id=\"p1\">*</bpt>pharma-sales-projecforcast<ept id=\"p1\">*</ept> group."
    },
    {
      "content": "Grant access",
      "pos": [
        2111,
        2123
      ]
    },
    {
      "content": "Once you have identified the role you wish to assign, to grant access use:",
      "pos": [
        2124,
        2198
      ]
    },
    {
      "content": "Assign role to group at subscription scope",
      "pos": [
        2238,
        2280
      ]
    },
    {
      "content": "To assign a role to a group at the subscription scope use:",
      "pos": [
        2281,
        2339
      ]
    },
    {
      "content": "azure role assignment create --objId  &lt;group's object id&gt; --role",
      "pos": [
        2344,
        2408
      ]
    },
    {
      "content": "--scope &lt;subscription/subscription id&gt;",
      "pos": [
        2424,
        2462
      ]
    },
    {
      "pos": [
        2464,
        2567
      ],
      "content": "The following example assigns the <bpt id=\"p1\">*</bpt>Reader<ept id=\"p1\">*</ept> role to <bpt id=\"p2\">*</bpt>Christine Koch's Team<ept id=\"p2\">*</ept> at the <bpt id=\"p3\">*</bpt>subscription<ept id=\"p3\">*</ept> scope."
    },
    {
      "content": "Assign role to application at subscription scope",
      "pos": [
        2674,
        2722
      ]
    },
    {
      "content": "To assign a role to an application at the subscription scope use:",
      "pos": [
        2723,
        2788
      ]
    },
    {
      "pos": [
        2921,
        3027
      ],
      "content": "Following example grants the <bpt id=\"p1\">*</bpt>Contributor<ept id=\"p1\">*</ept> role to an <bpt id=\"p2\">*</bpt>Azure AD<ept id=\"p2\">*</ept> application on the selected subscription."
    },
    {
      "content": "Assign role to user at resource group scope",
      "pos": [
        3135,
        3178
      ]
    },
    {
      "content": "To assign a role to a user at the resource group scope use:",
      "pos": [
        3179,
        3238
      ]
    },
    {
      "pos": [
        3385,
        3536
      ],
      "content": "Following example grants the <bpt id=\"p1\">*</bpt>Virtual Machine Contributor<ept id=\"p1\">*</ept> role to user <bpt id=\"p2\">*</bpt>samert@aaddemo.com<ept id=\"p2\">*</ept> at the <bpt id=\"p3\">*</bpt>Pharma-Sales-ProjectForcast<ept id=\"p3\">*</ept> resource group scope."
    },
    {
      "content": "Assign role to group at resource scope",
      "pos": [
        3643,
        3681
      ]
    },
    {
      "content": "To assign a role to a group at the resource scope use:",
      "pos": [
        3682,
        3736
      ]
    },
    {
      "pos": [
        3971,
        4072
      ],
      "content": "Following example grants the <bpt id=\"p1\">*</bpt>Virtual Machine Contributor<ept id=\"p1\">*</ept> role to an <bpt id=\"p2\">*</bpt>Azure AD<ept id=\"p2\">*</ept> group on a <bpt id=\"p3\">*</bpt>subnet<ept id=\"p3\">*</ept>."
    },
    {
      "content": "Remove access",
      "pos": [
        4179,
        4192
      ]
    },
    {
      "content": "To remove a role assignment, use:",
      "pos": [
        4193,
        4226
      ]
    },
    {
      "content": "Following example removes the <bpt id=\"p1\">*</bpt>Virtual Machine Contributor<ept id=\"p1\">*</ept> role assignment from <bpt id=\"p2\">*</bpt>sammert@aaddemo.com<ept id=\"p2\">*</ept> on the <bpt id=\"p3\">*</bpt>Pharma-Sales-ProjectForcast<ept id=\"p3\">*</ept> resource group.",
      "pos": [
        4334,
        4489
      ]
    },
    {
      "content": "Then, it removes the role assignment from a group on the subscription.",
      "pos": [
        4490,
        4560
      ]
    },
    {
      "content": "Create a custom role",
      "pos": [
        4664,
        4684
      ]
    },
    {
      "pos": [
        4685,
        4742
      ],
      "content": "To create a custom role, use <ph id=\"ph1\">`azure role create`</ph> command."
    },
    {
      "content": "The following example creates a custom role called <bpt id=\"p1\">*</bpt>Virtual Machine Operator<ept id=\"p1\">*</ept> that grants access to all read operations of <bpt id=\"p2\">*</bpt>Microsoft.Compute<ept id=\"p2\">*</ept>, <bpt id=\"p3\">*</bpt>Microsoft.Storage<ept id=\"p3\">*</ept>, and <bpt id=\"p4\">*</bpt>Microsoft.Network<ept id=\"p4\">*</ept> resource providers, and grants access to start, restart, and monitor virtual machines.",
      "pos": [
        4744,
        5019
      ]
    },
    {
      "content": "The custom role can be used in two subscriptions.",
      "pos": [
        5020,
        5069
      ]
    },
    {
      "content": "This example employs a json file as an input.",
      "pos": [
        5070,
        5115
      ]
    },
    {
      "content": "![](./media/role-based-access-control-manage-access-azure-cli/2-azure-role create-1.png)",
      "pos": [
        5117,
        5205
      ]
    },
    {
      "content": "Modify a custom role",
      "pos": [
        5300,
        5320
      ]
    },
    {
      "content": "To modify a custom role first, use the azure role show command to retrieve role definition.",
      "pos": [
        5322,
        5413
      ]
    },
    {
      "content": "Then, make desired changes to the role definition.",
      "pos": [
        5414,
        5464
      ]
    },
    {
      "content": "Finally, use azure role set command to save the modified role definition.",
      "pos": [
        5465,
        5538
      ]
    },
    {
      "content": "The following example adds the Microsoft.Insights/diagnosticSettings/* operation to the Actions, and an Azure subscription to the AssignableScopes of the Virtual Machine Operator custom role.",
      "pos": [
        5540,
        5731
      ]
    },
    {
      "content": "Delete a custom role",
      "pos": [
        5909,
        5929
      ]
    },
    {
      "content": "To delete a custom role first, use the <ph id=\"ph1\">`azure role show`</ph> command to determine the <bpt id=\"p1\">**</bpt>Id<ept id=\"p1\">**</ept> of the role.",
      "pos": [
        5931,
        6032
      ]
    },
    {
      "content": "Then, use <ph id=\"ph1\">`azure role delete`</ph> command to delete the role by specifying the <bpt id=\"p1\">**</bpt>Id<ept id=\"p1\">**</ept>.",
      "pos": [
        6033,
        6115
      ]
    },
    {
      "pos": [
        6117,
        6190
      ],
      "content": "The following example removes the <bpt id=\"p1\">*</bpt>Virtual Machine Operator<ept id=\"p1\">*</ept> custom role."
    },
    {
      "content": "List custom roles",
      "pos": [
        6283,
        6300
      ]
    },
    {
      "pos": [
        6302,
        6400
      ],
      "content": "To list the roles that are available for assignment at a scope, use the <ph id=\"ph1\">`azure role list`</ph> command."
    },
    {
      "content": "The following example lists all role available for assignment in the selected subscription.",
      "pos": [
        6402,
        6493
      ]
    },
    {
      "pos": [
        6582,
        6772
      ],
      "content": "In the following example the <bpt id=\"p1\">*</bpt>Virtual Machine Operator<ept id=\"p1\">*</ept> custom role isn’t available in the <bpt id=\"p2\">*</bpt>Production4<ept id=\"p2\">*</ept> subscription because that subscription isn’t in the <bpt id=\"p3\">**</bpt>AssignableScopes<ept id=\"p3\">**</ept> of the role."
    },
    {
      "content": "RBAC Topics",
      "pos": [
        6868,
        6879
      ]
    }
  ],
  "content": "<properties\n    pageTitle=\"Manage Role Based Access Control (RBAC) with Azure CLI | Microsoft Azure\"\n    description=\"Learn how to manage role-based access (RBAC) with the Azure command line interface by listing roles and role actions, assigning roles to the subscription and application scopes.\"\n    services=\"active-directory\"\n    documentationCenter=\"\"\n    authors=\"IHenkel\"\n    manager=\"stevenpo\"\n    editor=\"\"/>\n\n<tags\n    ms.service=\"active-directory\"\n    ms.devlang=\"na\"\n    ms.topic=\"article\"\n    ms.tgt_pltfrm=\"na\"\n    ms.workload=\"identity\"\n    ms.date=\"12/04/2015\"\n    ms.author=\"inhenk\"/>\n\n# Manage Role Based Access Control (RBAC) with the Azure Command Line Interface (CLI)\n<!-- Azure Selector -->\n> [AZURE.SELECTOR]\n- [PowerShell](role-based-access-control-manage-access-powershell.md)\n- [Azure CLI](role-based-access-control-manage-access-azure-cli.md)\n\n## List RBAC roles\n### List all available roles\nTo list all available roles use:\n\n        azure role list\n\nThe following example shows the list of *all available roles*.\n\n![](./media/role-based-access-control-manage-access-azure-cli/1-azure-role-list.png)\n\n### List actions of a role\nTo list the actions of a role use:\n\n    azure role show <role in quotes>\n\nThe following example shows the actions of the *Contributor* and *Virtual Machine Contributor* roles.\n\n![](./media/role-based-access-control-manage-access-azure-cli/1-azure-role-show.png)\n\n##  List access\n### List role assignments effective on a resource group\nTo list role assignments effective on a resource group  use:\n\n    azure role assignment list --resource-group <resource group name>\n\nThe following example shows the role assignments effective on the *pharma-sales-projecforcast* group.\n\n![](./media/role-based-access-control-manage-access-azure-cli/4-azure-role-assignment-list-1.png)\n\n### List role assignments to a user, including ones assigned to a user's groups\n\nThe following example shows the role assignments effective on the *pharma-sales-projecforcast* group.\n\n![](./media/role-based-access-control-manage-access-azure-cli/4-azure-role-assignment-list-2.png)\n\n##  Grant access\nOnce you have identified the role you wish to assign, to grant access use:\n\n    azure role assignment create\n\n### Assign role to group at subscription scope\nTo assign a role to a group at the subscription scope use:\n\n   azure role assignment create --objId  <group's object id> --role <name of role> --scope <subscription/subscription id>\n\nThe following example assigns the *Reader* role to *Christine Koch's Team* at the *subscription* scope.\n\n![](./media/role-based-access-control-manage-access-azure-cli/2-azure-role-assignment-create-1.png)\n\n### Assign role to application at subscription scope\nTo assign a role to an application at the subscription scope use:\n\n    azure role assignment create --objId  <applications's object id> --role <name of role> --scope <subscription/subscription id>\n\nFollowing example grants the *Contributor* role to an *Azure AD* application on the selected subscription.\n\n ![](./media/role-based-access-control-manage-access-azure-cli/2-azure-role-assignment-create-2.png)\n\n### Assign role to user at resource group scope\nTo assign a role to a user at the resource group scope use:\n\n    azure role assignment create --signInName  <user's email address> --roleName <name of role in quotes> --resourceGroup <resource group name>\n\nFollowing example grants the *Virtual Machine Contributor* role to user *samert@aaddemo.com* at the *Pharma-Sales-ProjectForcast* resource group scope.\n\n![](./media/role-based-access-control-manage-access-azure-cli/2-azure-role-assignment-create-3.png)\n\n### Assign role to group at resource scope\nTo assign a role to a group at the resource scope use:\n\n    azure role assignment create --objId  <group id> --roleName <name of role in quotes> --resource-name <resource group name> --resource-type <resource group type> --parent <resource group parent> --resource-group <resource group>\n\nFollowing example grants the *Virtual Machine Contributor* role to an *Azure AD* group on a *subnet*.\n\n![](./media/role-based-access-control-manage-access-azure-cli/2-azure-role-assignment-create-4.png)\n\n##  Remove access\nTo remove a role assignment, use:\n\n    azure role assignment delete --objId <object id to from which to remove role> --roleName <role name>\n\nFollowing example removes the *Virtual Machine Contributor* role assignment from *sammert@aaddemo.com* on the *Pharma-Sales-ProjectForcast* resource group.\nThen, it removes the role assignment from a group on the subscription.\n\n![](./media/role-based-access-control-manage-access-azure-cli/3-azure-role-assignment-delete.png)\n\n## Create a custom role\nTo create a custom role, use `azure role create` command.\n\nThe following example creates a custom role called *Virtual Machine Operator* that grants access to all read operations of *Microsoft.Compute*, *Microsoft.Storage*, and *Microsoft.Network* resource providers, and grants access to start, restart, and monitor virtual machines. The custom role can be used in two subscriptions. This example employs a json file as an input.\n\n![](./media/role-based-access-control-manage-access-azure-cli/2-azure-role create-1.png)\n\n![](./media/role-based-access-control-manage-access-azure-cli/2-azure-role-create-2.png)\n\n## Modify a custom role\n\nTo modify a custom role first, use the azure role show command to retrieve role definition. Then, make desired changes to the role definition. Finally, use azure role set command to save the modified role definition.\n\nThe following example adds the Microsoft.Insights/diagnosticSettings/* operation to the Actions, and an Azure subscription to the AssignableScopes of the Virtual Machine Operator custom role.\n\n![](./media/role-based-access-control-manage-access-azure-cli/3-azure-role-set-1.png)\n\n![](./media/role-based-access-control-manage-access-azure-cli/3-azure-role-set2.png)\n\n## Delete a custom role\n\nTo delete a custom role first, use the `azure role show` command to determine the **Id** of the role. Then, use `azure role delete` command to delete the role by specifying the **Id**.\n\nThe following example removes the *Virtual Machine Operator* custom role.\n\n![](./media/role-based-access-control-manage-access-azure-cli/4-azure-role-delete.png)\n\n## List custom roles\n\nTo list the roles that are available for assignment at a scope, use the `azure role list` command.\n\nThe following example lists all role available for assignment in the selected subscription.\n\n![](./media/role-based-access-control-manage-access-azure-cli/5-azure-role-list1.png)\n\nIn the following example the *Virtual Machine Operator* custom role isn’t available in the *Production4* subscription because that subscription isn’t in the **AssignableScopes** of the role.\n\n![](./media/role-based-access-control-manage-access-azure-cli/5-azure-role-list2.png)\n\n\n\n\n\n## RBAC Topics\n[AZURE.INCLUDE [role-based-access-control-toc.md](../../includes/role-based-access-control-toc.md)]\n\n\n"
}