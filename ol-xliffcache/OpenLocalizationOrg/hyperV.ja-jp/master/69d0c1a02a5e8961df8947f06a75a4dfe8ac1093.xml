{
  "nodes": [
    {
      "content": "Auto scaling and App Service Environment",
      "pos": [
        28,
        68
      ]
    },
    {
      "content": "Auto scaling and App Service Environment",
      "pos": [
        88,
        128
      ]
    },
    {
      "content": "Auto scaling and App Service Environment",
      "pos": [
        440,
        480
      ]
    },
    {
      "content": "Introduction",
      "pos": [
        484,
        496
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>App Service environments<ept id=\"p1\">**</ept> support auto-scale.",
      "pos": [
        497,
        545
      ]
    },
    {
      "content": "This is achieved by allowing you to auto-scale individual",
      "pos": [
        546,
        603
      ]
    },
    {
      "content": "worker pools based on metrics or schedule.",
      "pos": [
        605,
        647
      ]
    },
    {
      "content": "Auto-scale allows you to optimize your resource utilization by automatically growing and shrinking an",
      "pos": [
        663,
        764
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>App Service environment<ept id=\"p1\">**</ept> to fit your budget and or load profile.",
      "pos": [
        766,
        833
      ]
    },
    {
      "content": "Configuring Worker Pool Auto-scale",
      "pos": [
        837,
        871
      ]
    },
    {
      "content": "You can access the auto-scale functionality from the settings tab of the <bpt id=\"p1\">**</bpt>worker pool<ept id=\"p1\">**</ept>.",
      "pos": [
        873,
        962
      ]
    },
    {
      "content": "From there the interface should be fairly familiar since this is the same experience as when scaling an",
      "pos": [
        987,
        1090
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>App Service plan<ept id=\"p1\">**</ept>.",
      "pos": [
        1092,
        1113
      ]
    },
    {
      "content": "You will be able to either enter a scale value manually",
      "pos": [
        1114,
        1169
      ]
    },
    {
      "content": "Or configure an auto-scale profile:",
      "pos": [
        1192,
        1227
      ]
    },
    {
      "content": "Auto-scale profiles are useful to set limits on your scale.",
      "pos": [
        1251,
        1310
      ]
    },
    {
      "content": "This way you can have both a consistent",
      "pos": [
        1311,
        1350
      ]
    },
    {
      "content": "performance experience by setting a lower bound scale value (1) and a predictable spend cap, by",
      "pos": [
        1352,
        1447
      ]
    },
    {
      "content": "setting an upper bound (2).",
      "pos": [
        1449,
        1476
      ]
    },
    {
      "content": "Once a profile is defined, metrics based auto-scale rules can be added to scale up or down the",
      "pos": [
        1502,
        1596
      ]
    },
    {
      "content": "number of instances in the <bpt id=\"p1\">**</bpt>worker pool<ept id=\"p1\">**</ept> within the bounds defined by the profile.",
      "pos": [
        1598,
        1682
      ]
    },
    {
      "content": "Any of the <bpt id=\"p1\">**</bpt>worker pool<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>front end<ept id=\"p2\">**</ept> metrics can be used for defining auto scale rules.",
      "pos": [
        1702,
        1796
      ]
    },
    {
      "content": "This are",
      "pos": [
        1797,
        1805
      ]
    },
    {
      "content": "the same metrics you can monitor in the resource blade graphs or set alerts for.",
      "pos": [
        1808,
        1888
      ]
    },
    {
      "content": "Auto-scale Example",
      "pos": [
        1893,
        1911
      ]
    },
    {
      "content": "Auto-scale of an <bpt id=\"p1\">**</bpt>App Service environment<ept id=\"p1\">**</ept> can best be illustrated by walking through a scenario.",
      "pos": [
        1912,
        2011
      ]
    },
    {
      "content": "In this article I will walk through all the considerations necessary when setting up auto-scale and",
      "pos": [
        2013,
        2112
      ]
    },
    {
      "content": "all the interaction that come into play when we factor in auto scaling <bpt id=\"p1\">**</bpt>App Service environments<ept id=\"p1\">**</ept> that",
      "pos": [
        2114,
        2218
      ]
    },
    {
      "content": "are hosted in an ASE.",
      "pos": [
        2220,
        2241
      ]
    },
    {
      "content": "Scenario Introduction",
      "pos": [
        2246,
        2267
      ]
    },
    {
      "content": "Frank is a SysAdmin for an enterprise, he has migrated a portion of the workloads he manages to an",
      "pos": [
        2268,
        2366
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>App Service environment<ept id=\"p1\">**</ept>.",
      "pos": [
        2368,
        2396
      ]
    },
    {
      "pos": [
        2398,
        2471
      ],
      "content": "The <bpt id=\"p1\">**</bpt>App Service environment<ept id=\"p1\">**</ept> is configured to manual scale as follows:"
    },
    {
      "content": "Front Ends: 3",
      "pos": [
        2474,
        2487
      ]
    },
    {
      "content": "Worker Pool 1: 10",
      "pos": [
        2490,
        2507
      ]
    },
    {
      "content": "Worker Pool 2: 5",
      "pos": [
        2510,
        2526
      ]
    },
    {
      "content": "Worker Pool 3: 5",
      "pos": [
        2529,
        2545
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>Worker pool 1<ept id=\"p1\">**</ept> is used for production workloads, while <bpt id=\"p2\">**</bpt>worker pool 2<ept id=\"p2\">**</ept> and <bpt id=\"p3\">**</bpt>worker pool 3<ept id=\"p3\">**</ept>",
      "pos": [
        2547,
        2644
      ]
    },
    {
      "content": "are used for QA and development workloads.",
      "pos": [
        2646,
        2688
      ]
    },
    {
      "content": "The <bpt id=\"p1\">**</bpt>App Service plans<ept id=\"p1\">**</ept> used for QA and Dev are configured for <bpt id=\"p2\">**</bpt>manual scale<ept id=\"p2\">**</ept> but the production",
      "pos": [
        2690,
        2790
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>App Service plan<ept id=\"p1\">**</ept> is set to <bpt id=\"p2\">**</bpt>auto-scale<ept id=\"p2\">**</ept> to deal with variations in load and traffic.",
      "pos": [
        2792,
        2882
      ]
    },
    {
      "content": "Frank is very familiar with the application and he knows that the peak hours for load are between",
      "pos": [
        2884,
        2981
      ]
    },
    {
      "content": "9:00am and 6:00pm since this is a <bpt id=\"p1\">**</bpt>LOB application<ept id=\"p1\">**</ept> and is used by employees while they are in",
      "pos": [
        2983,
        3079
      ]
    },
    {
      "content": "the office.",
      "pos": [
        3081,
        3092
      ]
    },
    {
      "content": "Usage drops after that, once users are done for that day.",
      "pos": [
        3093,
        3150
      ]
    },
    {
      "content": "But there is still some load",
      "pos": [
        3151,
        3179
      ]
    },
    {
      "content": "since users can access it remotely with either their mobile devices or home computers.",
      "pos": [
        3181,
        3267
      ]
    },
    {
      "content": "The production",
      "pos": [
        3268,
        3282
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>App Service plan<ept id=\"p1\">**</ept> is already configured to <bpt id=\"p2\">**</bpt>auto-scale<ept id=\"p2\">**</ept> based on CPU usage with the following",
      "pos": [
        3284,
        3382
      ]
    },
    {
      "content": "rules:",
      "pos": [
        3384,
        3390
      ]
    },
    {
      "content": "Auto-scale Profile – Weekdays – App Service Plan",
      "pos": [
        3414,
        3462
      ]
    },
    {
      "content": "Auto-scale Profile – Weekends – App Service Plan",
      "pos": [
        3474,
        3522
      ]
    },
    {
      "pos": [
        3656,
        3681
      ],
      "content": "<bpt id=\"p1\">**</bpt>Name:<ept id=\"p1\">**</ept> Weekday Profile"
    },
    {
      "pos": [
        3716,
        3741
      ],
      "content": "<bpt id=\"p1\">**</bpt>Name:<ept id=\"p1\">**</ept> Weekend Profile"
    },
    {
      "pos": [
        3778,
        3822
      ],
      "content": "<bpt id=\"p1\">**</bpt>Scale by:<ept id=\"p1\">**</ept> Schedule and performance rules"
    },
    {
      "pos": [
        3838,
        3882
      ],
      "content": "<bpt id=\"p1\">**</bpt>Scale by:<ept id=\"p1\">**</ept> Schedule and performance rules"
    },
    {
      "pos": [
        3900,
        3921
      ],
      "content": "<bpt id=\"p1\">**</bpt>Profile:<ept id=\"p1\">**</ept> Weekdays"
    },
    {
      "pos": [
        3960,
        3980
      ],
      "content": "<bpt id=\"p1\">**</bpt>Profile:<ept id=\"p1\">**</ept> Weekend"
    },
    {
      "pos": [
        4022,
        4042
      ],
      "content": "<bpt id=\"p1\">**</bpt>Type:<ept id=\"p1\">**</ept> recurrence"
    },
    {
      "pos": [
        4082,
        4102
      ],
      "content": "<bpt id=\"p1\">**</bpt>Type:<ept id=\"p1\">**</ept> recurrence"
    },
    {
      "pos": [
        4144,
        4179
      ],
      "content": "<bpt id=\"p1\">**</bpt>Target Range:<ept id=\"p1\">**</ept> 5 to 20 instances"
    },
    {
      "pos": [
        4204,
        4239
      ],
      "content": "<bpt id=\"p1\">**</bpt>Target Range:<ept id=\"p1\">**</ept> 3 to 10 instances"
    },
    {
      "pos": [
        4266,
        4320
      ],
      "content": "<bpt id=\"p1\">**</bpt>Days:<ept id=\"p1\">**</ept> Monday, Tuesday, Wednesday, Thursday, Friday"
    },
    {
      "pos": [
        4326,
        4352
      ],
      "content": "<bpt id=\"p1\">**</bpt>Days:<ept id=\"p1\">**</ept> Saturday, Sunday"
    },
    {
      "pos": [
        4388,
        4410
      ],
      "content": "<bpt id=\"p1\">**</bpt>Start Time:<ept id=\"p1\">**</ept> 9:00AM"
    },
    {
      "pos": [
        4448,
        4470
      ],
      "content": "<bpt id=\"p1\">**</bpt>Start Time:<ept id=\"p1\">**</ept> 9:00AM"
    },
    {
      "pos": [
        4510,
        4533
      ],
      "content": "<bpt id=\"p1\">**</bpt>Time zone:<ept id=\"p1\">**</ept> UTC – 08"
    },
    {
      "pos": [
        4570,
        4593
      ],
      "content": "<bpt id=\"p1\">**</bpt>Time zone:<ept id=\"p1\">**</ept> UTC – 08"
    },
    {
      "content": "Auto-scale Rule (Scale UP)",
      "pos": [
        4756,
        4782
      ]
    },
    {
      "content": "Auto-scale Rule (Scale UP)",
      "pos": [
        4816,
        4842
      ]
    },
    {
      "pos": [
        4876,
        4926
      ],
      "content": "<bpt id=\"p1\">**</bpt>Resource:<ept id=\"p1\">**</ept> Production (App Service Environment)"
    },
    {
      "pos": [
        4936,
        4986
      ],
      "content": "<bpt id=\"p1\">**</bpt>Resource:<ept id=\"p1\">**</ept> Production (App Service Environment)"
    },
    {
      "pos": [
        4998,
        5015
      ],
      "content": "<bpt id=\"p1\">**</bpt>Metric:<ept id=\"p1\">**</ept> CPU %"
    },
    {
      "pos": [
        5058,
        5075
      ],
      "content": "<bpt id=\"p1\">**</bpt>Metric:<ept id=\"p1\">**</ept> CPU %"
    },
    {
      "pos": [
        5120,
        5151
      ],
      "content": "<bpt id=\"p1\">**</bpt>Operation:<ept id=\"p1\">**</ept> Greater than 60%"
    },
    {
      "pos": [
        5180,
        5211
      ],
      "content": "<bpt id=\"p1\">**</bpt>Operation:<ept id=\"p1\">**</ept> Greater than 80%"
    },
    {
      "pos": [
        5242,
        5265
      ],
      "content": "<bpt id=\"p1\">**</bpt>Duration:<ept id=\"p1\">**</ept> 5 Minutes"
    },
    {
      "pos": [
        5302,
        5326
      ],
      "content": "<bpt id=\"p1\">**</bpt>Duration:<ept id=\"p1\">**</ept> 10 Minutes"
    },
    {
      "pos": [
        5364,
        5393
      ],
      "content": "<bpt id=\"p1\">**</bpt>Time Aggregation:<ept id=\"p1\">**</ept> Average"
    },
    {
      "pos": [
        5424,
        5453
      ],
      "content": "<bpt id=\"p1\">**</bpt>Time Aggregation:<ept id=\"p1\">**</ept> Average"
    },
    {
      "pos": [
        5486,
        5517
      ],
      "content": "<bpt id=\"p1\">**</bpt>Action:<ept id=\"p1\">**</ept> Increase count by 2"
    },
    {
      "pos": [
        5546,
        5577
      ],
      "content": "<bpt id=\"p1\">**</bpt>Action:<ept id=\"p1\">**</ept> Increase count by 1"
    },
    {
      "pos": [
        5608,
        5635
      ],
      "content": "<bpt id=\"p1\">**</bpt>Cool down (minutes):<ept id=\"p1\">**</ept> 15"
    },
    {
      "pos": [
        5668,
        5695
      ],
      "content": "<bpt id=\"p1\">**</bpt>Cool down (minutes):<ept id=\"p1\">**</ept> 20"
    },
    {
      "content": "Auto-scale Rule (Scale DOWN)",
      "pos": [
        5854,
        5882
      ]
    },
    {
      "content": "Auto-scale Rule (Scale DOWN)",
      "pos": [
        5914,
        5942
      ]
    },
    {
      "pos": [
        5974,
        6024
      ],
      "content": "<bpt id=\"p1\">**</bpt>Resource:<ept id=\"p1\">**</ept> Production (App Service Environment)"
    },
    {
      "pos": [
        6034,
        6084
      ],
      "content": "<bpt id=\"p1\">**</bpt>Resource:<ept id=\"p1\">**</ept> Production (App Service Environment)"
    },
    {
      "pos": [
        6096,
        6113
      ],
      "content": "<bpt id=\"p1\">**</bpt>Metric:<ept id=\"p1\">**</ept> CPU %"
    },
    {
      "pos": [
        6156,
        6173
      ],
      "content": "<bpt id=\"p1\">**</bpt>Metric:<ept id=\"p1\">**</ept> CPU %"
    },
    {
      "pos": [
        6218,
        6248
      ],
      "content": "<bpt id=\"p1\">**</bpt>Operation:<ept id=\"p1\">**</ept> Lesser than 30%"
    },
    {
      "pos": [
        6278,
        6308
      ],
      "content": "<bpt id=\"p1\">**</bpt>Operation:<ept id=\"p1\">**</ept> Lesser than 20%"
    },
    {
      "pos": [
        6340,
        6364
      ],
      "content": "<bpt id=\"p1\">**</bpt>Duration:<ept id=\"p1\">**</ept> 10 Minutes"
    },
    {
      "pos": [
        6400,
        6424
      ],
      "content": "<bpt id=\"p1\">**</bpt>Duration:<ept id=\"p1\">**</ept> 15 Minutes"
    },
    {
      "pos": [
        6462,
        6491
      ],
      "content": "<bpt id=\"p1\">**</bpt>Time Aggregation:<ept id=\"p1\">**</ept> Average"
    },
    {
      "pos": [
        6522,
        6551
      ],
      "content": "<bpt id=\"p1\">**</bpt>Time Aggregation:<ept id=\"p1\">**</ept> Average"
    },
    {
      "pos": [
        6584,
        6615
      ],
      "content": "<bpt id=\"p1\">**</bpt>Action:<ept id=\"p1\">**</ept> Decrease count by 1"
    },
    {
      "pos": [
        6644,
        6675
      ],
      "content": "<bpt id=\"p1\">**</bpt>Action:<ept id=\"p1\">**</ept> Decrease count by 1"
    },
    {
      "pos": [
        6706,
        6733
      ],
      "content": "<bpt id=\"p1\">**</bpt>Cool down (minutes):<ept id=\"p1\">**</ept> 20"
    },
    {
      "pos": [
        6766,
        6793
      ],
      "content": "<bpt id=\"p1\">**</bpt>Cool down (minutes):<ept id=\"p1\">**</ept> 10"
    },
    {
      "content": "App Service Plan Inflation Rate",
      "pos": [
        6828,
        6859
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>App Service plans<ept id=\"p1\">**</ept> that are configured to auto-scale, will do so at a maximum rate per hour.",
      "pos": [
        6860,
        6955
      ]
    },
    {
      "content": "This rate",
      "pos": [
        6956,
        6965
      ]
    },
    {
      "content": "can be calculated based on the values provided on the auto-scale rule.",
      "pos": [
        6967,
        7037
      ]
    },
    {
      "content": "Understanding and calculating the <bpt id=\"p1\">**</bpt>App Service plan Inflation Rate<ept id=\"p1\">**</ept> is important to",
      "pos": [
        7039,
        7124
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>App Service environment<ept id=\"p1\">**</ept> <bpt id=\"p2\">**</bpt>worker pool<ept id=\"p2\">**</ept> auto-scale since scale changes to a <bpt id=\"p3\">**</bpt>worker pool<ept id=\"p3\">**</ept> are",
      "pos": [
        7126,
        7225
      ]
    },
    {
      "content": "not instantaneous and do take some time to apply.",
      "pos": [
        7227,
        7276
      ]
    },
    {
      "pos": [
        7278,
        7343
      ],
      "content": "The <bpt id=\"p1\">**</bpt>App Service plan<ept id=\"p1\">**</ept> inflation rate is calculated as follows:"
    },
    {
      "content": "Based on the <bpt id=\"p1\">*</bpt>Auto-scale - Scale UP<ept id=\"p1\">*</ept> rule for the <bpt id=\"p2\">*</bpt>Weekday<ept id=\"p2\">*</ept> profile of the production",
      "pos": [
        7365,
        7450
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>App Service plan<ept id=\"p1\">**</ept> this would look as follows:",
      "pos": [
        7452,
        7500
      ]
    },
    {
      "content": "In the case of the <bpt id=\"p1\">*</bpt>Auto-scale – Scale UP<ept id=\"p1\">*</ept> rule for the <bpt id=\"p2\">*</bpt>Weekends<ept id=\"p2\">*</ept> profile of the production",
      "pos": [
        7518,
        7610
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>App Service plan<ept id=\"p1\">**</ept> the formula would resolve to:",
      "pos": [
        7612,
        7662
      ]
    },
    {
      "content": "This value can also be calculated for scale down operations:",
      "pos": [
        7680,
        7740
      ]
    },
    {
      "content": "Based on the <bpt id=\"p1\">*</bpt>Auto-scale - Scale Down<ept id=\"p1\">*</ept> rule for the <bpt id=\"p2\">*</bpt>Weekday<ept id=\"p2\">*</ept> profile of the production",
      "pos": [
        7742,
        7829
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>App Service plan<ept id=\"p1\">**</ept> this would look as follows:",
      "pos": [
        7831,
        7879
      ]
    },
    {
      "content": "In the case of the <bpt id=\"p1\">*</bpt>Auto-scale – Scale Down<ept id=\"p1\">*</ept> rule for the <bpt id=\"p2\">*</bpt>Weekends<ept id=\"p2\">*</ept> profile of the production",
      "pos": [
        7897,
        7991
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>App Service plan<ept id=\"p1\">**</ept> the formula would resolve to:",
      "pos": [
        7993,
        8043
      ]
    },
    {
      "content": "What this means is that the production <bpt id=\"p1\">**</bpt>App Service plan<ept id=\"p1\">**</ept> can grow at a maximum rate of <bpt id=\"p2\">**</bpt>8<ept id=\"p2\">**</ept>",
      "pos": [
        8063,
        8158
      ]
    },
    {
      "content": "instances per hour during the week and <bpt id=\"p1\">**</bpt>4<ept id=\"p1\">**</ept> instances per hour during the weekend.",
      "pos": [
        8160,
        8243
      ]
    },
    {
      "content": "And it can",
      "pos": [
        8244,
        8254
      ]
    },
    {
      "content": "release instances at a maximum rate of <bpt id=\"p1\">**</bpt>4<ept id=\"p1\">**</ept> instances per hour during the week and <bpt id=\"p2\">**</bpt>6<ept id=\"p2\">**</ept> instances",
      "pos": [
        8256,
        8355
      ]
    },
    {
      "content": "per hour during weekends.",
      "pos": [
        8357,
        8382
      ]
    },
    {
      "content": "If multiple <bpt id=\"p1\">**</bpt>App Service plans<ept id=\"p1\">**</ept> are being hosted in a <bpt id=\"p2\">**</bpt>worker pool<ept id=\"p2\">**</ept>, then the <bpt id=\"p3\">**</bpt>total inflation rate<ept id=\"p3\">**</ept>",
      "pos": [
        8384,
        8490
      ]
    },
    {
      "content": "needs to be calculated and this can be expresses as the <bpt id=\"p1\">*</bpt>sum<ept id=\"p1\">*</ept> of the inflation rate for all the",
      "pos": [
        8492,
        8587
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>App Service plans<ept id=\"p1\">**</ept> being hosting in that <bpt id=\"p2\">**</bpt>worker pool<ept id=\"p2\">**</ept>.",
      "pos": [
        8589,
        8649
      ]
    },
    {
      "content": "Using the App Service Plan Inflation rate to define worker pool auto-scale rules",
      "pos": [
        8681,
        8761
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>Worker pools<ept id=\"p1\">**</ept> that host <bpt id=\"p2\">**</bpt>App Service plans<ept id=\"p2\">**</ept> that are configured to auto-scale will need to",
      "pos": [
        8762,
        8857
      ]
    },
    {
      "content": "be allocate a buffer of capacity to allow for the auto-scale operations to grow/shrink the",
      "pos": [
        8859,
        8949
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>App Service plan<ept id=\"p1\">**</ept> as needed.",
      "pos": [
        8951,
        8982
      ]
    },
    {
      "content": "The minimum buffer would be the calculated",
      "pos": [
        8983,
        9025
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>Total App Service Plan Inflation Rate<ept id=\"p1\">**</ept>.",
      "pos": [
        9027,
        9069
      ]
    },
    {
      "content": "Since <bpt id=\"p1\">**</bpt>App Service environment<ept id=\"p1\">**</ept> scale operations take some time to apply, any change should account",
      "pos": [
        9071,
        9172
      ]
    },
    {
      "content": "for further demand changes that could happen while a scale operation is in progress.",
      "pos": [
        9174,
        9258
      ]
    },
    {
      "content": "For this we",
      "pos": [
        9259,
        9270
      ]
    },
    {
      "content": "recommend using the calculated <bpt id=\"p1\">**</bpt>Total App Service Plan Inflation Rate<ept id=\"p1\">**</ept> as the minimum number of",
      "pos": [
        9272,
        9369
      ]
    },
    {
      "content": "instances added for each auto-scale operation.",
      "pos": [
        9371,
        9417
      ]
    },
    {
      "content": "With this Information Frank can define the following Auto-scale Profile and Rules",
      "pos": [
        9419,
        9500
      ]
    },
    {
      "content": "Auto-scale Profile – Weekdays",
      "pos": [
        9532,
        9561
      ]
    },
    {
      "content": "Auto-scale Profile – Weekends",
      "pos": [
        9592,
        9621
      ]
    },
    {
      "pos": [
        9758,
        9783
      ],
      "content": "<bpt id=\"p1\">**</bpt>Name:<ept id=\"p1\">**</ept> Weekday Profile"
    },
    {
      "pos": [
        9818,
        9843
      ],
      "content": "<bpt id=\"p1\">**</bpt>Name:<ept id=\"p1\">**</ept> Weekend Profile"
    },
    {
      "pos": [
        9872,
        9916
      ],
      "content": "<bpt id=\"p1\">**</bpt>Scale by:<ept id=\"p1\">**</ept> Schedule and performance rules"
    },
    {
      "pos": [
        9932,
        9976
      ],
      "content": "<bpt id=\"p1\">**</bpt>Scale by:<ept id=\"p1\">**</ept> Schedule and performance rules"
    },
    {
      "pos": [
        9986,
        10007
      ],
      "content": "<bpt id=\"p1\">**</bpt>Profile:<ept id=\"p1\">**</ept> Weekdays"
    },
    {
      "pos": [
        10046,
        10066
      ],
      "content": "<bpt id=\"p1\">**</bpt>Profile:<ept id=\"p1\">**</ept> Weekend"
    },
    {
      "pos": [
        10100,
        10120
      ],
      "content": "<bpt id=\"p1\">**</bpt>Type:<ept id=\"p1\">**</ept> recurrence"
    },
    {
      "pos": [
        10160,
        10180
      ],
      "content": "<bpt id=\"p1\">**</bpt>Type:<ept id=\"p1\">**</ept> recurrence"
    },
    {
      "pos": [
        10214,
        10250
      ],
      "content": "<bpt id=\"p1\">**</bpt>Target Range:<ept id=\"p1\">**</ept> 13 to 25 instances"
    },
    {
      "pos": [
        10274,
        10309
      ],
      "content": "<bpt id=\"p1\">**</bpt>Target Range:<ept id=\"p1\">**</ept> 6 to 15 instances"
    },
    {
      "pos": [
        10328,
        10382
      ],
      "content": "<bpt id=\"p1\">**</bpt>Days:<ept id=\"p1\">**</ept> Monday, Tuesday, Wednesday, Thursday, Friday"
    },
    {
      "pos": [
        10388,
        10414
      ],
      "content": "<bpt id=\"p1\">**</bpt>Days:<ept id=\"p1\">**</ept> Saturday, Sunday"
    },
    {
      "pos": [
        10442,
        10464
      ],
      "content": "<bpt id=\"p1\">**</bpt>Start Time:<ept id=\"p1\">**</ept> 7:00AM"
    },
    {
      "pos": [
        10502,
        10524
      ],
      "content": "<bpt id=\"p1\">**</bpt>Start Time:<ept id=\"p1\">**</ept> 9:00AM"
    },
    {
      "pos": [
        10556,
        10579
      ],
      "content": "<bpt id=\"p1\">**</bpt>Time zone:<ept id=\"p1\">**</ept> UTC – 08"
    },
    {
      "pos": [
        10616,
        10639
      ],
      "content": "<bpt id=\"p1\">**</bpt>Time zone:<ept id=\"p1\">**</ept> UTC – 08"
    },
    {
      "content": "Auto-scale Rule (Scale UP)",
      "pos": [
        10786,
        10812
      ]
    },
    {
      "content": "Auto-scale Rule (Scale UP)",
      "pos": [
        10846,
        10872
      ]
    },
    {
      "pos": [
        10898,
        10925
      ],
      "content": "<bpt id=\"p1\">**</bpt>Resource:<ept id=\"p1\">**</ept> Worker Pool 1"
    },
    {
      "pos": [
        10958,
        10985
      ],
      "content": "<bpt id=\"p1\">**</bpt>Resource:<ept id=\"p1\">**</ept> Worker Pool 1"
    },
    {
      "pos": [
        11012,
        11040
      ],
      "content": "<bpt id=\"p1\">**</bpt>Metric:<ept id=\"p1\">**</ept> WorkersAvailable"
    },
    {
      "pos": [
        11072,
        11100
      ],
      "content": "<bpt id=\"p1\">**</bpt>Metric:<ept id=\"p1\">**</ept> WorkersAvailable"
    },
    {
      "pos": [
        11126,
        11152
      ],
      "content": "<bpt id=\"p1\">**</bpt>Operation:<ept id=\"p1\">**</ept> Less than 8"
    },
    {
      "pos": [
        11186,
        11212
      ],
      "content": "<bpt id=\"p1\">**</bpt>Operation:<ept id=\"p1\">**</ept> Less than 3"
    },
    {
      "pos": [
        11240,
        11264
      ],
      "content": "<bpt id=\"p1\">**</bpt>Duration:<ept id=\"p1\">**</ept> 20 Minutes"
    },
    {
      "pos": [
        11300,
        11324
      ],
      "content": "<bpt id=\"p1\">**</bpt>Duration:<ept id=\"p1\">**</ept> 30 Minutes"
    },
    {
      "pos": [
        11354,
        11383
      ],
      "content": "<bpt id=\"p1\">**</bpt>Time Aggregation:<ept id=\"p1\">**</ept> Average"
    },
    {
      "pos": [
        11414,
        11443
      ],
      "content": "<bpt id=\"p1\">**</bpt>Time Aggregation:<ept id=\"p1\">**</ept> Average"
    },
    {
      "pos": [
        11468,
        11499
      ],
      "content": "<bpt id=\"p1\">**</bpt>Action:<ept id=\"p1\">**</ept> Increase count by 8"
    },
    {
      "pos": [
        11528,
        11559
      ],
      "content": "<bpt id=\"p1\">**</bpt>Action:<ept id=\"p1\">**</ept> Increase count by 3"
    },
    {
      "pos": [
        11582,
        11609
      ],
      "content": "<bpt id=\"p1\">**</bpt>Cool down (minutes):<ept id=\"p1\">**</ept> 90"
    },
    {
      "pos": [
        11642,
        11669
      ],
      "content": "<bpt id=\"p1\">**</bpt>Cool down (minutes):<ept id=\"p1\">**</ept> 90"
    },
    {
      "content": "Auto-scale Rule (Scale DOWN)",
      "pos": [
        11812,
        11840
      ]
    },
    {
      "content": "Auto-scale Rule (Scale DOWN)",
      "pos": [
        11872,
        11900
      ]
    },
    {
      "pos": [
        11924,
        11951
      ],
      "content": "<bpt id=\"p1\">**</bpt>Resource:<ept id=\"p1\">**</ept> Worker Pool 1"
    },
    {
      "pos": [
        11984,
        12011
      ],
      "content": "<bpt id=\"p1\">**</bpt>Resource:<ept id=\"p1\">**</ept> Worker Pool 1"
    },
    {
      "pos": [
        12038,
        12066
      ],
      "content": "<bpt id=\"p1\">**</bpt>Metric:<ept id=\"p1\">**</ept> WorkersAvailable"
    },
    {
      "pos": [
        12098,
        12126
      ],
      "content": "<bpt id=\"p1\">**</bpt>Metric:<ept id=\"p1\">**</ept> WorkersAvailable"
    },
    {
      "pos": [
        12152,
        12181
      ],
      "content": "<bpt id=\"p1\">**</bpt>Operation:<ept id=\"p1\">**</ept> Greater than 8"
    },
    {
      "pos": [
        12212,
        12238
      ],
      "content": "<bpt id=\"p1\">**</bpt>Operation:<ept id=\"p1\">**</ept> Less than 3"
    },
    {
      "pos": [
        12266,
        12290
      ],
      "content": "<bpt id=\"p1\">**</bpt>Duration:<ept id=\"p1\">**</ept> 20 Minutes"
    },
    {
      "pos": [
        12326,
        12350
      ],
      "content": "<bpt id=\"p1\">**</bpt>Duration:<ept id=\"p1\">**</ept> 15 Minutes"
    },
    {
      "pos": [
        12380,
        12409
      ],
      "content": "<bpt id=\"p1\">**</bpt>Time Aggregation:<ept id=\"p1\">**</ept> Average"
    },
    {
      "pos": [
        12440,
        12469
      ],
      "content": "<bpt id=\"p1\">**</bpt>Time Aggregation:<ept id=\"p1\">**</ept> Average"
    },
    {
      "pos": [
        12494,
        12525
      ],
      "content": "<bpt id=\"p1\">**</bpt>Action:<ept id=\"p1\">**</ept> Decrease count by 2"
    },
    {
      "pos": [
        12554,
        12585
      ],
      "content": "<bpt id=\"p1\">**</bpt>Action:<ept id=\"p1\">**</ept> Decrease count by 3"
    },
    {
      "pos": [
        12608,
        12635
      ],
      "content": "<bpt id=\"p1\">**</bpt>Cool down (minutes):<ept id=\"p1\">**</ept> 90"
    },
    {
      "pos": [
        12668,
        12695
      ],
      "content": "<bpt id=\"p1\">**</bpt>Cool down (minutes):<ept id=\"p1\">**</ept> 90"
    },
    {
      "content": "The Target range defined in the profile is calculated by the minimum instances defined in the",
      "pos": [
        12719,
        12812
      ]
    },
    {
      "content": "Profile for the <bpt id=\"p1\">**</bpt>App Service plan<ept id=\"p1\">**</ept> + buffer.",
      "pos": [
        12814,
        12860
      ]
    },
    {
      "content": "The Maximum range would be the sum of all the maximum ranges for all <bpt id=\"p1\">**</bpt>App Service plans<ept id=\"p1\">**</ept> hosted in",
      "pos": [
        12862,
        12962
      ]
    },
    {
      "content": "the <bpt id=\"p1\">**</bpt>worker pool<ept id=\"p1\">**</ept>.",
      "pos": [
        12964,
        12984
      ]
    },
    {
      "content": "The Increase count for the scale up rules should be set to be at least 1X the",
      "pos": [
        12986,
        13063
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>App Service Plan Inflation Rate<ept id=\"p1\">**</ept> for scale up.",
      "pos": [
        13065,
        13114
      ]
    },
    {
      "pos": [
        13116,
        13235
      ],
      "content": "Decrease count can be adjusted to something between 1/2X or 1X the <bpt id=\"p1\">**</bpt>App Service Plan Inflation \nRate<ept id=\"p1\">**</ept> for scale down."
    },
    {
      "content": "Auto-scale for Front End Pool",
      "pos": [
        13240,
        13269
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>Front end<ept id=\"p1\">**</ept> auto-scale rules are simpler than for <bpt id=\"p2\">**</bpt>worker pools<ept id=\"p2\">**</ept>, the main things to look for is to",
      "pos": [
        13270,
        13373
      ]
    },
    {
      "content": "make sure duration of the measurement and the cooldown timers take into consideration the fact that scale",
      "pos": [
        13375,
        13480
      ]
    },
    {
      "content": "operations on an <bpt id=\"p1\">**</bpt>App Service plan<ept id=\"p1\">**</ept> are not instantaneous.",
      "pos": [
        13482,
        13542
      ]
    },
    {
      "content": "For this scenario, Frank knows that the error rate increases once front ends reach 80% CPU utilization,",
      "pos": [
        13544,
        13647
      ]
    },
    {
      "content": "to prevent this he sets the auto-scale rule to increase instances as follows:",
      "pos": [
        13649,
        13726
      ]
    },
    {
      "content": "Auto-scale Profile – Front Ends",
      "pos": [
        13759,
        13790
      ]
    },
    {
      "pos": [
        13865,
        13898
      ],
      "content": "<bpt id=\"p1\">**</bpt>Name:<ept id=\"p1\">**</ept> Auto-scale – Front Ends"
    },
    {
      "pos": [
        13919,
        13963
      ],
      "content": "<bpt id=\"p1\">**</bpt>Scale by:<ept id=\"p1\">**</ept> Schedule and performance rules"
    },
    {
      "pos": [
        13973,
        13994
      ],
      "content": "<bpt id=\"p1\">**</bpt>Profile:<ept id=\"p1\">**</ept> Everyday"
    },
    {
      "pos": [
        14027,
        14047
      ],
      "content": "<bpt id=\"p1\">**</bpt>Type:<ept id=\"p1\">**</ept> recurrence"
    },
    {
      "pos": [
        14081,
        14116
      ],
      "content": "<bpt id=\"p1\">**</bpt>Target Range:<ept id=\"p1\">**</ept> 3 to 10 instances"
    },
    {
      "pos": [
        14135,
        14153
      ],
      "content": "<bpt id=\"p1\">**</bpt>Days:<ept id=\"p1\">**</ept> Everyday"
    },
    {
      "pos": [
        14189,
        14211
      ],
      "content": "<bpt id=\"p1\">**</bpt>Start Time:<ept id=\"p1\">**</ept> 9:00AM"
    },
    {
      "pos": [
        14243,
        14266
      ],
      "content": "<bpt id=\"p1\">**</bpt>Time zone:<ept id=\"p1\">**</ept> UTC – 08"
    },
    {
      "content": "Auto-scale Rule (Scale UP)",
      "pos": [
        14353,
        14379
      ]
    },
    {
      "pos": [
        14405,
        14433
      ],
      "content": "<bpt id=\"p1\">**</bpt>Resource:<ept id=\"p1\">**</ept> Front End Pool"
    },
    {
      "pos": [
        14459,
        14476
      ],
      "content": "<bpt id=\"p1\">**</bpt>Metric:<ept id=\"p1\">**</ept> CPU %"
    },
    {
      "pos": [
        14513,
        14544
      ],
      "content": "<bpt id=\"p1\">**</bpt>Operation:<ept id=\"p1\">**</ept> Greater than 60%"
    },
    {
      "pos": [
        14567,
        14591
      ],
      "content": "<bpt id=\"p1\">**</bpt>Duration:<ept id=\"p1\">**</ept> 20 Minutes"
    },
    {
      "pos": [
        14621,
        14650
      ],
      "content": "<bpt id=\"p1\">**</bpt>Time Aggregation:<ept id=\"p1\">**</ept> Average"
    },
    {
      "pos": [
        14675,
        14706
      ],
      "content": "<bpt id=\"p1\">**</bpt>Action:<ept id=\"p1\">**</ept> Increase count by 3"
    },
    {
      "pos": [
        14729,
        14756
      ],
      "content": "<bpt id=\"p1\">**</bpt>Cool down (minutes):<ept id=\"p1\">**</ept> 90"
    },
    {
      "content": "Auto-scale Rule (Scale DOWN)",
      "pos": [
        14839,
        14867
      ]
    },
    {
      "pos": [
        14891,
        14918
      ],
      "content": "<bpt id=\"p1\">**</bpt>Resource:<ept id=\"p1\">**</ept> Worker Pool 1"
    },
    {
      "pos": [
        14945,
        14962
      ],
      "content": "<bpt id=\"p1\">**</bpt>Metric:<ept id=\"p1\">**</ept> CPU %"
    },
    {
      "pos": [
        14999,
        15029
      ],
      "content": "<bpt id=\"p1\">**</bpt>Operation:<ept id=\"p1\">**</ept> Lesser than 30%"
    },
    {
      "pos": [
        15053,
        15077
      ],
      "content": "<bpt id=\"p1\">**</bpt>Duration:<ept id=\"p1\">**</ept> 20 Minutes"
    },
    {
      "pos": [
        15107,
        15136
      ],
      "content": "<bpt id=\"p1\">**</bpt>Time Aggregation:<ept id=\"p1\">**</ept> Average"
    },
    {
      "pos": [
        15161,
        15192
      ],
      "content": "<bpt id=\"p1\">**</bpt>Action:<ept id=\"p1\">**</ept> Decrease count by 3"
    },
    {
      "pos": [
        15215,
        15242
      ],
      "content": "<bpt id=\"p1\">**</bpt>Cool down (minutes):<ept id=\"p1\">**</ept> 90"
    }
  ],
  "content": "<properties \n    pageTitle=\"Auto scaling and App Service Environment\" \n    description=\"Auto scaling and App Service Environment\" \n    services=\"app-service\"\n    documentationCenter=\"\"\n    authors=\"btardif\" \n    manager=\"wpickett\" \n    editor=\"\" \n/>\n\n<tags \n    ms.service=\"app-service\" \n    ms.workload=\"web\" \n    ms.tgt_pltfrm=\"na\" \n    ms.devlang=\"na\" \n    ms.topic=\"article\" \n    ms.date=\"10/09/2015\" \n    ms.author=\"byvinyal\"\n/>\n    \n#Auto scaling and App Service Environment\n\n##Introduction\n**App Service environments** support auto-scale. This is achieved by allowing you to auto-scale individual \nworker pools based on metrics or schedule.\n \n![][intro]\n \nAuto-scale allows you to optimize your resource utilization by automatically growing and shrinking an \n**App Service environment** to fit your budget and or load profile.\n\n##Configuring Worker Pool Auto-scale \nYou can access the auto-scale functionality from the settings tab of the **worker pool**. \n \n![][settings-scale]\n\nFrom there the interface should be fairly familiar since this is the same experience as when scaling an \n**App Service plan**. You will be able to either enter a scale value manually\n \n![][scale-manual]\n \nOr configure an auto-scale profile:\n \n![][scale-profile]\n \nAuto-scale profiles are useful to set limits on your scale. This way you can have both a consistent \nperformance experience by setting a lower bound scale value (1) and a predictable spend cap, by \nsetting an upper bound (2). \n \n![][scale-profile2]\n \nOnce a profile is defined, metrics based auto-scale rules can be added to scale up or down the \nnumber of instances in the **worker pool** within the bounds defined by the profile.\n\n![][scale-rule]\n\n Any of the **worker pool** or **front end** metrics can be used for defining auto scale rules. This are \n the same metrics you can monitor in the resource blade graphs or set alerts for.\n \n##Auto-scale Example\nAuto-scale of an **App Service environment** can best be illustrated by walking through a scenario. \nIn this article I will walk through all the considerations necessary when setting up auto-scale and \nall the interaction that come into play when we factor in auto scaling **App Service environments** that \nare hosted in an ASE.\n\n###Scenario Introduction\nFrank is a SysAdmin for an enterprise, he has migrated a portion of the workloads he manages to an \n**App Service environment**.\n\nThe **App Service environment** is configured to manual scale as follows:\n* Front Ends: 3\n* Worker Pool 1: 10\n* Worker Pool 2: 5\n* Worker Pool 3: 5\n\n**Worker pool 1** is used for production workloads, while **worker pool 2** and **worker pool 3** \nare used for QA and development workloads.\n\nThe **App Service plans** used for QA and Dev are configured for **manual scale** but the production \n**App Service plan** is set to **auto-scale** to deal with variations in load and traffic.\n\nFrank is very familiar with the application and he knows that the peak hours for load are between \n9:00am and 6:00pm since this is a **LOB application** and is used by employees while they are in \nthe office. Usage drops after that, once users are done for that day. But there is still some load \nsince users can access it remotely with either their mobile devices or home computers. The production \n**App Service plan** is already configured to **auto-scale** based on CPU usage with the following \nrules:\n\n![][asp-scale]\n\n|   **Auto-scale Profile – Weekdays – App Service Plan**    |   **Auto-scale Profile – Weekends – App Service Plan**    |\n|   ----------------------------------------------------    |   ----------------------------------------------------    |\n|   **Name:** Weekday Profile                               |   **Name:** Weekend Profile                               |\n|   **Scale by:** Schedule and performance rules            |   **Scale by:** Schedule and performance rules            |\n|   **Profile:** Weekdays                                   |   **Profile:** Weekend                                    |\n|   **Type:** recurrence                                    |   **Type:** recurrence                                    |\n|   **Target Range:** 5 to 20 instances                     |   **Target Range:** 3 to 10 instances                     |\n|   **Days:** Monday, Tuesday, Wednesday, Thursday, Friday  |   **Days:** Saturday, Sunday                              |\n|   **Start Time:** 9:00AM                                  |   **Start Time:** 9:00AM                                  |\n|   **Time zone:** UTC – 08                                 |   **Time zone:** UTC – 08                                 |\n|                                                           |                                                           |\n|   **Auto-scale Rule (Scale UP)**                          |   **Auto-scale Rule (Scale UP)**                          |\n|   **Resource:** Production (App Service Environment)      |   **Resource:** Production (App Service Environment)      |\n|   **Metric:** CPU %                                       |   **Metric:** CPU %                                       |\n|   **Operation:** Greater than 60%                         |   **Operation:** Greater than 80%                         |\n|   **Duration:** 5 Minutes                                 |   **Duration:** 10 Minutes                                |\n|   **Time Aggregation:** Average                           |   **Time Aggregation:** Average                           |\n|   **Action:** Increase count by 2                         |   **Action:** Increase count by 1                         |\n|   **Cool down (minutes):** 15                             |   **Cool down (minutes):** 20                             |\n|                                                           |                                                           |\n|   **Auto-scale Rule (Scale DOWN)**                        |   **Auto-scale Rule (Scale DOWN)**                        |\n|   **Resource:** Production (App Service Environment)      |   **Resource:** Production (App Service Environment)      |\n|   **Metric:** CPU %                                       |   **Metric:** CPU %                                       |\n|   **Operation:** Lesser than 30%                          |   **Operation:** Lesser than 20%                          |\n|   **Duration:** 10 Minutes                                |   **Duration:** 15 Minutes                                |\n|   **Time Aggregation:** Average                           |   **Time Aggregation:** Average                           |\n|   **Action:** Decrease count by 1                         |   **Action:** Decrease count by 1                         |\n|   **Cool down (minutes):** 20                             |   **Cool down (minutes):** 10                             |\n\n###App Service Plan Inflation Rate\n**App Service plans** that are configured to auto-scale, will do so at a maximum rate per hour. This rate \ncan be calculated based on the values provided on the auto-scale rule.\n\nUnderstanding and calculating the **App Service plan Inflation Rate** is important to \n**App Service environment** **worker pool** auto-scale since scale changes to a **worker pool** are \nnot instantaneous and do take some time to apply.\n\nThe **App Service plan** inflation rate is calculated as follows:\n\n![][ASP-Inflation]\n\nBased on the *Auto-scale - Scale UP* rule for the *Weekday* profile of the production \n**App Service plan** this would look as follows:\n\n![][Equation1]\n\nIn the case of the *Auto-scale – Scale UP* rule for the *Weekends* profile of the production \n**App Service plan** the formula would resolve to:\n\n![][Equation2]\n\nThis value can also be calculated for scale down operations:\n\nBased on the *Auto-scale - Scale Down* rule for the *Weekday* profile of the production \n**App Service plan** this would look as follows:\n\n![][Equation3]\n\nIn the case of the *Auto-scale – Scale Down* rule for the *Weekends* profile of the production \n**App Service plan** the formula would resolve to:  \n\n![][Equation4]\n\nWhat this means is that the production **App Service plan** can grow at a maximum rate of **8** \ninstances per hour during the week and **4** instances per hour during the weekend. And it can \nrelease instances at a maximum rate of **4** instances per hour during the week and **6** instances \nper hour during weekends.\n\nIf multiple **App Service plans** are being hosted in a **worker pool**, then the **total inflation rate** \nneeds to be calculated and this can be expresses as the *sum* of the inflation rate for all the \n**App Service plans** being hosting in that **worker pool**.\n\n![][ASP-Total-Inflation] \n\n###Using the App Service Plan Inflation rate to define worker pool auto-scale rules\n**Worker pools** that host **App Service plans** that are configured to auto-scale will need to \nbe allocate a buffer of capacity to allow for the auto-scale operations to grow/shrink the \n**App Service plan** as needed. The minimum buffer would be the calculated \n**Total App Service Plan Inflation Rate**.\n\nSince **App Service environment** scale operations take some time to apply, any change should account \nfor further demand changes that could happen while a scale operation is in progress. For this we \nrecommend using the calculated **Total App Service Plan Inflation Rate** as the minimum number of \ninstances added for each auto-scale operation.\n\nWith this Information Frank can define the following Auto-scale Profile and Rules\n\n![][Worker-Pool-Scale]\n\n|   **Auto-scale Profile – Weekdays**                       |   **Auto-scale Profile – Weekends**               |\n|   ----------------------------------------------------    |   --------------------------------------------    |\n|   **Name:** Weekday Profile                               |   **Name:** Weekend Profile                       |\n|   **Scale by:** Schedule and performance rules            |   **Scale by:** Schedule and performance rules    |\n|   **Profile:** Weekdays                                   |   **Profile:** Weekend                            |\n|   **Type:** recurrence                                    |   **Type:** recurrence                            |\n|   **Target Range:** 13 to 25 instances                    |   **Target Range:** 6 to 15 instances             |\n|   **Days:** Monday, Tuesday, Wednesday, Thursday, Friday  |   **Days:** Saturday, Sunday                      |\n|   **Start Time:** 7:00AM                                  |   **Start Time:** 9:00AM                          |\n|   **Time zone:** UTC – 08                                 |   **Time zone:** UTC – 08                         |\n|                                                           |                                                   |\n|   **Auto-scale Rule (Scale UP)**                          |   **Auto-scale Rule (Scale UP)**                  |\n|   **Resource:** Worker Pool 1                             |   **Resource:** Worker Pool 1                     |\n|   **Metric:** WorkersAvailable                            |   **Metric:** WorkersAvailable                    |\n|   **Operation:** Less than 8                              |   **Operation:** Less than 3                      |\n|   **Duration:** 20 Minutes                                |   **Duration:** 30 Minutes                        |\n|   **Time Aggregation:** Average                           |   **Time Aggregation:** Average                   |\n|   **Action:** Increase count by 8                         |   **Action:** Increase count by 3                 |\n|   **Cool down (minutes):** 90                             |   **Cool down (minutes):** 90                     |\n|                                                           |                                                   |\n|   **Auto-scale Rule (Scale DOWN)**                        |   **Auto-scale Rule (Scale DOWN)**                |\n|   **Resource:** Worker Pool 1                             |   **Resource:** Worker Pool 1                     |\n|   **Metric:** WorkersAvailable                            |   **Metric:** WorkersAvailable                    |\n|   **Operation:** Greater than 8                           |   **Operation:** Less than 3                      |\n|   **Duration:** 20 Minutes                                |   **Duration:** 15 Minutes                        |\n|   **Time Aggregation:** Average                           |   **Time Aggregation:** Average                   |\n|   **Action:** Decrease count by 2                         |   **Action:** Decrease count by 3                 |\n|   **Cool down (minutes):** 90                             |   **Cool down (minutes):** 90                     |\n\nThe Target range defined in the profile is calculated by the minimum instances defined in the \nProfile for the **App Service plan** + buffer.\n\nThe Maximum range would be the sum of all the maximum ranges for all **App Service plans** hosted in \nthe **worker pool**.\n\nThe Increase count for the scale up rules should be set to be at least 1X the \n**App Service Plan Inflation Rate** for scale up.\n\nDecrease count can be adjusted to something between 1/2X or 1X the **App Service Plan Inflation \nRate** for scale down.\n\n###Auto-scale for Front End Pool\n**Front end** auto-scale rules are simpler than for **worker pools**, the main things to look for is to \nmake sure duration of the measurement and the cooldown timers take into consideration the fact that scale \noperations on an **App Service plan** are not instantaneous.\n\nFor this scenario, Frank knows that the error rate increases once front ends reach 80% CPU utilization, \nto prevent this he sets the auto-scale rule to increase instances as follows:\n \n![][Front-End-Scale]\n  \n|   **Auto-scale Profile – Front Ends**             |\n|   --------------------------------------------    |\n|   **Name:** Auto-scale – Front Ends               |\n|   **Scale by:** Schedule and performance rules    |\n|   **Profile:** Everyday                           |\n|   **Type:** recurrence                            |\n|   **Target Range:** 3 to 10 instances             |\n|   **Days:** Everyday                              |\n|   **Start Time:** 9:00AM                          |\n|   **Time zone:** UTC – 08                         |\n|                                                   |\n|   **Auto-scale Rule (Scale UP)**                  |\n|   **Resource:** Front End Pool                    |\n|   **Metric:** CPU %                               |\n|   **Operation:** Greater than 60%                 |\n|   **Duration:** 20 Minutes                        |\n|   **Time Aggregation:** Average                   |\n|   **Action:** Increase count by 3                 |\n|   **Cool down (minutes):** 90                     |\n|                                                   |\n|   **Auto-scale Rule (Scale DOWN)**                |\n|   **Resource:** Worker Pool 1                     |\n|   **Metric:** CPU %                               |\n|   **Operation:** Lesser than 30%                  |\n|   **Duration:** 20 Minutes                        |\n|   **Time Aggregation:** Average                   |\n|   **Action:** Decrease count by 3                 |\n|   **Cool down (minutes):** 90                     |\n\n<!-- IMAGES -->\n[intro]: ./media/app-service-environment-auto-scale/introduction.png\n[settings-scale]: ./media/app-service-environment-auto-scale/settings-scale.png\n[scale-manual]: ./media/app-service-environment-auto-scale/scale-manual.png\n[scale-profile]: ./media/app-service-environment-auto-scale/scale-profile.png\n[scale-profile2]: ./media/app-service-environment-auto-scale/scale-profile-2.png\n[scale-rule]: ./media/app-service-environment-auto-scale/scale-rule.png\n[asp-scale]: ./media/app-service-environment-auto-scale/asp-scale.png\n[ASP-Inflation]: ./media/app-service-environment-auto-scale/asp-inflation-rate.png\n[Equation1]: ./media/app-service-environment-auto-scale/equation1.png\n[Equation2]: ./media/app-service-environment-auto-scale/equation2.png\n[Equation3]: ./media/app-service-environment-auto-scale/equation3.png\n[Equation4]: ./media/app-service-environment-auto-scale/equation4.png\n[ASP-Total-Inflation]: ./media/app-service-environment-auto-scale/asp-total-inflation-rate.png\n[Worker-Pool-Scale]: ./media/app-service-environment-auto-scale/wp-scale.png\n[Front-End-Scale]: ./media/app-service-environment-auto-scale/fe-scale.png\n\n\n"
}