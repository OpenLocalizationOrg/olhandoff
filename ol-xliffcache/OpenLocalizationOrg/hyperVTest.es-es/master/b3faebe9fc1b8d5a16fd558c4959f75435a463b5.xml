{
  "nodes": [
    {
      "pos": [
        27,
        102
      ],
      "content": "Step 4: Train and evaluate the predictive analytic models | Microsoft Azure"
    },
    {
      "pos": [
        121,
        254
      ],
      "content": "Step 4 of the Develop a predictive solution walkthrough: Train, score, and evaluate multiple models in Azure Machine Learning Studio."
    },
    {
      "pos": [
        580,
        649
      ],
      "content": "Walkthrough Step 4: Train and evaluate the predictive analytic models"
    },
    {
      "pos": [
        651,
        823
      ],
      "content": "This is the fourth step of the walkthrough, <bpt id=\"p1\">[</bpt>Develop a predictive analytics solution in Azure Machine Learning<ept id=\"p1\">](machine-learning-walkthrough-develop-predictive-solution.md)</ept>"
    },
    {
      "pos": [
        830,
        922
      ],
      "content": "<bpt id=\"p2\">[</bpt>Create a Machine Learning workspace<ept id=\"p2\">](machine-learning-walkthrough-1-create-ml-workspace.md)</ept>"
    },
    {
      "pos": [
        927,
        996
      ],
      "content": "<bpt id=\"p3\">[</bpt>Upload existing data<ept id=\"p3\">](machine-learning-walkthrough-2-upload-data.md)</ept>"
    },
    {
      "pos": [
        1001,
        1083
      ],
      "content": "<bpt id=\"p4\">[</bpt>Create a new experiment<ept id=\"p4\">](machine-learning-walkthrough-3-create-new-experiment.md)</ept>"
    },
    {
      "pos": [
        1088,
        1121
      ],
      "content": "<bpt id=\"p5\">**</bpt>Train and evaluate the models<ept id=\"p5\">**</ept>"
    },
    {
      "pos": [
        1126,
        1205
      ],
      "content": "<bpt id=\"p6\">[</bpt>Deploy the web service<ept id=\"p6\">](machine-learning-walkthrough-5-publish-web-service.md)</ept>"
    },
    {
      "pos": [
        1210,
        1288
      ],
      "content": "<bpt id=\"p7\">[</bpt>Access the web service<ept id=\"p7\">](machine-learning-walkthrough-6-access-web-service.md)</ept>"
    },
    {
      "pos": [
        1302,
        1579
      ],
      "content": "One of the benefits of using Azure Machine Learning Studio for creating machine learning models is the ability to try more than one type of model at a time in an experiment and compare the results. This type of experimentation helps you find the best solution for your problem.",
      "nodes": [
        {
          "content": "One of the benefits of using Azure Machine Learning Studio for creating machine learning models is the ability to try more than one type of model at a time in an experiment and compare the results.",
          "pos": [
            0,
            197
          ]
        },
        {
          "content": "This type of experimentation helps you find the best solution for your problem.",
          "pos": [
            198,
            277
          ]
        }
      ]
    },
    {
      "pos": [
        1581,
        1784
      ],
      "content": "In the experiment we're developing in this walkthrough, we'll create two different types of models and then compare their scoring results to decide which algorithm we want to use in our final experiment."
    },
    {
      "pos": [
        1788,
        2123
      ],
      "content": "There are a number of models we could choose from. To see the models available, expand the <bpt id=\"p8\">**</bpt>Machine Learning<ept id=\"p8\">**</ept><ph id=\"ph2\"/> node in the module palette, and then expand <bpt id=\"p9\">**</bpt>Initialize Model<ept id=\"p9\">**</ept><ph id=\"ph3\"/> and the nodes beneath it. For the purposes of this experiment, we'll select the Support Vector Machine (SVM) and the Two-Class Boosted Decision Trees modules.",
      "nodes": [
        {
          "content": "There are a number of models we could choose from.",
          "pos": [
            0,
            50
          ]
        },
        {
          "content": "To see the models available, expand the <bpt id=\"p8\">**</bpt>Machine Learning<ept id=\"p8\">**</ept><ph id=\"ph2\"/> node in the module palette, and then expand <bpt id=\"p9\">**</bpt>Initialize Model<ept id=\"p9\">**</ept><ph id=\"ph3\"/> and the nodes beneath it.",
          "pos": [
            51,
            306
          ]
        },
        {
          "content": "For the purposes of this experiment, we'll select the Support Vector Machine (SVM) and the Two-Class Boosted Decision Trees modules.",
          "pos": [
            307,
            439
          ]
        }
      ]
    },
    {
      "pos": [
        2131,
        2361
      ],
      "content": "<ph id=\"ph4\">[AZURE.TIP]</ph><ph id=\"ph5\"/> To get help deciding which Machine Learning algorithm best suits the particular problem you're trying to solve, see <bpt id=\"p10\">[</bpt>How to choose algorithms for Microsoft Azure Machine Learning<ept id=\"p10\">](machine-learning-algorithm-choice.md)</ept>."
    },
    {
      "pos": [
        2365,
        2381
      ],
      "content": "Train the models"
    },
    {
      "pos": [
        2382,
        2434
      ],
      "content": "First, let's set up the boosted decision tree model:"
    },
    {
      "pos": [
        2442,
        2575
      ],
      "content": "Find the [Two-Class Boosted Decision Tree][two-class-boosted-decision-tree] module in the module palette and drag it onto the canvas."
    },
    {
      "pos": [
        2580,
        2797
      ],
      "content": "Find the [Train Model][train-model] module, drag it onto the canvas, and then connect the output of the boosted decision tree module to the left input port (\"Untrained model\") of the [Train Model][train-model] module."
    },
    {
      "pos": [
        2807,
        2985
      ],
      "content": "The [Two-Class Boosted Decision Tree][two-class-boosted-decision-tree] module initializes the generic model, and [Train Model][train-model] uses training data to train the model."
    },
    {
      "pos": [
        2997,
        3173
      ],
      "content": "Connect the left output (\"Result Dataset\") of the left [Execute R Script][execute-r-script] module to the right input port (\"Dataset\") of the [Train Model][train-model] module."
    },
    {
      "pos": [
        3181,
        3395
      ],
      "content": "<ph id=\"ph6\">[AZURE.TIP]</ph><ph id=\"ph7\"/> We don't need two of the inputs and one of the outputs of the [Execute R Script][execute-r-script] module for this experiment, so we'll just leave them unattached. This is not uncommon for some modules.",
      "nodes": [
        {
          "content": "<ph id=\"ph6\">[AZURE.TIP]</ph><ph id=\"ph7\"/> We don't need two of the inputs and one of the outputs of the [Execute R Script][execute-r-script] module for this experiment, so we'll just leave them unattached.",
          "pos": [
            0,
            207
          ]
        },
        {
          "content": "This is not uncommon for some modules.",
          "pos": [
            208,
            246
          ]
        }
      ]
    },
    {
      "pos": [
        3401,
        3787
      ],
      "content": "Select the [Train Model][train-model] module. In the <bpt id=\"p11\">**</bpt>Properties<ept id=\"p11\">**</ept><ph id=\"ph8\"/> pane, click <bpt id=\"p12\">**</bpt>Launch column selector<ept id=\"p12\">**</ept>, select <bpt id=\"p13\">**</bpt>Include<ept id=\"p13\">**</ept><ph id=\"ph9\"/> in the first dropdown, select <bpt id=\"p14\">**</bpt>column names<ept id=\"p14\">**</ept><ph id=\"ph10\"/> in the second dropdown, and enter \"Credit risk\" in the text field (you can also select <bpt id=\"p15\">**</bpt>column indices<ept id=\"p15\">**</ept><ph id=\"ph11\"/> and enter \"21\"). This identifies column 21, the credit risk value, as the column for the model to predict.",
      "nodes": [
        {
          "content": "Select the [Train Model][train-model] module.",
          "pos": [
            0,
            45
          ]
        },
        {
          "content": "In the <bpt id=\"p11\">**</bpt>Properties<ept id=\"p11\">**</ept><ph id=\"ph8\"/> pane, click <bpt id=\"p12\">**</bpt>Launch column selector<ept id=\"p12\">**</ept>, select <bpt id=\"p13\">**</bpt>Include<ept id=\"p13\">**</ept><ph id=\"ph9\"/> in the first dropdown, select <bpt id=\"p14\">**</bpt>column names<ept id=\"p14\">**</ept><ph id=\"ph10\"/> in the second dropdown, and enter \"Credit risk\" in the text field (you can also select <bpt id=\"p15\">**</bpt>column indices<ept id=\"p15\">**</ept><ph id=\"ph11\"/> and enter \"21\").",
          "pos": [
            46,
            554
          ]
        },
        {
          "content": "This identifies column 21, the credit risk value, as the column for the model to predict.",
          "pos": [
            555,
            644
          ]
        }
      ]
    },
    {
      "pos": [
        3790,
        3851
      ],
      "content": "This portion of the experiment now looks something like this:"
    },
    {
      "pos": [
        3855,
        3877
      ],
      "content": "<ph id=\"ph12\">![</ph>Training a model<ph id=\"ph13\">][1]</ph>"
    },
    {
      "pos": [
        3879,
        3912
      ],
      "content": "Next, we'll set up the SVM model."
    },
    {
      "pos": [
        3916,
        4700
      ],
      "content": "First, a little explanation about SVM. Boosted decision trees work well with features of any type. However, since the SVM module generates a linear classifier, the model that it generates has the best test error when all numeric features have the same scale. So to convert all numeric features to the same scale, we'll use a \"Tanh\" transformation (with the [Normalize Data][normalize-data] module) which will transform our numbers into the [0,1] range (string features are converted by the SVM module to categorical features and then to binary 0/1 features, so we don't need to manually transform string features). Also, we don't want to transform the Credit Risk column (column 21) - it's numeric, but it's the value we're training the model to predict, so we need to leave it alone.",
      "nodes": [
        {
          "content": "First, a little explanation about SVM.",
          "pos": [
            0,
            38
          ]
        },
        {
          "content": "Boosted decision trees work well with features of any type.",
          "pos": [
            39,
            98
          ]
        },
        {
          "content": "However, since the SVM module generates a linear classifier, the model that it generates has the best test error when all numeric features have the same scale.",
          "pos": [
            99,
            258
          ]
        },
        {
          "content": "So to convert all numeric features to the same scale, we'll use a \"Tanh\" transformation (with the [Normalize Data][normalize-data] module) which will transform our numbers into the [0,1] range (string features are converted by the SVM module to categorical features and then to binary 0/1 features, so we don't need to manually transform string features).",
          "pos": [
            259,
            614
          ]
        },
        {
          "content": "Also, we don't want to transform the Credit Risk column (column 21) - it's numeric, but it's the value we're training the model to predict, so we need to leave it alone.",
          "pos": [
            615,
            784
          ]
        }
      ]
    },
    {
      "pos": [
        4704,
        4746
      ],
      "content": "To set up the SVM model, do the following:"
    },
    {
      "pos": [
        4752,
        4887
      ],
      "content": "Find the [Two-Class Support Vector Machine][two-class-support-vector-machine] module in the module palette and drag it onto the canvas."
    },
    {
      "pos": [
        4892,
        5120
      ],
      "content": "Right-click the [Train Model][train-model] module, select <bpt id=\"p16\">**</bpt>Copy<ept id=\"p16\">**</ept>, and then right-click the canvas and select <bpt id=\"p17\">**</bpt>Paste<ept id=\"p17\">**</ept>. Note that the copy of the [Train Model][train-model] module has the same column selection as the original.",
      "nodes": [
        {
          "content": "Right-click the [Train Model][train-model] module, select <bpt id=\"p16\">**</bpt>Copy<ept id=\"p16\">**</ept>, and then right-click the canvas and select <bpt id=\"p17\">**</bpt>Paste<ept id=\"p17\">**</ept>.",
          "pos": [
            0,
            201
          ]
        },
        {
          "content": "Note that the copy of the [Train Model][train-model] module has the same column selection as the original.",
          "pos": [
            202,
            308
          ]
        }
      ]
    },
    {
      "pos": [
        5125,
        5246
      ],
      "content": "Connect the output of the SVM module to the left input port (\"Untrained model\") of the [Train Model][train-model] module."
    },
    {
      "pos": [
        5251,
        5328
      ],
      "content": "Find the [Normalize Data][normalize-data] module and drag it onto the canvas."
    },
    {
      "pos": [
        5333,
        5528
      ],
      "content": "Connect the input of this module to the left output of the left [Execute R Script][execute-r-script] module (note that the output port of a module may be connected to more than one other module)."
    },
    {
      "pos": [
        5533,
        5710
      ],
      "content": "Connect the left output port (\"Transformed Dataset\") of the [Normalize Data][normalize-data] module to the right input port (\"Dataset\") of the [Train Model][train-model] module."
    },
    {
      "pos": [
        5715,
        5851
      ],
      "content": "In the <bpt id=\"p18\">**</bpt>Properties<ept id=\"p18\">**</ept><ph id=\"ph14\"/> pane for the [Normalize Data][normalize-data] module, select <bpt id=\"p19\">**</bpt>Tanh<ept id=\"p19\">**</ept><ph id=\"ph15\"/> for the <bpt id=\"p20\">**</bpt>Transformation method<ept id=\"p20\">**</ept><ph id=\"ph16\"/> parameter."
    },
    {
      "pos": [
        5856,
        6148
      ],
      "content": "Click <bpt id=\"p21\">**</bpt>Launch column selector<ept id=\"p21\">**</ept>, select \"No columns\" for <bpt id=\"p22\">**</bpt>Begin With<ept id=\"p22\">**</ept>, select <bpt id=\"p23\">**</bpt>Include<ept id=\"p23\">**</ept><ph id=\"ph17\"/> in the first dropdown, select <bpt id=\"p24\">**</bpt>column type<ept id=\"p24\">**</ept><ph id=\"ph18\"/> in the second dropdown, and select <bpt id=\"p25\">**</bpt>Numeric<ept id=\"p25\">**</ept><ph id=\"ph19\"/> in the third dropdown. This specifies that all the numeric columns (and only numeric) will be transformed.",
      "nodes": [
        {
          "content": "Click <bpt id=\"p21\">**</bpt>Launch column selector<ept id=\"p21\">**</ept>, select \"No columns\" for <bpt id=\"p22\">**</bpt>Begin With<ept id=\"p22\">**</ept>, select <bpt id=\"p23\">**</bpt>Include<ept id=\"p23\">**</ept><ph id=\"ph17\"/> in the first dropdown, select <bpt id=\"p24\">**</bpt>column type<ept id=\"p24\">**</ept><ph id=\"ph18\"/> in the second dropdown, and select <bpt id=\"p25\">**</bpt>Numeric<ept id=\"p25\">**</ept><ph id=\"ph19\"/> in the third dropdown.",
          "pos": [
            0,
            453
          ]
        },
        {
          "content": "This specifies that all the numeric columns (and only numeric) will be transformed.",
          "pos": [
            454,
            537
          ]
        }
      ]
    },
    {
      "pos": [
        6153,
        6571
      ],
      "content": "Click the plus sign (+) to the right of this row - this creates a new row of dropdowns. Select <bpt id=\"p26\">**</bpt>Exclude<ept id=\"p26\">**</ept><ph id=\"ph20\"/> in the first dropdown, select <bpt id=\"p27\">**</bpt>column names<ept id=\"p27\">**</ept><ph id=\"ph21\"/> in the second dropdown, and enter \"Credit risk\" in the text field (or select <bpt id=\"p28\">**</bpt>column indices<ept id=\"p28\">**</ept><ph id=\"ph22\"/> and enter \"21\"). This specifies that the Credit Risk column should be ignored (we need to do this because this column is numeric and so would otherwise be transformed).",
      "nodes": [
        {
          "content": "Click the plus sign (+) to the right of this row - this creates a new row of dropdowns.",
          "pos": [
            0,
            87
          ]
        },
        {
          "content": "Select <bpt id=\"p26\">**</bpt>Exclude<ept id=\"p26\">**</ept><ph id=\"ph20\"/> in the first dropdown, select <bpt id=\"p27\">**</bpt>column names<ept id=\"p27\">**</ept><ph id=\"ph21\"/> in the second dropdown, and enter \"Credit risk\" in the text field (or select <bpt id=\"p28\">**</bpt>column indices<ept id=\"p28\">**</ept><ph id=\"ph22\"/> and enter \"21\").",
          "pos": [
            88,
            431
          ]
        },
        {
          "content": "This specifies that the Credit Risk column should be ignored (we need to do this because this column is numeric and so would otherwise be transformed).",
          "pos": [
            432,
            583
          ]
        }
      ]
    },
    {
      "pos": [
        6576,
        6589
      ],
      "content": "Click <bpt id=\"p29\">**</bpt>OK<ept id=\"p29\">**</ept>."
    },
    {
      "pos": [
        6594,
        6739
      ],
      "content": "The [Normalize Data][normalize-data] module is now set to perform a Tanh transformation on all numeric columns except for the Credit Risk column."
    },
    {
      "pos": [
        6743,
        6810
      ],
      "content": "This portion of our experiment should now look something like this:"
    },
    {
      "pos": [
        6814,
        6845
      ],
      "content": "<ph id=\"ph23\">![</ph>Training the second model<ph id=\"ph24\">][2]</ph>"
    },
    {
      "pos": [
        6851,
        6880
      ],
      "content": "Score and evaluate the models"
    },
    {
      "pos": [
        6881,
        7082
      ],
      "content": "We'll use the testing data that was separated out by the [Split Data][split] module to score our trained models. We can then compare the results of the two models to see which generated better results.",
      "nodes": [
        {
          "content": "We'll use the testing data that was separated out by the [Split Data][split] module to score our trained models.",
          "pos": [
            0,
            112
          ]
        },
        {
          "content": "We can then compare the results of the two models to see which generated better results.",
          "pos": [
            113,
            201
          ]
        }
      ]
    },
    {
      "pos": [
        7090,
        7161
      ],
      "content": "Find the [Score Model][score-model] module and drag it onto the canvas."
    },
    {
      "pos": [
        7166,
        7424
      ],
      "content": "Connect the left input port of this module to the boosted decision tree model (that is, connect it to the output port of the [Train Model][train-model] module that's connected to the [Two-Class Boosted Decision Tree][two-class-boosted-decision-tree] module)."
    },
    {
      "pos": [
        7429,
        7575
      ],
      "content": "Connect the right input port of the [Score Model][score-model] module to the left output of the right [Execute R Script][execute-r-script] module."
    },
    {
      "pos": [
        7581,
        7811
      ],
      "content": "The [Score Model][score-model] module now can now take the credit information from the testing data, run it through the model, and compare the predictions the model generates with the actual credit risk column in the testing data."
    },
    {
      "pos": [
        7817,
        7932
      ],
      "content": "Copy and paste the [Score Model][score-model] module to create a second copy, or drag a new module onto the canvas."
    },
    {
      "pos": [
        7937,
        8176
      ],
      "content": "Connect the left input port of this module to the SVM model (that is, connect to the output port of the [Train Model][train-model] module that's connected to the [Two-Class Support Vector Machine][two-class-support-vector-machine] module)."
    },
    {
      "pos": [
        8181,
        8464
      ],
      "content": "For the SVM model, we have to do the same transformation to the test data as we did to the training data. So copy and paste the [Normalize Data][normalize-data] module to create a second copy and connect it to the left output of the right [Execute R Script][execute-r-script] module.",
      "nodes": [
        {
          "content": "For the SVM model, we have to do the same transformation to the test data as we did to the training data.",
          "pos": [
            0,
            105
          ]
        },
        {
          "content": "So copy and paste the [Normalize Data][normalize-data] module to create a second copy and connect it to the left output of the right [Execute R Script][execute-r-script] module.",
          "pos": [
            106,
            283
          ]
        }
      ]
    },
    {
      "pos": [
        8469,
        8605
      ],
      "content": "Connect the right input port of the [Score Model][score-model] module to the left output of the [Normalize Data][normalize-data] module."
    },
    {
      "pos": [
        8609,
        8699
      ],
      "content": "To evaluate the two scoring results we'll use the [Evaluate Model][evaluate-model] module."
    },
    {
      "pos": [
        8707,
        8784
      ],
      "content": "Find the [Evaluate Model][evaluate-model] module and drag it onto the canvas."
    },
    {
      "pos": [
        8789,
        8925
      ],
      "content": "Connect the left input port to the output port of the [Score Model][score-model] module associated with the boosted decision tree model."
    },
    {
      "pos": [
        8930,
        9006
      ],
      "content": "Connect the right input port to the other [Score Model][score-model] module."
    },
    {
      "pos": [
        9010,
        9313
      ],
      "content": "Click the <bpt id=\"p30\">**</bpt>RUN<ept id=\"p30\">**</ept><ph id=\"ph25\"/> button below the canvas to run the experiment. It may take a few minutes. You'll see a spinning indicator on each module to indicate that it's running, and then a green check mark when the module is finished. When all the modules have a check mark, the experiment has finished running.",
      "nodes": [
        {
          "content": "Click the <bpt id=\"p30\">**</bpt>RUN<ept id=\"p30\">**</ept><ph id=\"ph25\"/> button below the canvas to run the experiment.",
          "pos": [
            0,
            119
          ]
        },
        {
          "content": "It may take a few minutes.",
          "pos": [
            120,
            146
          ]
        },
        {
          "content": "You'll see a spinning indicator on each module to indicate that it's running, and then a green check mark when the module is finished.",
          "pos": [
            147,
            281
          ]
        },
        {
          "content": "When all the modules have a check mark, the experiment has finished running.",
          "pos": [
            282,
            358
          ]
        }
      ]
    },
    {
      "pos": [
        9315,
        9366
      ],
      "content": "The experiment should now look something like this:"
    },
    {
      "pos": [
        9370,
        9398
      ],
      "content": "<ph id=\"ph26\">![</ph>Evaluating both models<ph id=\"ph27\">][3]</ph>"
    },
    {
      "pos": [
        9400,
        9516
      ],
      "content": "To check the results, click the output port of the [Evaluate Model][evaluate-model] module and select <bpt id=\"p31\">**</bpt>Visualize<ept id=\"p31\">**</ept>."
    },
    {
      "pos": [
        9520,
        10022
      ],
      "content": "The [Evaluate Model][evaluate-model] module produces a pair of curves and metrics that allow you to compare the results of the two scored models. You can view the results as Receiver Operator Characteristic (ROC) curves, Precision/Recall curves, or Lift curves. Additional data displayed includes a confusion matrix, cumulative values for the area under the curve (AUC), and other metrics. You can change the threshold value by moving the slider left or right and see how it affects the set of metrics.",
      "nodes": [
        {
          "content": "The [Evaluate Model][evaluate-model] module produces a pair of curves and metrics that allow you to compare the results of the two scored models.",
          "pos": [
            0,
            145
          ]
        },
        {
          "content": "You can view the results as Receiver Operator Characteristic (ROC) curves, Precision/Recall curves, or Lift curves.",
          "pos": [
            146,
            261
          ]
        },
        {
          "content": "Additional data displayed includes a confusion matrix, cumulative values for the area under the curve (AUC), and other metrics.",
          "pos": [
            262,
            389
          ]
        },
        {
          "content": "You can change the threshold value by moving the slider left or right and see how it affects the set of metrics.",
          "pos": [
            390,
            502
          ]
        }
      ]
    },
    {
      "pos": [
        10026,
        10591
      ],
      "content": "To the right of the graph, click <bpt id=\"p32\">**</bpt>Scored dataset<ept id=\"p32\">**</ept><ph id=\"ph28\"/> or <bpt id=\"p33\">**</bpt>Scored dataset to compare<ept id=\"p33\">**</ept><ph id=\"ph29\"/> to highlight the associated curve and to display the associated metrics below. In the legend for the curves, \"Scored dataset\" corresponds to the left input port of the [Evaluate Model][evaluate-model] module - in our case, this is the boosted decision tree model. \"Scored dataset to compare\" corresponds to the right input port - the SVM model in our case. When you click one of these labels you will highlight the curve for that model and display the corresponding metrics below.",
      "nodes": [
        {
          "content": "To the right of the graph, click <bpt id=\"p32\">**</bpt>Scored dataset<ept id=\"p32\">**</ept><ph id=\"ph28\"/> or <bpt id=\"p33\">**</bpt>Scored dataset to compare<ept id=\"p33\">**</ept><ph id=\"ph29\"/> to highlight the associated curve and to display the associated metrics below.",
          "pos": [
            0,
            273
          ]
        },
        {
          "content": "In the legend for the curves, \"Scored dataset\" corresponds to the left input port of the [Evaluate Model][evaluate-model] module - in our case, this is the boosted decision tree model.",
          "pos": [
            274,
            458
          ]
        },
        {
          "content": "\"Scored dataset to compare\" corresponds to the right input port - the SVM model in our case.",
          "pos": [
            459,
            551
          ]
        },
        {
          "content": "When you click one of these labels you will highlight the curve for that model and display the corresponding metrics below.",
          "pos": [
            552,
            675
          ]
        }
      ]
    },
    {
      "pos": [
        10595,
        10622
      ],
      "content": "<ph id=\"ph30\">![</ph>ROC curves for models<ph id=\"ph31\">][4]</ph>"
    },
    {
      "pos": [
        10624,
        10824
      ],
      "content": "By examining these values you can decide which model is closest to giving you the results you're looking for. You can go back and iterate on your experiment by changing values in the different models.",
      "nodes": [
        {
          "content": "By examining these values you can decide which model is closest to giving you the results you're looking for.",
          "pos": [
            0,
            109
          ]
        },
        {
          "content": "You can go back and iterate on your experiment by changing values in the different models.",
          "pos": [
            110,
            200
          ]
        }
      ]
    },
    {
      "pos": [
        10829,
        11401
      ],
      "content": "<ph id=\"ph32\">[AZURE.TIP]</ph><ph id=\"ph33\"/> Each time you run the experiment a record of that iteration is kept in the Run History. You can view these iterations, and return to any of them, by clicking <bpt id=\"p34\">**</bpt>VIEW RUN HISTORY<ept id=\"p34\">**</ept><ph id=\"ph34\"/> below the canvas. You can also click <bpt id=\"p35\">**</bpt>Prior Run<ept id=\"p35\">**</ept><ph id=\"ph35\"/> in the <bpt id=\"p36\">**</bpt>Properties<ept id=\"p36\">**</ept><ph id=\"ph36\"/> pane to return to the iteration immediately preceding the one you have open.\nYou can make a copy of any iteration of your experiment by clicking <bpt id=\"p37\">**</bpt>SAVE AS<ept id=\"p37\">**</ept><ph id=\"ph37\"/> below the canvas. \n<ph id=\"ph38\"/>Use the experiment's <bpt id=\"p38\">**</bpt>Summary<ept id=\"p38\">**</ept><ph id=\"ph39\"/> and <bpt id=\"p39\">**</bpt>Description<ept id=\"p39\">**</ept><ph id=\"ph40\"/> properties to keep a record of what you've tried in your experiment iterations.",
      "nodes": [
        {
          "content": "<ph id=\"ph32\">[AZURE.TIP]</ph><ph id=\"ph33\"/> Each time you run the experiment a record of that iteration is kept in the Run History.",
          "pos": [
            0,
            133
          ]
        },
        {
          "content": "You can view these iterations, and return to any of them, by clicking <bpt id=\"p34\">**</bpt>VIEW RUN HISTORY<ept id=\"p34\">**</ept><ph id=\"ph34\"/> below the canvas.",
          "pos": [
            134,
            297
          ]
        },
        {
          "content": "You can also click <bpt id=\"p35\">**</bpt>Prior Run<ept id=\"p35\">**</ept><ph id=\"ph35\"/> in the <bpt id=\"p36\">**</bpt>Properties<ept id=\"p36\">**</ept><ph id=\"ph36\"/> pane to return to the iteration immediately preceding the one you have open.",
          "pos": [
            298,
            539
          ]
        },
        {
          "content": "You can make a copy of any iteration of your experiment by clicking <bpt id=\"p37\">**</bpt>SAVE AS<ept id=\"p37\">**</ept><ph id=\"ph37\"/> below the canvas.",
          "pos": [
            540,
            692
          ]
        },
        {
          "content": "<ph id=\"ph38\"/>Use the experiment's <bpt id=\"p38\">**</bpt>Summary<ept id=\"p38\">**</ept><ph id=\"ph39\"/> and <bpt id=\"p39\">**</bpt>Description<ept id=\"p39\">**</ept><ph id=\"ph40\"/> properties to keep a record of what you've tried in your experiment iterations.",
          "pos": [
            694,
            951
          ]
        }
      ]
    },
    {
      "pos": [
        11406,
        11542
      ],
      "content": "For more details, see <bpt id=\"p40\">[</bpt>Manage experiment iterations in Azure Machine Learning Studio<ept id=\"p40\">](machine-learning-manage-experiment-iterations.md)</ept>."
    },
    {
      "pos": [
        11559,
        11648
      ],
      "content": "<bpt id=\"p41\">**</bpt>Next: <bpt id=\"p42\">[</bpt>Deploy the web service<ept id=\"p42\">](machine-learning-walkthrough-5-publish-web-service.md)</ept><ept id=\"p41\">**</ept>"
    },
    {
      "pos": [
        12003,
        12800
      ],
      "content": "[evaluate-model]: https://msdn.microsoft.com/library/azure/927d65ac-3b50-4694-9903-20f6c1672089/\n[execute-r-script]: https://msdn.microsoft.com/library/azure/30806023-392b-42e0-94d6-6b775a6e0fd5/\n[normalize-data]: https://msdn.microsoft.com/library/azure/986df333-6748-4b85-923d-871df70d6aaf/\n[score-model]: https://msdn.microsoft.com/library/azure/401b4f92-e724-4d5a-be81-d5b0ff9bdb33/\n[train-model]: https://msdn.microsoft.com/library/azure/5cc7053e-aa30-450d-96c0-dae4be720977/\n[two-class-boosted-decision-tree]: https://msdn.microsoft.com/library/azure/e3c522f8-53d9-4829-8ea4-5c6a6b75330c/\n[two-class-support-vector-machine]: https://msdn.microsoft.com/library/azure/12d8479b-74b4-4e67-b8de-d32867380e20/\n[split]: https://msdn.microsoft.com/library/azure/70530644-c97a-4ab6-85f7-88bf30a8be5f/"
    }
  ],
  "content": "<properties\n    pageTitle=\"Step 4: Train and evaluate the predictive analytic models | Microsoft Azure\"\n    description=\"Step 4 of the Develop a predictive solution walkthrough: Train, score, and evaluate multiple models in Azure Machine Learning Studio.\"\n    services=\"machine-learning\"\n    documentationCenter=\"\"\n    authors=\"garyericson\"\n    manager=\"paulettm\"\n    editor=\"cgronlun\"/>\n\n<tags\n    ms.service=\"machine-learning\"\n    ms.workload=\"data-services\"\n    ms.tgt_pltfrm=\"na\"\n    ms.devlang=\"na\"\n    ms.topic=\"article\"\n    ms.date=\"02/03/2016\"\n    ms.author=\"garye\"/>\n\n\n# Walkthrough Step 4: Train and evaluate the predictive analytic models\n\nThis is the fourth step of the walkthrough, [Develop a predictive analytics solution in Azure Machine Learning](machine-learning-walkthrough-develop-predictive-solution.md)\n\n\n1.  [Create a Machine Learning workspace](machine-learning-walkthrough-1-create-ml-workspace.md)\n2.  [Upload existing data](machine-learning-walkthrough-2-upload-data.md)\n3.  [Create a new experiment](machine-learning-walkthrough-3-create-new-experiment.md)\n4.  **Train and evaluate the models**\n5.  [Deploy the web service](machine-learning-walkthrough-5-publish-web-service.md)\n6.  [Access the web service](machine-learning-walkthrough-6-access-web-service.md)\n\n----------\n\nOne of the benefits of using Azure Machine Learning Studio for creating machine learning models is the ability to try more than one type of model at a time in an experiment and compare the results. This type of experimentation helps you find the best solution for your problem.\n\nIn the experiment we're developing in this walkthrough, we'll create two different types of models and then compare their scoring results to decide which algorithm we want to use in our final experiment.  \n\nThere are a number of models we could choose from. To see the models available, expand the **Machine Learning** node in the module palette, and then expand **Initialize Model** and the nodes beneath it. For the purposes of this experiment, we'll select the Support Vector Machine (SVM) and the Two-Class Boosted Decision Trees modules.    \n\n> [AZURE.TIP] To get help deciding which Machine Learning algorithm best suits the particular problem you're trying to solve, see [How to choose algorithms for Microsoft Azure Machine Learning](machine-learning-algorithm-choice.md).\n\n##Train the models\nFirst, let's set up the boosted decision tree model:  \n\n1.  Find the [Two-Class Boosted Decision Tree][two-class-boosted-decision-tree] module in the module palette and drag it onto the canvas.\n2.  Find the [Train Model][train-model] module, drag it onto the canvas, and then connect the output of the boosted decision tree module to the left input port (\"Untrained model\") of the [Train Model][train-model] module.\n    \n    The [Two-Class Boosted Decision Tree][two-class-boosted-decision-tree] module initializes the generic model, and [Train Model][train-model] uses training data to train the model. \n     \n3.  Connect the left output (\"Result Dataset\") of the left [Execute R Script][execute-r-script] module to the right input port (\"Dataset\") of the [Train Model][train-model] module.\n\n    > [AZURE.TIP] We don't need two of the inputs and one of the outputs of the [Execute R Script][execute-r-script] module for this experiment, so we'll just leave them unattached. This is not uncommon for some modules.\n\n4.  Select the [Train Model][train-model] module. In the **Properties** pane, click **Launch column selector**, select **Include** in the first dropdown, select **column names** in the second dropdown, and enter \"Credit risk\" in the text field (you can also select **column indices** and enter \"21\"). This identifies column 21, the credit risk value, as the column for the model to predict.\n\n\nThis portion of the experiment now looks something like this:  \n\n![Training a model][1]\n\nNext, we'll set up the SVM model.  \n\nFirst, a little explanation about SVM. Boosted decision trees work well with features of any type. However, since the SVM module generates a linear classifier, the model that it generates has the best test error when all numeric features have the same scale. So to convert all numeric features to the same scale, we'll use a \"Tanh\" transformation (with the [Normalize Data][normalize-data] module) which will transform our numbers into the [0,1] range (string features are converted by the SVM module to categorical features and then to binary 0/1 features, so we don't need to manually transform string features). Also, we don't want to transform the Credit Risk column (column 21) - it's numeric, but it's the value we're training the model to predict, so we need to leave it alone.  \n\nTo set up the SVM model, do the following:\n\n1.  Find the [Two-Class Support Vector Machine][two-class-support-vector-machine] module in the module palette and drag it onto the canvas.\n2.  Right-click the [Train Model][train-model] module, select **Copy**, and then right-click the canvas and select **Paste**. Note that the copy of the [Train Model][train-model] module has the same column selection as the original.\n3.  Connect the output of the SVM module to the left input port (\"Untrained model\") of the [Train Model][train-model] module.\n4.  Find the [Normalize Data][normalize-data] module and drag it onto the canvas.\n5.  Connect the input of this module to the left output of the left [Execute R Script][execute-r-script] module (note that the output port of a module may be connected to more than one other module).\n6.  Connect the left output port (\"Transformed Dataset\") of the [Normalize Data][normalize-data] module to the right input port (\"Dataset\") of the [Train Model][train-model] module.\n7.  In the **Properties** pane for the [Normalize Data][normalize-data] module, select **Tanh** for the **Transformation method** parameter.\n8.  Click **Launch column selector**, select \"No columns\" for **Begin With**, select **Include** in the first dropdown, select **column type** in the second dropdown, and select **Numeric** in the third dropdown. This specifies that all the numeric columns (and only numeric) will be transformed.\n9.  Click the plus sign (+) to the right of this row - this creates a new row of dropdowns. Select **Exclude** in the first dropdown, select **column names** in the second dropdown, and enter \"Credit risk\" in the text field (or select **column indices** and enter \"21\"). This specifies that the Credit Risk column should be ignored (we need to do this because this column is numeric and so would otherwise be transformed).\n10. Click **OK**.  \n\n\nThe [Normalize Data][normalize-data] module is now set to perform a Tanh transformation on all numeric columns except for the Credit Risk column.  \n\nThis portion of our experiment should now look something like this:  \n\n![Training the second model][2]  \n\n##Score and evaluate the models\nWe'll use the testing data that was separated out by the [Split Data][split] module to score our trained models. We can then compare the results of the two models to see which generated better results.  \n\n1.  Find the [Score Model][score-model] module and drag it onto the canvas.\n2.  Connect the left input port of this module to the boosted decision tree model (that is, connect it to the output port of the [Train Model][train-model] module that's connected to the [Two-Class Boosted Decision Tree][two-class-boosted-decision-tree] module).\n3.  Connect the right input port of the [Score Model][score-model] module to the left output of the right [Execute R Script][execute-r-script] module.\n\n    The [Score Model][score-model] module now can now take the credit information from the testing data, run it through the model, and compare the predictions the model generates with the actual credit risk column in the testing data.\n\n4.  Copy and paste the [Score Model][score-model] module to create a second copy, or drag a new module onto the canvas.\n5.  Connect the left input port of this module to the SVM model (that is, connect to the output port of the [Train Model][train-model] module that's connected to the [Two-Class Support Vector Machine][two-class-support-vector-machine] module).\n6.  For the SVM model, we have to do the same transformation to the test data as we did to the training data. So copy and paste the [Normalize Data][normalize-data] module to create a second copy and connect it to the left output of the right [Execute R Script][execute-r-script] module.\n7.  Connect the right input port of the [Score Model][score-model] module to the left output of the [Normalize Data][normalize-data] module.  \n\nTo evaluate the two scoring results we'll use the [Evaluate Model][evaluate-model] module.  \n\n1.  Find the [Evaluate Model][evaluate-model] module and drag it onto the canvas.\n2.  Connect the left input port to the output port of the [Score Model][score-model] module associated with the boosted decision tree model.\n3.  Connect the right input port to the other [Score Model][score-model] module.  \n\nClick the **RUN** button below the canvas to run the experiment. It may take a few minutes. You'll see a spinning indicator on each module to indicate that it's running, and then a green check mark when the module is finished. When all the modules have a check mark, the experiment has finished running.\n\nThe experiment should now look something like this:  \n\n![Evaluating both models][3]\n\nTo check the results, click the output port of the [Evaluate Model][evaluate-model] module and select **Visualize**.  \n\nThe [Evaluate Model][evaluate-model] module produces a pair of curves and metrics that allow you to compare the results of the two scored models. You can view the results as Receiver Operator Characteristic (ROC) curves, Precision/Recall curves, or Lift curves. Additional data displayed includes a confusion matrix, cumulative values for the area under the curve (AUC), and other metrics. You can change the threshold value by moving the slider left or right and see how it affects the set of metrics.  \n\nTo the right of the graph, click **Scored dataset** or **Scored dataset to compare** to highlight the associated curve and to display the associated metrics below. In the legend for the curves, \"Scored dataset\" corresponds to the left input port of the [Evaluate Model][evaluate-model] module - in our case, this is the boosted decision tree model. \"Scored dataset to compare\" corresponds to the right input port - the SVM model in our case. When you click one of these labels you will highlight the curve for that model and display the corresponding metrics below.  \n\n![ROC curves for models][4]\n\nBy examining these values you can decide which model is closest to giving you the results you're looking for. You can go back and iterate on your experiment by changing values in the different models. \n\n> [AZURE.TIP] Each time you run the experiment a record of that iteration is kept in the Run History. You can view these iterations, and return to any of them, by clicking **VIEW RUN HISTORY** below the canvas. You can also click **Prior Run** in the **Properties** pane to return to the iteration immediately preceding the one you have open.\nYou can make a copy of any iteration of your experiment by clicking **SAVE AS** below the canvas. \nUse the experiment's **Summary** and **Description** properties to keep a record of what you've tried in your experiment iterations.\n\n>  For more details, see [Manage experiment iterations in Azure Machine Learning Studio](machine-learning-manage-experiment-iterations.md).  \n\n\n----------\n\n**Next: [Deploy the web service](machine-learning-walkthrough-5-publish-web-service.md)**\n\n[1]: ./media/machine-learning-walkthrough-4-train-and-evaluate-models/train1.png\n[2]: ./media/machine-learning-walkthrough-4-train-and-evaluate-models/train2.png\n[3]: ./media/machine-learning-walkthrough-4-train-and-evaluate-models/train3.png\n[4]: ./media/machine-learning-walkthrough-4-train-and-evaluate-models/train4.png\n\n\n<!-- Module References -->\n[evaluate-model]: https://msdn.microsoft.com/library/azure/927d65ac-3b50-4694-9903-20f6c1672089/\n[execute-r-script]: https://msdn.microsoft.com/library/azure/30806023-392b-42e0-94d6-6b775a6e0fd5/\n[normalize-data]: https://msdn.microsoft.com/library/azure/986df333-6748-4b85-923d-871df70d6aaf/\n[score-model]: https://msdn.microsoft.com/library/azure/401b4f92-e724-4d5a-be81-d5b0ff9bdb33/\n[train-model]: https://msdn.microsoft.com/library/azure/5cc7053e-aa30-450d-96c0-dae4be720977/\n[two-class-boosted-decision-tree]: https://msdn.microsoft.com/library/azure/e3c522f8-53d9-4829-8ea4-5c6a6b75330c/\n[two-class-support-vector-machine]: https://msdn.microsoft.com/library/azure/12d8479b-74b4-4e67-b8de-d32867380e20/\n[split]: https://msdn.microsoft.com/library/azure/70530644-c97a-4ab6-85f7-88bf30a8be5f/\n"
}