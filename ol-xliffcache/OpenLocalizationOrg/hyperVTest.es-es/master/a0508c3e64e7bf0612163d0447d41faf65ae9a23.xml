{
  "nodes": [
    {
      "pos": [
        27,
        94
      ],
      "content": "Consume a Machine Learning Web Service from Excel | Microsoft Azure"
    },
    {
      "pos": [
        113,
        169
      ],
      "content": "Consume an Azure Machine Learning Web Service from Excel"
    },
    {
      "pos": [
        495,
        553
      ],
      "content": "Consuming an Azure Machine Learning Web Service from Excel"
    },
    {
      "pos": [
        556,
        676
      ],
      "content": "Azure Machine Learning Studio makes it easy to call web services directly from Excel without the need to write any code."
    },
    {
      "pos": [
        679,
        886
      ],
      "content": "If you are running Excel 2013 (or later) or you can save a file on OneDrive or SharePoint for use with Excel Online, then the <bpt id=\"p1\">[</bpt>Excel add-in<ept id=\"p1\">](machine-learning-excel-add-in-for-web-services.md)</ept><ph id=\"ph2\"/> is recommended."
    },
    {
      "pos": [
        985,
        990
      ],
      "content": "Steps"
    },
    {
      "pos": [
        995,
        1253
      ],
      "content": "Publish a web service. <bpt id=\"p2\">[</bpt>This page<ept id=\"p2\">](machine-learning-walkthrough-5-publish-web-service.md)</ept><ph id=\"ph4\"/> explains how to do it. Currently the Excel workbook feature is only supported for Request/Response services that have a single output (that is, a single scoring label).",
      "nodes": [
        {
          "content": "Publish a web service.",
          "pos": [
            0,
            22
          ]
        },
        {
          "content": "<bpt id=\"p2\">[</bpt>This page<ept id=\"p2\">](machine-learning-walkthrough-5-publish-web-service.md)</ept><ph id=\"ph4\"/> explains how to do it.",
          "pos": [
            23,
            164
          ]
        },
        {
          "content": "Currently the Excel workbook feature is only supported for Request/Response services that have a single output (that is, a single scoring label).",
          "pos": [
            165,
            310
          ]
        }
      ]
    },
    {
      "pos": [
        1258,
        1406
      ],
      "content": "Once you have a web service, click on the <bpt id=\"p3\">**</bpt>WEB SERVICES<ept id=\"p3\">**</ept><ph id=\"ph5\"/> section on the left of the studio, and then select the web service to consume from Excel."
    },
    {
      "pos": [
        1411,
        1604
      ],
      "content": "On the <bpt id=\"p4\">**</bpt>DASHBOARD<ept id=\"p4\">**</ept><ph id=\"ph6\"/> tab for the web service is a row for the <bpt id=\"p5\">**</bpt>REQUEST/RESPONSE<ept id=\"p5\">**</ept><ph id=\"ph7\"/> service. If this service had a single output, you should see the <bpt id=\"p6\">**</bpt>Download Excel Workbook<ept id=\"p6\">**</ept><ph id=\"ph8\"/> link in that row.",
      "nodes": [
        {
          "content": "On the <bpt id=\"p4\">**</bpt>DASHBOARD<ept id=\"p4\">**</ept><ph id=\"ph6\"/> tab for the web service is a row for the <bpt id=\"p5\">**</bpt>REQUEST/RESPONSE<ept id=\"p5\">**</ept><ph id=\"ph7\"/> service.",
          "pos": [
            0,
            195
          ]
        },
        {
          "content": "If this service had a single output, you should see the <bpt id=\"p6\">**</bpt>Download Excel Workbook<ept id=\"p6\">**</ept><ph id=\"ph8\"/> link in that row.",
          "pos": [
            196,
            349
          ]
        }
      ]
    },
    {
      "pos": [
        1621,
        1680
      ],
      "content": "Click on <bpt id=\"p7\">**</bpt>Download Excel Workbook<ept id=\"p7\">**</ept>, and open it in Excel."
    },
    {
      "pos": [
        1685,
        1752
      ],
      "content": "A Security Warning appears; click on the <bpt id=\"p8\">**</bpt>Enable Editing<ept id=\"p8\">**</ept><ph id=\"ph10\"/> button."
    },
    {
      "pos": [
        1769,
        1870
      ],
      "content": "A Security Warning appears. Click on the <bpt id=\"p9\">**</bpt>Enable Content<ept id=\"p9\">**</ept><ph id=\"ph12\"/> button to run macros on your spreadsheet.",
      "nodes": [
        {
          "content": "A Security Warning appears.",
          "pos": [
            0,
            27
          ]
        },
        {
          "content": "Click on the <bpt id=\"p9\">**</bpt>Enable Content<ept id=\"p9\">**</ept><ph id=\"ph12\"/> button to run macros on your spreadsheet.",
          "pos": [
            28,
            154
          ]
        }
      ]
    },
    {
      "pos": [
        1887,
        2211
      ],
      "content": "Once macros are enabled, a table is generated. Columns in blue are required as input into the RRS web service, or <bpt id=\"p10\">**</bpt>PARAMETERS<ept id=\"p10\">**</ept>. Note the output of the RRS service, <bpt id=\"p11\">**</bpt>PREDICTED VALUES<ept id=\"p11\">**</ept><ph id=\"ph14\"/> in green. When all columns for a given row are filled, the workbook automatically calls the scoring API, and displays the scored results.",
      "nodes": [
        {
          "content": "Once macros are enabled, a table is generated.",
          "pos": [
            0,
            46
          ]
        },
        {
          "content": "Columns in blue are required as input into the RRS web service, or <bpt id=\"p10\">**</bpt>PARAMETERS<ept id=\"p10\">**</ept>.",
          "pos": [
            47,
            169
          ]
        },
        {
          "content": "Note the output of the RRS service, <bpt id=\"p11\">**</bpt>PREDICTED VALUES<ept id=\"p11\">**</ept><ph id=\"ph14\"/> in green.",
          "pos": [
            170,
            291
          ]
        },
        {
          "content": "When all columns for a given row are filled, the workbook automatically calls the scoring API, and displays the scored results.",
          "pos": [
            292,
            419
          ]
        }
      ]
    },
    {
      "pos": [
        2228,
        2365
      ],
      "content": "To score more than one row, fill the second row with data and the predicted values are produced. You can even paste several rows at once.",
      "nodes": [
        {
          "content": "To score more than one row, fill the second row with data and the predicted values are produced.",
          "pos": [
            0,
            96
          ]
        },
        {
          "content": "You can even paste several rows at once.",
          "pos": [
            97,
            137
          ]
        }
      ]
    },
    {
      "pos": [
        2370,
        2484
      ],
      "content": "Now use any of the Excel features (graphs, power map, conditional formatting, etcetera) with the predicted values!"
    },
    {
      "pos": [
        2494,
        2515
      ],
      "content": "Sharing your workbook"
    },
    {
      "pos": [
        2517,
        2690
      ],
      "content": "In order for the macros to work, your ACCESS KEY needs to be part of the spreadsheet. That means that you should share the workbook only with entities/individuals you trust.",
      "nodes": [
        {
          "content": "In order for the macros to work, your ACCESS KEY needs to be part of the spreadsheet.",
          "pos": [
            0,
            85
          ]
        },
        {
          "content": "That means that you should share the workbook only with entities/individuals you trust.",
          "pos": [
            86,
            173
          ]
        }
      ]
    },
    {
      "pos": [
        2695,
        2712
      ],
      "content": "Automatic updates"
    },
    {
      "pos": [
        2714,
        2758
      ],
      "content": "An RRS call is made in these two situations:"
    },
    {
      "pos": [
        2763,
        2824
      ],
      "content": "The first time a row has content in all of its <bpt id=\"p12\">**</bpt>PARAMETERS<ept id=\"p12\">**</ept>"
    },
    {
      "pos": [
        2829,
        2924
      ],
      "content": "Any time any of the <bpt id=\"p13\">**</bpt>PARAMETERS<ept id=\"p13\">**</ept><ph id=\"ph16\"/> changes in a row that had all of its <bpt id=\"p14\">**</bpt>PARAMETERS<ept id=\"p14\">**</ept><ph id=\"ph17\"/> entered."
    }
  ],
  "content": "<properties\n    pageTitle=\"Consume a Machine Learning Web Service from Excel | Microsoft Azure\"\n    description=\"Consume an Azure Machine Learning Web Service from Excel\"\n    services=\"machine-learning\"\n    documentationCenter=\"\"\n    authors=\"LuisCabrer\"\n    manager=\"paulettm\"\n    editor=\"cgronlun\"/>\n\n<tags\n    ms.service=\"machine-learning\"\n    ms.workload=\"data-services\"\n    ms.tgt_pltfrm=\"na\"\n    ms.devlang=\"na\"\n    ms.topic=\"article\"\n    ms.date=\"02/12/2016\"\n    ms.author=\"tedway\"/>\n\n\n# Consuming an Azure Machine Learning Web Service from Excel\n\n Azure Machine Learning Studio makes it easy to call web services directly from Excel without the need to write any code.\n\n If you are running Excel 2013 (or later) or you can save a file on OneDrive or SharePoint for use with Excel Online, then the [Excel add-in](machine-learning-excel-add-in-for-web-services.md) is recommended.\n\n[AZURE.INCLUDE [machine-learning-free-trial](../../includes/machine-learning-free-trial.md)]\n\n## Steps\n\n1. Publish a web service. [This page](machine-learning-walkthrough-5-publish-web-service.md) explains how to do it. Currently the Excel workbook feature is only supported for Request/Response services that have a single output (that is, a single scoring label).\n\n2. Once you have a web service, click on the **WEB SERVICES** section on the left of the studio, and then select the web service to consume from Excel.\n\n3. On the **DASHBOARD** tab for the web service is a row for the **REQUEST/RESPONSE** service. If this service had a single output, you should see the **Download Excel Workbook** link in that row.\n\n    ![][1]\n\n4. Click on **Download Excel Workbook**, and open it in Excel.\n\n5. A Security Warning appears; click on the **Enable Editing** button.\n\n    ![][2]\n\n6. A Security Warning appears. Click on the **Enable Content** button to run macros on your spreadsheet.\n\n    ![][3]\n\n7. Once macros are enabled, a table is generated. Columns in blue are required as input into the RRS web service, or **PARAMETERS**. Note the output of the RRS service, **PREDICTED VALUES** in green. When all columns for a given row are filled, the workbook automatically calls the scoring API, and displays the scored results.\n\n    ![][4]\n\n7. To score more than one row, fill the second row with data and the predicted values are produced. You can even paste several rows at once.\n\n8. Now use any of the Excel features (graphs, power map, conditional formatting, etcetera) with the predicted values!    \n\n\n## Sharing your workbook\n\nIn order for the macros to work, your ACCESS KEY needs to be part of the spreadsheet. That means that you should share the workbook only with entities/individuals you trust.\n\n## Automatic updates\n\nAn RRS call is made in these two situations:\n\n1. The first time a row has content in all of its **PARAMETERS**\n\n2. Any time any of the **PARAMETERS** changes in a row that had all of its **PARAMETERS** entered.\n\n[1]: ./media/machine-learning-consuming-from-excel/excellink.png\n[2]: ./media/machine-learning-consuming-from-excel/enableeditting.png\n[3]: ./media/machine-learning-consuming-from-excel/enablecontent.png\n[4]: ./media/machine-learning-consuming-from-excel/sampletable.png\n"
}