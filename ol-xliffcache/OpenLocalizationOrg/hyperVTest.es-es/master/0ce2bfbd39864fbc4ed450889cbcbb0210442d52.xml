{
  "nodes": [
    {
      "pos": [
        27,
        92
      ],
      "content": "Step 5: Deploy the Machine Learning web service | Microsoft Azure"
    },
    {
      "pos": [
        111,
        243
      ],
      "content": "Step 5 of the Develop a predictive solution walkthrough: Deploy a predictive experiment in Machine Learning Studio as a web service."
    },
    {
      "pos": [
        569,
        634
      ],
      "content": "Walkthrough Step 5: Deploy the Azure Machine Learning web service"
    },
    {
      "pos": [
        636,
        807
      ],
      "content": "This is the fifth step of the walkthrough, <bpt id=\"p1\">[</bpt>Develop a predictive analytics solution in Azure Machine Learning<ept id=\"p1\">](machine-learning-walkthrough-develop-predictive-solution.md)</ept>"
    },
    {
      "pos": [
        814,
        906
      ],
      "content": "<bpt id=\"p2\">[</bpt>Create a Machine Learning workspace<ept id=\"p2\">](machine-learning-walkthrough-1-create-ml-workspace.md)</ept>"
    },
    {
      "pos": [
        911,
        980
      ],
      "content": "<bpt id=\"p3\">[</bpt>Upload existing data<ept id=\"p3\">](machine-learning-walkthrough-2-upload-data.md)</ept>"
    },
    {
      "pos": [
        985,
        1067
      ],
      "content": "<bpt id=\"p4\">[</bpt>Create a new experiment<ept id=\"p4\">](machine-learning-walkthrough-3-create-new-experiment.md)</ept>"
    },
    {
      "pos": [
        1072,
        1164
      ],
      "content": "<bpt id=\"p5\">[</bpt>Train and evaluate the models<ept id=\"p5\">](machine-learning-walkthrough-4-train-and-evaluate-models.md)</ept>"
    },
    {
      "pos": [
        1169,
        1195
      ],
      "content": "<bpt id=\"p6\">**</bpt>Deploy the web service<ept id=\"p6\">**</ept>"
    },
    {
      "pos": [
        1200,
        1278
      ],
      "content": "<bpt id=\"p7\">[</bpt>Access the web service<ept id=\"p7\">](machine-learning-walkthrough-6-access-web-service.md)</ept>"
    },
    {
      "pos": [
        1292,
        1423
      ],
      "content": "To give others a chance to use the predictive model we've developed in this walkthrough, we'll deploy it as a web service on Azure."
    },
    {
      "pos": [
        1425,
        1766
      ],
      "content": "Up to this point we've been experimenting with training our model. But the deployed service is no longer going to do training - it will be generating predictions by scoring the user's input based on our model. So we're going to do some preparation to convert this experiment from a <bpt id=\"p8\">***</bpt><bpt id=\"p9\"/>training<ept id=\"p9\">***</ept><ept id=\"p8\"/><ph id=\"ph2\"/> experiment to a <bpt id=\"p10\">***</bpt><bpt id=\"p11\"/>predictive<ept id=\"p11\">***</ept><ept id=\"p10\"/><ph id=\"ph3\"/> experiment.",
      "nodes": [
        {
          "content": "Up to this point we've been experimenting with training our model.",
          "pos": [
            0,
            66
          ]
        },
        {
          "content": "But the deployed service is no longer going to do training - it will be generating predictions by scoring the user's input based on our model.",
          "pos": [
            67,
            209
          ]
        },
        {
          "content": "So we're going to do some preparation to convert this experiment from a <bpt id=\"p8\">***</bpt><bpt id=\"p9\"/>training<ept id=\"p9\">***</ept><ept id=\"p8\"/><ph id=\"ph2\"/> experiment to a <bpt id=\"p10\">***</bpt><bpt id=\"p11\"/>predictive<ept id=\"p11\">***</ept><ept id=\"p10\"/><ph id=\"ph3\"/> experiment.",
          "pos": [
            210,
            505
          ]
        }
      ]
    },
    {
      "pos": [
        1769,
        1799
      ],
      "content": "So this is a two-step process:"
    },
    {
      "pos": [
        1806,
        1884
      ],
      "content": "Convert the <bpt id=\"p12\">*</bpt>training experiment<ept id=\"p12\">*</ept><ph id=\"ph4\"/> we've created into a <bpt id=\"p13\">*</bpt>predictive experiment<ept id=\"p13\">*</ept>"
    },
    {
      "pos": [
        1888,
        1937
      ],
      "content": "Deploy the predictive experiment as a web service"
    },
    {
      "pos": [
        1939,
        2119
      ],
      "content": "But first, we need to trim this experiment down a little. We currently have two different models in the experiment, but we only want one model when we deploy this as a web service.",
      "nodes": [
        {
          "content": "But first, we need to trim this experiment down a little.",
          "pos": [
            0,
            57
          ]
        },
        {
          "content": "We currently have two different models in the experiment, but we only want one model when we deploy this as a web service.",
          "pos": [
            58,
            180
          ]
        }
      ]
    },
    {
      "pos": [
        2123,
        2482
      ],
      "content": "Let's say we've decided that the boosted tree model was the better model to use. So the first thing to do is remove the [Two-Class Support Vector Machine][two-class-support-vector-machine] module and the modules that were used for training it. You may want to make a copy of the experiment first by clicking <bpt id=\"p14\">**</bpt>Save As<ept id=\"p14\">**</ept><ph id=\"ph5\"/> at the bottom of the experiment canvas.",
      "nodes": [
        {
          "content": "Let's say we've decided that the boosted tree model was the better model to use.",
          "pos": [
            0,
            80
          ]
        },
        {
          "content": "So the first thing to do is remove the [Two-Class Support Vector Machine][two-class-support-vector-machine] module and the modules that were used for training it.",
          "pos": [
            81,
            243
          ]
        },
        {
          "content": "You may want to make a copy of the experiment first by clicking <bpt id=\"p14\">**</bpt>Save As<ept id=\"p14\">**</ept><ph id=\"ph5\"/> at the bottom of the experiment canvas.",
          "pos": [
            244,
            413
          ]
        }
      ]
    },
    {
      "pos": [
        2484,
        2524
      ],
      "content": "We need to delete the following modules:"
    },
    {
      "pos": [
        2530,
        2598
      ],
      "content": "[Two-Class Support Vector Machine][two-class-support-vector-machine]"
    },
    {
      "pos": [
        2601,
        2692
      ],
      "content": "[Train Model][train-model] and [Score Model][score-model] modules that were connected to it"
    },
    {
      "pos": [
        2695,
        2742
      ],
      "content": "[Normalize Data][normalize-data] (both of them)"
    },
    {
      "pos": [
        2745,
        2777
      ],
      "content": "[Evaluate Model][evaluate-model]"
    },
    {
      "pos": [
        2779,
        2876
      ],
      "content": "Just select the module and press the Delete key, or right-click the module and select <bpt id=\"p15\">**</bpt>Delete<ept id=\"p15\">**</ept>."
    },
    {
      "pos": [
        2878,
        2992
      ],
      "content": "Now we're ready to deploy this model using the [Two-Class Boosted Decision Tree][two-class-boosted-decision-tree]."
    },
    {
      "pos": [
        2997,
        3055
      ],
      "content": "Convert the training experiment to a predictive experiment"
    },
    {
      "pos": [
        3057,
        3116
      ],
      "content": "Converting to a predictive experiment involves three steps:"
    },
    {
      "pos": [
        3121,
        3187
      ],
      "content": "Save the model we've trained and then replace our training modules"
    },
    {
      "pos": [
        3191,
        3263
      ],
      "content": "Trim the experiment to remove modules that were only needed for training"
    },
    {
      "pos": [
        3267,
        3347
      ],
      "content": "Define where the web service will accept input and where it will generate output"
    },
    {
      "pos": [
        3349,
        3524
      ],
      "content": "Fortunately, all three steps can be accomplished by just clicking <bpt id=\"p16\">**</bpt>Deploy Web Service<ept id=\"p16\">**</ept><ph id=\"ph6\"/> at the bottom of the experiment canvas (select the <bpt id=\"p17\">**</bpt>Predictive Web Service<ept id=\"p17\">**</ept><ph id=\"ph7\"/> option)."
    },
    {
      "pos": [
        3526,
        3587
      ],
      "content": "When you click <bpt id=\"p18\">**</bpt>Deploy Web Service<ept id=\"p18\">**</ept>, several things happen:"
    },
    {
      "pos": [
        3591,
        3762
      ],
      "content": "The model we trained is saved as a single <bpt id=\"p19\">**</bpt>Trained Model<ept id=\"p19\">**</ept><ph id=\"ph8\"/> module into the module palette to the left of the experiment canvas (you can find it under <bpt id=\"p20\">**</bpt>Trained Models<ept id=\"p20\">**</ept>)."
    },
    {
      "pos": [
        3765,
        3827
      ],
      "content": "Modules that were used for training are removed. Specifically:",
      "nodes": [
        {
          "content": "Modules that were used for training are removed.",
          "pos": [
            0,
            48
          ]
        },
        {
          "content": "Specifically:",
          "pos": [
            49,
            62
          ]
        }
      ]
    },
    {
      "pos": [
        3832,
        3898
      ],
      "content": "[Two-Class Boosted Decision Tree][two-class-boosted-decision-tree]"
    },
    {
      "pos": [
        3903,
        3929
      ],
      "content": "[Train Model][train-model]"
    },
    {
      "pos": [
        3934,
        3953
      ],
      "content": "[Split Data][split]"
    },
    {
      "pos": [
        3958,
        4040
      ],
      "content": "the second [Execute R Script][execute-r-script] module that was used for test data"
    },
    {
      "pos": [
        4043,
        4101
      ],
      "content": "The saved trained model is added back into the experiment."
    },
    {
      "pos": [
        4104,
        4171
      ],
      "content": "<bpt id=\"p21\">**</bpt>Web service input<ept id=\"p21\">**</ept><ph id=\"ph9\"/> and <bpt id=\"p22\">**</bpt>Web service output<ept id=\"p22\">**</ept><ph id=\"ph10\"/> modules are added."
    },
    {
      "pos": [
        4175,
        4454
      ],
      "content": "<ph id=\"ph11\">[AZURE.NOTE]</ph><ph id=\"ph12\"/> The experiment has been saved in two parts under tabs that have been added at the top of the experiment canvas: the original training experiment is under the tab <bpt id=\"p23\">**</bpt>Training experiment<ept id=\"p23\">**</ept>, and the newly-created predictive experiment is under <bpt id=\"p24\">**</bpt>Predictive experiment<ept id=\"p24\">**</ept>."
    },
    {
      "pos": [
        4456,
        4525
      ],
      "content": "We need to take one additional step with this particular experiment.\n",
      "nodes": [
        {
          "content": "We need to take one additional step with this particular experiment.",
          "pos": [
            0,
            68
          ]
        },
        {
          "content": "\n",
          "pos": [
            68,
            69
          ]
        }
      ]
    },
    {
      "pos": [
        4525,
        4698
      ],
      "content": "We added two [Execute R Script][execute-r-script] modules to provide a weighting function to the data for training and testing. We don't need to do that in the final model.\n",
      "nodes": [
        {
          "content": "We added two [Execute R Script][execute-r-script] modules to provide a weighting function to the data for training and testing.",
          "pos": [
            0,
            127
          ]
        },
        {
          "content": "We don't need to do that in the final model.",
          "pos": [
            128,
            172
          ]
        },
        {
          "content": "\n",
          "pos": [
            172,
            173
          ]
        }
      ]
    },
    {
      "pos": [
        4698,
        4942
      ],
      "content": "Machine Learning Studio removed one [Execute R Script][execute-r-script] module when it removed the [Split][split] module, so now we can now remove the other and connect [Metadata Editor][metadata-editor] directly to [Score Model][score-model]."
    },
    {
      "pos": [
        4948,
        4989
      ],
      "content": "Our experiment should now look like this:"
    },
    {
      "pos": [
        4993,
        5024
      ],
      "content": "<ph id=\"ph13\">![</ph>Scoring the trained model<ph id=\"ph14\">][4]</ph>"
    },
    {
      "pos": [
        5031,
        5265
      ],
      "content": "<ph id=\"ph15\">[AZURE.NOTE]</ph><ph id=\"ph16\"/> You may be wondering why we left the UCI German Credit Card Data dataset in the predictive experiment. The service is going to use the user's data, not the original dataset, so why leave the original dataset in the model?",
      "nodes": [
        {
          "content": "<ph id=\"ph15\">[AZURE.NOTE]</ph><ph id=\"ph16\"/> You may be wondering why we left the UCI German Credit Card Data dataset in the predictive experiment.",
          "pos": [
            0,
            149
          ]
        },
        {
          "content": "The service is going to use the user's data, not the original dataset, so why leave the original dataset in the model?",
          "pos": [
            150,
            268
          ]
        }
      ]
    },
    {
      "pos": [
        5269,
        5710
      ],
      "content": "It's true that the service doesn't need the original credit card data. But it does need the schema for that data, which includes information such as how many columns there are and which columns are numeric. This schema information is necessary in order to interpret the user's data. We leave these components connected so that the scoring module will have the dataset schema when the service is running. The data isn't used, just the schema.",
      "nodes": [
        {
          "content": "It's true that the service doesn't need the original credit card data.",
          "pos": [
            0,
            70
          ]
        },
        {
          "content": "But it does need the schema for that data, which includes information such as how many columns there are and which columns are numeric.",
          "pos": [
            71,
            206
          ]
        },
        {
          "content": "This schema information is necessary in order to interpret the user's data.",
          "pos": [
            207,
            282
          ]
        },
        {
          "content": "We leave these components connected so that the scoring module will have the dataset schema when the service is running.",
          "pos": [
            283,
            403
          ]
        },
        {
          "content": "The data isn't used, just the schema.",
          "pos": [
            404,
            441
          ]
        }
      ]
    },
    {
      "pos": [
        5714,
        6064
      ],
      "content": "Run the experiment one last time (click <bpt id=\"p25\">**</bpt>Run<ept id=\"p25\">**</ept>). If you want to verify that the model is still working, click the output of the [Score Model][score-model] module and select <bpt id=\"p26\">**</bpt>View Results<ept id=\"p26\">**</ept>. You'll see that the original data is displayed, along with the credit risk value (\"Scored Labels\") and the scoring probability value (\"Scored Probabilities\").",
      "nodes": [
        {
          "content": "Run the experiment one last time (click <bpt id=\"p25\">**</bpt>Run<ept id=\"p25\">**</ept>).",
          "pos": [
            0,
            89
          ]
        },
        {
          "content": "If you want to verify that the model is still working, click the output of the [Score Model][score-model] module and select <bpt id=\"p26\">**</bpt>View Results<ept id=\"p26\">**</ept>.",
          "pos": [
            90,
            271
          ]
        },
        {
          "content": "You'll see that the original data is displayed, along with the credit risk value (\"Scored Labels\") and the scoring probability value (\"Scored Probabilities\").",
          "pos": [
            272,
            430
          ]
        }
      ]
    },
    {
      "pos": [
        6071,
        6093
      ],
      "content": "Deploy the web service"
    },
    {
      "pos": [
        6095,
        6632
      ],
      "content": "To deploy a web service derived from our experiment, click <bpt id=\"p27\">**</bpt>Deploy Web Service<ept id=\"p27\">**</ept><ph id=\"ph17\"/> below the canvas. Machine Learning Studio deploys the experiment as a web service and takes you to the dashboard for that web service. From here you can return to the experiment (<bpt id=\"p28\">**</bpt>View snapshot<ept id=\"p28\">**</ept><ph id=\"ph18\"/> or <bpt id=\"p29\">**</bpt>View latest<ept id=\"p29\">**</ept>) and run a simple test of the web service (<bpt id=\"p30\">**</bpt>Test<ept id=\"p30\">**</ept><ph id=\"ph19\"/> button - see <bpt id=\"p31\">**</bpt>Test the web service<ept id=\"p31\">**</ept><ph id=\"ph20\"/> below). There is also information here for creating applications that can access the web service (more on that in the next step of this walkthrough).",
      "nodes": [
        {
          "content": "To deploy a web service derived from our experiment, click <bpt id=\"p27\">**</bpt>Deploy Web Service<ept id=\"p27\">**</ept><ph id=\"ph17\"/> below the canvas.",
          "pos": [
            0,
            154
          ]
        },
        {
          "content": "Machine Learning Studio deploys the experiment as a web service and takes you to the dashboard for that web service.",
          "pos": [
            155,
            271
          ]
        },
        {
          "content": "From here you can return to the experiment (<bpt id=\"p28\">**</bpt>View snapshot<ept id=\"p28\">**</ept><ph id=\"ph18\"/> or <bpt id=\"p29\">**</bpt>View latest<ept id=\"p29\">**</ept>) and run a simple test of the web service (<bpt id=\"p30\">**</bpt>Test<ept id=\"p30\">**</ept><ph id=\"ph19\"/> button - see <bpt id=\"p31\">**</bpt>Test the web service<ept id=\"p31\">**</ept><ph id=\"ph20\"/> below).",
          "pos": [
            272,
            655
          ]
        },
        {
          "content": "There is also information here for creating applications that can access the web service (more on that in the next step of this walkthrough).",
          "pos": [
            656,
            797
          ]
        }
      ]
    },
    {
      "pos": [
        6634,
        6661
      ],
      "content": "<ph id=\"ph21\">![</ph>Web service dashboard<ph id=\"ph22\">][6]</ph>"
    },
    {
      "pos": [
        6665,
        6978
      ],
      "content": "<ph id=\"ph23\">[AZURE.TIP]</ph><ph id=\"ph24\"/> You can update the web service after you've deployed it. For example, if you want to change your model, just edit the training experiment, tweak the model parameters, and click <bpt id=\"p32\">**</bpt>Deploy Web Service<ept id=\"p32\">**</ept>. When you deploy the experiment again, it will replace the web service, now using your updated model.",
      "nodes": [
        {
          "content": "<ph id=\"ph23\">[AZURE.TIP]</ph><ph id=\"ph24\"/> You can update the web service after you've deployed it.",
          "pos": [
            0,
            102
          ]
        },
        {
          "content": "For example, if you want to change your model, just edit the training experiment, tweak the model parameters, and click <bpt id=\"p32\">**</bpt>Deploy Web Service<ept id=\"p32\">**</ept>.",
          "pos": [
            103,
            286
          ]
        },
        {
          "content": "When you deploy the experiment again, it will replace the web service, now using your updated model.",
          "pos": [
            287,
            387
          ]
        }
      ]
    },
    {
      "pos": [
        6982,
        7231
      ],
      "content": "You can configure the service by clicking the <bpt id=\"p33\">**</bpt>CONFIGURATION<ept id=\"p33\">**</ept><ph id=\"ph25\"/> tab. Here you can modify the service name (it's given the experiment name by default) and give it a description. You can also give more friendly labels for the input and output columns.",
      "nodes": [
        {
          "content": "You can configure the service by clicking the <bpt id=\"p33\">**</bpt>CONFIGURATION<ept id=\"p33\">**</ept><ph id=\"ph25\"/> tab.",
          "pos": [
            0,
            123
          ]
        },
        {
          "content": "Here you can modify the service name (it's given the experiment name by default) and give it a description.",
          "pos": [
            124,
            231
          ]
        },
        {
          "content": "You can also give more friendly labels for the input and output columns.",
          "pos": [
            232,
            304
          ]
        }
      ]
    },
    {
      "pos": [
        7235,
        7266
      ],
      "content": "<ph id=\"ph26\">![</ph>Configure the web service<ph id=\"ph27\">][5]</ph>"
    },
    {
      "pos": [
        7273,
        7293
      ],
      "content": "Test the web service"
    },
    {
      "pos": [
        7294,
        7528
      ],
      "content": "On the <bpt id=\"p34\">**</bpt>DASHBOARD<ept id=\"p34\">**</ept><ph id=\"ph28\"/> page, click the <bpt id=\"p35\">**</bpt>Test<ept id=\"p35\">**</ept><ph id=\"ph29\"/> button under <bpt id=\"p36\">**</bpt>Default Endpoint<ept id=\"p36\">**</ept>. A dialog will pop up and ask you for the input data for the service. These are the same columns that appeared in the original German credit risk dataset.",
      "nodes": [
        {
          "content": "On the <bpt id=\"p34\">**</bpt>DASHBOARD<ept id=\"p34\">**</ept><ph id=\"ph28\"/> page, click the <bpt id=\"p35\">**</bpt>Test<ept id=\"p35\">**</ept><ph id=\"ph29\"/> button under <bpt id=\"p36\">**</bpt>Default Endpoint<ept id=\"p36\">**</ept>.",
          "pos": [
            0,
            230
          ]
        },
        {
          "content": "A dialog will pop up and ask you for the input data for the service.",
          "pos": [
            231,
            299
          ]
        },
        {
          "content": "These are the same columns that appeared in the original German credit risk dataset.",
          "pos": [
            300,
            384
          ]
        }
      ]
    },
    {
      "pos": [
        7532,
        7574
      ],
      "content": "Enter a set of data and then click <bpt id=\"p37\">**</bpt>OK<ept id=\"p37\">**</ept>."
    },
    {
      "pos": [
        7578,
        7859
      ],
      "content": "In the web service, the data enters through the <bpt id=\"p38\">**</bpt>Web service input<ept id=\"p38\">**</ept><ph id=\"ph30\"/> module, through the [Metadata Editor][metadata-editor] module, and to the [Score Model][score-model] module where it's scored. The results are then output from the web service through the <bpt id=\"p39\">**</bpt>Web service output<ept id=\"p39\">**</ept>.",
      "nodes": [
        {
          "content": "In the web service, the data enters through the <bpt id=\"p38\">**</bpt>Web service input<ept id=\"p38\">**</ept><ph id=\"ph30\"/> module, through the [Metadata Editor][metadata-editor] module, and to the [Score Model][score-model] module where it's scored.",
          "pos": [
            0,
            251
          ]
        },
        {
          "content": "The results are then output from the web service through the <bpt id=\"p39\">**</bpt>Web service output<ept id=\"p39\">**</ept>.",
          "pos": [
            252,
            376
          ]
        }
      ]
    },
    {
      "pos": [
        7863,
        8376
      ],
      "content": "<ph id=\"ph31\">[AZURE.TIP]</ph><ph id=\"ph32\"/> The way we have the predictive experiment configured, the entire results from the [Score Model][score-model] module are returned. This includes all the input data plus the credit risk value and the scoring probability. If you wanted to return something different - for example, only the credit risk value - then you could insert a [Project Columns][project-columns] module between [Score Model][score-model] and the <bpt id=\"p40\">**</bpt>Web service output<ept id=\"p40\">**</ept><ph id=\"ph33\"/> to eliminate columns you don't want the web service to return.",
      "nodes": [
        {
          "content": "<ph id=\"ph31\">[AZURE.TIP]</ph><ph id=\"ph32\"/> The way we have the predictive experiment configured, the entire results from the [Score Model][score-model] module are returned.",
          "pos": [
            0,
            175
          ]
        },
        {
          "content": "This includes all the input data plus the credit risk value and the scoring probability.",
          "pos": [
            176,
            264
          ]
        },
        {
          "content": "If you wanted to return something different - for example, only the credit risk value - then you could insert a [Project Columns][project-columns] module between [Score Model][score-model] and the <bpt id=\"p40\">**</bpt>Web service output<ept id=\"p40\">**</ept><ph id=\"ph33\"/> to eliminate columns you don't want the web service to return.",
          "pos": [
            265,
            602
          ]
        }
      ]
    },
    {
      "pos": [
        8382,
        8404
      ],
      "content": "Manage the web service"
    },
    {
      "pos": [
        8405,
        8527
      ],
      "content": "Once you've deployed your web service, you can manage it from the <bpt id=\"p41\">[</bpt>Azure classic portal<ept id=\"p41\">](https://manage.windowsazure.com)</ept>."
    },
    {
      "pos": [
        8532,
        8603
      ],
      "content": "Sign-in to the <bpt id=\"p42\">[</bpt>Azure classic portal<ept id=\"p42\">](https://manage.windowsazure.com)</ept>."
    },
    {
      "pos": [
        8607,
        8673
      ],
      "content": "In the Microsoft Azure services panel, click <bpt id=\"p43\">**</bpt>MACHINE LEARNING<ept id=\"p43\">**</ept>."
    },
    {
      "pos": [
        8677,
        8698
      ],
      "content": "Click your workspace."
    },
    {
      "pos": [
        8702,
        8733
      ],
      "content": "Click the <bpt id=\"p44\">**</bpt>WEB SERVICES<ept id=\"p44\">**</ept><ph id=\"ph34\"/> tab."
    },
    {
      "pos": [
        8737,
        8775
      ],
      "content": "Click the web service we just created."
    },
    {
      "pos": [
        8779,
        8808
      ],
      "content": "Click the \"default\" endpoint."
    },
    {
      "pos": [
        8810,
        8970
      ],
      "content": "From here you can do things like monitor how the web service is doing and make performance tweaks by changing how many concurrent calls the service can handle.\n",
      "nodes": [
        {
          "content": "From here you can do things like monitor how the web service is doing and make performance tweaks by changing how many concurrent calls the service can handle.",
          "pos": [
            0,
            159
          ]
        },
        {
          "content": "\n",
          "pos": [
            159,
            160
          ]
        }
      ]
    },
    {
      "pos": [
        8970,
        9033
      ],
      "content": "You can even publish your web service in the Azure Marketplace."
    },
    {
      "pos": [
        9035,
        9057
      ],
      "content": "For more details, see:"
    },
    {
      "pos": [
        9061,
        9118
      ],
      "content": "<bpt id=\"p45\">[</bpt>Creating Endpoints<ept id=\"p45\">](machine-learning-create-endpoint.md)</ept>"
    },
    {
      "pos": [
        9121,
        9182
      ],
      "content": "<bpt id=\"p46\">[</bpt>Scaling web service<ept id=\"p46\">](machine-learning-scaling-webservice.md)</ept>"
    },
    {
      "pos": [
        9185,
        9316
      ],
      "content": "<bpt id=\"p47\">[</bpt>Publish Azure Machine Learning Web Service to the Azure Marketplace<ept id=\"p47\">](machine-learning-publish-web-service-to-azure-marketplace.md)</ept>"
    },
    {
      "pos": [
        9330,
        9418
      ],
      "content": "<bpt id=\"p48\">**</bpt>Next: <bpt id=\"p49\">[</bpt>Access the web service<ept id=\"p49\">](machine-learning-walkthrough-6-access-web-service.md)</ept><ept id=\"p48\">**</ept>"
    },
    {
      "pos": [
        9911,
        10910
      ],
      "content": "[evaluate-model]: https://msdn.microsoft.com/library/azure/927d65ac-3b50-4694-9903-20f6c1672089/\n[execute-r-script]: https://msdn.microsoft.com/library/azure/30806023-392b-42e0-94d6-6b775a6e0fd5/\n[metadata-editor]: https://msdn.microsoft.com/library/azure/370b6676-c11c-486f-bf73-35349f842a66/\n[normalize-data]: https://msdn.microsoft.com/library/azure/986df333-6748-4b85-923d-871df70d6aaf/\n[score-model]: https://msdn.microsoft.com/library/azure/401b4f92-e724-4d5a-be81-d5b0ff9bdb33/\n[split]: https://msdn.microsoft.com/library/azure/70530644-c97a-4ab6-85f7-88bf30a8be5f/\n[train-model]: https://msdn.microsoft.com/library/azure/5cc7053e-aa30-450d-96c0-dae4be720977/\n[two-class-boosted-decision-tree]: https://msdn.microsoft.com/library/azure/e3c522f8-53d9-4829-8ea4-5c6a6b75330c/\n[two-class-support-vector-machine]: https://msdn.microsoft.com/library/azure/12d8479b-74b4-4e67-b8de-d32867380e20/\n[project-columns]: https://msdn.microsoft.com/en-us/library/azure/1ec722fa-b623-4e26-a44e-a50c6d726223/"
    }
  ],
  "content": "<properties\n    pageTitle=\"Step 5: Deploy the Machine Learning web service | Microsoft Azure\"\n    description=\"Step 5 of the Develop a predictive solution walkthrough: Deploy a predictive experiment in Machine Learning Studio as a web service.\"\n    services=\"machine-learning\"\n    documentationCenter=\"\"\n    authors=\"garyericson\"\n    manager=\"paulettm\"\n    editor=\"cgronlun\"/>\n\n<tags\n    ms.service=\"machine-learning\"\n    ms.workload=\"data-services\"\n    ms.tgt_pltfrm=\"na\"\n    ms.devlang=\"na\"\n    ms.topic=\"article\"\n    ms.date=\"02/03/2016\"\n    ms.author=\"garye\"/>\n\n\n# Walkthrough Step 5: Deploy the Azure Machine Learning web service\n\nThis is the fifth step of the walkthrough, [Develop a predictive analytics solution in Azure Machine Learning](machine-learning-walkthrough-develop-predictive-solution.md)\n\n\n1.  [Create a Machine Learning workspace](machine-learning-walkthrough-1-create-ml-workspace.md)\n2.  [Upload existing data](machine-learning-walkthrough-2-upload-data.md)\n3.  [Create a new experiment](machine-learning-walkthrough-3-create-new-experiment.md)\n4.  [Train and evaluate the models](machine-learning-walkthrough-4-train-and-evaluate-models.md)\n5.  **Deploy the web service**\n6.  [Access the web service](machine-learning-walkthrough-6-access-web-service.md)\n\n----------\n\nTo give others a chance to use the predictive model we've developed in this walkthrough, we'll deploy it as a web service on Azure.\n\nUp to this point we've been experimenting with training our model. But the deployed service is no longer going to do training - it will be generating predictions by scoring the user's input based on our model. So we're going to do some preparation to convert this experiment from a ***training*** experiment to a ***predictive*** experiment. \n\nSo this is a two-step process:  \n\n1. Convert the *training experiment* we've created into a *predictive experiment*\n2. Deploy the predictive experiment as a web service\n\nBut first, we need to trim this experiment down a little. We currently have two different models in the experiment, but we only want one model when we deploy this as a web service.  \n\nLet's say we've decided that the boosted tree model was the better model to use. So the first thing to do is remove the [Two-Class Support Vector Machine][two-class-support-vector-machine] module and the modules that were used for training it. You may want to make a copy of the experiment first by clicking **Save As** at the bottom of the experiment canvas.\n\nWe need to delete the following modules:  \n\n- [Two-Class Support Vector Machine][two-class-support-vector-machine]\n- [Train Model][train-model] and [Score Model][score-model] modules that were connected to it\n- [Normalize Data][normalize-data] (both of them)\n- [Evaluate Model][evaluate-model]\n\nJust select the module and press the Delete key, or right-click the module and select **Delete**.\n\nNow we're ready to deploy this model using the [Two-Class Boosted Decision Tree][two-class-boosted-decision-tree].\n\n## Convert the training experiment to a predictive experiment\n\nConverting to a predictive experiment involves three steps:\n\n1. Save the model we've trained and then replace our training modules\n2. Trim the experiment to remove modules that were only needed for training\n3. Define where the web service will accept input and where it will generate output\n\nFortunately, all three steps can be accomplished by just clicking **Deploy Web Service** at the bottom of the experiment canvas (select the **Predictive Web Service** option).\n\nWhen you click **Deploy Web Service**, several things happen:\n\n- The model we trained is saved as a single **Trained Model** module into the module palette to the left of the experiment canvas (you can find it under **Trained Models**).\n- Modules that were used for training are removed. Specifically:\n  - [Two-Class Boosted Decision Tree][two-class-boosted-decision-tree]\n  - [Train Model][train-model]\n  - [Split Data][split]\n  - the second [Execute R Script][execute-r-script] module that was used for test data\n- The saved trained model is added back into the experiment.\n- **Web service input** and **Web service output** modules are added.\n\n> [AZURE.NOTE] The experiment has been saved in two parts under tabs that have been added at the top of the experiment canvas: the original training experiment is under the tab **Training experiment**, and the newly-created predictive experiment is under **Predictive experiment**.\n\nWe need to take one additional step with this particular experiment.\nWe added two [Execute R Script][execute-r-script] modules to provide a weighting function to the data for training and testing. We don't need to do that in the final model.\nMachine Learning Studio removed one [Execute R Script][execute-r-script] module when it removed the [Split][split] module, so now we can now remove the other and connect [Metadata Editor][metadata-editor] directly to [Score Model][score-model].    \n\nOur experiment should now look like this:  \n\n![Scoring the trained model][4]  \n\n\n> [AZURE.NOTE] You may be wondering why we left the UCI German Credit Card Data dataset in the predictive experiment. The service is going to use the user's data, not the original dataset, so why leave the original dataset in the model?\n>\n>It's true that the service doesn't need the original credit card data. But it does need the schema for that data, which includes information such as how many columns there are and which columns are numeric. This schema information is necessary in order to interpret the user's data. We leave these components connected so that the scoring module will have the dataset schema when the service is running. The data isn't used, just the schema.  \n\nRun the experiment one last time (click **Run**). If you want to verify that the model is still working, click the output of the [Score Model][score-model] module and select **View Results**. You'll see that the original data is displayed, along with the credit risk value (\"Scored Labels\") and the scoring probability value (\"Scored Probabilities\").  \n\n## Deploy the web service\n\nTo deploy a web service derived from our experiment, click **Deploy Web Service** below the canvas. Machine Learning Studio deploys the experiment as a web service and takes you to the dashboard for that web service. From here you can return to the experiment (**View snapshot** or **View latest**) and run a simple test of the web service (**Test** button - see **Test the web service** below). There is also information here for creating applications that can access the web service (more on that in the next step of this walkthrough).\n\n![Web service dashboard][6]\n\n> [AZURE.TIP] You can update the web service after you've deployed it. For example, if you want to change your model, just edit the training experiment, tweak the model parameters, and click **Deploy Web Service**. When you deploy the experiment again, it will replace the web service, now using your updated model.  \n\nYou can configure the service by clicking the **CONFIGURATION** tab. Here you can modify the service name (it's given the experiment name by default) and give it a description. You can also give more friendly labels for the input and output columns.  \n\n![Configure the web service][5]  \n\n## Test the web service\nOn the **DASHBOARD** page, click the **Test** button under **Default Endpoint**. A dialog will pop up and ask you for the input data for the service. These are the same columns that appeared in the original German credit risk dataset.  \n\nEnter a set of data and then click **OK**.  \n\nIn the web service, the data enters through the **Web service input** module, through the [Metadata Editor][metadata-editor] module, and to the [Score Model][score-model] module where it's scored. The results are then output from the web service through the **Web service output**.\n\n> [AZURE.TIP] The way we have the predictive experiment configured, the entire results from the [Score Model][score-model] module are returned. This includes all the input data plus the credit risk value and the scoring probability. If you wanted to return something different - for example, only the credit risk value - then you could insert a [Project Columns][project-columns] module between [Score Model][score-model] and the **Web service output** to eliminate columns you don't want the web service to return. \n\n## Manage the web service\nOnce you've deployed your web service, you can manage it from the [Azure classic portal](https://manage.windowsazure.com).\n\n1. Sign-in to the [Azure classic portal](https://manage.windowsazure.com).\n2. In the Microsoft Azure services panel, click **MACHINE LEARNING**.\n3. Click your workspace.\n4. Click the **WEB SERVICES** tab.\n5. Click the web service we just created.\n6. Click the \"default\" endpoint.\n\nFrom here you can do things like monitor how the web service is doing and make performance tweaks by changing how many concurrent calls the service can handle.\nYou can even publish your web service in the Azure Marketplace.\n\nFor more details, see:\n\n- [Creating Endpoints](machine-learning-create-endpoint.md)\n- [Scaling web service](machine-learning-scaling-webservice.md)\n- [Publish Azure Machine Learning Web Service to the Azure Marketplace](machine-learning-publish-web-service-to-azure-marketplace.md)\n\n----------\n\n**Next: [Access the web service](machine-learning-walkthrough-6-access-web-service.md)**\n\n[1]: ./media/machine-learning-walkthrough-5-publish-web-service/publish1.png\n[2]: ./media/machine-learning-walkthrough-5-publish-web-service/publish2.png\n[3]: ./media/machine-learning-walkthrough-5-publish-web-service/publish3.png\n[4]: ./media/machine-learning-walkthrough-5-publish-web-service/publish4.png\n[5]: ./media/machine-learning-walkthrough-5-publish-web-service/publish5.png\n[6]: ./media/machine-learning-walkthrough-5-publish-web-service/publish6.png\n\n\n<!-- Module References -->\n[evaluate-model]: https://msdn.microsoft.com/library/azure/927d65ac-3b50-4694-9903-20f6c1672089/\n[execute-r-script]: https://msdn.microsoft.com/library/azure/30806023-392b-42e0-94d6-6b775a6e0fd5/\n[metadata-editor]: https://msdn.microsoft.com/library/azure/370b6676-c11c-486f-bf73-35349f842a66/\n[normalize-data]: https://msdn.microsoft.com/library/azure/986df333-6748-4b85-923d-871df70d6aaf/\n[score-model]: https://msdn.microsoft.com/library/azure/401b4f92-e724-4d5a-be81-d5b0ff9bdb33/\n[split]: https://msdn.microsoft.com/library/azure/70530644-c97a-4ab6-85f7-88bf30a8be5f/\n[train-model]: https://msdn.microsoft.com/library/azure/5cc7053e-aa30-450d-96c0-dae4be720977/\n[two-class-boosted-decision-tree]: https://msdn.microsoft.com/library/azure/e3c522f8-53d9-4829-8ea4-5c6a6b75330c/\n[two-class-support-vector-machine]: https://msdn.microsoft.com/library/azure/12d8479b-74b4-4e67-b8de-d32867380e20/\n[project-columns]: https://msdn.microsoft.com/en-us/library/azure/1ec722fa-b623-4e26-a44e-a50c6d726223/"
}