<markdown_skeleton_root>
  <block_element>
    <ArrayOfMarkdownBlockBase xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="fe76d62c-0950-4f7f-b104-37117d364ab9"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>fa2fd977-302f-4d34-afe7-8f82d4533cb0</SegmentId>
            <InternalNormalItem
              internal_item_id="2f984275-a6d9-4476-a2d7-afff4c86c884"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="b1db6217-982f-4ea9-9366-4832eec7fd9b"
        item_type="Header"
        item_footer="footer_not_set">
        <header_type>Star</header_type>
        <header_level>1</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="9e80e4df-babb-449a-a1f3-4ff53bad8a6a"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>6aa4cadf-74e9-47da-aa05-aeefceed4d13</SegmentId>
            <InternalNormalItem
              internal_item_id="a4c93965-757d-4ed9-8bb4-2a8b0a89f137"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="601e7ecc-3947-421c-828a-6f99eff73b86"
        item_type="Header"
        item_footer="footer_not_set">
        <header_type>Star</header_type>
        <header_level>3</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownListBlock"
        item_id="caf90c84-2b1f-4a73-b4a6-6283d9b7d040"
        item_type="List"
        item_footer="">
        <inner_list_items>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="de36f677-1c22-4874-9157-fd12cec95c3b"
              item_type="NormalParagraph"
              item_footer="footer_not_set">
              <paragraph_segments>
                <MarkdownSegment>
                  <SegmentId>6483f44c-bd51-4481-922b-635d758ac9f7</SegmentId>
                  <InternalNormalItem
                    internal_item_id="d2ed2025-0444-43b6-9b94-f5b24f2e56cd"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                  <MarkdownInternalBoldItem
                    internal_item_id="885480cf-ce49-4f2a-8cbf-5746ac7d3db1"
                    internal_item_type="Bold">
                    <internal_items />
                    <internal_itatic_bold_item_type>Star</internal_itatic_bold_item_type>
                  </MarkdownInternalBoldItem>
                  <InternalNormalItem
                    internal_item_id="d41bb3d6-ff92-4ef6-a1dd-3ea63f4381db"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>1.  </Identifier>
          </ListItem>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="fa15db46-1175-45d8-8426-088eb0c6ba43"
              item_type="NormalParagraph"
              item_footer="footer_not_set">
              <paragraph_segments>
                <MarkdownSegment>
                  <SegmentId>a59fc7aa-3607-40ca-92a5-18a93f0dd7c9</SegmentId>
                  <InternalNormalItem
                    internal_item_id="d56f424d-9dbb-4ef2-a7f4-b4c4dfa249cf"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>2.  </Identifier>
          </ListItem>
        </inner_list_items>
        <ListType>Number</ListType>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="5e6839c5-5bf1-4fdd-b19a-2004dac47398"
        item_type="FencedCodeBlock"
        item_footer="footer_not_set">
        <codeblock_wraper> ```</codeblock_wraper>
        <code_block>get-command –module hyper-v | out-gridview
```
  You get something like this:

  ![](media\command_grid.png)

3. To learn more about a particular PowerShell command use `get-help`. For instance running the following command will return information about the `get-vm` Hyper-V command.

  ```powershell
get-help get-vm
```
 The output shows you how to structure the command, what the required and optional parameters are, and the aliases that you can use.

 ![](media\get_help.png)


### Return a list of virtual machines

Use the `get-vm` command to return a list of virtual machines.

1. In PowerShell, run the following command:

 ```powershell
get-vm
```
 This displays something like this:

 ![](media\get_vm.png)

2. To return a list of only powered on virtual machines add a filter to the `get-vm` command. A filter can be added by using the where-object command. For more information on filtering see the [Using the Where-Object](https://technet.microsoft.com/en-us/library/ee177028.aspx) documentation.   

 ```powershell
 get-vm | where {$_.State –eq ‘Running’}
</code_block>
        <fenced_code_lang>powershell</fenced_code_lang>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownListBlock"
        item_id="a72a2252-ca8b-4c9c-a539-252e4d5ceba5"
        item_type="List"
        item_footer="">
        <inner_list_items>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="123f461c-1ead-4f0b-8899-1e3ce17f509b"
              item_type="NormalParagraph"
              item_footer="footer_not_set">
              <paragraph_segments>
                <MarkdownSegment>
                  <SegmentId>223934fd-77b4-410f-bfd4-1ad61590ec07</SegmentId>
                  <InternalNormalItem
                    internal_item_id="72e86886-ac44-4887-a6c4-8dccace7cc89"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
                <MarkdownSegment>
                  <SegmentId>0d6f32ec-f35a-45cf-9fc3-663e5f4d0434</SegmentId>
                  <InternalNormalItem
                    internal_item_id="b04290f2-cf24-4bd6-8c00-821a0948663c"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>3.  </Identifier>
          </ListItem>
        </inner_list_items>
        <ListType>Number</ListType>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="a7df7c28-0b78-4603-83f6-8225edcc58b5"
        item_type="FencedCodeBlock"
        item_footer="">
        <codeblock_wraper> ```</codeblock_wraper>
        <code_block> get-vm | where {$_.State –eq ‘Off’}
</code_block>
        <fenced_code_lang>powershell</fenced_code_lang>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="60b74aab-bfba-44ce-aa0e-baba45474a72"
        item_type="Header"
        item_footer="footer_not_set">
        <header_type>Star</header_type>
        <header_level>3</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownListBlock"
        item_id="e823f950-58cd-4f27-a96c-ff790c4015c1"
        item_type="List"
        item_footer="">
        <inner_list_items>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="058a9fdf-a9ed-481b-b699-415ce5771da1"
              item_type="NormalParagraph"
              item_footer="footer_not_set">
              <paragraph_segments>
                <MarkdownSegment>
                  <SegmentId>52f458c1-020a-4e39-ac28-3986c55bcef1</SegmentId>
                  <InternalNormalItem
                    internal_item_id="e644ae1b-9e70-4b56-92a9-43e719846d9a"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>1. </Identifier>
          </ListItem>
        </inner_list_items>
        <ListType>Number</ListType>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="a877cdbe-9dd1-4fab-bc7d-fa9d003fafc2"
        item_type="FencedCodeBlock"
        item_footer="">
        <codeblock_wraper> ```</codeblock_wraper>
        <code_block> Start-vm –Name &lt;virtual machine name&gt;
</code_block>
        <fenced_code_lang>powershell</fenced_code_lang>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownListBlock"
        item_id="c4a5206d-0cc2-418b-b66b-955caff453f0"
        item_type="List"
        item_footer="">
        <inner_list_items>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="64991bf3-9be6-4317-9992-3cae4e659895"
              item_type="NormalParagraph"
              item_footer="footer_not_set">
              <paragraph_segments>
                <MarkdownSegment>
                  <SegmentId>75e74a23-79d1-4463-a990-c4349acfa609</SegmentId>
                  <InternalNormalItem
                    internal_item_id="dfc16b7b-743e-41b8-b043-e26262a96c90"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>2. </Identifier>
          </ListItem>
        </inner_list_items>
        <ListType>Number</ListType>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="53f50ae6-822a-4635-be41-a03646895d64"
        item_type="FencedCodeBlock"
        item_footer="">
        <codeblock_wraper>  ```</codeblock_wraper>
        <code_block> get-vm | where {$_.State –eq ‘Off’} | start-vm
 ```
3. To shut down all running virtual machines, run this:

  ```powershell
 get-vm | where {$_.State –eq ‘Running’} | stop-vm
 ```

### Create a VM checkpoint

To create a checkpoint using PowerShell, select the virtual machine using the `get-vm` command and pipe this to the `checkpoint-vm` command. Finally give the checkpoint a name using `-snapshotname`. The complete command will look like the following:

 ```powershell
 get-vm -Name &lt;VM Name&gt; | checkpoint-vm -snapshotname &lt;name for snapshot&gt;
 ```
For example, here is a checkpoint with the name DEMOCP:

 ![](media\POSH_CP2.png)

### Create a new virtual machine

The following example shows how to create a new virtual machine in the PowerShell Integrated Scripting Environment (ISE). This is a simple example and could be expanded on to include additional PowerShell features and more advanced VM deployments.

1. To open the PowerShell ISE click on start, type **PowerShell ISE**.
2. Run the following code to create a virtual machine. See the [New-VM](https://technet.microsoft.com/en-us/library/hh848537.aspx) documentation for detailed information on the New-VM command.

  ```powershell
 $VMName = "VMNAME"

 $VM = @{
     Name = $VMName 
     MemoryStartupBytes = 2147483648
     Generation = 2
     NewVHDPath = "C:\Virtual Machines\$VMName\$VMName.vhdx"
     NewVHDSizeBytes = 53687091200
     BootDevice = "VHD"
     Path = "C:\Virtual Machines\$VMName "
     SwitchName = (get-vmswitch).Name[0]
 }

 New-VM @VM
</code_block>
        <fenced_code_lang>powershell</fenced_code_lang>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="248c8583-ff98-49e0-b86b-295202980a3a"
        item_type="Header"
        item_footer="footer_not_set">
        <header_type>Star</header_type>
        <header_level>2</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="6298f440-3bdc-4fbe-b343-18b5b04364fe"
        item_type="NormalParagraph"
        item_footer="&#xA;&#xA;&#xA;&#xA;">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>a21c0956-8408-4b0d-8b83-e7d716f7fd1c</SegmentId>
            <InternalNormalItem
              internal_item_id="bec97ebe-f64e-49fc-9745-bd622fc291dc"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment>
            <SegmentId>5034cff5-1cf8-42ec-8f76-073a2262879e</SegmentId>
            <InternalNormalItem
              internal_item_id="48cf5da5-a105-4746-9eec-31eaeb167ca3"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
            <LinkItem
              internal_item_id="dff2a0a3-767d-4135-87fb-71fa943dba55"
              internal_item_type="Link">
              <internal_items />
              <internal_link_type>Inline</internal_link_type>
              <internal_link_text>Hyper-V Cmdlets in Windows PowerShell reference</internal_link_text>
              <internal_link_url>https://technet.microsoft.com/%5Clibrary/Hh848559.aspx</internal_link_url>
              <internal_link_title />
            </LinkItem>
            <InternalNormalItem
              internal_item_id="f9616534-a472-49e0-911d-54e87bf4d9a3"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
    </ArrayOfMarkdownBlockBase>
  </block_element>
  <references>
    <ArrayOfMarkdownLinkedReference xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
  </references>
</markdown_skeleton_root>