{
  "nodes": [
    {
      "pos": [
        28,
        116
      ],
      "content": "How to authorize developer accounts using Azure Active Directory in Azure API Management"
    },
    {
      "pos": [
        136,
        212
      ],
      "content": "Learn how to authorize users using Azure Active Directory in API Management."
    },
    {
      "pos": [
        540,
        628
      ],
      "content": "How to authorize developer accounts using Azure Active Directory in Azure API Management"
    },
    {
      "pos": [
        634,
        642
      ],
      "content": "Overview"
    },
    {
      "pos": [
        643,
        921
      ],
      "content": "This guide shows you how to enable access to the developer portal for all users in one or more Azure Active Directories. This guide also shows you how to manage groups of Azure Active Directory users by adding external groups that contain the users of an Azure Active Directory.",
      "nodes": [
        {
          "content": "This guide shows you how to enable access to the developer portal for all users in one or more Azure Active Directories.",
          "pos": [
            0,
            120
          ]
        },
        {
          "content": "This guide also shows you how to manage groups of Azure Active Directory users by adding external groups that contain the users of an Azure Active Directory.",
          "pos": [
            121,
            278
          ]
        }
      ]
    },
    {
      "pos": [
        924,
        1040
      ],
      "content": "To complete the steps in this guide you must first have an Azure Active Directory in which to create an application."
    },
    {
      "pos": [
        1045,
        1109
      ],
      "content": "How to authorize developer accounts using Azure Active Directory"
    },
    {
      "pos": [
        1111,
        1259
      ],
      "content": "To get started, click <bpt id=\"p1\">**</bpt>Manage<ept id=\"p1\">**</ept><ph id=\"ph2\"/> in the Azure Classic Portal for your API Management service. This takes you to the API Management publisher portal.",
      "nodes": [
        {
          "content": "To get started, click <bpt id=\"p1\">**</bpt>Manage<ept id=\"p1\">**</ept><ph id=\"ph2\"/> in the Azure Classic Portal for your API Management service.",
          "pos": [
            0,
            145
          ]
        },
        {
          "content": "This takes you to the API Management publisher portal.",
          "pos": [
            146,
            200
          ]
        }
      ]
    },
    {
      "pos": [
        1261,
        1315
      ],
      "content": "<ph id=\"ph3\">![</ph>Publisher portal<ph id=\"ph4\">][api-management-management-console]</ph>"
    },
    {
      "pos": [
        1318,
        1490
      ],
      "content": "If you have not yet created an API Management service instance, see <bpt id=\"p2\">[</bpt>Create an API Management service instance<ept id=\"p2\">][]</ept><ph id=\"ph5\"/> in the <bpt id=\"p3\">[</bpt>Get started with Azure API Management<ept id=\"p3\">][]</ept><ph id=\"ph6\"/> tutorial."
    },
    {
      "pos": [
        1492,
        1590
      ],
      "content": "Click <bpt id=\"p4\">**</bpt>Security<ept id=\"p4\">**</ept><ph id=\"ph7\"/> from the <bpt id=\"p5\">**</bpt>API Management<ept id=\"p5\">**</ept><ph id=\"ph8\"/> menu on the left and click <bpt id=\"p6\">**</bpt>External Identities<ept id=\"p6\">**</ept>."
    },
    {
      "pos": [
        1592,
        1659
      ],
      "content": "<ph id=\"ph9\">![</ph>External Identities<ph id=\"ph10\">][api-management-security-external-identities]</ph>"
    },
    {
      "pos": [
        1661,
        1806
      ],
      "content": "Click <bpt id=\"p7\">**</bpt>Azure Active Directory<ept id=\"p7\">**</ept>. Make a note of the <bpt id=\"p8\">**</bpt>Redirect URL<ept id=\"p8\">**</ept><ph id=\"ph11\"/> and switch over to your Azure Active Directory in the Azure Classic Portal.",
      "nodes": [
        {
          "content": "Click <bpt id=\"p7\">**</bpt>Azure Active Directory<ept id=\"p7\">**</ept>.",
          "pos": [
            0,
            71
          ]
        },
        {
          "content": "Make a note of the <bpt id=\"p8\">**</bpt>Redirect URL<ept id=\"p8\">**</ept><ph id=\"ph11\"/> and switch over to your Azure Active Directory in the Azure Classic Portal.",
          "pos": [
            72,
            236
          ]
        }
      ]
    },
    {
      "pos": [
        1808,
        1863
      ],
      "content": "<ph id=\"ph12\">![</ph>External Identities<ph id=\"ph13\">][api-management-security-aad-new]</ph>"
    },
    {
      "pos": [
        1865,
        2006
      ],
      "content": "Click the <bpt id=\"p9\">**</bpt>Add<ept id=\"p9\">**</ept><ph id=\"ph14\"/> button to create a new Azure Active Directory application, and choose <bpt id=\"p10\">**</bpt>Add an application my organization is developing<ept id=\"p10\">**</ept>."
    },
    {
      "pos": [
        2008,
        2094
      ],
      "content": "<ph id=\"ph15\">![</ph>Add new Azure Active Directory application<ph id=\"ph16\">][api-management-new-aad-application-menu]</ph>"
    },
    {
      "pos": [
        2096,
        2199
      ],
      "content": "Enter a name for the application, select <bpt id=\"p11\">**</bpt>Web application and/or Web API<ept id=\"p11\">**</ept>, and click the next button."
    },
    {
      "pos": [
        2201,
        2280
      ],
      "content": "<ph id=\"ph17\">![</ph>New Azure Active Directory application<ph id=\"ph18\">][api-management-new-aad-application-1]</ph>"
    },
    {
      "pos": [
        2282,
        2584
      ],
      "content": "For <bpt id=\"p12\">**</bpt>Sign-on URL<ept id=\"p12\">**</ept>, copy the <bpt id=\"p13\">**</bpt>Redirect URL<ept id=\"p13\">**</ept><ph id=\"ph19\"/> from the <bpt id=\"p14\">**</bpt>Azure Active Directory<ept id=\"p14\">**</ept><ph id=\"ph20\"/> section of the <bpt id=\"p15\">**</bpt>External Identities<ept id=\"p15\">**</ept><ph id=\"ph21\"/> tab in the publisher portal and remove the <bpt id=\"p16\">**</bpt>-aad<ept id=\"p16\">**</ept><ph id=\"ph22\"/> suffix from the end of the URL. In this example, the <bpt id=\"p17\">**</bpt>Sign-on URL<ept id=\"p17\">**</ept><ph id=\"ph23\"/> is <ph id=\"ph24\">`https://aad03.portal.current.int-azure-api.net/signin`</ph>.",
      "nodes": [
        {
          "content": "For <bpt id=\"p12\">**</bpt>Sign-on URL<ept id=\"p12\">**</ept>, copy the <bpt id=\"p13\">**</bpt>Redirect URL<ept id=\"p13\">**</ept><ph id=\"ph19\"/> from the <bpt id=\"p14\">**</bpt>Azure Active Directory<ept id=\"p14\">**</ept><ph id=\"ph20\"/> section of the <bpt id=\"p15\">**</bpt>External Identities<ept id=\"p15\">**</ept><ph id=\"ph21\"/> tab in the publisher portal and remove the <bpt id=\"p16\">**</bpt>-aad<ept id=\"p16\">**</ept><ph id=\"ph22\"/> suffix from the end of the URL.",
          "pos": [
            0,
            465
          ]
        },
        {
          "content": "In this example, the <bpt id=\"p17\">**</bpt>Sign-on URL<ept id=\"p17\">**</ept><ph id=\"ph23\"/> is <ph id=\"ph24\">`https://aad03.portal.current.int-azure-api.net/signin`</ph>.",
          "pos": [
            466,
            636
          ]
        }
      ]
    },
    {
      "pos": [
        2587,
        2852
      ],
      "content": "For the <bpt id=\"p18\">**</bpt>App ID URL<ept id=\"p18\">**</ept>, enter either the default domain or a custom domain for the Azure Active Directory, and append a unique string to it. In this example the default domain of <bpt id=\"p19\">**</bpt>https://contoso5api.onmicrosoft.com<ept id=\"p19\">**</ept><ph id=\"ph25\"/> is used with the suffix of <bpt id=\"p20\">**</bpt>/api<ept id=\"p20\">**</ept><ph id=\"ph26\"/> specified.",
      "nodes": [
        {
          "content": "For the <bpt id=\"p18\">**</bpt>App ID URL<ept id=\"p18\">**</ept>, enter either the default domain or a custom domain for the Azure Active Directory, and append a unique string to it.",
          "pos": [
            0,
            180
          ]
        },
        {
          "content": "In this example the default domain of <bpt id=\"p19\">**</bpt>https://contoso5api.onmicrosoft.com<ept id=\"p19\">**</ept><ph id=\"ph25\"/> is used with the suffix of <bpt id=\"p20\">**</bpt>/api<ept id=\"p20\">**</ept><ph id=\"ph26\"/> specified.",
          "pos": [
            181,
            415
          ]
        }
      ]
    },
    {
      "pos": [
        2854,
        2944
      ],
      "content": "<ph id=\"ph27\">![</ph>New Azure Active Directory application properties<ph id=\"ph28\">][api-management-new-aad-application-2]</ph>"
    },
    {
      "pos": [
        2946,
        3079
      ],
      "content": "Click the check button to save and create the new application, and switch  to the <bpt id=\"p21\">**</bpt>Configure<ept id=\"p21\">**</ept><ph id=\"ph29\"/> tab to configure the new application."
    },
    {
      "pos": [
        3081,
        3166
      ],
      "content": "<ph id=\"ph30\">![</ph>New Azure Active Directory application created<ph id=\"ph31\">][api-management-new-aad-app-created]</ph>"
    },
    {
      "pos": [
        3168,
        3321
      ],
      "content": "If multiple Azure Active Directories are going to be used for this application, click <bpt id=\"p22\">**</bpt>Yes<ept id=\"p22\">**</ept><ph id=\"ph32\"/> for <bpt id=\"p23\">**</bpt>Application is multi-tenant<ept id=\"p23\">**</ept>. The default is <bpt id=\"p24\">**</bpt>No<ept id=\"p24\">**</ept>.",
      "nodes": [
        {
          "content": "If multiple Azure Active Directories are going to be used for this application, click <bpt id=\"p22\">**</bpt>Yes<ept id=\"p22\">**</ept><ph id=\"ph32\"/> for <bpt id=\"p23\">**</bpt>Application is multi-tenant<ept id=\"p23\">**</ept>.",
          "pos": [
            0,
            225
          ]
        },
        {
          "content": "The default is <bpt id=\"p24\">**</bpt>No<ept id=\"p24\">**</ept>.",
          "pos": [
            226,
            288
          ]
        }
      ]
    },
    {
      "pos": [
        3323,
        3390
      ],
      "content": "<ph id=\"ph33\">![</ph>Application is multi-tenant<ph id=\"ph34\">][api-management-aad-app-multi-tenant]</ph>"
    },
    {
      "pos": [
        3392,
        3566
      ],
      "content": "Copy the <bpt id=\"p25\">**</bpt>Redirect URL<ept id=\"p25\">**</ept><ph id=\"ph35\"/> from the <bpt id=\"p26\">**</bpt>Azure Active Directory<ept id=\"p26\">**</ept><ph id=\"ph36\"/> section of the <bpt id=\"p27\">**</bpt>External Identities<ept id=\"p27\">**</ept><ph id=\"ph37\"/> tab in the publisher portal and paste it into the <bpt id=\"p28\">**</bpt>Reply URL<ept id=\"p28\">**</ept><ph id=\"ph38\"/> text box."
    },
    {
      "pos": [
        3569,
        3611
      ],
      "content": "<ph id=\"ph39\">![</ph>Reply URL<ph id=\"ph40\">][api-management-aad-reply-url]</ph>"
    },
    {
      "pos": [
        3613,
        3740
      ],
      "content": "Scroll to the bottom of the configure tab, select the <bpt id=\"p29\">**</bpt>Application Permissions<ept id=\"p29\">**</ept><ph id=\"ph41\"/> drop-down, and check <bpt id=\"p30\">**</bpt>Read directory data<ept id=\"p30\">**</ept>."
    },
    {
      "pos": [
        3742,
        3804
      ],
      "content": "<ph id=\"ph42\">![</ph>Application Permissions<ph id=\"ph43\">][api-management-aad-app-permissions]</ph>"
    },
    {
      "pos": [
        3806,
        3907
      ],
      "content": "Select the <bpt id=\"p31\">**</bpt>Delegate Permissions<ept id=\"p31\">**</ept><ph id=\"ph44\"/> drop-down, and check <bpt id=\"p32\">**</bpt>Enable sign-on and read users' profiles<ept id=\"p32\">**</ept>."
    },
    {
      "pos": [
        3909,
        3975
      ],
      "content": "<ph id=\"ph45\">![</ph>Delegated Permissions<ph id=\"ph46\">][api-management-aad-delegated-permissions]</ph>"
    },
    {
      "pos": [
        3978,
        4076
      ],
      "content": "For more information about application and delegated permissions, see <bpt id=\"p33\">[</bpt>Accessing the Graph API<ept id=\"p33\">][]</ept>."
    },
    {
      "pos": [
        4078,
        4118
      ],
      "content": "Copy the <bpt id=\"p34\">**</bpt>Client Id<ept id=\"p34\">**</ept><ph id=\"ph47\"/> to the clipboard."
    },
    {
      "pos": [
        4120,
        4166
      ],
      "content": "<ph id=\"ph48\">![</ph>Client Id<ph id=\"ph49\">][api-management-aad-app-client-id]</ph>"
    },
    {
      "pos": [
        4168,
        4300
      ],
      "content": "Switch back to the publisher portal and paste in the <bpt id=\"p35\">**</bpt>Client Id<ept id=\"p35\">**</ept><ph id=\"ph50\"/> copied from the Azure Active Directory application configuration."
    },
    {
      "pos": [
        4302,
        4340
      ],
      "content": "<ph id=\"ph51\">![</ph>Client Id<ph id=\"ph52\">][api-management-client-id]</ph>"
    },
    {
      "pos": [
        4342,
        4527
      ],
      "content": "Switch back to the Azure Active Directory configuration, and click the <bpt id=\"p36\">**</bpt>Select duration<ept id=\"p36\">**</ept><ph id=\"ph53\"/> drop-down in the <bpt id=\"p37\">**</bpt>Keys<ept id=\"p37\">**</ept><ph id=\"ph54\"/> section and specify an interval. In this example <bpt id=\"p38\">**</bpt>1 year<ept id=\"p38\">**</ept><ph id=\"ph55\"/> is used.",
      "nodes": [
        {
          "content": "Switch back to the Azure Active Directory configuration, and click the <bpt id=\"p36\">**</bpt>Select duration<ept id=\"p36\">**</ept><ph id=\"ph53\"/> drop-down in the <bpt id=\"p37\">**</bpt>Keys<ept id=\"p37\">**</ept><ph id=\"ph54\"/> section and specify an interval.",
          "pos": [
            0,
            259
          ]
        },
        {
          "content": "In this example <bpt id=\"p38\">**</bpt>1 year<ept id=\"p38\">**</ept><ph id=\"ph55\"/> is used.",
          "pos": [
            260,
            350
          ]
        }
      ]
    },
    {
      "pos": [
        4529,
        4571
      ],
      "content": "<ph id=\"ph56\">![</ph>Key<ph id=\"ph57\">][api-management-aad-key-before-save]</ph>"
    },
    {
      "pos": [
        4573,
        4665
      ],
      "content": "Click <bpt id=\"p39\">**</bpt>Save<ept id=\"p39\">**</ept><ph id=\"ph58\"/> to save the configuration and display the key. Copy the key to the clipboard.",
      "nodes": [
        {
          "content": "Click <bpt id=\"p39\">**</bpt>Save<ept id=\"p39\">**</ept><ph id=\"ph58\"/> to save the configuration and display the key.",
          "pos": [
            0,
            116
          ]
        },
        {
          "content": "Copy the key to the clipboard.",
          "pos": [
            117,
            147
          ]
        }
      ]
    },
    {
      "pos": [
        4668,
        4791
      ],
      "content": "Make a note of this key. Once you close the Azure Active Directory configuration window, the key cannot be displayed again.",
      "nodes": [
        {
          "content": "Make a note of this key.",
          "pos": [
            0,
            24
          ]
        },
        {
          "content": "Once you close the Azure Active Directory configuration window, the key cannot be displayed again.",
          "pos": [
            25,
            123
          ]
        }
      ]
    },
    {
      "pos": [
        4793,
        4834
      ],
      "content": "<ph id=\"ph59\">![</ph>Key<ph id=\"ph60\">][api-management-aad-key-after-save]</ph>"
    },
    {
      "pos": [
        4836,
        4926
      ],
      "content": "Switch back to the publisher portal and paste the key into the <bpt id=\"p40\">**</bpt>Client Secret<ept id=\"p40\">**</ept><ph id=\"ph61\"/> text box."
    },
    {
      "pos": [
        4928,
        4974
      ],
      "content": "<ph id=\"ph62\">![</ph>Client Secret<ph id=\"ph63\">][api-management-client-secret]</ph>"
    },
    {
      "pos": [
        4976,
        5250
      ],
      "content": "<bpt id=\"p41\">**</bpt>Allowed Tenants<ept id=\"p41\">**</ept><ph id=\"ph64\"/> specifies which directories have access to the APIs of the API Management service instance. Specify the domains of the Azure Active Directory instances to which you want to grant access. You can separate multiple domains with newlines, spaces, or commas.",
      "nodes": [
        {
          "content": "<bpt id=\"p41\">**</bpt>Allowed Tenants<ept id=\"p41\">**</ept><ph id=\"ph64\"/> specifies which directories have access to the APIs of the API Management service instance.",
          "pos": [
            0,
            166
          ]
        },
        {
          "content": "Specify the domains of the Azure Active Directory instances to which you want to grant access.",
          "pos": [
            167,
            261
          ]
        },
        {
          "content": "You can separate multiple domains with newlines, spaces, or commas.",
          "pos": [
            262,
            329
          ]
        }
      ]
    },
    {
      "pos": [
        5252,
        5309
      ],
      "content": "<ph id=\"ph65\">![</ph>Allowed tenants<ph id=\"ph66\">][api-management-client-allowed-tenants]</ph>"
    },
    {
      "pos": [
        5311,
        5873
      ],
      "content": "Multiple domains can be specified in the <bpt id=\"p42\">**</bpt>Allowed Tenants<ept id=\"p42\">**</ept><ph id=\"ph67\"/> section. Before any user can log in from a different domain than the original domain where the application was registered, a global administrator of the different domain must grant permission for the application to access directory data. To grant permission, a global administrator must log in to the application and click <bpt id=\"p43\">**</bpt>Accept<ept id=\"p43\">**</ept>. In the following example <ph id=\"ph68\">`miaoaad.onmicrosoft.com`</ph><ph id=\"ph69\"/> has been added to <bpt id=\"p44\">**</bpt>Allowed Tenants<ept id=\"p44\">**</ept><ph id=\"ph70\"/> and a global administrator from that domain is logging in for the first time.",
      "nodes": [
        {
          "content": "Multiple domains can be specified in the <bpt id=\"p42\">**</bpt>Allowed Tenants<ept id=\"p42\">**</ept><ph id=\"ph67\"/> section.",
          "pos": [
            0,
            124
          ]
        },
        {
          "content": "Before any user can log in from a different domain than the original domain where the application was registered, a global administrator of the different domain must grant permission for the application to access directory data.",
          "pos": [
            125,
            353
          ]
        },
        {
          "content": "To grant permission, a global administrator must log in to the application and click <bpt id=\"p43\">**</bpt>Accept<ept id=\"p43\">**</ept>.",
          "pos": [
            354,
            490
          ]
        },
        {
          "content": "In the following example <ph id=\"ph68\">`miaoaad.onmicrosoft.com`</ph><ph id=\"ph69\"/> has been added to <bpt id=\"p44\">**</bpt>Allowed Tenants<ept id=\"p44\">**</ept><ph id=\"ph70\"/> and a global administrator from that domain is logging in for the first time.",
          "pos": [
            491,
            746
          ]
        }
      ]
    },
    {
      "pos": [
        5875,
        5922
      ],
      "content": "<ph id=\"ph71\">![</ph>Permissions<ph id=\"ph72\">][api-management-permissions-form]</ph>"
    },
    {
      "pos": [
        5925,
        6086
      ],
      "content": "If a non-global administrator tries to log in before permissions are granted by a global administrator, the login attempt fails and an error screen is displayed."
    },
    {
      "pos": [
        6088,
        6148
      ],
      "content": "Once the desired configuration is specified, click <bpt id=\"p45\">**</bpt>Save<ept id=\"p45\">**</ept>."
    },
    {
      "pos": [
        6150,
        6201
      ],
      "content": "<ph id=\"ph73\">![</ph>Save<ph id=\"ph74\">][api-management-client-allowed-tenants-save]</ph>"
    },
    {
      "pos": [
        6203,
        6416
      ],
      "content": "Once the changes are saved, the users in the specified Azure Active Directory can log into the Developer portal by following the steps in <bpt id=\"p46\">[</bpt>Log in to the Developer portal using an Azure Active Directory account<ept id=\"p46\">][]</ept>."
    },
    {
      "pos": [
        6421,
        6472
      ],
      "content": "How to add an external Azure Active Directory Group"
    },
    {
      "pos": [
        6474,
        6693
      ],
      "content": "After enabling access for users in an Azure Active Directory, you can add Azure Active Directory groups into API Management to more easily manage the association of the developers in the group with the desired products."
    },
    {
      "pos": [
        6697,
        6886
      ],
      "content": "In order to configure an external Azure Active Directory group, the Azure Active Directory must first be configured in the Identities tab by following the procedure in the previous section."
    },
    {
      "pos": [
        6889,
        7097
      ],
      "content": "External Azure Active Directory groups are added from the <bpt id=\"p47\">**</bpt>Visibility<ept id=\"p47\">**</ept><ph id=\"ph75\"/> tab of the product for which you wish to grant access to the group. Click <bpt id=\"p48\">**</bpt>Products<ept id=\"p48\">**</ept>, and then click the name of the desired product.",
      "nodes": [
        {
          "content": "External Azure Active Directory groups are added from the <bpt id=\"p47\">**</bpt>Visibility<ept id=\"p47\">**</ept><ph id=\"ph75\"/> tab of the product for which you wish to grant access to the group.",
          "pos": [
            0,
            195
          ]
        },
        {
          "content": "Click <bpt id=\"p48\">**</bpt>Products<ept id=\"p48\">**</ept>, and then click the name of the desired product.",
          "pos": [
            196,
            303
          ]
        }
      ]
    },
    {
      "pos": [
        7099,
        7153
      ],
      "content": "<ph id=\"ph76\">![</ph>Configure product<ph id=\"ph77\">][api-management-configure-product]</ph>"
    },
    {
      "pos": [
        7155,
        7242
      ],
      "content": "Switch to the <bpt id=\"p49\">**</bpt>Visibility<ept id=\"p49\">**</ept><ph id=\"ph78\"/> tab, and click <bpt id=\"p50\">**</bpt>Add Groups from Azure Active Directory<ept id=\"p50\">**</ept>."
    },
    {
      "pos": [
        7244,
        7284
      ],
      "content": "<ph id=\"ph79\">![</ph>Add groups<ph id=\"ph80\">][api-management-add-groups]</ph>"
    },
    {
      "pos": [
        7286,
        7439
      ],
      "content": "Select the <bpt id=\"p51\">**</bpt>Azure Active Directory Tenant<ept id=\"p51\">**</ept><ph id=\"ph81\"/> from the drop-down list, and then type the name of the desired group in the <bpt id=\"p52\">**</bpt>Groups<ept id=\"p52\">**</ept><ph id=\"ph82\"/> to be added text box."
    },
    {
      "pos": [
        7441,
        7485
      ],
      "content": "<ph id=\"ph83\">![</ph>Select group<ph id=\"ph84\">][api-management-select-group]</ph>"
    },
    {
      "pos": [
        7487,
        7606
      ],
      "content": "This group name can be found in the <bpt id=\"p53\">**</bpt>Groups<ept id=\"p53\">**</ept><ph id=\"ph85\"/> list for your Azure Active Directory, as shown in the following example."
    },
    {
      "pos": [
        7608,
        7677
      ],
      "content": "<ph id=\"ph86\">![</ph>Azure Active Directory Groups List<ph id=\"ph87\">][api-management-aad-groups-list]</ph>"
    },
    {
      "pos": [
        7679,
        7808
      ],
      "content": "Click <bpt id=\"p54\">**</bpt>Add<ept id=\"p54\">**</ept><ph id=\"ph88\"/> to validate the group name and add the group. In this example the <bpt id=\"p55\">**</bpt>Contoso 5 Developers<ept id=\"p55\">**</ept><ph id=\"ph89\"/> external group is added.",
      "nodes": [
        {
          "content": "Click <bpt id=\"p54\">**</bpt>Add<ept id=\"p54\">**</ept><ph id=\"ph88\"/> to validate the group name and add the group.",
          "pos": [
            0,
            114
          ]
        },
        {
          "content": "In this example the <bpt id=\"p55\">**</bpt>Contoso 5 Developers<ept id=\"p55\">**</ept><ph id=\"ph89\"/> external group is added.",
          "pos": [
            115,
            239
          ]
        }
      ]
    },
    {
      "pos": [
        7811,
        7857
      ],
      "content": "<ph id=\"ph90\">![</ph>Group added<ph id=\"ph91\">][api-management-aad-group-added]</ph>"
    },
    {
      "pos": [
        7859,
        7906
      ],
      "content": "Click <bpt id=\"p56\">**</bpt>Save<ept id=\"p56\">**</ept><ph id=\"ph92\"/> to save the new group selection."
    },
    {
      "pos": [
        7908,
        8107
      ],
      "content": "Once an Azure Azure Active Directory group has been configured from one product, it is available to be checked on the <bpt id=\"p57\">**</bpt>Visibility<ept id=\"p57\">**</ept><ph id=\"ph93\"/> tab for the other products in the API Management service instance."
    },
    {
      "pos": [
        8109,
        8250
      ],
      "content": "To review and configure the properties for external groups once they have been added, click on the name of the group from the <bpt id=\"p58\">**</bpt>Groups<ept id=\"p58\">**</ept><ph id=\"ph94\"/> tab."
    },
    {
      "pos": [
        8252,
        8291
      ],
      "content": "<ph id=\"ph95\">![</ph>Manage groups<ph id=\"ph96\">][api-management-groups]</ph>"
    },
    {
      "pos": [
        8293,
        8366
      ],
      "content": "From here you can edit the <bpt id=\"p59\">**</bpt>Name<ept id=\"p59\">**</ept><ph id=\"ph97\"/> and the <bpt id=\"p60\">**</bpt>Description<ept id=\"p60\">**</ept><ph id=\"ph98\"/> of the group."
    },
    {
      "pos": [
        8368,
        8408
      ],
      "content": "<ph id=\"ph99\">![</ph>Edit group<ph id=\"ph100\">][api-management-edit-group]</ph>"
    },
    {
      "pos": [
        8410,
        8616
      ],
      "content": "Users from the configured Azure Active Directory can log into the Developer portal and view and subscribe to any groups for which they have visibility by following the instructions in the following section."
    },
    {
      "pos": [
        8621,
        8698
      ],
      "content": "How to log in to the Developer portal using an Azure Active Directory account"
    },
    {
      "pos": [
        8700,
        8952
      ],
      "content": "To log into the Developer portal using an Azure Active Directory account configured in the previous sections, open a new browser window using the <bpt id=\"p61\">**</bpt>Sign-on URL<ept id=\"p61\">**</ept><ph id=\"ph101\"/> from the Active Directory application configuration, and click <bpt id=\"p62\">**</bpt>Azure Active Directory<ept id=\"p62\">**</ept>."
    },
    {
      "pos": [
        8954,
        9007
      ],
      "content": "<ph id=\"ph102\">![</ph>Developer Portal<ph id=\"ph103\">][api-management-dev-portal-signin]</ph>"
    },
    {
      "pos": [
        9009,
        9105
      ],
      "content": "Enter the credentials of one of the users in your Azure Active Directory, and click <bpt id=\"p63\">**</bpt>Sign in<ept id=\"p63\">**</ept>."
    },
    {
      "pos": [
        9107,
        9144
      ],
      "content": "<ph id=\"ph104\">![</ph>Sign in<ph id=\"ph105\">][api-management-aad-signin]</ph>"
    },
    {
      "pos": [
        9146,
        9287
      ],
      "content": "You may be prompted with a registration form if any additional information is required. Complete the registration form and click <bpt id=\"p64\">**</bpt>Sign up<ept id=\"p64\">**</ept>.",
      "nodes": [
        {
          "content": "You may be prompted with a registration form if any additional information is required.",
          "pos": [
            0,
            87
          ]
        },
        {
          "content": "Complete the registration form and click <bpt id=\"p64\">**</bpt>Sign up<ept id=\"p64\">**</ept>.",
          "pos": [
            88,
            181
          ]
        }
      ]
    },
    {
      "pos": [
        9289,
        9342
      ],
      "content": "<ph id=\"ph106\">![</ph>Registration<ph id=\"ph107\">][api-management-complete-registration]</ph>"
    },
    {
      "pos": [
        9344,
        9435
      ],
      "content": "Your user is now logged into the developer portal for your API Management service instance."
    },
    {
      "pos": [
        9437,
        9499
      ],
      "content": "<ph id=\"ph108\">![</ph>Registration Complete<ph id=\"ph109\">][api-management-registration-complete]</ph>"
    }
  ],
  "content": "<properties \n    pageTitle=\"How to authorize developer accounts using Azure Active Directory in Azure API Management\" \n    description=\"Learn how to authorize users using Azure Active Directory in API Management.\" \n    services=\"api-management\" \n    documentationCenter=\"API Management\" \n    authors=\"steved0x\" \n    manager=\"dwrede\" \n    editor=\"\"/>\n\n<tags \n    ms.service=\"api-management\" \n    ms.workload=\"mobile\" \n    ms.tgt_pltfrm=\"na\" \n    ms.devlang=\"na\" \n    ms.topic=\"article\" \n    ms.date=\"12/07/2015\" \n    ms.author=\"sdanie\"/>\n\n# How to authorize developer accounts using Azure Active Directory in Azure API Management\n\n\n## Overview\nThis guide shows you how to enable access to the developer portal for all users in one or more Azure Active Directories. This guide also shows you how to manage groups of Azure Active Directory users by adding external groups that contain the users of an Azure Active Directory.\n\n>To complete the steps in this guide you must first have an Azure Active Directory in which to create an application.\n\n## How to authorize developer accounts using Azure Active Directory\n\nTo get started, click **Manage** in the Azure Classic Portal for your API Management service. This takes you to the API Management publisher portal.\n\n![Publisher portal][api-management-management-console]\n\n>If you have not yet created an API Management service instance, see [Create an API Management service instance][] in the [Get started with Azure API Management][] tutorial.\n\nClick **Security** from the **API Management** menu on the left and click **External Identities**.\n\n![External Identities][api-management-security-external-identities]\n\nClick **Azure Active Directory**. Make a note of the **Redirect URL** and switch over to your Azure Active Directory in the Azure Classic Portal.\n\n![External Identities][api-management-security-aad-new]\n\nClick the **Add** button to create a new Azure Active Directory application, and choose **Add an application my organization is developing**.\n\n![Add new Azure Active Directory application][api-management-new-aad-application-menu]\n\nEnter a name for the application, select **Web application and/or Web API**, and click the next button.\n\n![New Azure Active Directory application][api-management-new-aad-application-1]\n\nFor **Sign-on URL**, copy the **Redirect URL** from the **Azure Active Directory** section of the **External Identities** tab in the publisher portal and remove the **-aad** suffix from the end of the URL. In this example, the **Sign-on URL** is `https://aad03.portal.current.int-azure-api.net/signin`. \n\nFor the **App ID URL**, enter either the default domain or a custom domain for the Azure Active Directory, and append a unique string to it. In this example the default domain of **https://contoso5api.onmicrosoft.com** is used with the suffix of **/api** specified.\n\n![New Azure Active Directory application properties][api-management-new-aad-application-2]\n\nClick the check button to save and create the new application, and switch  to the **Configure** tab to configure the new application.\n\n![New Azure Active Directory application created][api-management-new-aad-app-created]\n\nIf multiple Azure Active Directories are going to be used for this application, click **Yes** for **Application is multi-tenant**. The default is **No**.\n\n![Application is multi-tenant][api-management-aad-app-multi-tenant]\n\nCopy the **Redirect URL** from the **Azure Active Directory** section of the **External Identities** tab in the publisher portal and paste it into the **Reply URL** text box. \n\n![Reply URL][api-management-aad-reply-url]\n\nScroll to the bottom of the configure tab, select the **Application Permissions** drop-down, and check **Read directory data**.\n\n![Application Permissions][api-management-aad-app-permissions]\n\nSelect the **Delegate Permissions** drop-down, and check **Enable sign-on and read users' profiles**.\n\n![Delegated Permissions][api-management-aad-delegated-permissions]\n\n>For more information about application and delegated permissions, see [Accessing the Graph API][].\n\nCopy the **Client Id** to the clipboard.\n\n![Client Id][api-management-aad-app-client-id]\n\nSwitch back to the publisher portal and paste in the **Client Id** copied from the Azure Active Directory application configuration.\n\n![Client Id][api-management-client-id]\n\nSwitch back to the Azure Active Directory configuration, and click the **Select duration** drop-down in the **Keys** section and specify an interval. In this example **1 year** is used.\n\n![Key][api-management-aad-key-before-save]\n\nClick **Save** to save the configuration and display the key. Copy the key to the clipboard.\n\n>Make a note of this key. Once you close the Azure Active Directory configuration window, the key cannot be displayed again.\n\n![Key][api-management-aad-key-after-save]\n\nSwitch back to the publisher portal and paste the key into the **Client Secret** text box.\n\n![Client Secret][api-management-client-secret]\n\n**Allowed Tenants** specifies which directories have access to the APIs of the API Management service instance. Specify the domains of the Azure Active Directory instances to which you want to grant access. You can separate multiple domains with newlines, spaces, or commas.\n\n![Allowed tenants][api-management-client-allowed-tenants]\n\nMultiple domains can be specified in the **Allowed Tenants** section. Before any user can log in from a different domain than the original domain where the application was registered, a global administrator of the different domain must grant permission for the application to access directory data. To grant permission, a global administrator must log in to the application and click **Accept**. In the following example `miaoaad.onmicrosoft.com` has been added to **Allowed Tenants** and a global administrator from that domain is logging in for the first time.\n\n![Permissions][api-management-permissions-form]\n\n>If a non-global administrator tries to log in before permissions are granted by a global administrator, the login attempt fails and an error screen is displayed.\n\nOnce the desired configuration is specified, click **Save**.\n\n![Save][api-management-client-allowed-tenants-save]\n\nOnce the changes are saved, the users in the specified Azure Active Directory can log into the Developer portal by following the steps in [Log in to the Developer portal using an Azure Active Directory account][].\n\n## How to add an external Azure Active Directory Group\n\nAfter enabling access for users in an Azure Active Directory, you can add Azure Active Directory groups into API Management to more easily manage the association of the developers in the group with the desired products.\n\n> In order to configure an external Azure Active Directory group, the Azure Active Directory must first be configured in the Identities tab by following the procedure in the previous section. \n\nExternal Azure Active Directory groups are added from the **Visibility** tab of the product for which you wish to grant access to the group. Click **Products**, and then click the name of the desired product.\n\n![Configure product][api-management-configure-product]\n\nSwitch to the **Visibility** tab, and click **Add Groups from Azure Active Directory**.\n\n![Add groups][api-management-add-groups]\n\nSelect the **Azure Active Directory Tenant** from the drop-down list, and then type the name of the desired group in the **Groups** to be added text box.\n\n![Select group][api-management-select-group]\n\nThis group name can be found in the **Groups** list for your Azure Active Directory, as shown in the following example.\n\n![Azure Active Directory Groups List][api-management-aad-groups-list]\n\nClick **Add** to validate the group name and add the group. In this example the **Contoso 5 Developers** external group is added. \n\n![Group added][api-management-aad-group-added]\n\nClick **Save** to save the new group selection.\n\nOnce an Azure Azure Active Directory group has been configured from one product, it is available to be checked on the **Visibility** tab for the other products in the API Management service instance.\n\nTo review and configure the properties for external groups once they have been added, click on the name of the group from the **Groups** tab.\n\n![Manage groups][api-management-groups]\n\nFrom here you can edit the **Name** and the **Description** of the group.\n\n![Edit group][api-management-edit-group]\n\nUsers from the configured Azure Active Directory can log into the Developer portal and view and subscribe to any groups for which they have visibility by following the instructions in the following section.\n\n## How to log in to the Developer portal using an Azure Active Directory account\n\nTo log into the Developer portal using an Azure Active Directory account configured in the previous sections, open a new browser window using the **Sign-on URL** from the Active Directory application configuration, and click **Azure Active Directory**.\n\n![Developer Portal][api-management-dev-portal-signin]\n\nEnter the credentials of one of the users in your Azure Active Directory, and click **Sign in**.\n\n![Sign in][api-management-aad-signin]\n\nYou may be prompted with a registration form if any additional information is required. Complete the registration form and click **Sign up**.\n\n![Registration][api-management-complete-registration]\n\nYour user is now logged into the developer portal for your API Management service instance.\n\n![Registration Complete][api-management-registration-complete]\n\n\n\n[api-management-management-console]: ./media/api-management-howto-aad/api-management-management-console.png\n[api-management-security-external-identities]: ./media/api-management-howto-aad/api-management-security-external-identities.png\n[api-management-security-aad-new]: ./media/api-management-howto-aad/api-management-security-aad-new.png\n[api-management-new-aad-application-menu]: ./media/api-management-howto-aad/api-management-new-aad-application-menu.png\n[api-management-new-aad-application-1]: ./media/api-management-howto-aad/api-management-new-aad-application-1.png\n[api-management-new-aad-application-2]: ./media/api-management-howto-aad/api-management-new-aad-application-2.png\n[api-management-new-aad-app-created]: ./media/api-management-howto-aad/api-management-new-aad-app-created.png\n[api-management-aad-app-permissions]: ./media/api-management-howto-aad/api-management-aad-app-permissions.png\n[api-management-aad-app-client-id]: ./media/api-management-howto-aad/api-management-aad-app-client-id.png\n[api-management-client-id]: ./media/api-management-howto-aad/api-management-client-id.png\n[api-management-aad-key-before-save]: ./media/api-management-howto-aad/api-management-aad-key-before-save.png\n[api-management-aad-key-after-save]: ./media/api-management-howto-aad/api-management-aad-key-after-save.png\n[api-management-client-secret]: ./media/api-management-howto-aad/api-management-client-secret.png\n[api-management-client-allowed-tenants]: ./media/api-management-howto-aad/api-management-client-allowed-tenants.png\n[api-management-client-allowed-tenants-save]: ./media/api-management-howto-aad/api-management-client-allowed-tenants-save.png\n[api-management-aad-delegated-permissions]: ./media/api-management-howto-aad/api-management-aad-delegated-permissions.png\n[api-management-dev-portal-signin]: ./media/api-management-howto-aad/api-management-dev-portal-signin.png\n[api-management-aad-signin]: ./media/api-management-howto-aad/api-management-aad-signin.png\n[api-management-complete-registration]: ./media/api-management-howto-aad/api-management-complete-registration.png\n[api-management-registration-complete]: ./media/api-management-howto-aad/api-management-registration-complete.png\n[api-management-aad-app-multi-tenant]: ./media/api-management-howto-aad/api-management-aad-app-multi-tenant.png\n[api-management-aad-reply-url]: ./media/api-management-howto-aad/api-management-aad-reply-url.png\n[api-management-permissions-form]: ./media/api-management-howto-aad/api-management-permissions-form.png\n[api-management-configure-product]: ./media/api-management-howto-aad/api-management-configure-product.png\n[api-management-add-groups]: ./media/api-management-howto-aad/api-management-add-groups.png\n[api-management-select-group]: ./media/api-management-howto-aad/api-management-select-group.png\n[api-management-aad-groups-list]: ./media/api-management-howto-aad/api-management-aad-groups-list.png\n[api-management-aad-group-added]: ./media/api-management-howto-aad/api-management-aad-group-added.png\n[api-management-groups]: ./media/api-management-howto-aad/api-management-groups.png\n[api-management-edit-group]: ./media/api-management-howto-aad/api-management-edit-group.png\n\n[How to add operations to an API]: api-management-howto-add-operations.md\n[How to add and publish a product]: api-management-howto-add-products.md\n[Monitoring and analytics]: api-management-monitoring.md\n[Add APIs to a product]: api-management-howto-add-products.md#add-apis\n[Publish a product]: api-management-howto-add-products.md#publish-product\n[Get started with Azure API Management]: api-management-get-started.md\n[Get started with advanced API configuration]: api-management-get-started-advanced.md\n[API Management policy reference]: api-management-policy-reference.md\n[Caching policies]: api-management-policy-reference.md#caching-policies\n[Create an API Management service instance]: api-management-get-started.md#create-service-instance\n\n[http://oauth.net/2/]: http://oauth.net/2/\n[WebApp-GraphAPI-DotNet]: https://github.com/AzureADSamples/WebApp-GraphAPI-DotNet\n[Accessing the Graph API]: http://msdn.microsoft.com/library/azure/dn132599.aspx#BKMK_Graph\n\n[Prerequisites]: #prerequisites\n[Configure an OAuth 2.0 authorization server in API Management]: #step1\n[Configure an API to use OAuth 2.0 user authorization]: #step2\n[Test the OAuth 2.0 user authorization in the Developer Portal]: #step3\n[Next steps]: #next-steps\n\n[Log in to the Developer portal using an Azure Active Directory account]: #Log-in-to-the-Developer-portal-using-an-Azure-Active-Directory-account\n\n"
}