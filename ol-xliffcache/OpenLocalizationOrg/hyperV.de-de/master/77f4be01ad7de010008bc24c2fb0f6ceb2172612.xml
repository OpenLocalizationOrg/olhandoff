{
  "nodes": [
    {
      "content": "Enable Microsoft Passport for Work in the organization | Microsoft Azure",
      "pos": [
        28,
        100
      ]
    },
    {
      "content": "Deployment instructions to enable Microsoft Passport in your organization.",
      "pos": [
        120,
        194
      ]
    },
    {
      "content": "Enable Microsoft Passport for work in the organization",
      "pos": [
        546,
        600
      ]
    },
    {
      "content": "After connecting Windows 10 domain joined devices with Azure AD do the following to enable Microsoft Passport for Work in the organization.",
      "pos": [
        602,
        741
      ]
    },
    {
      "content": "Deploy System Center Configuration Manager version 1509 for Technical Preview",
      "pos": [
        746,
        823
      ]
    },
    {
      "content": "To deploy user certificates based on Microsoft Passport keys, you need the following:",
      "pos": [
        824,
        909
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>System Center Configuration Manager version 1509 for Technical Preview<ept id=\"p1\">**</ept>.",
      "pos": [
        913,
        988
      ]
    },
    {
      "content": "For more information, see <bpt id=\"p1\">[</bpt>Microsoft System Center Configuration Manager Technical Preview<ept id=\"p1\">](https://technet.microsoft.com/library/dn965439.aspx#BKMK_TP3Update)</ept>.",
      "pos": [
        989,
        1149
      ]
    },
    {
      "content": "and <bpt id=\"p1\">[</bpt>System Center Configuration Manager Team Blog<ept id=\"p1\">](http://blogs.technet.com/b/configmgrteam/archive/2015/09/23/now-available-update-for-system-center-config-manager-tp3.aspx)</ept>.",
      "pos": [
        1150,
        1326
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>PKI infrastructure<ept id=\"p1\">**</ept>: To enable Microsoft Passport for Work using user certificates you must have a PKI infrastructure in place.",
      "pos": [
        1329,
        1459
      ]
    },
    {
      "content": "If you don’t have one or you don’t want to use it for user certificates you can deploy a domain controllers (DC) of the new version of Windows Server:",
      "pos": [
        1460,
        1610
      ]
    },
    {
      "pos": [
        1614,
        2138
      ],
      "content": "<bpt id=\"p1\">**</bpt>Deploy a DC of new version of Windows Server<ept id=\"p1\">**</ept>: On a brand new Windows Server build 10551 or newer (The ISOs are available for download on <bpt id=\"p2\">[</bpt>Signiant Media Exchange<ept id=\"p2\">](https://datatransfer.microsoft.com/signiant_media_exchange/spring/main?sdkAccessible=true)</ept>) follow the steps to <bpt id=\"p3\">[</bpt>install a replica DC in an existing domain<ept id=\"p3\">](https://technet.microsoft.com/en-us/library/jj574134.aspx)</ept> or to <bpt id=\"p4\">[</bpt>install a new Active Directory forest if creating a brand new environment<ept id=\"p4\">](https://technet.microsoft.com/en-us/library/jj574134.aspx)</ept>."
    },
    {
      "content": "Configure Microsoft Passport for work via Group Policy in Active Directory",
      "pos": [
        2143,
        2217
      ]
    },
    {
      "content": "You can use an Active Directory Group Policy to configure your Windows 10 domain joined devices to provision user Microsoft Passport credentials upon user logon to Windows:",
      "pos": [
        2220,
        2392
      ]
    },
    {
      "pos": [
        2398,
        2474
      ],
      "content": "Open Server Manager and navigate to <bpt id=\"p1\">**</bpt>Tools<ept id=\"p1\">**</ept> &gt; <bpt id=\"p2\">**</bpt>Group Policy Management<ept id=\"p2\">**</ept>."
    },
    {
      "content": "From Group Policy Management, navigate to the domain node that corresponds to the domain in which you would like to enable Azure AD Join.",
      "pos": [
        2479,
        2616
      ]
    },
    {
      "content": "Right-click <bpt id=\"p1\">**</bpt>Group Policy Objects<ept id=\"p1\">**</ept> and select <bpt id=\"p2\">**</bpt>New<ept id=\"p2\">**</ept>.",
      "pos": [
        2621,
        2677
      ]
    },
    {
      "content": "Give your Group Policy object a name, for example, <bpt id=\"p1\">**</bpt>Enable Microsoft Passport<ept id=\"p1\">**</ept>.",
      "pos": [
        2678,
        2759
      ]
    },
    {
      "content": "Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.",
      "pos": [
        2760,
        2773
      ]
    },
    {
      "pos": [
        2778,
        2847
      ],
      "content": "Right-click on your new Group Policy object and then select <bpt id=\"p1\">**</bpt>Edit<ept id=\"p1\">**</ept>."
    },
    {
      "pos": [
        2852,
        2986
      ],
      "content": "Navigate to <bpt id=\"p1\">**</bpt>Computer Configuration<ept id=\"p1\">**</ept> &gt; <bpt id=\"p2\">**</bpt>Policies<ept id=\"p2\">**</ept> &gt; <bpt id=\"p3\">**</bpt>Administrative Templates<ept id=\"p3\">**</ept> &gt; <bpt id=\"p4\">**</bpt>Windows Components<ept id=\"p4\">**</ept> &gt; <bpt id=\"p5\">**</bpt>Passport for Work<ept id=\"p5\">**</ept>."
    },
    {
      "pos": [
        2991,
        3057
      ],
      "content": "Right-click <bpt id=\"p1\">**</bpt>Enable Passport for Work<ept id=\"p1\">**</ept> and then select <bpt id=\"p2\">**</bpt>Edit<ept id=\"p2\">**</ept>."
    },
    {
      "content": "Select the <bpt id=\"p1\">**</bpt>Enabled<ept id=\"p1\">**</ept> radio button and then click <bpt id=\"p2\">**</bpt>Apply<ept id=\"p2\">**</ept>.",
      "pos": [
        3062,
        3123
      ]
    },
    {
      "content": "Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.",
      "pos": [
        3124,
        3137
      ]
    },
    {
      "content": "You may now link the Group Policy object to a location of your choice.",
      "pos": [
        3142,
        3212
      ]
    },
    {
      "content": "To enable this policy for all of the domain joined Windows 10 devices at your organization, link the Group Policy to the domain.",
      "pos": [
        3213,
        3341
      ]
    },
    {
      "content": "For example:",
      "pos": [
        3342,
        3354
      ]
    },
    {
      "content": "A specific Organizational Unit (OU) in AD where Windows 10 domain-joined computers will be located.",
      "pos": [
        3358,
        3457
      ]
    },
    {
      "content": "A specific security group containing Windows 10 domain-joined computers that will be auto-registered with Azure AD.",
      "pos": [
        3461,
        3576
      ]
    },
    {
      "content": "Configure Microsoft Passport for work via deploying PowerShell through Configuration Manager",
      "pos": [
        3581,
        3673
      ]
    },
    {
      "content": "Run the following PowerShell command:",
      "pos": [
        3676,
        3713
      ]
    },
    {
      "content": "Configure certificate profile to enroll \"Passport for work\" enrollment certificate in Configuration manager",
      "pos": [
        3919,
        4026
      ]
    },
    {
      "content": "To use Passport for Work Certificate based logon/Microsoft Hello,  configure Certificate profile (Assets &amp; Compliance -&gt; Compliance Settings -&gt; Company Resource Access -&gt; Certificate Profiles) selecting a template that has Smart Card logon EKU.",
      "pos": [
        4027,
        4271
      ]
    },
    {
      "content": "Setup a scheduled task, which gets triggered when the Passport for Work container is enabled and requests Certificate evaluation",
      "pos": [
        4275,
        4403
      ]
    },
    {
      "content": "This is a short term fix that admins need to create a scheduled task that listens for an Passport for Work container creation and requests certificate evaluation.",
      "pos": [
        4404,
        4566
      ]
    },
    {
      "content": "This reduces the delay in setting up the container and PIN and its ability to be used on next logon.",
      "pos": [
        4567,
        4667
      ]
    },
    {
      "content": "To create the scheduled task, use the below command or use the UI",
      "pos": [
        4671,
        4736
      ]
    },
    {
      "content": "schtasks /create /xml %0\\..\\&lt;EnrollCertificate.xml&gt; /tn",
      "pos": [
        4743,
        4798
      ]
    },
    {
      "content": "The sample xml is as below:",
      "pos": [
        4812,
        4839
      ]
    },
    {
      "content": "Where the ScopeId_73F3BB5E-5EDC-4928-87BD-4E75EB4BBC34/ConfigurationPolicy_db89c51e-1d1b-4a17-8e42-a5459b742ccd is the ID for the certificate profile created in the step, \"Configure certificate profile to enroll Passport for work enrollment certificate in Configuration manager\" and &lt;8&gt; is the version.",
      "pos": [
        6961,
        7263
      ]
    },
    {
      "content": "Additional Information",
      "pos": [
        7268,
        7290
      ]
    },
    {
      "content": "Windows 10 for the enterprise: Ways to use devices for work",
      "pos": [
        7294,
        7353
      ]
    },
    {
      "content": "Extending cloud capabilities to Windows 10 devices through Azure Active Directory Join",
      "pos": [
        7418,
        7504
      ]
    },
    {
      "content": "Authenticating identities without passwords through Microsoft Passport",
      "pos": [
        7555,
        7625
      ]
    },
    {
      "content": "Learn about usage scenarios for Azure AD Join",
      "pos": [
        7672,
        7717
      ]
    },
    {
      "content": "Connect domain-joined devices to Azure AD for Windows 10 experiences",
      "pos": [
        7780,
        7848
      ]
    },
    {
      "content": "Set up Azure AD Join",
      "pos": [
        7907,
        7927
      ]
    }
  ],
  "content": "<properties \n    pageTitle=\"Enable Microsoft Passport for Work in the organization | Microsoft Azure\" \n    description=\"Deployment instructions to enable Microsoft Passport in your organization.\" \n    services=\"active-directory\" \n    documentationCenter=\"\" \n    authors=\"femila\" \n    manager=\"stevenpo\" \n    editor=\"\"\n    tags=\"azure-classic-portal\"/>\n\n<tags \n    ms.service=\"active-directory\" \n    ms.workload=\"identity\" \n    ms.tgt_pltfrm=\"na\" \n    ms.devlang=\"na\" \n    ms.topic=\"article\" \n    ms.date=\"11/19/2015\" \n    ms.author=\"femila\"/>\n\n# Enable Microsoft Passport for work in the organization\n\nAfter connecting Windows 10 domain joined devices with Azure AD do the following to enable Microsoft Passport for Work in the organization.\n\n## Deploy System Center Configuration Manager version 1509 for Technical Preview\nTo deploy user certificates based on Microsoft Passport keys, you need the following:\n\n- **System Center Configuration Manager version 1509 for Technical Preview**. For more information, see [Microsoft System Center Configuration Manager Technical Preview](https://technet.microsoft.com/library/dn965439.aspx#BKMK_TP3Update). and [System Center Configuration Manager Team Blog](http://blogs.technet.com/b/configmgrteam/archive/2015/09/23/now-available-update-for-system-center-config-manager-tp3.aspx).\n- **PKI infrastructure**: To enable Microsoft Passport for Work using user certificates you must have a PKI infrastructure in place. If you don’t have one or you don’t want to use it for user certificates you can deploy a domain controllers (DC) of the new version of Windows Server:\n - **Deploy a DC of new version of Windows Server**: On a brand new Windows Server build 10551 or newer (The ISOs are available for download on [Signiant Media Exchange](https://datatransfer.microsoft.com/signiant_media_exchange/spring/main?sdkAccessible=true)) follow the steps to [install a replica DC in an existing domain](https://technet.microsoft.com/en-us/library/jj574134.aspx) or to [install a new Active Directory forest if creating a brand new environment](https://technet.microsoft.com/en-us/library/jj574134.aspx).\n\n## Configure Microsoft Passport for work via Group Policy in Active Directory\n\n You can use an Active Directory Group Policy to configure your Windows 10 domain joined devices to provision user Microsoft Passport credentials upon user logon to Windows:\n\n1.  Open Server Manager and navigate to **Tools** > **Group Policy Management**.\n2.  From Group Policy Management, navigate to the domain node that corresponds to the domain in which you would like to enable Azure AD Join.\n3.  Right-click **Group Policy Objects** and select **New**. Give your Group Policy object a name, for example, **Enable Microsoft Passport**. Click **OK**.\n4.  Right-click on your new Group Policy object and then select **Edit**.\n5.  Navigate to **Computer Configuration** > **Policies** > **Administrative Templates** > **Windows Components** > **Passport for Work**.\n6.  Right-click **Enable Passport for Work** and then select **Edit**.\n7.  Select the **Enabled** radio button and then click **Apply**. Click **OK**.\n8.  You may now link the Group Policy object to a location of your choice. To enable this policy for all of the domain joined Windows 10 devices at your organization, link the Group Policy to the domain. For example:\n - A specific Organizational Unit (OU) in AD where Windows 10 domain-joined computers will be located.\n - A specific security group containing Windows 10 domain-joined computers that will be auto-registered with Azure AD.\n\n## Configure Microsoft Passport for work via deploying PowerShell through Configuration Manager \n\nRun the following PowerShell command:\n\n    powershell.exe -ExecutionPolicy Bypass -NoLogo -NoProfile -Command \"& {New-ItemProperty \"HKLM:\\Software\\Policies\\Microsoft\\PassportForWork\" -Name \"Enabled\" -Value 1 -PropertyType \"DWord\" -Force}\"\n\n## Configure certificate profile to enroll \"Passport for work\" enrollment certificate in Configuration manager\nTo use Passport for Work Certificate based logon/Microsoft Hello,  configure Certificate profile (Assets & Compliance -> Compliance Settings -> Company Resource Access -> Certificate Profiles) selecting a template that has Smart Card logon EKU.\n\n##Setup a scheduled task, which gets triggered when the Passport for Work container is enabled and requests Certificate evaluation\nThis is a short term fix that admins need to create a scheduled task that listens for an Passport for Work container creation and requests certificate evaluation. This reduces the delay in setting up the container and PIN and its ability to be used on next logon.\n\n**To create the scheduled task, use the below command or use the UI**\n    schtasks /create /xml %0\\..\\<EnrollCertificate.xml> /tn <Task Name>\n\nThe sample xml is as below:\n\n    <?xml version=\"1.0\" encoding=\"UTF-16\"?>\n    <Task version=\"1.2\" xmlns=\"http://schemas.microsoft.com/windows/2004/02/mit/task\">\n       <RegistrationInfo>\n         <Date>2015-09-04T17:48:45.9973761</Date>\n          <Author><DomainName/UserName></Author>\n        <URI>\\Enroll Certificates</URI>\n      </RegistrationInfo>\n      <Triggers>\n        <EventTrigger>\n          <Enabled>true</Enabled>\n          <Subscription>&lt;QueryList&gt;&lt;Query Id=\"0\" Path=\"Microsoft-Windows-User Device Registration/Admin\"&gt;&lt;Select Path=\"Microsoft-Windows-User Device Registration/Admin\"&gt;*[System[Provider[@Name='Microsoft-Windows-User Device Registration'] and EventID=300]]&lt;/Select&gt;&lt;/Query&gt;&lt;/QueryList&gt;</Subscription>\n        </EventTrigger>\n      </Triggers>\n      <Principals>\n      </Principals>\n      <Settings>\n        <MultipleInstancesPolicy>IgnoreNew</MultipleInstancesPolicy>\n        <DisallowStartIfOnBatteries>false</DisallowStartIfOnBatteries>\n        <StopIfGoingOnBatteries>true</StopIfGoingOnBatteries>\n        <AllowHardTerminate>true</AllowHardTerminate>\n        <StartWhenAvailable>true</StartWhenAvailable>\n        <RunOnlyIfNetworkAvailable>false</RunOnlyIfNetworkAvailable>\n        <IdleSettings>\n          <StopOnIdleEnd>true</StopOnIdleEnd>\n          <RestartOnIdle>false</RestartOnIdle>\n        </IdleSettings>\n        <AllowStartOnDemand>true</AllowStartOnDemand>\n        <Enabled>true</Enabled>\n        <Hidden>false</Hidden>\n        <RunOnlyIfIdle>false</RunOnlyIfIdle>\n        <WakeToRun>false</WakeToRun>\n        <ExecutionTimeLimit>PT1H</ExecutionTimeLimit>\n        <Priority>7</Priority>\n        <RestartOnFailure>\n          <Interval>PT1M</Interval>\n          <Count>3</Count>\n        </RestartOnFailure>\n      </Settings>\n      <Actions Context=\"Author\">\n        <Exec>\n          <Command>wmic</Command>\n          <Arguments>/namespace:\\\\root\\ccm\\dcm path SMS_DesiredConfiguration call TriggerEvaluation 1,0,\"ScopeId_73F3BB5E-5EDC-4928-87BD-4E75EB4BBC34/ConfigurationPolicy_db89c51e-1d1b-4a17-8e42-a5459b742ccd\",8</Arguments>\n        </Exec>\n      </Actions>\n    </Task>\n\nWhere the ScopeId_73F3BB5E-5EDC-4928-87BD-4E75EB4BBC34/ConfigurationPolicy_db89c51e-1d1b-4a17-8e42-a5459b742ccd is the ID for the certificate profile created in the step, \"Configure certificate profile to enroll Passport for work enrollment certificate in Configuration manager\" and <8> is the version.\n\n## Additional Information\n* [Windows 10 for the enterprise: Ways to use devices for work](active-directory-azureadjoin-windows10-devices-overview.md)\n* [Extending cloud capabilities to Windows 10 devices through Azure Active Directory Join](active-directory-azureadjoin-user-upgrade.md)\n* [Authenticating identities without passwords through Microsoft Passport](active-directory-azureadjoin-passport.md)\n* [Learn about usage scenarios for Azure AD Join](active-directory-azureadjoin-deployment-aadjoindirect.md)\n* [Connect domain-joined devices to Azure AD for Windows 10 experiences](active-directory-azureadjoin-devices-group-policy.md)\n* [Set up Azure AD Join](active-directory-azureadjoin-setup.md)\n\n"
}