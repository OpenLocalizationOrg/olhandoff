#Windows PowerShell 4.0 требуемой конфигурации локального состояния Configuration Manager (НОК)

> Область применения: Windows PowerShell 4.0, Windows PowerShell 5.0

Локальный диспетчер конфигурации — это подсистема обработки конфигурации состояния требуемой Windows PowerShell (DSC). Он работает на все целевые узлы и отвечает за вызов конфигурация ресурсов, которые включены в скрипт конфигурации DSC. В этом разделе перечислены свойства локального Configuration Manager и описывает, как можно изменить параметры локальной Configuration Manager на целевой узел.

##Свойства локального Configuration Manager

Ниже перечислены свойства локальный диспетчер конфигурации, которые можно задать или получить.

* **AllowModuleOverwrite**: элементы управления для перезаписи старых на целевом узле разрешены ли новые конфигурации загрузки с сервера конфигурации. Возможные значения: True и False.
* **Ид_сертификата**: GUID сертификат, используемый для защиты учетных данных для доступа к конфигурации. Дополнительные сведения см. [необходимо обеспечить безопасность учетных данных в требуемой конфигурации состояния Windows PowerShell?](http://blogs.msdn.com/b/powershell/archive/2014/01/31/want-to-secure-credentials-in-windows-powershell-desired-state-configuration.aspx).
* **ConfigurationID**: Указывает идентификатор GUID, который используется для получения определенного файла конфигурации сервер настроен как сервер «по запросу». Идентификатор GUID гарантирует, что доступ к файлу правильную конфигурацию.
* **ConfigurationMode**: Указывает, как локальный диспетчер конфигурации фактически применяется конфигурация целевые узлы. Он может принимать следующие значения:
   - **ApplyOnly**: этот параметр, DSC применяет конфигурацию и не выполняет никаких действий дальнейшей Если обнаружена новая конфигурация, либо вам отправлять новую конфигурацию целевой узел ("push") или если необходимо настроить сервер «по запросу» и DSC обнаруживает новую конфигурацию при проверке на сервере «по запросу». Если целевой узел конфигурации drifts, никакие действия не выполняются.
   - **ApplyAndMonitor**: этот параметр (по умолчанию), DSC применяет любые новые конфигурации ли отправленные непосредственно на целевом узле или обнаружены на сервере «по запросу». Соответственно Если конфигурация целевой узел drifts из файла конфигурации, DSC отчеты несоответствие в журналах. Дополнительные сведения о ведении журнала DSC [Использование журналов событий диагностики ошибки в требуемой конфигурации состояния](http://blogs.msdn.com/b/powershell/archive/2014/01/03/using-event-logs-to-diagnose-errors-in-desired-state-configuration.aspx).
   - **ApplyAndAutoCorrect**: этот параметр DSC применяет любые новые конфигурации ли отправленные непосредственно на целевом узле или обнаружены на сервере «по запросу». Соответственно если конфигурации целевого узла drifts из файла конфигурации, DSC сообщает несоответствие в журналах, а затем пытается изменить конфигурацию целевой узел для перевода файла конфигурации в соответствии с.
* **ConfigurationModeFrequencyMins**: указывает на частоту (в минутах), по которому приложение фона DSC пытается реализовать текущей конфигурации на целевом узле. Значение по умолчанию — 15. Это значение может задаваться в сочетании с RefreshMode. Когда RefreshMode равным по ЗАПРОСУ, целевой узел соединяется с сервером конфигурации задается RefreshFrequencyMins интервалом и загружает текущей конфигурации. Независимо от значения RefreshMode через интервал, задаваемый ConfigurationModeFrequencyMins, подсистема согласованности применяет последнюю конфигурацию, загруженный на целевой узел. RefreshFrequencyMins должно быть присвоено целое число кратно ConfigurationModeFrequencyMins.
* **Учетные данные**: указывает учетные данные (как с Get-Credential) требуется для доступа к удаленным ресурсам, такие как связаться с сервером конфигурации.
* **DownloadManagerCustomData**: представляет массив, содержащий пользовательские данные, относящиеся к диспетчеру загрузки.
* **DownloadManagerName**: Указывает имя конфигурации и диспетчер загрузки модуля.
* **RebootNodeIfNeeded**: некоторые изменения в конфигурации на целевой узел может потребоваться его, чтобы применить изменения, необходимо перезапустить. Со значением **True**, это свойство будет перезапустить узел сразу же конфигурации был полностью применяется без дальнейшей предупреждения. Если **False** (значение по умолчанию), конфигурация будет продолжена, но узла необходимо перезапустить вручную изменения вступили в силу.
* **RefreshFrequencyMins**: используется при настройке сервера «по запросу». Представляет частоту (в минутах), по которому локальный диспетчер конфигурации соединяется с сервером «по запросу» для загрузки текущей конфигурации. Это значение может быть задано в сочетании с ConfigurationModeFrequencyMins. Когда RefreshMode равным по ЗАПРОСУ, целевой узел связывается с сервером «по запросу» интервал, задаваемый RefreshFrequencyMins и загружает текущей конфигурации. Задаваемый ConfigurationModeFrequencyMins интервалом подсистема согласованности затем применяет последнюю конфигурацию, загруженный на целевой узел. Если RefreshFrequencyMins не присвоено целочисленное значение будет округлять кратно ConfigurationModeFrequencyMins системы. Значение по умолчанию — 30.
* **RefreshMode**: возможными значениями являются **Push** (по умолчанию) и **по запросу**. В конфигурации «push» необходимо поместить файл конфигурации на каждом конечном узле с помощью любого клиентского компьютера. В режиме «по запросу» необходимо настроить сервер для локальных Configuration Manager для подключения и доступа к файлам конфигурации «по запросу».

###Пример обновления параметров локальной Configuration Manager

Можно обновить параметры конфигурации диспетчера локальных целевой узел, включая **LocalConfigurationManager** блок внутри блока узла в скрипт конфигурации, как показано в следующем примере.

```powershell
Configuration ExampleConfig
{
    Node “Server001”
    {
        LocalConfigurationManager
        {
            ConfigurationID = "646e48cb-3082-4a12-9fd9-f71b9a562d4e"
            ConfigurationModeFrequencyMins = 45
            ConfigurationMode = "ApplyAndAutocorrect"
            RefreshMode = "Pull"
            RefreshFrequencyMins = 90
            DownloadManagerName = "WebDownloadManager"
            DownloadManagerCustomData = (@{ServerUrl="https://$PullServer/psdscpullserver.svc"})
            CertificateID = "71AA68562316FE3F73536F1096B85D66289ED60E"
            Credential = $cred
            RebootNodeIfNeeded = $true
            AllowModuleOverwrite = $false
        }
# One or more resource blocks can be added here
    }
}

# The following line invokes the configuration and creates a file called Server001.meta.mof at the specified path
ExampleConfig -OutputPath "c:\users\public\dsc"  
```

Выполнение скрипта в предыдущем примере создает MOF-файл, который определяет и хранит нужные параметры. Чтобы применить параметры, можно использовать **набора DscLocalConfigurationManager** командлет, как показано в следующем примере.

```powershell
Set-DscLocalConfigurationManager -Path "c:\users\public\dsc"
```

> **Примечание**: для **путь** параметр, необходимо указать тот же путь, указанный для **OutputPath** параметра при вызове конфигурации в предыдущем примере.

Чтобы просмотреть текущие параметры локального Configuration Manager, можно использовать **Get DscLocalConfigurationManager** командлета. Если вызвать этот командлет без параметров по умолчанию он получит параметры локального Configuration Manager для узла, на котором она запущена. Чтобы указать другой узел, используйте **CimSession** параметра с помощью этого командлета.



