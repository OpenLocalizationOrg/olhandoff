{
  "nodes": [
    {
      "pos": [
        28,
        100
      ],
      "content": "Install and use Giraph on Hadoop clusters in HDInsight | Microsoft Azure"
    },
    {
      "pos": [
        120,
        256
      ],
      "content": "Learn how to customize HDInsight cluster with Giraph. You'll use a Script Action configuration option to use a script to install Giraph.",
      "nodes": [
        {
          "content": "Learn how to customize HDInsight cluster with Giraph.",
          "pos": [
            0,
            53
          ]
        },
        {
          "content": "You'll use a Script Action configuration option to use a script to install Giraph.",
          "pos": [
            54,
            136
          ]
        }
      ]
    },
    {
      "pos": [
        572,
        661
      ],
      "content": "Install Giraph on HDInsight Hadoop clusters, and use Giraph to process large-scale graphs"
    },
    {
      "pos": [
        663,
        964
      ],
      "content": "Learn how to customize Windows based HDInsight cluster with Giraph using Script Action, and how to use Giraph to process large-scale graphs. For information on using Giraph with a Linux-based cluster, see <bpt id=\"p1\">[</bpt>Install Giraph on HDInsight Hadoop clusters (Linux)<ept id=\"p1\">](hdinsight-hadoop-giraph-install-linux.md)</ept>.",
      "nodes": [
        {
          "content": "Learn how to customize Windows based HDInsight cluster with Giraph using Script Action, and how to use Giraph to process large-scale graphs.",
          "pos": [
            0,
            140
          ]
        },
        {
          "content": "For information on using Giraph with a Linux-based cluster, see <bpt id=\"p1\">[</bpt>Install Giraph on HDInsight Hadoop clusters (Linux)<ept id=\"p1\">](hdinsight-hadoop-giraph-install-linux.md)</ept>.",
          "pos": [
            141,
            339
          ]
        }
      ]
    },
    {
      "pos": [
        967,
        1575
      ],
      "content": "You can install Giraph on any type of cluster (Hadoop, Storm, HBase, Spark) on Azure HDInsight by using <bpt id=\"p2\">*</bpt>Script Action<ept id=\"p2\">*</ept>. A sample script to install Giraph on an HDInsight cluster is available from a read-only Azure storage blob at <bpt id=\"p3\">[</bpt>https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1<ept id=\"p3\">](https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1)</ept>. The sample script works only with HDInsight cluster version 3.1. For more information on HDInsight cluster versions, see <bpt id=\"p4\">[</bpt>HDInsight cluster versions<ept id=\"p4\">](hdinsight-component-versioning.md)</ept>.",
      "nodes": [
        {
          "content": "You can install Giraph on any type of cluster (Hadoop, Storm, HBase, Spark) on Azure HDInsight by using <bpt id=\"p2\">*</bpt>Script Action<ept id=\"p2\">*</ept>.",
          "pos": [
            0,
            158
          ]
        },
        {
          "content": "A sample script to install Giraph on an HDInsight cluster is available from a read-only Azure storage blob at <bpt id=\"p3\">[</bpt>https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1<ept id=\"p3\">](https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1)</ept>.",
          "pos": [
            159,
            498
          ]
        },
        {
          "content": "The sample script works only with HDInsight cluster version 3.1.",
          "pos": [
            499,
            563
          ]
        },
        {
          "content": "For more information on HDInsight cluster versions, see <bpt id=\"p4\">[</bpt>HDInsight cluster versions<ept id=\"p4\">](hdinsight-component-versioning.md)</ept>.",
          "pos": [
            564,
            722
          ]
        }
      ]
    },
    {
      "pos": [
        1577,
        1597
      ],
      "content": "<bpt id=\"p5\">**</bpt>Related articles<ept id=\"p5\">**</ept>"
    },
    {
      "pos": [
        1601,
        1714
      ],
      "content": "<bpt id=\"p6\">[</bpt>Install Giraph on HDInsight clusters<ept id=\"p6\">](hdinsight-hadoop-giraph-install.md)</ept>: install Giraph using the Azure Portal"
    },
    {
      "pos": [
        1717,
        1812
      ],
      "content": "<bpt id=\"p7\">[</bpt>Install Giraph on HDInsight Hadoop clusters (Linux)<ept id=\"p7\">](hdinsight-hadoop-giraph-install-linux.md)</ept>"
    },
    {
      "pos": [
        1815,
        1938
      ],
      "content": "<bpt id=\"p8\">[</bpt>Create Hadoop clusters in HDInsight<ept id=\"p8\">](hdinsight-provision-clusters.md)</ept>: general information on creating HDInsight clusters."
    },
    {
      "pos": [
        1941,
        2095
      ],
      "content": "<bpt id=\"p9\">[</bpt>Customize HDInsight cluster using Script Action<ept id=\"p9\">][hdinsight-cluster-customize]</ept>: general information on customizing HDInsight clusters using Script Action."
    },
    {
      "pos": [
        2098,
        2180
      ],
      "content": "<bpt id=\"p10\">[</bpt>Develop Script Action scripts for HDInsight<ept id=\"p10\">](hdinsight-hadoop-script-actions.md)</ept>."
    },
    {
      "pos": [
        2186,
        2201
      ],
      "content": "What is Giraph?"
    },
    {
      "pos": [
        2255,
        2268
      ],
      "content": "Apache Giraph"
    },
    {
      "pos": [
        2273,
        2681
      ],
      "content": "allows you to perform graph processing by using Hadoop, and can be used with Azure HDInsight. Graphs model relationships between objects, such as the connections between routers on a large network like the Internet, or relationships between people on social networks (sometimes referred to as a social graph). Graph processing allows you to reason about the relationships between objects in a graph, such as:",
      "nodes": [
        {
          "content": "allows you to perform graph processing by using Hadoop, and can be used with Azure HDInsight.",
          "pos": [
            0,
            93
          ]
        },
        {
          "content": "Graphs model relationships between objects, such as the connections between routers on a large network like the Internet, or relationships between people on social networks (sometimes referred to as a social graph).",
          "pos": [
            94,
            309
          ]
        },
        {
          "content": "Graph processing allows you to reason about the relationships between objects in a graph, such as:",
          "pos": [
            310,
            408
          ]
        }
      ]
    },
    {
      "pos": [
        2685,
        2751
      ],
      "content": "Identifying potential friends based on your current relationships."
    },
    {
      "pos": [
        2754,
        2820
      ],
      "content": "Identifying the shortest route between two computers in a network."
    },
    {
      "pos": [
        2823,
        2861
      ],
      "content": "Calculating the page rank of webpages."
    },
    {
      "pos": [
        2869,
        2896
      ],
      "content": "Install Giraph using portal"
    },
    {
      "pos": [
        2984,
        3058
      ],
      "content": "<bpt id=\"p11\">[</bpt>Install Giraph on HDInsight clusters<ept id=\"p11\">](hdinsight-hadoop-giraph-install.md)</ept>"
    },
    {
      "pos": [
        3063,
        3242
      ],
      "content": "Start creating a cluster by using the <bpt id=\"p12\">**</bpt>CUSTOM CREATE<ept id=\"p12\">**</ept><ph id=\"ph3\"/> option, as described at <bpt id=\"p13\">[</bpt>Create Hadoop clusters in HDInsight using custom options<ept id=\"p13\">](hdinsight-provision-clusters.md#portal)</ept>."
    },
    {
      "pos": [
        3247,
        3380
      ],
      "content": "On the <bpt id=\"p14\">**</bpt>Script Actions<ept id=\"p14\">**</ept><ph id=\"ph4\"/> page of the wizard, click <bpt id=\"p15\">**</bpt>add script action<ept id=\"p15\">**</ept><ph id=\"ph5\"/> to provide details about the script action, as shown below:"
    },
    {
      "pos": [
        3386,
        3545
      ],
      "content": "<ph id=\"ph6\">![</ph>Use Script Action to customize a cluster<ph id=\"ph7\">](./media/hdinsight-hadoop-giraph-install-v1/hdi-script-action-giraph.png \"Use Script Action to customize a cluster\")</ph>"
    },
    {
      "pos": [
        3555,
        4428
      ],
      "leadings": [
        "",
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "   "
      ],
      "content": "<ph id=\"ph8\">&lt;table border='1'&gt;</ph><ph id=\"ph9\">\n     &lt;tr&gt;</ph><ph id=\"ph10\">&lt;th&gt;</ph>Property<ph id=\"ph11\">&lt;/th&gt;</ph><ph id=\"ph12\">&lt;th&gt;</ph>Value<ph id=\"ph13\">&lt;/th&gt;</ph><ph id=\"ph14\">&lt;/tr&gt;</ph><ph id=\"ph15\">\n     &lt;tr&gt;</ph><ph id=\"ph16\">&lt;td&gt;</ph>Name<ph id=\"ph17\">&lt;/td&gt;</ph><ph id=\"ph18\">\n         &lt;td&gt;</ph>Specify a name for the script action. For example, <ph id=\"ph19\">&lt;b&gt;</ph>Install Giraph<ph id=\"ph20\">&lt;/b&gt;</ph>.<ph id=\"ph21\">&lt;/td&gt;</ph><ph id=\"ph22\">&lt;/tr&gt;</ph><ph id=\"ph23\">\n     &lt;tr&gt;</ph><ph id=\"ph24\">&lt;td&gt;</ph>Script URI<ph id=\"ph25\">&lt;/td&gt;</ph><ph id=\"ph26\">\n         &lt;td&gt;</ph>Specify the Uniform Resource Identifier (URI) to the script that is invoked to customize the cluster. For example, <ph id=\"ph27\">&lt;i&gt;</ph>https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1<ph id=\"ph28\">&lt;/i&gt;</ph><ph id=\"ph29\">&lt;/td&gt;</ph><ph id=\"ph30\">&lt;/tr&gt;</ph><ph id=\"ph31\">\n     &lt;tr&gt;</ph><ph id=\"ph32\">&lt;td&gt;</ph>Node Type<ph id=\"ph33\">&lt;/td&gt;</ph><ph id=\"ph34\">\n         &lt;td&gt;</ph>Specify the nodes on which the customization script is run. You can choose <ph id=\"ph35\">&lt;b&gt;</ph>All nodes<ph id=\"ph36\">&lt;/b&gt;</ph>, <ph id=\"ph37\">&lt;b&gt;</ph>Head nodes only<ph id=\"ph38\">&lt;/b&gt;</ph>, or <ph id=\"ph39\">&lt;b&gt;</ph>Worker nodes only<ph id=\"ph40\">&lt;/b&gt;</ph>.\n     <ph id=\"ph41\">&lt;tr&gt;</ph><ph id=\"ph42\">&lt;td&gt;</ph>Parameters<ph id=\"ph43\">&lt;/td&gt;</ph><ph id=\"ph44\">\n         &lt;td&gt;</ph>Specify the parameters, if required by the script. The script to install Giraph does not require any parameters, so you can leave this blank.<ph id=\"ph45\">&lt;/td&gt;</ph><ph id=\"ph46\">&lt;/tr&gt;</ph><ph id=\"ph47\">\n &lt;/table&gt;</ph>",
      "nodes": [
        {
          "content": "<ph id=\"ph8\">&lt;table border='1'&gt;</ph><ph id=\"ph9\">\n     &lt;tr&gt;</ph><ph id=\"ph10\">&lt;th&gt;</ph>Property<ph id=\"ph11\">&lt;/th&gt;</ph><ph id=\"ph12\">&lt;th&gt;</ph>Value<ph id=\"ph13\">&lt;/th&gt;</ph><ph id=\"ph14\">&lt;/tr&gt;</ph><ph id=\"ph15\">\n     &lt;tr&gt;</ph><ph id=\"ph16\">&lt;td&gt;</ph>Name<ph id=\"ph17\">&lt;/td&gt;</ph><ph id=\"ph18\">\n         &lt;td&gt;</ph>Specify a name for the script action.",
          "pos": [
            0,
            411
          ]
        },
        {
          "content": "For example, <ph id=\"ph19\">&lt;b&gt;</ph>Install Giraph<ph id=\"ph20\">&lt;/b&gt;</ph>.<ph id=\"ph21\">&lt;/td&gt;</ph><ph id=\"ph22\">&lt;/tr&gt;</ph><ph id=\"ph23\">\n     &lt;tr&gt;</ph><ph id=\"ph24\">&lt;td&gt;</ph>Script URI<ph id=\"ph25\">&lt;/td&gt;</ph><ph id=\"ph26\">\n         &lt;td&gt;</ph>Specify the Uniform Resource Identifier (URI) to the script that is invoked to customize the cluster.",
          "pos": [
            412,
            801
          ]
        },
        {
          "content": "For example, <ph id=\"ph27\">&lt;i&gt;</ph>https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1<ph id=\"ph28\">&lt;/i&gt;</ph><ph id=\"ph29\">&lt;/td&gt;</ph><ph id=\"ph30\">&lt;/tr&gt;</ph><ph id=\"ph31\">\n     &lt;tr&gt;</ph><ph id=\"ph32\">&lt;td&gt;</ph>Node Type<ph id=\"ph33\">&lt;/td&gt;</ph><ph id=\"ph34\">\n         &lt;td&gt;</ph>Specify the nodes on which the customization script is run.",
          "pos": [
            802,
            1226
          ]
        },
        {
          "content": "You can choose <ph id=\"ph35\">&lt;b&gt;</ph>All nodes<ph id=\"ph36\">&lt;/b&gt;</ph>, <ph id=\"ph37\">&lt;b&gt;</ph>Head nodes only<ph id=\"ph38\">&lt;/b&gt;</ph>, or <ph id=\"ph39\">&lt;b&gt;</ph>Worker nodes only<ph id=\"ph40\">&lt;/b&gt;</ph>.",
          "pos": [
            1227,
            1462
          ]
        },
        {
          "content": "<ph id=\"ph41\">&lt;tr&gt;</ph><ph id=\"ph42\">&lt;td&gt;</ph>Parameters<ph id=\"ph43\">&lt;/td&gt;</ph><ph id=\"ph44\">\n         &lt;td&gt;</ph>Specify the parameters, if required by the script.",
          "pos": [
            1468,
            1655
          ]
        },
        {
          "content": "The script to install Giraph does not require any parameters, so you can leave this blank.<ph id=\"ph45\">&lt;/td&gt;</ph><ph id=\"ph46\">&lt;/tr&gt;</ph><ph id=\"ph47\">\n &lt;/table&gt;</ph>",
          "pos": [
            1656,
            1841
          ]
        }
      ]
    },
    {
      "pos": [
        4438,
        4609
      ],
      "content": "You can add more than one script action to install multiple components on the cluster. After you have added the scripts, click the checkmark to start creating the cluster.",
      "nodes": [
        {
          "content": "You can add more than one script action to install multiple components on the cluster.",
          "pos": [
            0,
            86
          ]
        },
        {
          "content": "After you have added the scripts, click the checkmark to start creating the cluster.",
          "pos": [
            87,
            171
          ]
        }
      ]
    },
    {
      "pos": [
        4611,
        4790
      ],
      "content": "You can also use the script to install Giraph on HDInsight by using Azure PowerShell or the HDInsight .NET SDK. Instructions for these procedures are provided later in this topic.",
      "nodes": [
        {
          "content": "You can also use the script to install Giraph on HDInsight by using Azure PowerShell or the HDInsight .NET SDK.",
          "pos": [
            0,
            111
          ]
        },
        {
          "content": "Instructions for these procedures are provided later in this topic.",
          "pos": [
            112,
            179
          ]
        }
      ]
    },
    {
      "pos": [
        4795,
        4805
      ],
      "content": "Use Giraph"
    },
    {
      "pos": [
        4807,
        4881
      ],
      "content": "We use the SimpleShortestPathsComputation example to demonstrate the basic"
    },
    {
      "pos": [
        4952,
        4958
      ],
      "content": "Pregel"
    },
    {
      "pos": [
        4963,
        5195
      ],
      "content": "implementation for finding the shortest path between objects in a graph. Use the following steps to upload the sample data and the sample jar, run a job by using the SimpleShortestPathsComputation example, and then view the results.",
      "nodes": [
        {
          "content": "implementation for finding the shortest path between objects in a graph.",
          "pos": [
            0,
            72
          ]
        },
        {
          "content": "Use the following steps to upload the sample data and the sample jar, run a job by using the SimpleShortestPathsComputation example, and then view the results.",
          "pos": [
            73,
            232
          ]
        }
      ]
    },
    {
      "pos": [
        5200,
        5358
      ],
      "content": "Upload a sample data file to Azure Blob storage. On your local workstation, create a new file named <bpt id=\"p16\">**</bpt>tiny_graph.txt<ept id=\"p16\">**</ept>. It should contain the following lines:",
      "nodes": [
        {
          "content": "Upload a sample data file to Azure Blob storage.",
          "pos": [
            0,
            48
          ]
        },
        {
          "content": "On your local workstation, create a new file named <bpt id=\"p16\">**</bpt>tiny_graph.txt<ept id=\"p16\">**</ept>.",
          "pos": [
            49,
            159
          ]
        },
        {
          "content": "It should contain the following lines:",
          "pos": [
            160,
            198
          ]
        }
      ]
    },
    {
      "pos": [
        5517,
        5712
      ],
      "content": "Upload the tiny_graph.txt file to the primary storage for your HDInsight cluster. For instructions on how to upload data, see <bpt id=\"p17\">[</bpt>Upload data for Hadoop jobs in HDInsight<ept id=\"p17\">](hdinsight-upload-data.md)</ept>.",
      "nodes": [
        {
          "content": "Upload the tiny_graph.txt file to the primary storage for your HDInsight cluster.",
          "pos": [
            0,
            81
          ]
        },
        {
          "content": "For instructions on how to upload data, see <bpt id=\"p17\">[</bpt>Upload data for Hadoop jobs in HDInsight<ept id=\"p17\">](hdinsight-upload-data.md)</ept>.",
          "pos": [
            82,
            235
          ]
        }
      ]
    },
    {
      "pos": [
        5718,
        6112
      ],
      "content": "This data describes a relationship between objects in a directed graph, by using the format [source\\_id, source\\_value,[[dest\\_id], [edge\\_value],...]]. Each line represents a relationship between a <bpt id=\"p18\">**</bpt>source\\_id<ept id=\"p18\">**</ept><ph id=\"ph48\"/> object and one or more <bpt id=\"p19\">**</bpt>dest\\_id<ept id=\"p19\">**</ept><ph id=\"ph49\"/> objects. The <bpt id=\"p20\">**</bpt>edge\\_value<ept id=\"p20\">**</ept><ph id=\"ph50\"/> (or weight) can be thought of as the strength or distance of the connection between <bpt id=\"p21\">**</bpt>source_id<ept id=\"p21\">**</ept><ph id=\"ph51\"/> and <bpt id=\"p22\">**</bpt>dest\\_id<ept id=\"p22\">**</ept>.",
      "nodes": [
        {
          "content": "This data describes a relationship between objects in a directed graph, by using the format [source\\_id, source\\_value,[[dest\\_id], [edge\\_value],...]].",
          "pos": [
            0,
            152
          ]
        },
        {
          "content": "Each line represents a relationship between a <bpt id=\"p18\">**</bpt>source\\_id<ept id=\"p18\">**</ept><ph id=\"ph48\"/> object and one or more <bpt id=\"p19\">**</bpt>dest\\_id<ept id=\"p19\">**</ept><ph id=\"ph49\"/> objects.",
          "pos": [
            153,
            368
          ]
        },
        {
          "content": "The <bpt id=\"p20\">**</bpt>edge\\_value<ept id=\"p20\">**</ept><ph id=\"ph50\"/> (or weight) can be thought of as the strength or distance of the connection between <bpt id=\"p21\">**</bpt>source_id<ept id=\"p21\">**</ept><ph id=\"ph51\"/> and <bpt id=\"p22\">**</bpt>dest\\_id<ept id=\"p22\">**</ept>.",
          "pos": [
            369,
            654
          ]
        }
      ]
    },
    {
      "pos": [
        6118,
        6230
      ],
      "content": "Drawn out, and using the value (or weight) as the distance between objects, the above data might look like this:"
    },
    {
      "pos": [
        6236,
        6370
      ],
      "content": "<ph id=\"ph52\">![</ph>tiny_graph.txt drawn as circles with lines of varying distance between<ph id=\"ph53\">](./media/hdinsight-hadoop-giraph-install-v1/giraph-graph.png)</ph>"
    },
    {
      "pos": [
        6381,
        6626
      ],
      "content": "Run the SimpleShortestPathsComputation example. Use the following Azure PowerShell cmdlets to run the example by using the tiny_graph.txt file as input. This requires that you have installed and configured <bpt id=\"p23\">[</bpt>Azure PowerShell<ept id=\"p23\">][powershell-install]</ept>.",
      "nodes": [
        {
          "content": "Run the SimpleShortestPathsComputation example.",
          "pos": [
            0,
            47
          ]
        },
        {
          "content": "Use the following Azure PowerShell cmdlets to run the example by using the tiny_graph.txt file as input.",
          "pos": [
            48,
            152
          ]
        },
        {
          "content": "This requires that you have installed and configured <bpt id=\"p23\">[</bpt>Azure PowerShell<ept id=\"p23\">][powershell-install]</ept>.",
          "pos": [
            153,
            285
          ]
        }
      ]
    },
    {
      "pos": [
        8114,
        8226
      ],
      "content": "In the above example, replace <bpt id=\"p24\">**</bpt>clustername<ept id=\"p24\">**</ept><ph id=\"ph54\"/> with the name of your HDInsight cluster that has Giraph installed."
    },
    {
      "pos": [
        8231,
        8495
      ],
      "content": "View the results. Once the job has finished, the results will be stored in two output files in the <bpt id=\"p25\">__</bpt>wasb:///example/out/shotestpaths<ept id=\"p25\">__</ept><ph id=\"ph55\"/> folder. The files are called <bpt id=\"p26\">__</bpt>part-m-00001<ept id=\"p26\">__</ept><ph id=\"ph56\"/> and <bpt id=\"p27\">__</bpt>part-m-00002<ept id=\"p27\">__</ept>. Perform the following steps to download and view the output:",
      "nodes": [
        {
          "content": "View the results.",
          "pos": [
            0,
            17
          ]
        },
        {
          "content": "Once the job has finished, the results will be stored in two output files in the <bpt id=\"p25\">__</bpt>wasb:///example/out/shotestpaths<ept id=\"p25\">__</ept><ph id=\"ph55\"/> folder.",
          "pos": [
            18,
            198
          ]
        },
        {
          "content": "The files are called <bpt id=\"p26\">__</bpt>part-m-00001<ept id=\"p26\">__</ept><ph id=\"ph56\"/> and <bpt id=\"p27\">__</bpt>part-m-00002<ept id=\"p27\">__</ept>.",
          "pos": [
            199,
            353
          ]
        },
        {
          "content": "Perform the following steps to download and view the output:",
          "pos": [
            354,
            414
          ]
        }
      ]
    },
    {
      "pos": [
        9460,
        9631
      ],
      "content": "This will create the <bpt id=\"p28\">__</bpt>example/output/shortestpaths<ept id=\"p28\">__</ept><ph id=\"ph57\"/> directory structure in the current directory on your workstation, and download the two output files to that location."
    },
    {
      "pos": [
        9637,
        9697
      ],
      "content": "Use the <bpt id=\"p29\">__</bpt>Cat<ept id=\"p29\">__</ept><ph id=\"ph58\"/> cmdlet to display the contents of the files:"
    },
    {
      "pos": [
        9752,
        9802
      ],
      "content": "The output should appear similar to the following:"
    },
    {
      "pos": [
        10636,
        10672
      ],
      "content": "Install Giraph using Aure PowerShell"
    },
    {
      "pos": [
        10674,
        11100
      ],
      "content": "See <bpt id=\"p30\">[</bpt>Customize HDInsight clusters using Script Action<ept id=\"p30\">](hdinsight-hadoop-customize-cluster.md#call_scripts_using_powershell)</ept>.  The sample demonstrates how to install Spark using Azure PowerShell. You need to customize the script to use <bpt id=\"p31\">[</bpt>https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1<ept id=\"p31\">](https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1)</ept>.",
      "nodes": [
        {
          "content": "See <bpt id=\"p30\">[</bpt>Customize HDInsight clusters using Script Action<ept id=\"p30\">](hdinsight-hadoop-customize-cluster.md#call_scripts_using_powershell)</ept>.",
          "pos": [
            0,
            164
          ]
        },
        {
          "content": "The sample demonstrates how to install Spark using Azure PowerShell.",
          "pos": [
            166,
            234
          ]
        },
        {
          "content": "You need to customize the script to use <bpt id=\"p31\">[</bpt>https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1<ept id=\"p31\">](https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1)</ept>.",
          "pos": [
            235,
            506
          ]
        }
      ]
    },
    {
      "pos": [
        11105,
        11134
      ],
      "content": "Install Giraph using .NET SDK"
    },
    {
      "pos": [
        11136,
        11563
      ],
      "content": "See <bpt id=\"p32\">[</bpt>Customize HDInsight clusters using Script Action<ept id=\"p32\">](hdinsight-hadoop-customize-cluster.md#call_scripts_using_azure_powershell)</ept>. The sample demonstrates how to install Spark using the .NET SDK. You need to customize the script to use <bpt id=\"p33\">[</bpt>https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1<ept id=\"p33\">](https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1)</ept>.",
      "nodes": [
        {
          "content": "See <bpt id=\"p32\">[</bpt>Customize HDInsight clusters using Script Action<ept id=\"p32\">](hdinsight-hadoop-customize-cluster.md#call_scripts_using_azure_powershell)</ept>.",
          "pos": [
            0,
            170
          ]
        },
        {
          "content": "The sample demonstrates how to install Spark using the .NET SDK.",
          "pos": [
            171,
            235
          ]
        },
        {
          "content": "You need to customize the script to use <bpt id=\"p33\">[</bpt>https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1<ept id=\"p33\">](https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1)</ept>.",
          "pos": [
            236,
            507
          ]
        }
      ]
    },
    {
      "pos": [
        11569,
        11577
      ],
      "content": "See also"
    },
    {
      "pos": [
        11581,
        11694
      ],
      "content": "<bpt id=\"p34\">[</bpt>Install Giraph on HDInsight clusters<ept id=\"p34\">](hdinsight-hadoop-giraph-install.md)</ept>: install Giraph using the Azure Portal"
    },
    {
      "pos": [
        11697,
        11792
      ],
      "content": "<bpt id=\"p35\">[</bpt>Install Giraph on HDInsight Hadoop clusters (Linux)<ept id=\"p35\">](hdinsight-hadoop-giraph-install-linux.md)</ept>"
    },
    {
      "pos": [
        11795,
        11918
      ],
      "content": "<bpt id=\"p36\">[</bpt>Create Hadoop clusters in HDInsight<ept id=\"p36\">](hdinsight-provision-clusters.md)</ept>: general information on creating HDInsight clusters."
    },
    {
      "pos": [
        11921,
        12075
      ],
      "content": "<bpt id=\"p37\">[</bpt>Customize HDInsight cluster using Script Action<ept id=\"p37\">][hdinsight-cluster-customize]</ept>: general information on customizing HDInsight clusters using Script Action."
    },
    {
      "pos": [
        12078,
        12160
      ],
      "content": "<bpt id=\"p38\">[</bpt>Develop Script Action scripts for HDInsight<ept id=\"p38\">](hdinsight-hadoop-script-actions.md)</ept>."
    },
    {
      "pos": [
        12163,
        12279
      ],
      "content": "<bpt id=\"p39\">[</bpt>Install and use Spark on HDInsight clusters<ept id=\"p39\">][hdinsight-install-spark]</ept>: Script Action sample about installing Spark."
    },
    {
      "pos": [
        12282,
        12378
      ],
      "content": "<bpt id=\"p40\">[</bpt>Install R on HDInsight clusters<ept id=\"p40\">][hdinsight-install-r]</ept>: Script Action sample about installing R."
    },
    {
      "pos": [
        12381,
        12496
      ],
      "content": "<bpt id=\"p41\">[</bpt>Install Solr on HDInsight clusters<ept id=\"p41\">](hdinsight-hadoop-solr-install.md)</ept>: Script Action sample about installing Solr."
    }
  ],
  "content": "<properties \n    pageTitle=\"Install and use Giraph on Hadoop clusters in HDInsight | Microsoft Azure\" \n    description=\"Learn how to customize HDInsight cluster with Giraph. You'll use a Script Action configuration option to use a script to install Giraph.\" \n    services=\"hdinsight\" \n    documentationCenter=\"\" \n    authors=\"nitinme\" \n    manager=\"paulettm\" \n    editor=\"cgronlun\"/>\n\n<tags \n    ms.service=\"hdinsight\" \n    ms.workload=\"big-data\" \n    ms.tgt_pltfrm=\"na\" \n    ms.devlang=\"na\" \n    ms.topic=\"article\" \n    ms.date=\"02/12/2016\" \n    ms.author=\"nitinme\"/>\n\n# Install Giraph on HDInsight Hadoop clusters, and use Giraph to process large-scale graphs\n\nLearn how to customize Windows based HDInsight cluster with Giraph using Script Action, and how to use Giraph to process large-scale graphs. For information on using Giraph with a Linux-based cluster, see [Install Giraph on HDInsight Hadoop clusters (Linux)](hdinsight-hadoop-giraph-install-linux.md).\n \nYou can install Giraph on any type of cluster (Hadoop, Storm, HBase, Spark) on Azure HDInsight by using *Script Action*. A sample script to install Giraph on an HDInsight cluster is available from a read-only Azure storage blob at [https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1](https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1). The sample script works only with HDInsight cluster version 3.1. For more information on HDInsight cluster versions, see [HDInsight cluster versions](hdinsight-component-versioning.md).\n\n**Related articles**\n\n- [Install Giraph on HDInsight clusters](hdinsight-hadoop-giraph-install.md): install Giraph using the Azure Portal\n- [Install Giraph on HDInsight Hadoop clusters (Linux)](hdinsight-hadoop-giraph-install-linux.md)\n- [Create Hadoop clusters in HDInsight](hdinsight-provision-clusters.md): general information on creating HDInsight clusters.\n- [Customize HDInsight cluster using Script Action][hdinsight-cluster-customize]: general information on customizing HDInsight clusters using Script Action.\n- [Develop Script Action scripts for HDInsight](hdinsight-hadoop-script-actions.md).\n\n\n## What is Giraph?\n\n<a href=\"http://giraph.apache.org/\" target=\"_blank\">Apache Giraph</a> allows you to perform graph processing by using Hadoop, and can be used with Azure HDInsight. Graphs model relationships between objects, such as the connections between routers on a large network like the Internet, or relationships between people on social networks (sometimes referred to as a social graph). Graph processing allows you to reason about the relationships between objects in a graph, such as:\n\n- Identifying potential friends based on your current relationships.\n- Identifying the shortest route between two computers in a network.\n- Calculating the page rank of webpages.\n   \n## Install Giraph using portal\n\n[AZURE.INCLUDE [hdinsight-azure-portal](../../includes/hdinsight-azure-portal.md)]\n\n* [Install Giraph on HDInsight clusters](hdinsight-hadoop-giraph-install.md)\n\n1. Start creating a cluster by using the **CUSTOM CREATE** option, as described at [Create Hadoop clusters in HDInsight using custom options](hdinsight-provision-clusters.md#portal). \n2. On the **Script Actions** page of the wizard, click **add script action** to provide details about the script action, as shown below:\n\n    ![Use Script Action to customize a cluster](./media/hdinsight-hadoop-giraph-install-v1/hdi-script-action-giraph.png \"Use Script Action to customize a cluster\")\n    \n    <table border='1'>\n        <tr><th>Property</th><th>Value</th></tr>\n        <tr><td>Name</td>\n            <td>Specify a name for the script action. For example, <b>Install Giraph</b>.</td></tr>\n        <tr><td>Script URI</td>\n            <td>Specify the Uniform Resource Identifier (URI) to the script that is invoked to customize the cluster. For example, <i>https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1</i></td></tr>\n        <tr><td>Node Type</td>\n            <td>Specify the nodes on which the customization script is run. You can choose <b>All nodes</b>, <b>Head nodes only</b>, or <b>Worker nodes only</b>.\n        <tr><td>Parameters</td>\n            <td>Specify the parameters, if required by the script. The script to install Giraph does not require any parameters, so you can leave this blank.</td></tr>\n    </table>    \n\n    You can add more than one script action to install multiple components on the cluster. After you have added the scripts, click the checkmark to start creating the cluster.\n\nYou can also use the script to install Giraph on HDInsight by using Azure PowerShell or the HDInsight .NET SDK. Instructions for these procedures are provided later in this topic.\n\n## Use Giraph\n\nWe use the SimpleShortestPathsComputation example to demonstrate the basic <a href = \"http://people.apache.org/~edwardyoon/documents/pregel.pdf\">Pregel</a> implementation for finding the shortest path between objects in a graph. Use the following steps to upload the sample data and the sample jar, run a job by using the SimpleShortestPathsComputation example, and then view the results.\n\n1. Upload a sample data file to Azure Blob storage. On your local workstation, create a new file named **tiny_graph.txt**. It should contain the following lines:\n\n        [0,0,[[1,1],[3,3]]]\n        [1,0,[[0,1],[2,2],[3,1]]]\n        [2,0,[[1,2],[4,4]]]\n        [3,0,[[0,3],[1,1],[4,4]]]\n        [4,0,[[3,4],[2,4]]]\n\n    Upload the tiny_graph.txt file to the primary storage for your HDInsight cluster. For instructions on how to upload data, see [Upload data for Hadoop jobs in HDInsight](hdinsight-upload-data.md).\n\n    This data describes a relationship between objects in a directed graph, by using the format [source\\_id, source\\_value,[[dest\\_id], [edge\\_value],...]]. Each line represents a relationship between a **source\\_id** object and one or more **dest\\_id** objects. The **edge\\_value** (or weight) can be thought of as the strength or distance of the connection between **source_id** and **dest\\_id**.\n\n    Drawn out, and using the value (or weight) as the distance between objects, the above data might look like this:\n\n    ![tiny_graph.txt drawn as circles with lines of varying distance between](./media/hdinsight-hadoop-giraph-install-v1/giraph-graph.png)\n\n    \n\n4. Run the SimpleShortestPathsComputation example. Use the following Azure PowerShell cmdlets to run the example by using the tiny_graph.txt file as input. This requires that you have installed and configured [Azure PowerShell][powershell-install].\n\n        $clusterName = \"clustername\"\n        # Giraph examples jar\n        $jarFile = \"wasb:///example/jars/giraph-examples.jar\"\n        # Arguments for this job\n        $jobArguments = \"org.apache.giraph.examples.SimpleShortestPathsComputation\",\n                        \"-ca\", \"mapred.job.tracker=headnodehost:9010\",\n                        \"-vif\", \"org.apache.giraph.io.formats.JsonLongDoubleFloatDoubleVertexInputFormat\",\n                        \"-vip\", \"wasb:///example/data/tiny_graph.txt\",\n                        \"-vof\", \"org.apache.giraph.io.formats.IdWithValueTextOutputFormat\",\n                        \"-op\",  \"wasb:///example/output/shortestpaths\",\n                        \"-w\", \"2\"\n        # Create the definition\n        $jobDefinition = New-AzureHDInsightMapReduceJobDefinition\n          -JarFile $jarFile\n          -ClassName \"org.apache.giraph.GiraphRunner\"\n          -Arguments $jobArguments\n        \n        # Run the job, write output to the Azure PowerShell window\n        $job = Start-AzureHDInsightJob -Cluster $clusterName -JobDefinition $jobDefinition\n        Write-Host \"Wait for the job to complete ...\" -ForegroundColor Green\n        Wait-AzureHDInsightJob -Job $job\n        Write-Host \"STDERR\"\n        Get-AzureHDInsightJobOutput -Cluster $clusterName -JobId $job.JobId -StandardError\n        Write-Host \"Display the standard output ...\" -ForegroundColor Green\n        Get-AzureHDInsightJobOutput -Cluster $clusterName -JobId $job.JobId -StandardOutput\n\n    In the above example, replace **clustername** with the name of your HDInsight cluster that has Giraph installed.\n\n5. View the results. Once the job has finished, the results will be stored in two output files in the __wasb:///example/out/shotestpaths__ folder. The files are called __part-m-00001__ and __part-m-00002__. Perform the following steps to download and view the output:\n\n        $subscriptionName = \"<SubscriptionName>\"       # Azure subscription name\n        $storageAccountName = \"<StorageAccountName>\"   # Azure Storage account name\n        $containerName = \"<ContainerName>\"             # Blob storage container name\n\n        # Select the current subscription\n        Select-AzureSubscription $subscriptionName\n        \n        # Create the Storage account context object\n        $storageAccountKey = Get-AzureStorageKey $storageAccountName | %{ $_.Primary }\n        $storageContext = New-AzureStorageContext -StorageAccountName $storageAccountName -StorageAccountKey $storageAccountKey\n\n        # Download the job output to the workstation\n        Get-AzureStorageBlobContent -Container $containerName -Blob example/output/shortestpaths/part-m-00001 -Context $storageContext -Force\n        Get-AzureStorageBlobContent -Container $containerName -Blob example/output/shortestpaths/part-m-00002 -Context $storageContext -Force\n\n    This will create the __example/output/shortestpaths__ directory structure in the current directory on your workstation, and download the two output files to that location.\n\n    Use the __Cat__ cmdlet to display the contents of the files: \n\n        Cat example/output/shortestpaths/part*\n\n    The output should appear similar to the following:\n\n\n        0   1.0\n        4   5.0\n        2   2.0\n        1   0.0\n        3   1.0\n\n    The SimpleShortestPathComputation example is hard coded to start with object ID 1 and find the shortest path to other objects. So the output should be read as `destination_id distance`, where distance is the value (or weight) of the edges traveled between object ID 1 and the target ID.\n    \n    Visualizing this, you can verify the results by traveling the shortest paths between ID 1 and all other objects. Note that the shortest path between ID 1 and ID 4 is 5. This is the total distance between <span style=\"color:orange\">ID 1 and 3</span>, and then <span style=\"color:red\">ID 3 and 4</span>.\n\n    ![Drawing of objects as circles with shortest paths drawn between](./media/hdinsight-hadoop-giraph-install-v1/giraph-graph-out.png) \n\n\n\n\n\n\n\n## Install Giraph using Aure PowerShell\n\nSee [Customize HDInsight clusters using Script Action](hdinsight-hadoop-customize-cluster.md#call_scripts_using_powershell).  The sample demonstrates how to install Spark using Azure PowerShell. You need to customize the script to use [https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1](https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1).\n\n## Install Giraph using .NET SDK\n\nSee [Customize HDInsight clusters using Script Action](hdinsight-hadoop-customize-cluster.md#call_scripts_using_azure_powershell). The sample demonstrates how to install Spark using the .NET SDK. You need to customize the script to use [https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1](https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1).\n\n\n## See also\n\n- [Install Giraph on HDInsight clusters](hdinsight-hadoop-giraph-install.md): install Giraph using the Azure Portal\n- [Install Giraph on HDInsight Hadoop clusters (Linux)](hdinsight-hadoop-giraph-install-linux.md)\n- [Create Hadoop clusters in HDInsight](hdinsight-provision-clusters.md): general information on creating HDInsight clusters.\n- [Customize HDInsight cluster using Script Action][hdinsight-cluster-customize]: general information on customizing HDInsight clusters using Script Action.\n- [Develop Script Action scripts for HDInsight](hdinsight-hadoop-script-actions.md).\n- [Install and use Spark on HDInsight clusters][hdinsight-install-spark]: Script Action sample about installing Spark.\n- [Install R on HDInsight clusters][hdinsight-install-r]: Script Action sample about installing R.\n- [Install Solr on HDInsight clusters](hdinsight-hadoop-solr-install.md): Script Action sample about installing Solr.\n\n[tools]: https://github.com/Blackmist/hdinsight-tools\n[aps]: http://azure.microsoft.com/documentation/articles/install-configure-powershell/\n\n[powershell-install]: ../powershell-install-configure.md\n[hdinsight-provision]: hdinsight-provision-clusters.md\n[hdinsight-install-r]: hdinsight-hadoop-r-scripts.md\n[hdinsight-install-spark]: hdinsight-hadoop-spark-install.md\n[hdinsight-cluster-customize]: hdinsight-hadoop-customize-cluster.md\n "
}