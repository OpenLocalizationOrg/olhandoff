{
  "nodes": [
    {
      "content": "Azure Active Directory AD Role-based Access Control | Microsoft Azure",
      "pos": [
        27,
        96
      ]
    },
    {
      "content": "This article describes Azure role-based access control.",
      "pos": [
        115,
        170
      ]
    },
    {
      "content": "Azure Role-based Access Control",
      "pos": [
        479,
        510
      ]
    },
    {
      "content": "Role-based Access Control",
      "pos": [
        515,
        540
      ]
    },
    {
      "content": "Azure Role-Based Access Control (RBAC) enables fine-grained access management for Azure.",
      "pos": [
        541,
        629
      ]
    },
    {
      "content": "Using RBAC, you can segregate duties within your DevOps team and grant only the amount of access to users that they need to perform their jobs.",
      "pos": [
        630,
        773
      ]
    },
    {
      "content": "Basics of access management in Azure",
      "pos": [
        779,
        815
      ]
    },
    {
      "content": "Each Azure subscription is homed to an Azure Active Directory.",
      "pos": [
        816,
        878
      ]
    },
    {
      "content": "Only users, groups, and applications from that directory can be granted access to manage resources in the Azure subscription, using Azure portal, Azure Command-Line tools and Azure Management APIs.",
      "pos": [
        879,
        1076
      ]
    },
    {
      "content": "Access is granted by assigning the appropriate RBAC role to users, groups, and applications, at the right scope.",
      "pos": [
        1078,
        1190
      ]
    },
    {
      "content": "To grant access to the entire subscription, assign a role at the subscription scope.",
      "pos": [
        1191,
        1275
      ]
    },
    {
      "content": "To grant access to a specific resource group within a subscription, assign a role at the resource group scope.",
      "pos": [
        1276,
        1386
      ]
    },
    {
      "content": "You may assign roles at specific resources too, like websites, virtual machines and subnets, to grant access only to a resource.",
      "pos": [
        1387,
        1515
      ]
    },
    {
      "content": "The RBAC role that you assign to users, groups, and applications, dictates what resources the user (or application) can manage within that scope.",
      "pos": [
        1580,
        1725
      ]
    },
    {
      "content": "Azure RBAC Built-In Roles",
      "pos": [
        1731,
        1756
      ]
    },
    {
      "content": "Azure RBAC has three basic roles that apply to all resource types: Owner, Contributor and Reader.",
      "pos": [
        1757,
        1854
      ]
    },
    {
      "content": "Owner has full access to all resources including the right to delegate access to others.",
      "pos": [
        1855,
        1943
      ]
    },
    {
      "content": "Contributor can create and manage all types of Azure resources but can’t grant access to others.",
      "pos": [
        1944,
        2040
      ]
    },
    {
      "content": "Reader can only view existing Azure resources.",
      "pos": [
        2041,
        2087
      ]
    },
    {
      "content": "The rest of the RBAC roles in Azure allow management of specific Azure resources.",
      "pos": [
        2088,
        2169
      ]
    },
    {
      "content": "For instance, the Virtual Machine Contributor role allows creation and management of virtual machines but does not allow management of the virtual network or the subnet that the virtual machine connects to.",
      "pos": [
        2170,
        2376
      ]
    },
    {
      "content": "<bpt id=\"p1\">[</bpt>RBAC Built in Roles<ept id=\"p1\">](role-based-access-built-in-roles.md)</ept> lists the built-in RBAC roles available in Azure.",
      "pos": [
        2378,
        2486
      ]
    },
    {
      "content": "For each role it specifies the operations to which a built-in role grants access.",
      "pos": [
        2487,
        2568
      ]
    },
    {
      "content": "Azure Resource Hierarchy and Access Inheritance",
      "pos": [
        2574,
        2621
      ]
    },
    {
      "content": "Each subscription in Azure belongs to one and only one directory, each resource group belongs to one and only one subscription, and each resource belongs to one and only one resource group.",
      "pos": [
        2622,
        2811
      ]
    },
    {
      "content": "Access that you grant at parent scopes is inherited at child scopes.",
      "pos": [
        2812,
        2880
      ]
    },
    {
      "content": "If you grant reader role to an Azure AD group at the subscription scope, the members of that group will be able to view every resource groups and every resource in the subscription.",
      "pos": [
        2881,
        3062
      ]
    },
    {
      "content": "If you grant the contributor role to an application at the resource group scope, it will be able to manage resources of all types in that resource group but not other resource groups in the subscription.",
      "pos": [
        3063,
        3266
      ]
    },
    {
      "content": "Azure RBAC vs. Classic Subscription Administrator and Co-Admins",
      "pos": [
        3272,
        3335
      ]
    },
    {
      "content": "Classic subscription administrator and co-admins have full access to the Azure subscription.",
      "pos": [
        3336,
        3428
      ]
    },
    {
      "content": "They can manage resources using both the Azure classic portal (https://manage.windowsazure.com), and Azure Service Manager APIs, as well as the Azure portal (https://portal.azure.com), and new Azure Resource Manager APIs.",
      "pos": [
        3429,
        3650
      ]
    },
    {
      "content": "In the RBAC model, classic administrators are assigned the Owner role at the subscription scope.",
      "pos": [
        3651,
        3747
      ]
    },
    {
      "content": "The finer-grained authorization model (Azure RBAC) is supported only by the Azure portal (https://portal.azure.com) and Azure Resource Manager APIs.",
      "pos": [
        3749,
        3897
      ]
    },
    {
      "content": "Users and applications that are assigned RBAC roles (at subscription/resource group/resource scope) cannot use the classic management portal (http://manage.windowsazure.com) and the Azure Service Management APIs.",
      "pos": [
        3898,
        4110
      ]
    },
    {
      "content": "Authorization for Management vs Data Operations",
      "pos": [
        4116,
        4163
      ]
    },
    {
      "content": "The finer-grained authorization model (Azure RBAC) is supported only for management operations of the Azure resources in the Azure portal and Azure Resource Manager APIs.",
      "pos": [
        4164,
        4334
      ]
    },
    {
      "content": "Not all data level operations for Azure resources can be authorized via RBAC.",
      "pos": [
        4335,
        4412
      ]
    },
    {
      "content": "For instance, create/read/update/delete of Storage Accounts can be controlled via RBAC, but create/read/update/delete of blobs or tables within the Storage Account cannot yet be controlled via RBAC.",
      "pos": [
        4413,
        4611
      ]
    },
    {
      "content": "Similarly, create/read/update/delete of a SQL DB can be controlled via RBAC but create/read/update/delete of SQL tables within the DB cannot yet be controlled via RBAC.",
      "pos": [
        4612,
        4780
      ]
    },
    {
      "content": "Manage access using the Azure portal",
      "pos": [
        4785,
        4821
      ]
    },
    {
      "content": "View Access",
      "pos": [
        4826,
        4837
      ]
    },
    {
      "content": "Select access settings in the essentials section of the resource group blade.",
      "pos": [
        4838,
        4915
      ]
    },
    {
      "content": "The <bpt id=\"p1\">**</bpt>Users<ept id=\"p1\">**</ept> blade lists all users, groups and applications that have been granted access to the resource group.",
      "pos": [
        4916,
        5029
      ]
    },
    {
      "content": "Access is either assigned on the resource group or inherited from an assignment on the parent subscription.",
      "pos": [
        5030,
        5137
      ]
    },
    {
      "pos": [
        5207,
        5325
      ],
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> Classic subscription admins and co-admins are in effect owners of the subscription in the new RBAC model."
    },
    {
      "content": "Add Access",
      "pos": [
        5331,
        5341
      ]
    },
    {
      "content": "Click the <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> icon on the <bpt id=\"p2\">**</bpt>Users<ept id=\"p2\">**</ept> blade.",
      "pos": [
        5345,
        5391
      ]
    },
    {
      "content": "Select the role that you wish to assign.",
      "pos": [
        5462,
        5502
      ]
    },
    {
      "content": "Search for and select the user, or group, or application that you wish to grant access to.",
      "pos": [
        5506,
        5596
      ]
    },
    {
      "pos": [
        5600,
        5784
      ],
      "content": "Search the directory for users, groups, and applications using display names, email addresses, and object identifiers.<ph id=\"ph1\">![](./media/role-based-access-control-configure/grant-access2.png)</ph>"
    },
    {
      "content": "Remove Access",
      "pos": [
        5790,
        5803
      ]
    },
    {
      "pos": [
        5807,
        5882
      ],
      "content": "In the <bpt id=\"p1\">**</bpt>Users<ept id=\"p1\">**</ept> blade, select the role assignment that you wish to remove."
    },
    {
      "pos": [
        5886,
        5944
      ],
      "content": "Click the <bpt id=\"p1\">**</bpt>Remove<ept id=\"p1\">**</ept> icon in the assignment details blade."
    },
    {
      "pos": [
        5948,
        5981
      ],
      "content": "Click <bpt id=\"p1\">**</bpt>yes<ept id=\"p1\">**</ept> to confirm removal."
    },
    {
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> Inherited assignments can not be removed from child scopes.",
      "pos": [
        6055,
        6127
      ]
    },
    {
      "content": "Navigate to the parent scope and remove such assignments.",
      "pos": [
        6128,
        6185
      ]
    },
    {
      "content": "Manage access using Azure PowerShell",
      "pos": [
        6260,
        6296
      ]
    },
    {
      "content": "Access can be managed used Azure RBAC commands in the Azure PowerShell tools.",
      "pos": [
        6297,
        6374
      ]
    },
    {
      "pos": [
        6380,
        6513
      ],
      "content": "Use <ph id=\"ph1\">`Get-AzureRmRoleDefinition`</ph> to list RBAC roles available for assignment and to inspect the operations to which they grant access."
    },
    {
      "content": "Use <ph id=\"ph1\">`Get-AzureRmRoleAssignment`</ph> to list RBAC access assignments effective at the specified subscription or resource group or resource.",
      "pos": [
        6519,
        6653
      ]
    },
    {
      "content": "Use the <ph id=\"ph1\">`ExpandPrincipalGroups`</ph> parameter to list access assignments to the specified user as well as to the groups of which the user is member.",
      "pos": [
        6654,
        6798
      ]
    },
    {
      "content": "Use the <ph id=\"ph1\">`IncludeClassicAdministrators`</ph> parameter to also list classic Subscription Administrator and Co-Administrators.",
      "pos": [
        6799,
        6918
      ]
    },
    {
      "pos": [
        6924,
        7006
      ],
      "content": "Use <ph id=\"ph1\">`New-AzureRmRoleAssignment`</ph> to grant access to users, groups and applications."
    },
    {
      "pos": [
        7012,
        7064
      ],
      "content": "Use <ph id=\"ph1\">`Remove-AzureRmRoleAssignment`</ph> to remove access."
    },
    {
      "pos": [
        7066,
        7233
      ],
      "content": "See <bpt id=\"p1\">[</bpt>Manage access using Azure PowerShell<ept id=\"p1\">](role-based-access-control-manage-access-powershell.md)</ept> for more detailed examples of managing access using Azure PowerShell."
    },
    {
      "content": "Manage access using the Azure Command-Line Interface",
      "pos": [
        7238,
        7290
      ]
    },
    {
      "content": "Access can be managed used Azure RBAC commands in the Azure Command-Line Interface.",
      "pos": [
        7291,
        7374
      ]
    },
    {
      "content": "Use <ph id=\"ph1\">`azure role list`</ph> to list RBAC roles available for assignment.",
      "pos": [
        7380,
        7446
      ]
    },
    {
      "content": "Use azure role show to inspect the operations to which they grant access.",
      "pos": [
        7447,
        7520
      ]
    },
    {
      "content": "Use <ph id=\"ph1\">`azure role assignment list`</ph> to list RBAC access assignments effective at the specified subscription or resource group or resource.",
      "pos": [
        7526,
        7661
      ]
    },
    {
      "content": "Use the <ph id=\"ph1\">`expandPrincipalGroups`</ph> option to list access assignments to the specified user as well as to the groups of which the user is member.",
      "pos": [
        7662,
        7803
      ]
    },
    {
      "content": "Use the  <ph id=\"ph1\">`includeClassicAdministrators`</ph> parameter to also list classic Subscription Administrator and Co-Administrators.",
      "pos": [
        7804,
        7924
      ]
    },
    {
      "pos": [
        7930,
        8015
      ],
      "content": "Use <ph id=\"ph1\">`azure role assignment create`</ph> to grant access to users, groups and applications."
    },
    {
      "pos": [
        8021,
        8073
      ],
      "content": "Use <ph id=\"ph1\">`azure role assignment delete`</ph> to remove access."
    },
    {
      "pos": [
        8075,
        8235
      ],
      "content": "See <bpt id=\"p1\">[</bpt>Manage access using the Azure CLI<ept id=\"p1\">](role-based-access-control-manage-access-azure-cli.md)</ept> for more detailed examples of managing access using the Azure CLI."
    },
    {
      "content": "Using the Access Change History Report",
      "pos": [
        8240,
        8278
      ]
    },
    {
      "content": "All access changes happening in your Azure subscriptions get logged in Azure events.",
      "pos": [
        8279,
        8363
      ]
    },
    {
      "content": "Create a report with Azure PowerShell",
      "pos": [
        8369,
        8406
      ]
    },
    {
      "content": "To create a report of who granted/revoked what kind of access to/from whom on what scope within your Azure subscirptions use the following PowerShell command:",
      "pos": [
        8407,
        8565
      ]
    },
    {
      "content": "Create a report with Azure CLI",
      "pos": [
        8610,
        8640
      ]
    },
    {
      "content": "To create a report of who granted/revoked what kind of access to/from whom on what scope within your Azure subscirptions use the Azure command line interface (CLI) command:",
      "pos": [
        8641,
        8813
      ]
    },
    {
      "pos": [
        8854,
        8938
      ],
      "content": "<ph id=\"ph1\">[AZURE.NOTE]</ph> Access changes can be queried for the past 90 days (in 15 day batches)."
    },
    {
      "content": "The following lists all access changes in the subscription for the past 7 days.",
      "pos": [
        8940,
        9019
      ]
    },
    {
      "content": "Export Access Change to a Spreadsheet",
      "pos": [
        9101,
        9138
      ]
    },
    {
      "content": "It is convenient to export access changes into a spreadsheet for review.",
      "pos": [
        9139,
        9211
      ]
    },
    {
      "content": "Custom Roles in Azure RBAC",
      "pos": [
        9297,
        9323
      ]
    },
    {
      "content": "Create a custom role in Azure RBAC if none of the built-in roles meets your specific access need.",
      "pos": [
        9324,
        9421
      ]
    },
    {
      "content": "Custom roles can be created using RBAC command-line tools in Azure PowerShell, and Azure Command-Line Interface.",
      "pos": [
        9422,
        9534
      ]
    },
    {
      "content": "Just like built-in roles, custom roles can be assigned to users, groups, and applications at subscription, resource group, and resource scope.",
      "pos": [
        9535,
        9677
      ]
    },
    {
      "content": "Following is an example custom role definition that allows monitoring and restarting virtual machines:",
      "pos": [
        9679,
        9781
      ]
    },
    {
      "content": "Actions",
      "pos": [
        10632,
        10639
      ]
    },
    {
      "content": "The actions property of a custom role specifies the Azure operations to which the role grants access.",
      "pos": [
        10640,
        10741
      ]
    },
    {
      "content": "It is a collection of operation strings that identify securable operations of Azure resource providers.",
      "pos": [
        10742,
        10845
      ]
    },
    {
      "content": "Operation strings that contain wildcards (\\*) grant access go all operations that match the operation string.",
      "pos": [
        10846,
        10955
      ]
    },
    {
      "content": "For instance:",
      "pos": [
        10956,
        10969
      ]
    },
    {
      "pos": [
        10975,
        11072
      ],
      "content": "<ph id=\"ph1\">`*/read`</ph> grants access to read operations for all resource types of all Azure resource providers."
    },
    {
      "pos": [
        11077,
        11212
      ],
      "content": "<ph id=\"ph1\">`Microsoft.Network/*/read`</ph> grants access to read operations for all resource types in the Microsoft.Network resource provider of Azure."
    },
    {
      "pos": [
        11217,
        11336
      ],
      "content": "<ph id=\"ph1\">`Microsoft.Compute/virtualMachines/*`</ph> grants access to all operations of virtual machines and its child resource types."
    },
    {
      "pos": [
        11341,
        11412
      ],
      "content": "<ph id=\"ph1\">`Microsoft.Web/sites/restart/Action`</ph> grants access to restart websites."
    },
    {
      "content": "Use <ph id=\"ph1\">`Get-AzureRmProviderOperation`</ph> or <ph id=\"ph2\">`azure provider operations show`</ph> commands to list operations of Azure resource providers.",
      "pos": [
        11414,
        11541
      ]
    },
    {
      "content": "You may also use these commands to verify that an operation string is valid, and to expand wildcard operation strings.",
      "pos": [
        11542,
        11660
      ]
    },
    {
      "content": "Not Actions",
      "pos": [
        11840,
        11851
      ]
    },
    {
      "content": "If the set of operations that you wish to allow is easily expressed by excluding specific operations rather than including all operations operations except than the ones you wish to exclude, then use the <bpt id=\"p1\">**</bpt>NotActions<ept id=\"p1\">**</ept> property of a custom role.",
      "pos": [
        11852,
        12097
      ]
    },
    {
      "content": "The effective access granted by a custom role is computed by excluding the <bpt id=\"p1\">**</bpt>NotActions<ept id=\"p1\">**</ept> operations from the Actions operations.",
      "pos": [
        12098,
        12227
      ]
    },
    {
      "content": "Note that if a user is assigned a role that excludes an operation in <bpt id=\"p1\">**</bpt>NotActions<ept id=\"p1\">**</ept> and is assigned a second role that grants access to the same operation – the user will be allowed to perform that operation.",
      "pos": [
        12229,
        12437
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>NotActions<ept id=\"p1\">**</ept> is not a deny rule – it is simply a convenient way to create a set of allowed operations when specific operations need to be excluded.",
      "pos": [
        12438,
        12587
      ]
    },
    {
      "content": "AssignableScopes",
      "pos": [
        12593,
        12609
      ]
    },
    {
      "content": "The <bpt id=\"p1\">**</bpt>AssignableScopes<ept id=\"p1\">**</ept> property of the custom role specifies the scopes (subscriptions, or resource groups, or resources) within which the custom role is available for assignment to users, groups, and applications.",
      "pos": [
        12610,
        12826
      ]
    },
    {
      "content": "Using <bpt id=\"p1\">**</bpt>AssignableScopes<ept id=\"p1\">**</ept> you can make the custom role available for assignment in only the subscriptions or resource groups that require it, and not clutter user experience for the rest of the subscriptions or resource groups.",
      "pos": [
        12827,
        13055
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>AssignableScopes<ept id=\"p1\">**</ept> of a custom role also control who is allowed to view, update, and delete the role.",
      "pos": [
        13056,
        13159
      ]
    },
    {
      "content": "Following are some valid assignable scopes:",
      "pos": [
        13160,
        13203
      ]
    },
    {
      "content": "“/subscriptions/c276fc76-9cd4-44c9-99a7-4fd71546436e”, “/subscriptions/e91d47c4-76f3-4271-a796-21b4ecfe3624”: makes the role available for assignment in two subscriptions.",
      "pos": [
        13209,
        13380
      ]
    },
    {
      "content": "“/subscriptions/c276fc76-9cd4-44c9-99a7-4fd71546436e”: makes the role available for assignment in a single subscription.",
      "pos": [
        13385,
        13505
      ]
    },
    {
      "content": "“/subscriptions/c276fc76-9cd4-44c9-99a7-4fd71546436e/resourceGroups/Network”: makes the role available for assignment only in the Network resource group.",
      "pos": [
        13510,
        13663
      ]
    },
    {
      "content": "Custom Roles Access Control",
      "pos": [
        13669,
        13696
      ]
    },
    {
      "pos": [
        13697,
        13801
      ],
      "content": "The <bpt id=\"p1\">**</bpt>AssignableScopes<ept id=\"p1\">**</ept> property of the custom role dictates who can view, modify, and delete the role."
    },
    {
      "content": "Who can create a custom role?",
      "pos": [
        13805,
        13834
      ]
    },
    {
      "content": "Custom role creation succeeds only if the user creating the role is allowed to create a custom role for all of the specified <bpt id=\"p1\">**</bpt>AssignableScopes<ept id=\"p1\">**</ept>.",
      "pos": [
        13837,
        13983
      ]
    },
    {
      "content": "Custom role creation succeeds only if the user creating the role can perform <ph id=\"ph1\">`Microsoft.Authorization/roleDefinition/write operation`</ph> on all the <bpt id=\"p1\">**</bpt>AssignableScopes<ept id=\"p1\">**</ept> of the role.",
      "pos": [
        13984,
        14162
      ]
    },
    {
      "content": "So, Owners (and User Access Administrators) of subscriptions, resource groups, and resources can create custom roles for use in those scopes.",
      "pos": [
        14163,
        14304
      ]
    },
    {
      "content": "Who can modify a custom role?",
      "pos": [
        14308,
        14337
      ]
    },
    {
      "content": "Users who are allowed to update custom roles for all <bpt id=\"p1\">**</bpt>AssignableScopes<ept id=\"p1\">**</ept> of a role can modify that custom role.",
      "pos": [
        14340,
        14452
      ]
    },
    {
      "content": "Users that can perform <ph id=\"ph1\">`Microsoft.Authorization/roleDefinition/write`</ph> operation on all the <bpt id=\"p1\">**</bpt>AssignableScopes<ept id=\"p1\">**</ept> of a custom role can modify that custom role.",
      "pos": [
        14453,
        14610
      ]
    },
    {
      "content": "For instance, if a custom role is assignable in two Azure subscriptions (i.e. It has two subscriptions in its <bpt id=\"p1\">**</bpt>AssignableScopes<ept id=\"p1\">**</ept> property) - a user must be Owner (or User Access Administrators) of both subscriptions, to be able to modify the custom role.",
      "pos": [
        14611,
        14867
      ]
    },
    {
      "content": "Who can view custom roles that are available for assignment at a scope?",
      "pos": [
        14871,
        14942
      ]
    },
    {
      "content": "Users who can perform the <ph id=\"ph1\">`Microsoft.Authorization/roleDefinition/read`</ph> operation at a scope can view the RBAC roles that are available for assignment at that scope.",
      "pos": [
        14945,
        15110
      ]
    },
    {
      "content": "All built-in roles in Azure RBAC allow viewing of roles that are available for assignment.",
      "pos": [
        15111,
        15201
      ]
    }
  ],
  "content": "<properties\n    pageTitle=\"Azure Active Directory AD Role-based Access Control | Microsoft Azure\"\n    description=\"This article describes Azure role-based access control.\"\n    services=\"active-directory\"\n    documentationCenter=\"\"\n    authors=\"IHenkel\"\n    manager=\"stevenpo\"\n    editor=\"\"/>\n\n<tags\n    ms.service=\"active-directory\"\n    ms.devlang=\"na\"\n    ms.topic=\"article\"\n    ms.tgt_pltfrm=\"na\"\n    ms.workload=\"identity\"\n    ms.date=\"12/14/2015\"\n    ms.author=\"inhenk\"/>\n\n# Azure Role-based Access Control\n\n## Role-based Access Control\nAzure Role-Based Access Control (RBAC) enables fine-grained access management for Azure. Using RBAC, you can segregate duties within your DevOps team and grant only the amount of access to users that they need to perform their jobs.\n\n### Basics of access management in Azure\nEach Azure subscription is homed to an Azure Active Directory. Only users, groups, and applications from that directory can be granted access to manage resources in the Azure subscription, using Azure portal, Azure Command-Line tools and Azure Management APIs.\n\nAccess is granted by assigning the appropriate RBAC role to users, groups, and applications, at the right scope. To grant access to the entire subscription, assign a role at the subscription scope. To grant access to a specific resource group within a subscription, assign a role at the resource group scope. You may assign roles at specific resources too, like websites, virtual machines and subnets, to grant access only to a resource.\n\n![](./media/role-based-access-control-configure/overview.png)\n\nThe RBAC role that you assign to users, groups, and applications, dictates what resources the user (or application) can manage within that scope.\n\n### Azure RBAC Built-In Roles\nAzure RBAC has three basic roles that apply to all resource types: Owner, Contributor and Reader. Owner has full access to all resources including the right to delegate access to others. Contributor can create and manage all types of Azure resources but can’t grant access to others. Reader can only view existing Azure resources. The rest of the RBAC roles in Azure allow management of specific Azure resources. For instance, the Virtual Machine Contributor role allows creation and management of virtual machines but does not allow management of the virtual network or the subnet that the virtual machine connects to.\n\n[RBAC Built in Roles](role-based-access-built-in-roles.md) lists the built-in RBAC roles available in Azure. For each role it specifies the operations to which a built-in role grants access.\n\n### Azure Resource Hierarchy and Access Inheritance\nEach subscription in Azure belongs to one and only one directory, each resource group belongs to one and only one subscription, and each resource belongs to one and only one resource group. Access that you grant at parent scopes is inherited at child scopes. If you grant reader role to an Azure AD group at the subscription scope, the members of that group will be able to view every resource groups and every resource in the subscription. If you grant the contributor role to an application at the resource group scope, it will be able to manage resources of all types in that resource group but not other resource groups in the subscription.\n\n### Azure RBAC vs. Classic Subscription Administrator and Co-Admins\nClassic subscription administrator and co-admins have full access to the Azure subscription. They can manage resources using both the Azure classic portal (https://manage.windowsazure.com), and Azure Service Manager APIs, as well as the Azure portal (https://portal.azure.com), and new Azure Resource Manager APIs. In the RBAC model, classic administrators are assigned the Owner role at the subscription scope.\n\nThe finer-grained authorization model (Azure RBAC) is supported only by the Azure portal (https://portal.azure.com) and Azure Resource Manager APIs. Users and applications that are assigned RBAC roles (at subscription/resource group/resource scope) cannot use the classic management portal (http://manage.windowsazure.com) and the Azure Service Management APIs.\n\n### Authorization for Management vs Data Operations\nThe finer-grained authorization model (Azure RBAC) is supported only for management operations of the Azure resources in the Azure portal and Azure Resource Manager APIs. Not all data level operations for Azure resources can be authorized via RBAC. For instance, create/read/update/delete of Storage Accounts can be controlled via RBAC, but create/read/update/delete of blobs or tables within the Storage Account cannot yet be controlled via RBAC. Similarly, create/read/update/delete of a SQL DB can be controlled via RBAC but create/read/update/delete of SQL tables within the DB cannot yet be controlled via RBAC.\n\n## Manage access using the Azure portal\n### View Access\nSelect access settings in the essentials section of the resource group blade. The **Users** blade lists all users, groups and applications that have been granted access to the resource group. Access is either assigned on the resource group or inherited from an assignment on the parent subscription.\n\n![](./media/role-based-access-control-configure/view-access.png)\n\n> [AZURE.NOTE] Classic subscription admins and co-admins are in effect owners of the subscription in the new RBAC model.\n\n### Add Access\n1. Click the **Add** icon on the **Users** blade. ![](./media/role-based-access-control-configure/grant-access1.png)\n2. Select the role that you wish to assign.\n3. Search for and select the user, or group, or application that you wish to grant access to.\n4. Search the directory for users, groups, and applications using display names, email addresses, and object identifiers.![](./media/role-based-access-control-configure/grant-access2.png)\n\n### Remove Access\n1. In the **Users** blade, select the role assignment that you wish to remove.\n2. Click the **Remove** icon in the assignment details blade.\n3. Click **yes** to confirm removal.\n\n![](./media/role-based-access-control-configure/remove-access1.png)\n\n\n> [AZURE.NOTE] Inherited assignments can not be removed from child scopes. Navigate to the parent scope and remove such assignments.\n\n\n![](./media/role-based-access-control-configure/remove-access2.png)\n\n## Manage access using Azure PowerShell\nAccess can be managed used Azure RBAC commands in the Azure PowerShell tools.\n\n-   Use `Get-AzureRmRoleDefinition` to list RBAC roles available for assignment and to inspect the operations to which they grant access.\n\n-   Use `Get-AzureRmRoleAssignment` to list RBAC access assignments effective at the specified subscription or resource group or resource. Use the `ExpandPrincipalGroups` parameter to list access assignments to the specified user as well as to the groups of which the user is member. Use the `IncludeClassicAdministrators` parameter to also list classic Subscription Administrator and Co-Administrators.\n\n-   Use `New-AzureRmRoleAssignment` to grant access to users, groups and applications.\n\n-   Use `Remove-AzureRmRoleAssignment` to remove access.\n\nSee [Manage access using Azure PowerShell](role-based-access-control-manage-access-powershell.md) for more detailed examples of managing access using Azure PowerShell.\n\n## Manage access using the Azure Command-Line Interface\nAccess can be managed used Azure RBAC commands in the Azure Command-Line Interface.\n\n-   Use `azure role list` to list RBAC roles available for assignment. Use azure role show to inspect the operations to which they grant access.\n\n-   Use `azure role assignment list` to list RBAC access assignments effective at the specified subscription or resource group or resource. Use the `expandPrincipalGroups` option to list access assignments to the specified user as well as to the groups of which the user is member. Use the  `includeClassicAdministrators` parameter to also list classic Subscription Administrator and Co-Administrators.\n\n-   Use `azure role assignment create` to grant access to users, groups and applications.\n\n-   Use `azure role assignment delete` to remove access.\n\nSee [Manage access using the Azure CLI](role-based-access-control-manage-access-azure-cli.md) for more detailed examples of managing access using the Azure CLI.\n\n## Using the Access Change History Report\nAll access changes happening in your Azure subscriptions get logged in Azure events.\n\n### Create a report with Azure PowerShell\nTo create a report of who granted/revoked what kind of access to/from whom on what scope within your Azure subscirptions use the following PowerShell command:\n\n    `Get-AzureAuthorizationChangeLog`\n\n### Create a report with Azure CLI\nTo create a report of who granted/revoked what kind of access to/from whom on what scope within your Azure subscirptions use the Azure command line interface (CLI) command:\n\n    `azure authorization changelog`\n\n> [AZURE.NOTE] Access changes can be queried for the past 90 days (in 15 day batches).\n\nThe following lists all access changes in the subscription for the past 7 days.\n\n![](./media/role-based-access-control-configure/access-change-history.png)\n\n### Export Access Change to a Spreadsheet\nIt is convenient to export access changes into a spreadsheet for review.\n\n![](./media/role-based-access-control-configure/change-history-spreadsheet.png)\n\n## Custom Roles in Azure RBAC\nCreate a custom role in Azure RBAC if none of the built-in roles meets your specific access need. Custom roles can be created using RBAC command-line tools in Azure PowerShell, and Azure Command-Line Interface. Just like built-in roles, custom roles can be assigned to users, groups, and applications at subscription, resource group, and resource scope.\n\nFollowing is an example custom role definition that allows monitoring and restarting virtual machines:\n\n```\n{\n  \"Name\": \"Virtual Machine Operator\",\n  \"Id\": \"cadb4a5a-4e7a-47be-84db-05cad13b6769\",\n  \"IsCustom\": true,\n  \"Description\": \"Can monitor and restart virtual machines.\",\n  \"Actions\": [\n    \"Microsoft.Storage/*/read\",\n    \"Microsoft.Network/*/read\",\n    \"Microsoft.Compute/*/read\",\n    \"Microsoft.Compute/virtualMachines/start/action\",\n    \"Microsoft.Compute/virtualMachines/restart/action\",\n    \"Microsoft.Authorization/*/read\",\n    \"Microsoft.Resources/subscriptions/resourceGroups/read\",\n    \"Microsoft.Insights/alertRules/*\",\n    \"Microsoft.Insights/diagnosticSettings/*\",\n    \"Microsoft.Support/*\"\n  ],\n  \"NotActions\": [\n\n  ],\n  \"AssignableScopes\": [\n    \"/subscriptions/c276fc76-9cd4-44c9-99a7-4fd71546436e\",\n    \"/subscriptions/e91d47c4-76f3-4271-a796-21b4ecfe3624\",\n    \"/subscriptions/34370e90-ac4a-4bf9-821f-85eeedeae1a2\"\n  ]\n}\n```\n### Actions\nThe actions property of a custom role specifies the Azure operations to which the role grants access. It is a collection of operation strings that identify securable operations of Azure resource providers. Operation strings that contain wildcards (\\*) grant access go all operations that match the operation string. For instance:\n\n-   `*/read` grants access to read operations for all resource types of all Azure resource providers.\n-   `Microsoft.Network/*/read` grants access to read operations for all resource types in the Microsoft.Network resource provider of Azure.\n-   `Microsoft.Compute/virtualMachines/*` grants access to all operations of virtual machines and its child resource types.\n-   `Microsoft.Web/sites/restart/Action` grants access to restart websites.\n\nUse `Get-AzureRmProviderOperation` or `azure provider operations show` commands to list operations of Azure resource providers. You may also use these commands to verify that an operation string is valid, and to expand wildcard operation strings.\n\n![](./media/role-based-access-control-configure/1-get-azurermprovideroperation-1.png)\n\n![](./media/role-based-access-control-configure/1-azure-provider-operations-show.png)\n\n### Not Actions\nIf the set of operations that you wish to allow is easily expressed by excluding specific operations rather than including all operations operations except than the ones you wish to exclude, then use the **NotActions** property of a custom role. The effective access granted by a custom role is computed by excluding the **NotActions** operations from the Actions operations.\n\nNote that if a user is assigned a role that excludes an operation in **NotActions** and is assigned a second role that grants access to the same operation – the user will be allowed to perform that operation. **NotActions** is not a deny rule – it is simply a convenient way to create a set of allowed operations when specific operations need to be excluded.\n\n### AssignableScopes\nThe **AssignableScopes** property of the custom role specifies the scopes (subscriptions, or resource groups, or resources) within which the custom role is available for assignment to users, groups, and applications. Using **AssignableScopes** you can make the custom role available for assignment in only the subscriptions or resource groups that require it, and not clutter user experience for the rest of the subscriptions or resource groups. **AssignableScopes** of a custom role also control who is allowed to view, update, and delete the role. Following are some valid assignable scopes:\n\n-   “/subscriptions/c276fc76-9cd4-44c9-99a7-4fd71546436e”, “/subscriptions/e91d47c4-76f3-4271-a796-21b4ecfe3624”: makes the role available for assignment in two subscriptions.\n-   “/subscriptions/c276fc76-9cd4-44c9-99a7-4fd71546436e”: makes the role available for assignment in a single subscription.\n-   “/subscriptions/c276fc76-9cd4-44c9-99a7-4fd71546436e/resourceGroups/Network”: makes the role available for assignment only in the Network resource group.\n\n### Custom Roles Access Control\nThe **AssignableScopes** property of the custom role dictates who can view, modify, and delete the role.\n\n**Who can create a custom role?**\nCustom role creation succeeds only if the user creating the role is allowed to create a custom role for all of the specified **AssignableScopes**. Custom role creation succeeds only if the user creating the role can perform `Microsoft.Authorization/roleDefinition/write operation` on all the **AssignableScopes** of the role. So, Owners (and User Access Administrators) of subscriptions, resource groups, and resources can create custom roles for use in those scopes.\n\n**Who can modify a custom role?**\nUsers who are allowed to update custom roles for all **AssignableScopes** of a role can modify that custom role. Users that can perform `Microsoft.Authorization/roleDefinition/write` operation on all the **AssignableScopes** of a custom role can modify that custom role. For instance, if a custom role is assignable in two Azure subscriptions (i.e. It has two subscriptions in its **AssignableScopes** property) - a user must be Owner (or User Access Administrators) of both subscriptions, to be able to modify the custom role.\n\n**Who can view custom roles that are available for assignment at a scope?**\nUsers who can perform the `Microsoft.Authorization/roleDefinition/read` operation at a scope can view the RBAC roles that are available for assignment at that scope. All built-in roles in Azure RBAC allow viewing of roles that are available for assignment.\n\n\n"
}