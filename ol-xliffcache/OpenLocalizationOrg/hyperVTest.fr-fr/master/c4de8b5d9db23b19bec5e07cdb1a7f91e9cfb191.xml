<markdown_skeleton_root>
  <block_element>
    <ArrayOfMarkdownBlockBase xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="083db46a-6551-4a9d-957b-1ddfc3340f50"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>3b97604b-6e2b-4e25-859b-61192a660cd4</SegmentId>
            <InternalNormalItem
              internal_item_id="5885cd0f-f1b8-4183-b07a-3ded92189ccd"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="afb69138-f5ae-4173-802f-b047aa1ec79d"
        item_type="Header"
        item_footer="footer_not_set">
        <header_type>Star</header_type>
        <header_level>1</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="3b6fb282-8665-42a7-8df5-f63a778da5d6"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>672630f6-c397-4609-a078-3d6fc8ab27ca</SegmentId>
            <InternalNormalItem
              internal_item_id="f533c0da-6887-4546-9871-307e44b73dce"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="6e2cd656-305c-4c99-b694-362d9e99f1aa"
        item_type="Header"
        item_footer="footer_not_set">
        <header_type>Star</header_type>
        <header_level>3</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownListBlock"
        item_id="bf8cfd0b-6e32-48c8-b2a9-38f78e8b745a"
        item_type="List"
        item_footer="">
        <inner_list_items>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="3eb3b553-4aca-4dcb-88e8-f6a5ae20bc06"
              item_type="NormalParagraph"
              item_footer="footer_not_set">
              <paragraph_segments>
                <MarkdownSegment>
                  <SegmentId>8d324827-2e0b-468e-ad38-35086770ad88</SegmentId>
                  <InternalNormalItem
                    internal_item_id="7e35bd59-9b03-4c89-8aeb-3b1a8e0ab2b2"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                  <MarkdownInternalBoldItem
                    internal_item_id="925db686-385f-4c9a-98bc-3fbbaa18142d"
                    internal_item_type="Bold">
                    <internal_items />
                    <internal_itatic_bold_item_type>Star</internal_itatic_bold_item_type>
                  </MarkdownInternalBoldItem>
                  <InternalNormalItem
                    internal_item_id="14f04521-c1b7-4cf0-a1cd-c0c6ca946c3d"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>1.  </Identifier>
          </ListItem>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="fac60f8b-33ac-4ec5-9e78-044c99edb5a8"
              item_type="NormalParagraph"
              item_footer="footer_not_set">
              <paragraph_segments>
                <MarkdownSegment>
                  <SegmentId>270bcfce-7409-454c-bc7c-c03247042202</SegmentId>
                  <InternalNormalItem
                    internal_item_id="131cc909-cdd6-44f2-80eb-11e5478e069b"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>2.  </Identifier>
          </ListItem>
        </inner_list_items>
        <ListType>Number</ListType>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="277b741d-a2cd-4796-8d8e-c47d097732f8"
        item_type="FencedCodeBlock"
        item_footer="footer_not_set">
        <codeblock_wraper> ```</codeblock_wraper>
        <code_block>get-command –module hyper-v | out-gridview
```
  You get something like this:

  ![](media\command_grid.png)

3. To learn more about a particular PowerShell command use `get-help`. For instance running the following command will return information about the `get-vm` Hyper-V command.

  ```powershell
get-help get-vm
```
 The output shows you how to structure the command, what the required and optional parameters are, and the aliases that you can use.

 ![](media\get_help.png)


### Return a list of virtual machines

Use the `get-vm` command to return a list of virtual machines.

1. In PowerShell, run the following command:

 ```powershell
get-vm
```
 This displays something like this:

 ![](media\get_vm.png)

2. To return a list of only powered on virtual machines add a filter to the `get-vm` command. A filter can be added by using the where-object command. For more information on filtering see the [Using the Where-Object](https://technet.microsoft.com/en-us/library/ee177028.aspx) documentation.   

 ```powershell
 get-vm | where {$_.State –eq ‘Running’}
</code_block>
        <fenced_code_lang>powershell</fenced_code_lang>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownListBlock"
        item_id="609c2c20-30d1-4230-b666-235de7ff34bf"
        item_type="List"
        item_footer="">
        <inner_list_items>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="b4d1f1a7-f54a-412e-98e6-845da152e945"
              item_type="NormalParagraph"
              item_footer="footer_not_set">
              <paragraph_segments>
                <MarkdownSegment>
                  <SegmentId>23bac49b-5109-44f5-9291-14546a308a94</SegmentId>
                  <InternalNormalItem
                    internal_item_id="b496e630-7551-4248-b1e4-da9c47f08968"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
                <MarkdownSegment>
                  <SegmentId>15432f36-4cdc-49b1-bd52-7dc1a9066e70</SegmentId>
                  <InternalNormalItem
                    internal_item_id="1a8765de-fde0-4ede-9f35-b5cf736123f6"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>3.  </Identifier>
          </ListItem>
        </inner_list_items>
        <ListType>Number</ListType>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="5a123d28-8304-4180-894b-9ca050c51da4"
        item_type="FencedCodeBlock"
        item_footer="">
        <codeblock_wraper> ```</codeblock_wraper>
        <code_block> get-vm | where {$_.State –eq ‘Off’}
</code_block>
        <fenced_code_lang>powershell</fenced_code_lang>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="14ab5a23-0b54-42cd-8602-0d9990f1aca1"
        item_type="Header"
        item_footer="footer_not_set">
        <header_type>Star</header_type>
        <header_level>3</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownListBlock"
        item_id="f33284c9-6ad8-4f2e-9580-062438508be9"
        item_type="List"
        item_footer="">
        <inner_list_items>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="78ba58d2-1ec4-40a8-acd8-ad8ef6082382"
              item_type="NormalParagraph"
              item_footer="footer_not_set">
              <paragraph_segments>
                <MarkdownSegment>
                  <SegmentId>770f0546-2cfa-40e5-9ad9-9af9276d6c44</SegmentId>
                  <InternalNormalItem
                    internal_item_id="88068322-af58-43ba-bddf-415bd264142f"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>1. </Identifier>
          </ListItem>
        </inner_list_items>
        <ListType>Number</ListType>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="8b457081-dbf4-47fb-b55d-2095a63fc436"
        item_type="FencedCodeBlock"
        item_footer="">
        <codeblock_wraper> ```</codeblock_wraper>
        <code_block> Start-vm –Name &lt;virtual machine name&gt;
</code_block>
        <fenced_code_lang>powershell</fenced_code_lang>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownListBlock"
        item_id="082c0f84-90d4-4e9e-b5fd-e7e4c9182b5e"
        item_type="List"
        item_footer="">
        <inner_list_items>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="1d423031-6e39-4313-9e9f-f4fba17ebda8"
              item_type="NormalParagraph"
              item_footer="footer_not_set">
              <paragraph_segments>
                <MarkdownSegment>
                  <SegmentId>5914b10e-28e1-44d2-a536-c34dbf1695a2</SegmentId>
                  <InternalNormalItem
                    internal_item_id="5c0ce3a7-188e-4712-bfe9-c9c49e36c4fe"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>2. </Identifier>
          </ListItem>
        </inner_list_items>
        <ListType>Number</ListType>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="12fa41f3-9b61-47b1-914f-637bc15467cd"
        item_type="FencedCodeBlock"
        item_footer="">
        <codeblock_wraper>  ```</codeblock_wraper>
        <code_block> get-vm | where {$_.State –eq ‘Off’} | start-vm
 ```
3. To shut down all running virtual machines, run this:

  ```powershell
 get-vm | where {$_.State –eq ‘Running’} | stop-vm
 ```

### Create a VM checkpoint

To create a checkpoint using PowerShell, select the virtual machine using the `get-vm` command and pipe this to the `checkpoint-vm` command. Finally give the checkpoint a name using `-snapshotname`. The complete command will look like the following:

 ```powershell
 get-vm -Name &lt;VM Name&gt; | checkpoint-vm -snapshotname &lt;name for snapshot&gt;
 ```
For example, here is a checkpoint with the name DEMOCP:

 ![](media\POSH_CP2.png)

### Create a new virtual machine

The following example shows how to create a new virtual machine in the PowerShell Integrated Scripting Environment (ISE). This is a simple example and could be expanded on to include additional PowerShell features and more advanced VM deployments.

1. To open the PowerShell ISE click on start, type **PowerShell ISE**.
2. Run the following code to create a virtual machine. See the [New-VM](https://technet.microsoft.com/en-us/library/hh848537.aspx) documentation for detailed information on the New-VM command.

  ```powershell
 $VMName = "VMNAME"

 $VM = @{
     Name = $VMName 
     MemoryStartupBytes = 2147483648
     Generation = 2
     NewVHDPath = "C:\Virtual Machines\$VMName\$VMName.vhdx"
     NewVHDSizeBytes = 53687091200
     BootDevice = "VHD"
     Path = "C:\Virtual Machines\$VMName "
     SwitchName = (get-vmswitch).Name[0]
 }

 New-VM @VM
</code_block>
        <fenced_code_lang>powershell</fenced_code_lang>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="aad09f92-3fd5-4e56-83fa-1656a84d4f11"
        item_type="Header"
        item_footer="footer_not_set">
        <header_type>Star</header_type>
        <header_level>2</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="00c3aa9d-7e7f-4d23-be72-56646f73bcfe"
        item_type="NormalParagraph"
        item_footer="&#xA;&#xA;&#xA;&#xA;">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>a6e45a27-8f30-4995-9cae-814f59ab9a5c</SegmentId>
            <InternalNormalItem
              internal_item_id="a08292ca-b248-4882-a666-06cbcb2ab942"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment>
            <SegmentId>20e78109-7b2f-4256-a31f-9129f8104482</SegmentId>
            <InternalNormalItem
              internal_item_id="65c744cf-7432-433c-bf2d-af70a2d0c940"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
            <LinkItem
              internal_item_id="8bd36985-902f-48ec-8fac-cd929024dfc7"
              internal_item_type="Link">
              <internal_items />
              <internal_link_type>Inline</internal_link_type>
              <internal_link_text>Hyper-V Cmdlets in Windows PowerShell reference</internal_link_text>
              <internal_link_url>https://technet.microsoft.com/%5Clibrary/Hh848559.aspx</internal_link_url>
              <internal_link_title />
            </LinkItem>
            <InternalNormalItem
              internal_item_id="5be38200-7006-4de4-b513-df586d767afe"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
    </ArrayOfMarkdownBlockBase>
  </block_element>
  <references>
    <ArrayOfMarkdownLinkedReference xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
  </references>
</markdown_skeleton_root>