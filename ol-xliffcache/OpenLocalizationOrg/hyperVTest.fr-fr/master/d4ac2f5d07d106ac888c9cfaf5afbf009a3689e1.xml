{
  "nodes": [
    {
      "pos": [
        27,
        96
      ],
      "content": "Use Script Action to install Solr on Hadoop cluster | Microsoft Azure"
    },
    {
      "pos": [
        115,
        186
      ],
      "content": "Learn how to customize HDInsight cluster with Solr using Script Action."
    },
    {
      "pos": [
        514,
        563
      ],
      "content": "Install and use Solr on HDInsight Hadoop clusters"
    },
    {
      "pos": [
        565,
        849
      ],
      "content": "Learn how to customize Windows based HDInsight cluster with Solr using Script Action, and how to use Solr to search data. For information on using Solr with a Linux-based cluster, see <bpt id=\"p1\">[</bpt>Install and use Solr on HDinsight Hadoop clusters (Linux)<ept id=\"p1\">](hdinsight-hadoop-solr-install-linux.md)</ept>.",
      "nodes": [
        {
          "content": "Learn how to customize Windows based HDInsight cluster with Solr using Script Action, and how to use Solr to search data.",
          "pos": [
            0,
            121
          ]
        },
        {
          "content": "For information on using Solr with a Linux-based cluster, see <bpt id=\"p1\">[</bpt>Install and use Solr on HDinsight Hadoop clusters (Linux)<ept id=\"p1\">](hdinsight-hadoop-solr-install-linux.md)</ept>.",
          "pos": [
            122,
            322
          ]
        }
      ]
    },
    {
      "pos": [
        852,
        1262
      ],
      "content": "You can install Solr on any type of cluster (Hadoop, Storm, HBase, Spark) on Azure HDInsight by using <bpt id=\"p2\">*</bpt>Script Action<ept id=\"p2\">*</ept>. A sample script to install Solr on an HDInsight cluster is available from a read-only Azure storage blob at <bpt id=\"p3\">[</bpt>https://hdiconfigactions.blob.core.windows.net/solrconfigactionv01/solr-installer-v01.ps1<ept id=\"p3\">](https://hdiconfigactions.blob.core.windows.net/solrconfigactionv01/solr-installer-v01.ps1)</ept>.",
      "nodes": [
        {
          "content": "You can install Solr on any type of cluster (Hadoop, Storm, HBase, Spark) on Azure HDInsight by using <bpt id=\"p2\">*</bpt>Script Action<ept id=\"p2\">*</ept>.",
          "pos": [
            0,
            156
          ]
        },
        {
          "content": "A sample script to install Solr on an HDInsight cluster is available from a read-only Azure storage blob at <bpt id=\"p3\">[</bpt>https://hdiconfigactions.blob.core.windows.net/solrconfigactionv01/solr-installer-v01.ps1<ept id=\"p3\">](https://hdiconfigactions.blob.core.windows.net/solrconfigactionv01/solr-installer-v01.ps1)</ept>.",
          "pos": [
            157,
            486
          ]
        }
      ]
    },
    {
      "pos": [
        1265,
        1450
      ],
      "content": "The sample script works only with HDInsight cluster version 3.1. For more information on HDInsight cluster versions, see <bpt id=\"p4\">[</bpt>HDInsight cluster versions<ept id=\"p4\">](hdinsight-component-versioning.md)</ept>.",
      "nodes": [
        {
          "content": "The sample script works only with HDInsight cluster version 3.1.",
          "pos": [
            0,
            64
          ]
        },
        {
          "content": "For more information on HDInsight cluster versions, see <bpt id=\"p4\">[</bpt>HDInsight cluster versions<ept id=\"p4\">](hdinsight-component-versioning.md)</ept>.",
          "pos": [
            65,
            223
          ]
        }
      ]
    },
    {
      "pos": [
        1452,
        1717
      ],
      "content": "The sample script used in this topic creates a Windows-based Solr cluster with a specific configuration. If you want to configure the Solr cluster with different collections, shards, schemas, replicas, etc., you must modify the script and Solr binaries accordingly.",
      "nodes": [
        {
          "content": "The sample script used in this topic creates a Windows-based Solr cluster with a specific configuration.",
          "pos": [
            0,
            104
          ]
        },
        {
          "content": "If you want to configure the Solr cluster with different collections, shards, schemas, replicas, etc., you must modify the script and Solr binaries accordingly.",
          "pos": [
            105,
            265
          ]
        }
      ]
    },
    {
      "pos": [
        1719,
        1739
      ],
      "content": "<bpt id=\"p5\">**</bpt>Related articles<ept id=\"p5\">**</ept>"
    },
    {
      "pos": [
        1743,
        1842
      ],
      "content": "<bpt id=\"p6\">[</bpt>Install and use Solr on HDinsight Hadoop clusters (Linux)<ept id=\"p6\">](hdinsight-hadoop-solr-install-linux.md)</ept>"
    },
    {
      "pos": [
        1845,
        1968
      ],
      "content": "<bpt id=\"p7\">[</bpt>Create Hadoop clusters in HDInsight<ept id=\"p7\">](hdinsight-provision-clusters.md)</ept>: general information on creating HDInsight clusters."
    },
    {
      "pos": [
        1971,
        2125
      ],
      "content": "<bpt id=\"p8\">[</bpt>Customize HDInsight cluster using Script Action<ept id=\"p8\">][hdinsight-cluster-customize]</ept>: general information on customizing HDInsight clusters using Script Action."
    },
    {
      "pos": [
        2128,
        2210
      ],
      "content": "<bpt id=\"p9\">[</bpt>Develop Script Action scripts for HDInsight<ept id=\"p9\">](hdinsight-hadoop-script-actions.md)</ept>."
    },
    {
      "pos": [
        2216,
        2229
      ],
      "content": "What is Solr?"
    },
    {
      "pos": [
        2301,
        2312
      ],
      "content": "Apache Solr"
    },
    {
      "pos": [
        2317,
        2536
      ],
      "content": "is an enterprise search platform that enables powerful full-text search on data. While Hadoop enables storing and managing vast amounts of data, Apache Solr provides the search capabilities to quickly retrieve the data.",
      "nodes": [
        {
          "content": "is an enterprise search platform that enables powerful full-text search on data.",
          "pos": [
            0,
            80
          ]
        },
        {
          "content": "While Hadoop enables storing and managing vast amounts of data, Apache Solr provides the search capabilities to quickly retrieve the data.",
          "pos": [
            81,
            219
          ]
        }
      ]
    },
    {
      "pos": [
        2542,
        2567
      ],
      "content": "Install Solr using portal"
    },
    {
      "pos": [
        2671,
        2744
      ],
      "content": "<bpt id=\"p10\">[</bpt>Install Solr on HDInsight clusters<ept id=\"p10\">](hdinsight-hadoop-solr-install-v1.md)</ept>"
    },
    {
      "pos": [
        2749,
        2907
      ],
      "content": "Start creating a cluster by using the <bpt id=\"p11\">**</bpt>CUSTOM CREATE<ept id=\"p11\">**</ept><ph id=\"ph3\"/> option, as described at <bpt id=\"p12\">[</bpt>Create Hadoop clusters in HDInsight<ept id=\"p12\">](hdinsight-provision-clusters.md#portal)</ept>."
    },
    {
      "pos": [
        2911,
        3044
      ],
      "content": "On the <bpt id=\"p13\">**</bpt>Script Actions<ept id=\"p13\">**</ept><ph id=\"ph4\"/> page of the wizard, click <bpt id=\"p14\">**</bpt>add script action<ept id=\"p14\">**</ept><ph id=\"ph5\"/> to provide details about the script action, as shown below:"
    },
    {
      "pos": [
        3050,
        3202
      ],
      "content": "<ph id=\"ph6\">![</ph>Use Script Action to customize a cluster<ph id=\"ph7\">](./media/hdinsight-hadoop-solr-install/hdi-script-action-solr.png \"Use Script Action to customize a cluster\")</ph>"
    },
    {
      "pos": [
        3208,
        4073
      ],
      "leadings": [
        "",
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "   "
      ],
      "content": "<ph id=\"ph8\">&lt;table border='1'&gt;</ph><ph id=\"ph9\">\n     &lt;tr&gt;</ph><ph id=\"ph10\">&lt;th&gt;</ph>Property<ph id=\"ph11\">&lt;/th&gt;</ph><ph id=\"ph12\">&lt;th&gt;</ph>Value<ph id=\"ph13\">&lt;/th&gt;</ph><ph id=\"ph14\">&lt;/tr&gt;</ph><ph id=\"ph15\">\n     &lt;tr&gt;</ph><ph id=\"ph16\">&lt;td&gt;</ph>Name<ph id=\"ph17\">&lt;/td&gt;</ph><ph id=\"ph18\">\n         &lt;td&gt;</ph>Specify a name for the script action. For example, <ph id=\"ph19\">&lt;b&gt;</ph>Install Solr<ph id=\"ph20\">&lt;/b&gt;</ph>.<ph id=\"ph21\">&lt;/td&gt;</ph><ph id=\"ph22\">&lt;/tr&gt;</ph><ph id=\"ph23\">\n     &lt;tr&gt;</ph><ph id=\"ph24\">&lt;td&gt;</ph>Script URI<ph id=\"ph25\">&lt;/td&gt;</ph><ph id=\"ph26\">\n         &lt;td&gt;</ph>Specify the Uniform Resource Identifier (URI) to the script that is invoked to customize the cluster. For example, <ph id=\"ph27\">&lt;i&gt;</ph>https://hdiconfigactions.blob.core.windows.net/solrconfigactionv01/solr-installer-v01.ps1<ph id=\"ph28\">&lt;/i&gt;</ph><ph id=\"ph29\">&lt;/td&gt;</ph><ph id=\"ph30\">&lt;/tr&gt;</ph><ph id=\"ph31\">\n     &lt;tr&gt;</ph><ph id=\"ph32\">&lt;td&gt;</ph>Node Type<ph id=\"ph33\">&lt;/td&gt;</ph><ph id=\"ph34\">\n         &lt;td&gt;</ph>Specify the nodes on which the customization script is run. You can choose <ph id=\"ph35\">&lt;b&gt;</ph>All nodes<ph id=\"ph36\">&lt;/b&gt;</ph>, <ph id=\"ph37\">&lt;b&gt;</ph>Head nodes only<ph id=\"ph38\">&lt;/b&gt;</ph>, or <ph id=\"ph39\">&lt;b&gt;</ph>Worker nodes only<ph id=\"ph40\">&lt;/b&gt;</ph>.\n     <ph id=\"ph41\">&lt;tr&gt;</ph><ph id=\"ph42\">&lt;td&gt;</ph>Parameters<ph id=\"ph43\">&lt;/td&gt;</ph><ph id=\"ph44\">\n         &lt;td&gt;</ph>Specify the parameters, if required by the script. The script to install Solr does not require any parameters, so you can leave this blank.<ph id=\"ph45\">&lt;/td&gt;</ph><ph id=\"ph46\">&lt;/tr&gt;</ph><ph id=\"ph47\">\n &lt;/table&gt;</ph>",
      "nodes": [
        {
          "content": "<ph id=\"ph8\">&lt;table border='1'&gt;</ph><ph id=\"ph9\">\n     &lt;tr&gt;</ph><ph id=\"ph10\">&lt;th&gt;</ph>Property<ph id=\"ph11\">&lt;/th&gt;</ph><ph id=\"ph12\">&lt;th&gt;</ph>Value<ph id=\"ph13\">&lt;/th&gt;</ph><ph id=\"ph14\">&lt;/tr&gt;</ph><ph id=\"ph15\">\n     &lt;tr&gt;</ph><ph id=\"ph16\">&lt;td&gt;</ph>Name<ph id=\"ph17\">&lt;/td&gt;</ph><ph id=\"ph18\">\n         &lt;td&gt;</ph>Specify a name for the script action.",
          "pos": [
            0,
            411
          ]
        },
        {
          "content": "For example, <ph id=\"ph19\">&lt;b&gt;</ph>Install Solr<ph id=\"ph20\">&lt;/b&gt;</ph>.<ph id=\"ph21\">&lt;/td&gt;</ph><ph id=\"ph22\">&lt;/tr&gt;</ph><ph id=\"ph23\">\n     &lt;tr&gt;</ph><ph id=\"ph24\">&lt;td&gt;</ph>Script URI<ph id=\"ph25\">&lt;/td&gt;</ph><ph id=\"ph26\">\n         &lt;td&gt;</ph>Specify the Uniform Resource Identifier (URI) to the script that is invoked to customize the cluster.",
          "pos": [
            412,
            799
          ]
        },
        {
          "content": "For example, <ph id=\"ph27\">&lt;i&gt;</ph>https://hdiconfigactions.blob.core.windows.net/solrconfigactionv01/solr-installer-v01.ps1<ph id=\"ph28\">&lt;/i&gt;</ph><ph id=\"ph29\">&lt;/td&gt;</ph><ph id=\"ph30\">&lt;/tr&gt;</ph><ph id=\"ph31\">\n     &lt;tr&gt;</ph><ph id=\"ph32\">&lt;td&gt;</ph>Node Type<ph id=\"ph33\">&lt;/td&gt;</ph><ph id=\"ph34\">\n         &lt;td&gt;</ph>Specify the nodes on which the customization script is run.",
          "pos": [
            800,
            1220
          ]
        },
        {
          "content": "You can choose <ph id=\"ph35\">&lt;b&gt;</ph>All nodes<ph id=\"ph36\">&lt;/b&gt;</ph>, <ph id=\"ph37\">&lt;b&gt;</ph>Head nodes only<ph id=\"ph38\">&lt;/b&gt;</ph>, or <ph id=\"ph39\">&lt;b&gt;</ph>Worker nodes only<ph id=\"ph40\">&lt;/b&gt;</ph>.",
          "pos": [
            1221,
            1456
          ]
        },
        {
          "content": "<ph id=\"ph41\">&lt;tr&gt;</ph><ph id=\"ph42\">&lt;td&gt;</ph>Parameters<ph id=\"ph43\">&lt;/td&gt;</ph><ph id=\"ph44\">\n         &lt;td&gt;</ph>Specify the parameters, if required by the script.",
          "pos": [
            1462,
            1649
          ]
        },
        {
          "content": "The script to install Solr does not require any parameters, so you can leave this blank.<ph id=\"ph45\">&lt;/td&gt;</ph><ph id=\"ph46\">&lt;/tr&gt;</ph><ph id=\"ph47\">\n &lt;/table&gt;</ph>",
          "pos": [
            1650,
            1833
          ]
        }
      ]
    },
    {
      "pos": [
        4079,
        4250
      ],
      "content": "You can add more than one script action to install multiple components on the cluster. After you have added the scripts, click the checkmark to start creating the cluster.",
      "nodes": [
        {
          "content": "You can add more than one script action to install multiple components on the cluster.",
          "pos": [
            0,
            86
          ]
        },
        {
          "content": "After you have added the scripts, click the checkmark to start creating the cluster.",
          "pos": [
            87,
            171
          ]
        }
      ]
    },
    {
      "pos": [
        4256,
        4264
      ],
      "content": "Use Solr"
    },
    {
      "pos": [
        4266,
        4451
      ],
      "content": "You must start with indexing Solr with some data files. You can then use Solr to run search queries on the indexed data. Perform the following steps to use Solr in an HDInsight cluster:",
      "nodes": [
        {
          "content": "You must start with indexing Solr with some data files.",
          "pos": [
            0,
            55
          ]
        },
        {
          "content": "You can then use Solr to run search queries on the indexed data.",
          "pos": [
            56,
            120
          ]
        },
        {
          "content": "Perform the following steps to use Solr in an HDInsight cluster:",
          "pos": [
            121,
            185
          ]
        }
      ]
    },
    {
      "pos": [
        4456,
        4821
      ],
      "content": "<bpt id=\"p15\">**</bpt>Use Remote Desktop Protocol (RDP) to remote into the HDInsight cluster with Solr installed<ept id=\"p15\">**</ept>. From the Azure portal, enable Remote Desktop for the cluster you created with Solr installed, and then remote into the cluster. For instructions, see <bpt id=\"p16\">[</bpt>Connect to HDInsight clusters using RDP<ept id=\"p16\">](hdinsight-administer-use-management-portal.md#connect-to-clusters-using-rdp)</ept>.",
      "nodes": [
        {
          "content": "<bpt id=\"p15\">**</bpt>Use Remote Desktop Protocol (RDP) to remote into the HDInsight cluster with Solr installed<ept id=\"p15\">**</ept>.",
          "pos": [
            0,
            135
          ]
        },
        {
          "content": "From the Azure portal, enable Remote Desktop for the cluster you created with Solr installed, and then remote into the cluster.",
          "pos": [
            136,
            263
          ]
        },
        {
          "content": "For instructions, see <bpt id=\"p16\">[</bpt>Connect to HDInsight clusters using RDP<ept id=\"p16\">](hdinsight-administer-use-management-portal.md#connect-to-clusters-using-rdp)</ept>.",
          "pos": [
            264,
            445
          ]
        }
      ]
    },
    {
      "pos": [
        4826,
        5140
      ],
      "content": "<bpt id=\"p17\">**</bpt>Index Solr by uploading data files<ept id=\"p17\">**</ept>. When you index Solr, you put documents in it that you may need to search on. To index Solr, use RDP to remote into the cluster, navigate to the desktop, open the Hadoop command line, and navigate to <bpt id=\"p18\">**</bpt>C:\\apps\\dist\\solr-4.7.2\\example\\exampledocs<ept id=\"p18\">**</ept>. Run the following command:",
      "nodes": [
        {
          "content": "<bpt id=\"p17\">**</bpt>Index Solr by uploading data files<ept id=\"p17\">**</ept>.",
          "pos": [
            0,
            79
          ]
        },
        {
          "content": "When you index Solr, you put documents in it that you may need to search on.",
          "pos": [
            80,
            156
          ]
        },
        {
          "content": "To index Solr, use RDP to remote into the cluster, navigate to the desktop, open the Hadoop command line, and navigate to <bpt id=\"p18\">**</bpt>C:\\apps\\dist\\solr-4.7.2\\example\\exampledocs<ept id=\"p18\">**</ept>.",
          "pos": [
            157,
            367
          ]
        },
        {
          "content": "Run the following command:",
          "pos": [
            368,
            394
          ]
        }
      ]
    },
    {
      "pos": [
        5195,
        5242
      ],
      "content": "You'll see the following output on the console:"
    },
    {
      "pos": [
        5446,
        5624
      ],
      "content": "The post.jar utility indexes Solr with two sample documents, <bpt id=\"p19\">**</bpt>solr.xml<ept id=\"p19\">**</ept><ph id=\"ph48\"/> and <bpt id=\"p20\">**</bpt>monitor.xml<ept id=\"p20\">**</ept>. The post.jar utility and the sample documents are available with Solr installation.",
      "nodes": [
        {
          "content": "The post.jar utility indexes Solr with two sample documents, <bpt id=\"p19\">**</bpt>solr.xml<ept id=\"p19\">**</ept><ph id=\"ph48\"/> and <bpt id=\"p20\">**</bpt>monitor.xml<ept id=\"p20\">**</ept>.",
          "pos": [
            0,
            189
          ]
        },
        {
          "content": "The post.jar utility and the sample documents are available with Solr installation.",
          "pos": [
            190,
            273
          ]
        }
      ]
    },
    {
      "pos": [
        5629,
        6039
      ],
      "content": "<bpt id=\"p21\">**</bpt>Use the Solr dashboard to search within the indexed documents<ept id=\"p21\">**</ept>. In the RDP session to the HDInsight cluster, open Internet Explorer, and launch the Solr dashboard at <bpt id=\"p22\">**</bpt>http://headnodehost:8983/solr/#/<ept id=\"p22\">**</ept>. From the left pane, from the <bpt id=\"p23\">**</bpt>Core Selector<ept id=\"p23\">**</ept><ph id=\"ph49\"/> drop-down, select <bpt id=\"p24\">**</bpt>collection1<ept id=\"p24\">**</ept>, and within that, click <bpt id=\"p25\">**</bpt>Query<ept id=\"p25\">**</ept>. As an example, to select and return all the docs in Solr, provide the following values:",
      "nodes": [
        {
          "content": "<bpt id=\"p21\">**</bpt>Use the Solr dashboard to search within the indexed documents<ept id=\"p21\">**</ept>.",
          "pos": [
            0,
            106
          ]
        },
        {
          "content": "In the RDP session to the HDInsight cluster, open Internet Explorer, and launch the Solr dashboard at <bpt id=\"p22\">**</bpt>http://headnodehost:8983/solr/#/<ept id=\"p22\">**</ept>.",
          "pos": [
            107,
            286
          ]
        },
        {
          "content": "From the left pane, from the <bpt id=\"p23\">**</bpt>Core Selector<ept id=\"p23\">**</ept><ph id=\"ph49\"/> drop-down, select <bpt id=\"p24\">**</bpt>collection1<ept id=\"p24\">**</ept>, and within that, click <bpt id=\"p25\">**</bpt>Query<ept id=\"p25\">**</ept>.",
          "pos": [
            287,
            537
          ]
        },
        {
          "content": "As an example, to select and return all the docs in Solr, provide the following values:",
          "pos": [
            538,
            625
          ]
        }
      ]
    },
    {
      "pos": [
        6047,
        6245
      ],
      "content": "In the <bpt id=\"p26\">**</bpt>q<ept id=\"p26\">**</ept><ph id=\"ph50\"/> text box, enter <bpt id=\"p27\">**</bpt>\\*:<ept id=\"p27\">**</ept>\\*. This will return all the documents that are indexed in Solr. If you want to search for a specific string within the documents, you can enter that string here.",
      "nodes": [
        {
          "content": "In the <bpt id=\"p26\">**</bpt>q<ept id=\"p26\">**</ept><ph id=\"ph50\"/> text box, enter <bpt id=\"p27\">**</bpt>\\*:<ept id=\"p27\">**</ept>\\*.",
          "pos": [
            0,
            134
          ]
        },
        {
          "content": "This will return all the documents that are indexed in Solr.",
          "pos": [
            135,
            195
          ]
        },
        {
          "content": "If you want to search for a specific string within the documents, you can enter that string here.",
          "pos": [
            196,
            293
          ]
        }
      ]
    },
    {
      "pos": [
        6257,
        6352
      ],
      "content": "In the <bpt id=\"p28\">**</bpt>wt<ept id=\"p28\">**</ept><ph id=\"ph51\"/> text box, select the output format. Default is <bpt id=\"p29\">**</bpt>json<ept id=\"p29\">**</ept>. Click <bpt id=\"p30\">**</bpt>Execute Query<ept id=\"p30\">**</ept>.",
      "nodes": [
        {
          "content": "In the <bpt id=\"p28\">**</bpt>wt<ept id=\"p28\">**</ept><ph id=\"ph51\"/> text box, select the output format.",
          "pos": [
            0,
            104
          ]
        },
        {
          "content": "Default is <bpt id=\"p29\">**</bpt>json<ept id=\"p29\">**</ept>.",
          "pos": [
            105,
            165
          ]
        },
        {
          "content": "Click <bpt id=\"p30\">**</bpt>Execute Query<ept id=\"p30\">**</ept>.",
          "pos": [
            166,
            230
          ]
        }
      ]
    },
    {
      "pos": [
        6358,
        6501
      ],
      "content": "<ph id=\"ph52\">![</ph>Use Script Action to customize a cluster<ph id=\"ph53\">](./media/hdinsight-hadoop-solr-install/hdi-solr-dashboard-query.png \"Run a query on Solr dashboard\")</ph>"
    },
    {
      "pos": [
        6511,
        6610
      ],
      "content": "The output returns the two docs that we used for indexing Solr. The output resembles the following:",
      "nodes": [
        {
          "content": "The output returns the two docs that we used for indexing Solr.",
          "pos": [
            0,
            63
          ]
        },
        {
          "content": "The output resembles the following:",
          "pos": [
            64,
            99
          ]
        }
      ]
    },
    {
      "pos": [
        8795,
        9054
      ],
      "content": "<bpt id=\"p31\">**</bpt>Recommended: Back up the indexed data from Solr to Azure Blob storage associated with the HDInsight cluster<ept id=\"p31\">**</ept>. As a good practice, you should back up the indexed data from the Solr cluster nodes onto Azure Blob storage. Perform the following steps to do so:",
      "nodes": [
        {
          "content": "<bpt id=\"p31\">**</bpt>Recommended: Back up the indexed data from Solr to Azure Blob storage associated with the HDInsight cluster<ept id=\"p31\">**</ept>.",
          "pos": [
            0,
            152
          ]
        },
        {
          "content": "As a good practice, you should back up the indexed data from the Solr cluster nodes onto Azure Blob storage.",
          "pos": [
            153,
            261
          ]
        },
        {
          "content": "Perform the following steps to do so:",
          "pos": [
            262,
            299
          ]
        }
      ]
    },
    {
      "pos": [
        9063,
        9140
      ],
      "content": "From the RDP session, open Internet Explorer, and point to the following URL:"
    },
    {
      "pos": [
        9217,
        9253
      ],
      "content": "You should see a response like this:"
    },
    {
      "pos": [
        9551,
        9845
      ],
      "content": "In the remote session, navigate to {SOLR_HOME}\\{Collection}\\data. For the cluster created via the sample script, this should be <bpt id=\"p32\">**</bpt>C:\\apps\\dist\\solr-4.7.2\\example\\solr\\collection1\\data<ept id=\"p32\">**</ept>. At this location, you should see a snapshot folder created with a name similar to <bpt id=\"p33\">*</bpt><bpt id=\"p34\">*</bpt>snapshot.<ept id=\"p34\">*</ept>timestamp<ept id=\"p33\">*</ept>**.",
      "nodes": [
        {
          "content": "In the remote session, navigate to {SOLR_HOME}\\{Collection}\\data.",
          "pos": [
            0,
            65
          ]
        },
        {
          "content": "For the cluster created via the sample script, this should be <bpt id=\"p32\">**</bpt>C:\\apps\\dist\\solr-4.7.2\\example\\solr\\collection1\\data<ept id=\"p32\">**</ept>.",
          "pos": [
            66,
            226
          ]
        },
        {
          "content": "At this location, you should see a snapshot folder created with a name similar to <bpt id=\"p33\">*</bpt><bpt id=\"p34\">*</bpt>snapshot.<ept id=\"p34\">*</ept>timestamp<ept id=\"p33\">*</ept>**.",
          "pos": [
            227,
            414
          ]
        }
      ]
    },
    {
      "pos": [
        9854,
        10024
      ],
      "content": "Zip the snapshot folder and upload it to Azure Blob storage. From the Hadoop command line, navigate to the location of the snapshot folder by using the following command:",
      "nodes": [
        {
          "content": "Zip the snapshot folder and upload it to Azure Blob storage.",
          "pos": [
            0,
            60
          ]
        },
        {
          "content": "From the Hadoop command line, navigate to the location of the snapshot folder by using the following command:",
          "pos": [
            61,
            170
          ]
        }
      ]
    },
    {
      "pos": [
        10113,
        10247
      ],
      "content": "This command copies the snapshot to /example/data/ under the container within the default Storage account associated with the cluster."
    },
    {
      "pos": [
        10252,
        10286
      ],
      "content": "Install Solr using Aure PowerShell"
    },
    {
      "pos": [
        10288,
        10706
      ],
      "content": "See <bpt id=\"p35\">[</bpt>Customize HDInsight clusters using Script Action<ept id=\"p35\">](hdinsight-hadoop-customize-cluster.md#call_scripts_using_powershell)</ept>.  The sample demonstrates how to install Spark using Azure PowerShell. You need to customize the script to use <bpt id=\"p36\">[</bpt>https://hdiconfigactions.blob.core.windows.net/solrconfigactionv01/solr-installer-v01.ps1<ept id=\"p36\">](https://hdiconfigactions.blob.core.windows.net/solrconfigactionv01/solr-installer-v01.ps1)</ept>.",
      "nodes": [
        {
          "content": "See <bpt id=\"p35\">[</bpt>Customize HDInsight clusters using Script Action<ept id=\"p35\">](hdinsight-hadoop-customize-cluster.md#call_scripts_using_powershell)</ept>.",
          "pos": [
            0,
            164
          ]
        },
        {
          "content": "The sample demonstrates how to install Spark using Azure PowerShell.",
          "pos": [
            166,
            234
          ]
        },
        {
          "content": "You need to customize the script to use <bpt id=\"p36\">[</bpt>https://hdiconfigactions.blob.core.windows.net/solrconfigactionv01/solr-installer-v01.ps1<ept id=\"p36\">](https://hdiconfigactions.blob.core.windows.net/solrconfigactionv01/solr-installer-v01.ps1)</ept>.",
          "pos": [
            235,
            498
          ]
        }
      ]
    },
    {
      "pos": [
        10711,
        10738
      ],
      "content": "Install Sole using .NET SDK"
    },
    {
      "pos": [
        10740,
        11159
      ],
      "content": "See <bpt id=\"p37\">[</bpt>Customize HDInsight clusters using Script Action<ept id=\"p37\">](hdinsight-hadoop-customize-cluster.md#call_scripts_using_azure_powershell)</ept>. The sample demonstrates how to install Spark using the .NET SDK. You need to customize the script to use <bpt id=\"p38\">[</bpt>https://hdiconfigactions.blob.core.windows.net/solrconfigactionv01/solr-installer-v01.ps1<ept id=\"p38\">](https://hdiconfigactions.blob.core.windows.net/solrconfigactionv01/solr-installer-v01.ps1)</ept>.",
      "nodes": [
        {
          "content": "See <bpt id=\"p37\">[</bpt>Customize HDInsight clusters using Script Action<ept id=\"p37\">](hdinsight-hadoop-customize-cluster.md#call_scripts_using_azure_powershell)</ept>.",
          "pos": [
            0,
            170
          ]
        },
        {
          "content": "The sample demonstrates how to install Spark using the .NET SDK.",
          "pos": [
            171,
            235
          ]
        },
        {
          "content": "You need to customize the script to use <bpt id=\"p38\">[</bpt>https://hdiconfigactions.blob.core.windows.net/solrconfigactionv01/solr-installer-v01.ps1<ept id=\"p38\">](https://hdiconfigactions.blob.core.windows.net/solrconfigactionv01/solr-installer-v01.ps1)</ept>.",
          "pos": [
            236,
            499
          ]
        }
      ]
    },
    {
      "pos": [
        11166,
        11174
      ],
      "content": "See also"
    },
    {
      "pos": [
        11178,
        11277
      ],
      "content": "<bpt id=\"p39\">[</bpt>Install and use Solr on HDinsight Hadoop clusters (Linux)<ept id=\"p39\">](hdinsight-hadoop-solr-install-linux.md)</ept>"
    },
    {
      "pos": [
        11280,
        11403
      ],
      "content": "<bpt id=\"p40\">[</bpt>Create Hadoop clusters in HDInsight<ept id=\"p40\">](hdinsight-provision-clusters.md)</ept>: general information on creating HDInsight clusters."
    },
    {
      "pos": [
        11406,
        11560
      ],
      "content": "<bpt id=\"p41\">[</bpt>Customize HDInsight cluster using Script Action<ept id=\"p41\">][hdinsight-cluster-customize]</ept>: general information on customizing HDInsight clusters using Script Action."
    },
    {
      "pos": [
        11563,
        11645
      ],
      "content": "<bpt id=\"p42\">[</bpt>Develop Script Action scripts for HDInsight<ept id=\"p42\">](hdinsight-hadoop-script-actions.md)</ept>."
    },
    {
      "pos": [
        11648,
        11764
      ],
      "content": "<bpt id=\"p43\">[</bpt>Install and use Spark on HDInsight clusters<ept id=\"p43\">][hdinsight-install-spark]</ept>: Script Action sample about installing Spark."
    },
    {
      "pos": [
        11767,
        11863
      ],
      "content": "<bpt id=\"p44\">[</bpt>Install R on HDInsight clusters<ept id=\"p44\">][hdinsight-install-r]</ept>: Script Action sample about installing R."
    },
    {
      "pos": [
        11866,
        11987
      ],
      "content": "<bpt id=\"p45\">[</bpt>Install Giraph on HDInsight clusters<ept id=\"p45\">](hdinsight-hadoop-giraph-install.md)</ept>: Script Action sample about installing Giraph."
    }
  ],
  "content": "<properties\n    pageTitle=\"Use Script Action to install Solr on Hadoop cluster | Microsoft Azure\"\n    description=\"Learn how to customize HDInsight cluster with Solr using Script Action.\"\n    services=\"hdinsight\"\n    documentationCenter=\"\"\n    authors=\"nitinme\"\n    manager=\"paulettm\"\n    editor=\"cgronlun\"\n    tags=\"azure-portal\"/>\n\n<tags\n    ms.service=\"hdinsight\"\n    ms.workload=\"big-data\"\n    ms.tgt_pltfrm=\"na\"\n    ms.devlang=\"na\"\n    ms.topic=\"article\"\n    ms.date=\"02/05/2016\"\n    ms.author=\"nitinme\"/>\n\n# Install and use Solr on HDInsight Hadoop clusters\n\nLearn how to customize Windows based HDInsight cluster with Solr using Script Action, and how to use Solr to search data. For information on using Solr with a Linux-based cluster, see [Install and use Solr on HDinsight Hadoop clusters (Linux)](hdinsight-hadoop-solr-install-linux.md).\n \nYou can install Solr on any type of cluster (Hadoop, Storm, HBase, Spark) on Azure HDInsight by using *Script Action*. A sample script to install Solr on an HDInsight cluster is available from a read-only Azure storage blob at [https://hdiconfigactions.blob.core.windows.net/solrconfigactionv01/solr-installer-v01.ps1](https://hdiconfigactions.blob.core.windows.net/solrconfigactionv01/solr-installer-v01.ps1). \n\nThe sample script works only with HDInsight cluster version 3.1. For more information on HDInsight cluster versions, see [HDInsight cluster versions](hdinsight-component-versioning.md).\n\nThe sample script used in this topic creates a Windows-based Solr cluster with a specific configuration. If you want to configure the Solr cluster with different collections, shards, schemas, replicas, etc., you must modify the script and Solr binaries accordingly.\n\n**Related articles**\n\n- [Install and use Solr on HDinsight Hadoop clusters (Linux)](hdinsight-hadoop-solr-install-linux.md)\n- [Create Hadoop clusters in HDInsight](hdinsight-provision-clusters.md): general information on creating HDInsight clusters.\n- [Customize HDInsight cluster using Script Action][hdinsight-cluster-customize]: general information on customizing HDInsight clusters using Script Action.\n- [Develop Script Action scripts for HDInsight](hdinsight-hadoop-script-actions.md).\n\n\n## What is Solr?\n\n<a href=\"http://lucene.apache.org/solr/features.html\" target=\"_blank\">Apache Solr</a> is an enterprise search platform that enables powerful full-text search on data. While Hadoop enables storing and managing vast amounts of data, Apache Solr provides the search capabilities to quickly retrieve the data. \n\n## Install Solr using portal\n\n[AZURE.INCLUDE [hdinsight-azure-preview-portal](../../includes/hdinsight-azure-preview-portal.md)]\n\n* [Install Solr on HDInsight clusters](hdinsight-hadoop-solr-install-v1.md)\n\n1. Start creating a cluster by using the **CUSTOM CREATE** option, as described at [Create Hadoop clusters in HDInsight](hdinsight-provision-clusters.md#portal).\n2. On the **Script Actions** page of the wizard, click **add script action** to provide details about the script action, as shown below:\n\n    ![Use Script Action to customize a cluster](./media/hdinsight-hadoop-solr-install/hdi-script-action-solr.png \"Use Script Action to customize a cluster\")\n\n    <table border='1'>\n        <tr><th>Property</th><th>Value</th></tr>\n        <tr><td>Name</td>\n            <td>Specify a name for the script action. For example, <b>Install Solr</b>.</td></tr>\n        <tr><td>Script URI</td>\n            <td>Specify the Uniform Resource Identifier (URI) to the script that is invoked to customize the cluster. For example, <i>https://hdiconfigactions.blob.core.windows.net/solrconfigactionv01/solr-installer-v01.ps1</i></td></tr>\n        <tr><td>Node Type</td>\n            <td>Specify the nodes on which the customization script is run. You can choose <b>All nodes</b>, <b>Head nodes only</b>, or <b>Worker nodes only</b>.\n        <tr><td>Parameters</td>\n            <td>Specify the parameters, if required by the script. The script to install Solr does not require any parameters, so you can leave this blank.</td></tr>\n    </table>\n\n    You can add more than one script action to install multiple components on the cluster. After you have added the scripts, click the checkmark to start creating the cluster.\n\n\n## Use Solr\n\nYou must start with indexing Solr with some data files. You can then use Solr to run search queries on the indexed data. Perform the following steps to use Solr in an HDInsight cluster:\n\n1. **Use Remote Desktop Protocol (RDP) to remote into the HDInsight cluster with Solr installed**. From the Azure portal, enable Remote Desktop for the cluster you created with Solr installed, and then remote into the cluster. For instructions, see [Connect to HDInsight clusters using RDP](hdinsight-administer-use-management-portal.md#connect-to-clusters-using-rdp).\n\n2. **Index Solr by uploading data files**. When you index Solr, you put documents in it that you may need to search on. To index Solr, use RDP to remote into the cluster, navigate to the desktop, open the Hadoop command line, and navigate to **C:\\apps\\dist\\solr-4.7.2\\example\\exampledocs**. Run the following command:\n\n        java -jar post.jar solr.xml monitor.xml\n\n    You'll see the following output on the console:\n\n        POSTing file solr.xml\n        POSTing file monitor.xml\n        2 files indexed.\n        COMMITting Solr index changes to http://localhost:8983/solr/update..\n        Time spent: 0:00:01.624\n\n    The post.jar utility indexes Solr with two sample documents, **solr.xml** and **monitor.xml**. The post.jar utility and the sample documents are available with Solr installation.\n\n3. **Use the Solr dashboard to search within the indexed documents**. In the RDP session to the HDInsight cluster, open Internet Explorer, and launch the Solr dashboard at **http://headnodehost:8983/solr/#/**. From the left pane, from the **Core Selector** drop-down, select **collection1**, and within that, click **Query**. As an example, to select and return all the docs in Solr, provide the following values:\n\n    * In the **q** text box, enter **\\*:**\\*. This will return all the documents that are indexed in Solr. If you want to search for a specific string within the documents, you can enter that string here.\n    \n    * In the **wt** text box, select the output format. Default is **json**. Click **Execute Query**.\n\n    ![Use Script Action to customize a cluster](./media/hdinsight-hadoop-solr-install/hdi-solr-dashboard-query.png \"Run a query on Solr dashboard\")\n    \n    The output returns the two docs that we used for indexing Solr. The output resembles the following:\n\n            \"response\": {\n                \"numFound\": 2,\n                \"start\": 0,\n                \"maxScore\": 1,\n                \"docs\": [\n                  {\n                    \"id\": \"SOLR1000\",\n                    \"name\": \"Solr, the Enterprise Search Server\",\n                    \"manu\": \"Apache Software Foundation\",\n                    \"cat\": [\n                      \"software\",\n                      \"search\"\n                    ],\n                    \"features\": [\n                      \"Advanced Full-Text Search Capabilities using Lucene\",\n                      \"Optimized for High Volume Web Traffic\",\n                      \"Standards Based Open Interfaces - XML and HTTP\",\n                      \"Comprehensive HTML Administration Interfaces\",\n                      \"Scalability - Efficient Replication to other Solr Search Servers\",\n                      \"Flexible and Adaptable with XML configuration and Schema\",\n                      \"Good unicode support: héllo (hello with an accent over the e)\"\n                    ],\n                    \"price\": 0,\n                    \"price_c\": \"0,USD\",\n                    \"popularity\": 10,\n                    \"inStock\": true,\n                    \"incubationdate_dt\": \"2006-01-17T00:00:00Z\",\n                    \"_version_\": 1486960636996878300\n                  },\n                  {\n                    \"id\": \"3007WFP\",\n                    \"name\": \"Dell Widescreen UltraSharp 3007WFP\",\n                    \"manu\": \"Dell, Inc.\",\n                    \"manu_id_s\": \"dell\",\n                    \"cat\": [\n                      \"electronics and computer1\"\n                    ],\n                    \"features\": [\n                      \"30\\\" TFT active matrix LCD, 2560 x 1600, .25mm dot pitch, 700:1 contrast\"\n                    ],\n                    \"includes\": \"USB cable\",\n                    \"weight\": 401.6,\n                    \"price\": 2199,\n                    \"price_c\": \"2199,USD\",\n                    \"popularity\": 6,\n                    \"inStock\": true,\n                    \"store\": \"43.17614,-90.57341\",\n                    \"_version_\": 1486960637584081000\n                  }\n                ]\n              }\n\n\n4. **Recommended: Back up the indexed data from Solr to Azure Blob storage associated with the HDInsight cluster**. As a good practice, you should back up the indexed data from the Solr cluster nodes onto Azure Blob storage. Perform the following steps to do so:\n\n    1. From the RDP session, open Internet Explorer, and point to the following URL:\n\n            http://localhost:8983/solr/replication?command=backup\n\n        You should see a response like this:\n\n            <?xml version=\"1.0\" encoding=\"UTF-8\"?>\n            <response>\n              <lst name=\"responseHeader\">\n                <int name=\"status\">0</int>\n                <int name=\"QTime\">9</int>\n              </lst>\n              <str name=\"status\">OK</str>\n            </response>\n\n    2. In the remote session, navigate to {SOLR_HOME}\\{Collection}\\data. For the cluster created via the sample script, this should be **C:\\apps\\dist\\solr-4.7.2\\example\\solr\\collection1\\data**. At this location, you should see a snapshot folder created with a name similar to **snapshot.*timestamp***.\n\n    3. Zip the snapshot folder and upload it to Azure Blob storage. From the Hadoop command line, navigate to the location of the snapshot folder by using the following command:\n\n              hadoop fs -CopyFromLocal snapshot._timestamp_.zip /example/data\n\n        This command copies the snapshot to /example/data/ under the container within the default Storage account associated with the cluster.\n\n## Install Solr using Aure PowerShell\n\nSee [Customize HDInsight clusters using Script Action](hdinsight-hadoop-customize-cluster.md#call_scripts_using_powershell).  The sample demonstrates how to install Spark using Azure PowerShell. You need to customize the script to use [https://hdiconfigactions.blob.core.windows.net/solrconfigactionv01/solr-installer-v01.ps1](https://hdiconfigactions.blob.core.windows.net/solrconfigactionv01/solr-installer-v01.ps1).\n\n## Install Sole using .NET SDK\n\nSee [Customize HDInsight clusters using Script Action](hdinsight-hadoop-customize-cluster.md#call_scripts_using_azure_powershell). The sample demonstrates how to install Spark using the .NET SDK. You need to customize the script to use [https://hdiconfigactions.blob.core.windows.net/solrconfigactionv01/solr-installer-v01.ps1](https://hdiconfigactions.blob.core.windows.net/solrconfigactionv01/solr-installer-v01.ps1).\n\n\n\n## See also\n\n- [Install and use Solr on HDinsight Hadoop clusters (Linux)](hdinsight-hadoop-solr-install-linux.md)\n- [Create Hadoop clusters in HDInsight](hdinsight-provision-clusters.md): general information on creating HDInsight clusters.\n- [Customize HDInsight cluster using Script Action][hdinsight-cluster-customize]: general information on customizing HDInsight clusters using Script Action.\n- [Develop Script Action scripts for HDInsight](hdinsight-hadoop-script-actions.md).\n- [Install and use Spark on HDInsight clusters][hdinsight-install-spark]: Script Action sample about installing Spark.\n- [Install R on HDInsight clusters][hdinsight-install-r]: Script Action sample about installing R.\n- [Install Giraph on HDInsight clusters](hdinsight-hadoop-giraph-install.md): Script Action sample about installing Giraph.\n\n\n[powershell-install-configure]: powershell-install-configure.md\n[hdinsight-provision]: hdinsight-provision-clusters.md\n[hdinsight-install-r]: hdinsight-hadoop-r-scripts.md\n[hdinsight-install-spark]: hdinsight-hadoop-spark-install.md\n[hdinsight-cluster-customize]: hdinsight-hadoop-customize-cluster.md\n"
}