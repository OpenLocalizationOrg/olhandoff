{
  "nodes": [
    {
      "pos": [
        27,
        99
      ],
      "content": "Install and use Giraph on Hadoop clusters in HDInsight | Microsoft Azure"
    },
    {
      "pos": [
        118,
        194
      ],
      "content": "Learn how to customize HDInsight cluster with Giraph, and how to use Giraph."
    },
    {
      "pos": [
        522,
        557
      ],
      "content": "Install and use Giraph in HDInsight"
    },
    {
      "pos": [
        560,
        861
      ],
      "content": "Learn how to customize Windows based HDInsight cluster with Giraph using Script Action, and how to use Giraph to process large-scale graphs. For information on using Giraph with a Linux-based cluster, see <bpt id=\"p1\">[</bpt>Install Giraph on HDInsight Hadoop clusters (Linux)<ept id=\"p1\">](hdinsight-hadoop-giraph-install-linux.md)</ept>.",
      "nodes": [
        {
          "content": "Learn how to customize Windows based HDInsight cluster with Giraph using Script Action, and how to use Giraph to process large-scale graphs.",
          "pos": [
            0,
            140
          ]
        },
        {
          "content": "For information on using Giraph with a Linux-based cluster, see <bpt id=\"p1\">[</bpt>Install Giraph on HDInsight Hadoop clusters (Linux)<ept id=\"p1\">](hdinsight-hadoop-giraph-install-linux.md)</ept>.",
          "pos": [
            141,
            339
          ]
        }
      ]
    },
    {
      "pos": [
        864,
        1472
      ],
      "content": "You can install Giraph on any type of cluster (Hadoop, Storm, HBase, Spark) on Azure HDInsight by using <bpt id=\"p2\">*</bpt>Script Action<ept id=\"p2\">*</ept>. A sample script to install Giraph on an HDInsight cluster is available from a read-only Azure storage blob at <bpt id=\"p3\">[</bpt>https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1<ept id=\"p3\">](https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1)</ept>. The sample script works only with HDInsight cluster version 3.1. For more information on HDInsight cluster versions, see <bpt id=\"p4\">[</bpt>HDInsight cluster versions<ept id=\"p4\">](hdinsight-component-versioning.md)</ept>.",
      "nodes": [
        {
          "content": "You can install Giraph on any type of cluster (Hadoop, Storm, HBase, Spark) on Azure HDInsight by using <bpt id=\"p2\">*</bpt>Script Action<ept id=\"p2\">*</ept>.",
          "pos": [
            0,
            158
          ]
        },
        {
          "content": "A sample script to install Giraph on an HDInsight cluster is available from a read-only Azure storage blob at <bpt id=\"p3\">[</bpt>https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1<ept id=\"p3\">](https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1)</ept>.",
          "pos": [
            159,
            498
          ]
        },
        {
          "content": "The sample script works only with HDInsight cluster version 3.1.",
          "pos": [
            499,
            563
          ]
        },
        {
          "content": "For more information on HDInsight cluster versions, see <bpt id=\"p4\">[</bpt>HDInsight cluster versions<ept id=\"p4\">](hdinsight-component-versioning.md)</ept>.",
          "pos": [
            564,
            722
          ]
        }
      ]
    },
    {
      "pos": [
        1474,
        1494
      ],
      "content": "<bpt id=\"p5\">**</bpt>Related articles<ept id=\"p5\">**</ept>"
    },
    {
      "pos": [
        1498,
        1593
      ],
      "content": "<bpt id=\"p6\">[</bpt>Install Giraph on HDInsight Hadoop clusters (Linux)<ept id=\"p6\">](hdinsight-hadoop-giraph-install-linux.md)</ept>"
    },
    {
      "pos": [
        1596,
        1719
      ],
      "content": "<bpt id=\"p7\">[</bpt>Create Hadoop clusters in HDInsight<ept id=\"p7\">](hdinsight-provision-clusters.md)</ept>: general information on creating HDInsight clusters."
    },
    {
      "pos": [
        1722,
        1876
      ],
      "content": "<bpt id=\"p8\">[</bpt>Customize HDInsight cluster using Script Action<ept id=\"p8\">][hdinsight-cluster-customize]</ept>: general information on customizing HDInsight clusters using Script Action."
    },
    {
      "pos": [
        1879,
        1961
      ],
      "content": "<bpt id=\"p9\">[</bpt>Develop Script Action scripts for HDInsight<ept id=\"p9\">](hdinsight-hadoop-script-actions.md)</ept>."
    },
    {
      "pos": [
        1966,
        1981
      ],
      "content": "What is Giraph?"
    },
    {
      "pos": [
        2035,
        2048
      ],
      "content": "Apache Giraph"
    },
    {
      "pos": [
        2053,
        2461
      ],
      "content": "allows you to perform graph processing by using Hadoop, and can be used with Azure HDInsight. Graphs model relationships between objects, such as the connections between routers on a large network like the Internet, or relationships between people on social networks (sometimes referred to as a social graph). Graph processing allows you to reason about the relationships between objects in a graph, such as:",
      "nodes": [
        {
          "content": "allows you to perform graph processing by using Hadoop, and can be used with Azure HDInsight.",
          "pos": [
            0,
            93
          ]
        },
        {
          "content": "Graphs model relationships between objects, such as the connections between routers on a large network like the Internet, or relationships between people on social networks (sometimes referred to as a social graph).",
          "pos": [
            94,
            309
          ]
        },
        {
          "content": "Graph processing allows you to reason about the relationships between objects in a graph, such as:",
          "pos": [
            310,
            408
          ]
        }
      ]
    },
    {
      "pos": [
        2465,
        2531
      ],
      "content": "Identifying potential friends based on your current relationships."
    },
    {
      "pos": [
        2534,
        2600
      ],
      "content": "Identifying the shortest route between two computers in a network."
    },
    {
      "pos": [
        2603,
        2641
      ],
      "content": "Calculating the page rank of webpages."
    },
    {
      "pos": [
        2647,
        2674
      ],
      "content": "Install Giraph using portal"
    },
    {
      "pos": [
        2778,
        2855
      ],
      "content": "<bpt id=\"p10\">[</bpt>Install Giraph on HDInsight clusters<ept id=\"p10\">](hdinsight-hadoop-giraph-install-v1.md)</ept>"
    },
    {
      "pos": [
        2860,
        3018
      ],
      "content": "Start creating a cluster by using the <bpt id=\"p11\">**</bpt>CUSTOM CREATE<ept id=\"p11\">**</ept><ph id=\"ph3\"/> option, as described at <bpt id=\"p12\">[</bpt>Create Hadoop clusters in HDInsight<ept id=\"p12\">](hdinsight-provision-clusters.md#portal)</ept>."
    },
    {
      "pos": [
        3022,
        3155
      ],
      "content": "On the <bpt id=\"p13\">**</bpt>Script Actions<ept id=\"p13\">**</ept><ph id=\"ph4\"/> page of the wizard, click <bpt id=\"p14\">**</bpt>add script action<ept id=\"p14\">**</ept><ph id=\"ph5\"/> to provide details about the script action, as shown below:"
    },
    {
      "pos": [
        3161,
        3317
      ],
      "content": "<ph id=\"ph6\">![</ph>Use Script Action to customize a cluster<ph id=\"ph7\">](./media/hdinsight-hadoop-giraph-install/hdi-script-action-giraph.png \"Use Script Action to customize a cluster\")</ph>"
    },
    {
      "pos": [
        3323,
        4196
      ],
      "leadings": [
        "",
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "   ",
        "   "
      ],
      "content": "<ph id=\"ph8\">&lt;table border='1'&gt;</ph><ph id=\"ph9\">\n     &lt;tr&gt;</ph><ph id=\"ph10\">&lt;th&gt;</ph>Property<ph id=\"ph11\">&lt;/th&gt;</ph><ph id=\"ph12\">&lt;th&gt;</ph>Value<ph id=\"ph13\">&lt;/th&gt;</ph><ph id=\"ph14\">&lt;/tr&gt;</ph><ph id=\"ph15\">\n     &lt;tr&gt;</ph><ph id=\"ph16\">&lt;td&gt;</ph>Name<ph id=\"ph17\">&lt;/td&gt;</ph><ph id=\"ph18\">\n         &lt;td&gt;</ph>Specify a name for the script action. For example, <ph id=\"ph19\">&lt;b&gt;</ph>Install Giraph<ph id=\"ph20\">&lt;/b&gt;</ph>.<ph id=\"ph21\">&lt;/td&gt;</ph><ph id=\"ph22\">&lt;/tr&gt;</ph><ph id=\"ph23\">\n     &lt;tr&gt;</ph><ph id=\"ph24\">&lt;td&gt;</ph>Script URI<ph id=\"ph25\">&lt;/td&gt;</ph><ph id=\"ph26\">\n         &lt;td&gt;</ph>Specify the Uniform Resource Identifier (URI) to the script that is invoked to customize the cluster. For example, <ph id=\"ph27\">&lt;i&gt;</ph>https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1<ph id=\"ph28\">&lt;/i&gt;</ph><ph id=\"ph29\">&lt;/td&gt;</ph><ph id=\"ph30\">&lt;/tr&gt;</ph><ph id=\"ph31\">\n     &lt;tr&gt;</ph><ph id=\"ph32\">&lt;td&gt;</ph>Node Type<ph id=\"ph33\">&lt;/td&gt;</ph><ph id=\"ph34\">\n         &lt;td&gt;</ph>Specify the nodes on which the customization script is run. You can choose <ph id=\"ph35\">&lt;b&gt;</ph>All nodes<ph id=\"ph36\">&lt;/b&gt;</ph>, <ph id=\"ph37\">&lt;b&gt;</ph>Head nodes only<ph id=\"ph38\">&lt;/b&gt;</ph>, or <ph id=\"ph39\">&lt;b&gt;</ph>Worker nodes only<ph id=\"ph40\">&lt;/b&gt;</ph>.\n     <ph id=\"ph41\">&lt;tr&gt;</ph><ph id=\"ph42\">&lt;td&gt;</ph>Parameters<ph id=\"ph43\">&lt;/td&gt;</ph><ph id=\"ph44\">\n         &lt;td&gt;</ph>Specify the parameters, if required by the script. The script to install Giraph does not require any parameters, so you can leave this blank.<ph id=\"ph45\">&lt;/td&gt;</ph><ph id=\"ph46\">&lt;/tr&gt;</ph><ph id=\"ph47\">\n &lt;/table&gt;</ph>",
      "nodes": [
        {
          "content": "<ph id=\"ph8\">&lt;table border='1'&gt;</ph><ph id=\"ph9\">\n     &lt;tr&gt;</ph><ph id=\"ph10\">&lt;th&gt;</ph>Property<ph id=\"ph11\">&lt;/th&gt;</ph><ph id=\"ph12\">&lt;th&gt;</ph>Value<ph id=\"ph13\">&lt;/th&gt;</ph><ph id=\"ph14\">&lt;/tr&gt;</ph><ph id=\"ph15\">\n     &lt;tr&gt;</ph><ph id=\"ph16\">&lt;td&gt;</ph>Name<ph id=\"ph17\">&lt;/td&gt;</ph><ph id=\"ph18\">\n         &lt;td&gt;</ph>Specify a name for the script action.",
          "pos": [
            0,
            411
          ]
        },
        {
          "content": "For example, <ph id=\"ph19\">&lt;b&gt;</ph>Install Giraph<ph id=\"ph20\">&lt;/b&gt;</ph>.<ph id=\"ph21\">&lt;/td&gt;</ph><ph id=\"ph22\">&lt;/tr&gt;</ph><ph id=\"ph23\">\n     &lt;tr&gt;</ph><ph id=\"ph24\">&lt;td&gt;</ph>Script URI<ph id=\"ph25\">&lt;/td&gt;</ph><ph id=\"ph26\">\n         &lt;td&gt;</ph>Specify the Uniform Resource Identifier (URI) to the script that is invoked to customize the cluster.",
          "pos": [
            412,
            801
          ]
        },
        {
          "content": "For example, <ph id=\"ph27\">&lt;i&gt;</ph>https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1<ph id=\"ph28\">&lt;/i&gt;</ph><ph id=\"ph29\">&lt;/td&gt;</ph><ph id=\"ph30\">&lt;/tr&gt;</ph><ph id=\"ph31\">\n     &lt;tr&gt;</ph><ph id=\"ph32\">&lt;td&gt;</ph>Node Type<ph id=\"ph33\">&lt;/td&gt;</ph><ph id=\"ph34\">\n         &lt;td&gt;</ph>Specify the nodes on which the customization script is run.",
          "pos": [
            802,
            1226
          ]
        },
        {
          "content": "You can choose <ph id=\"ph35\">&lt;b&gt;</ph>All nodes<ph id=\"ph36\">&lt;/b&gt;</ph>, <ph id=\"ph37\">&lt;b&gt;</ph>Head nodes only<ph id=\"ph38\">&lt;/b&gt;</ph>, or <ph id=\"ph39\">&lt;b&gt;</ph>Worker nodes only<ph id=\"ph40\">&lt;/b&gt;</ph>.",
          "pos": [
            1227,
            1462
          ]
        },
        {
          "content": "<ph id=\"ph41\">&lt;tr&gt;</ph><ph id=\"ph42\">&lt;td&gt;</ph>Parameters<ph id=\"ph43\">&lt;/td&gt;</ph><ph id=\"ph44\">\n         &lt;td&gt;</ph>Specify the parameters, if required by the script.",
          "pos": [
            1468,
            1655
          ]
        },
        {
          "content": "The script to install Giraph does not require any parameters, so you can leave this blank.<ph id=\"ph45\">&lt;/td&gt;</ph><ph id=\"ph46\">&lt;/tr&gt;</ph><ph id=\"ph47\">\n &lt;/table&gt;</ph>",
          "pos": [
            1656,
            1841
          ]
        }
      ]
    },
    {
      "pos": [
        4202,
        4373
      ],
      "content": "You can add more than one script action to install multiple components on the cluster. After you have added the scripts, click the checkmark to start creating the cluster.",
      "nodes": [
        {
          "content": "You can add more than one script action to install multiple components on the cluster.",
          "pos": [
            0,
            86
          ]
        },
        {
          "content": "After you have added the scripts, click the checkmark to start creating the cluster.",
          "pos": [
            87,
            171
          ]
        }
      ]
    },
    {
      "pos": [
        4378,
        4388
      ],
      "content": "Use Giraph"
    },
    {
      "pos": [
        4390,
        4464
      ],
      "content": "We use the SimpleShortestPathsComputation example to demonstrate the basic"
    },
    {
      "pos": [
        4535,
        4541
      ],
      "content": "Pregel"
    },
    {
      "pos": [
        4546,
        4778
      ],
      "content": "implementation for finding the shortest path between objects in a graph. Use the following steps to upload the sample data and the sample jar, run a job by using the SimpleShortestPathsComputation example, and then view the results.",
      "nodes": [
        {
          "content": "implementation for finding the shortest path between objects in a graph.",
          "pos": [
            0,
            72
          ]
        },
        {
          "content": "Use the following steps to upload the sample data and the sample jar, run a job by using the SimpleShortestPathsComputation example, and then view the results.",
          "pos": [
            73,
            232
          ]
        }
      ]
    },
    {
      "pos": [
        4783,
        4941
      ],
      "content": "Upload a sample data file to Azure Blob storage. On your local workstation, create a new file named <bpt id=\"p15\">**</bpt>tiny_graph.txt<ept id=\"p15\">**</ept>. It should contain the following lines:",
      "nodes": [
        {
          "content": "Upload a sample data file to Azure Blob storage.",
          "pos": [
            0,
            48
          ]
        },
        {
          "content": "On your local workstation, create a new file named <bpt id=\"p15\">**</bpt>tiny_graph.txt<ept id=\"p15\">**</ept>.",
          "pos": [
            49,
            159
          ]
        },
        {
          "content": "It should contain the following lines:",
          "pos": [
            160,
            198
          ]
        }
      ]
    },
    {
      "pos": [
        5100,
        5295
      ],
      "content": "Upload the tiny_graph.txt file to the primary storage for your HDInsight cluster. For instructions on how to upload data, see <bpt id=\"p16\">[</bpt>Upload data for Hadoop jobs in HDInsight<ept id=\"p16\">](hdinsight-upload-data.md)</ept>.",
      "nodes": [
        {
          "content": "Upload the tiny_graph.txt file to the primary storage for your HDInsight cluster.",
          "pos": [
            0,
            81
          ]
        },
        {
          "content": "For instructions on how to upload data, see <bpt id=\"p16\">[</bpt>Upload data for Hadoop jobs in HDInsight<ept id=\"p16\">](hdinsight-upload-data.md)</ept>.",
          "pos": [
            82,
            235
          ]
        }
      ]
    },
    {
      "pos": [
        5301,
        5695
      ],
      "content": "This data describes a relationship between objects in a directed graph, by using the format [source\\_id, source\\_value,[[dest\\_id], [edge\\_value],...]]. Each line represents a relationship between a <bpt id=\"p17\">**</bpt>source\\_id<ept id=\"p17\">**</ept><ph id=\"ph48\"/> object and one or more <bpt id=\"p18\">**</bpt>dest\\_id<ept id=\"p18\">**</ept><ph id=\"ph49\"/> objects. The <bpt id=\"p19\">**</bpt>edge\\_value<ept id=\"p19\">**</ept><ph id=\"ph50\"/> (or weight) can be thought of as the strength or distance of the connection between <bpt id=\"p20\">**</bpt>source_id<ept id=\"p20\">**</ept><ph id=\"ph51\"/> and <bpt id=\"p21\">**</bpt>dest\\_id<ept id=\"p21\">**</ept>.",
      "nodes": [
        {
          "content": "This data describes a relationship between objects in a directed graph, by using the format [source\\_id, source\\_value,[[dest\\_id], [edge\\_value],...]].",
          "pos": [
            0,
            152
          ]
        },
        {
          "content": "Each line represents a relationship between a <bpt id=\"p17\">**</bpt>source\\_id<ept id=\"p17\">**</ept><ph id=\"ph48\"/> object and one or more <bpt id=\"p18\">**</bpt>dest\\_id<ept id=\"p18\">**</ept><ph id=\"ph49\"/> objects.",
          "pos": [
            153,
            368
          ]
        },
        {
          "content": "The <bpt id=\"p19\">**</bpt>edge\\_value<ept id=\"p19\">**</ept><ph id=\"ph50\"/> (or weight) can be thought of as the strength or distance of the connection between <bpt id=\"p20\">**</bpt>source_id<ept id=\"p20\">**</ept><ph id=\"ph51\"/> and <bpt id=\"p21\">**</bpt>dest\\_id<ept id=\"p21\">**</ept>.",
          "pos": [
            369,
            654
          ]
        }
      ]
    },
    {
      "pos": [
        5701,
        5813
      ],
      "content": "Drawn out, and using the value (or weight) as the distance between objects, the above data might look like this:"
    },
    {
      "pos": [
        5819,
        5950
      ],
      "content": "<ph id=\"ph52\">![</ph>tiny_graph.txt drawn as circles with lines of varying distance between<ph id=\"ph53\">](./media/hdinsight-hadoop-giraph-install/giraph-graph.png)</ph>"
    },
    {
      "pos": [
        5957,
        6202
      ],
      "content": "Run the SimpleShortestPathsComputation example. Use the following Azure PowerShell cmdlets to run the example by using the tiny_graph.txt file as input. This requires that you have installed and configured <bpt id=\"p22\">[</bpt>Azure PowerShell<ept id=\"p22\">][powershell-install]</ept>.",
      "nodes": [
        {
          "content": "Run the SimpleShortestPathsComputation example.",
          "pos": [
            0,
            47
          ]
        },
        {
          "content": "Use the following Azure PowerShell cmdlets to run the example by using the tiny_graph.txt file as input.",
          "pos": [
            48,
            152
          ]
        },
        {
          "content": "This requires that you have installed and configured <bpt id=\"p22\">[</bpt>Azure PowerShell<ept id=\"p22\">][powershell-install]</ept>.",
          "pos": [
            153,
            285
          ]
        }
      ]
    },
    {
      "pos": [
        7682,
        7794
      ],
      "content": "In the above example, replace <bpt id=\"p23\">**</bpt>clustername<ept id=\"p23\">**</ept><ph id=\"ph54\"/> with the name of your HDInsight cluster that has Giraph installed."
    },
    {
      "pos": [
        7799,
        8063
      ],
      "content": "View the results. Once the job has finished, the results will be stored in two output files in the <bpt id=\"p24\">__</bpt>wasb:///example/out/shotestpaths<ept id=\"p24\">__</ept><ph id=\"ph55\"/> folder. The files are called <bpt id=\"p25\">__</bpt>part-m-00001<ept id=\"p25\">__</ept><ph id=\"ph56\"/> and <bpt id=\"p26\">__</bpt>part-m-00002<ept id=\"p26\">__</ept>. Perform the following steps to download and view the output:",
      "nodes": [
        {
          "content": "View the results.",
          "pos": [
            0,
            17
          ]
        },
        {
          "content": "Once the job has finished, the results will be stored in two output files in the <bpt id=\"p24\">__</bpt>wasb:///example/out/shotestpaths<ept id=\"p24\">__</ept><ph id=\"ph55\"/> folder.",
          "pos": [
            18,
            198
          ]
        },
        {
          "content": "The files are called <bpt id=\"p25\">__</bpt>part-m-00001<ept id=\"p25\">__</ept><ph id=\"ph56\"/> and <bpt id=\"p26\">__</bpt>part-m-00002<ept id=\"p26\">__</ept>.",
          "pos": [
            199,
            353
          ]
        },
        {
          "content": "Perform the following steps to download and view the output:",
          "pos": [
            354,
            414
          ]
        }
      ]
    },
    {
      "pos": [
        9020,
        9191
      ],
      "content": "This will create the <bpt id=\"p27\">__</bpt>example/output/shortestpaths<ept id=\"p27\">__</ept><ph id=\"ph57\"/> directory structure in the current directory on your workstation, and download the two output files to that location."
    },
    {
      "pos": [
        9197,
        9257
      ],
      "content": "Use the <bpt id=\"p28\">__</bpt>Cat<ept id=\"p28\">__</ept><ph id=\"ph58\"/> cmdlet to display the contents of the files:"
    },
    {
      "pos": [
        9311,
        9361
      ],
      "content": "The output should appear similar to the following:"
    },
    {
      "pos": [
        10181,
        10217
      ],
      "content": "Install Giraph using Aure PowerShell"
    },
    {
      "pos": [
        10219,
        10645
      ],
      "content": "See <bpt id=\"p29\">[</bpt>Customize HDInsight clusters using Script Action<ept id=\"p29\">](hdinsight-hadoop-customize-cluster.md#call_scripts_using_powershell)</ept>.  The sample demonstrates how to install Spark using Azure PowerShell. You need to customize the script to use <bpt id=\"p30\">[</bpt>https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1<ept id=\"p30\">](https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1)</ept>.",
      "nodes": [
        {
          "content": "See <bpt id=\"p29\">[</bpt>Customize HDInsight clusters using Script Action<ept id=\"p29\">](hdinsight-hadoop-customize-cluster.md#call_scripts_using_powershell)</ept>.",
          "pos": [
            0,
            164
          ]
        },
        {
          "content": "The sample demonstrates how to install Spark using Azure PowerShell.",
          "pos": [
            166,
            234
          ]
        },
        {
          "content": "You need to customize the script to use <bpt id=\"p30\">[</bpt>https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1<ept id=\"p30\">](https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1)</ept>.",
          "pos": [
            235,
            506
          ]
        }
      ]
    },
    {
      "pos": [
        10650,
        10679
      ],
      "content": "Install Giraph using .NET SDK"
    },
    {
      "pos": [
        10681,
        11108
      ],
      "content": "See <bpt id=\"p31\">[</bpt>Customize HDInsight clusters using Script Action<ept id=\"p31\">](hdinsight-hadoop-customize-cluster.md#call_scripts_using_azure_powershell)</ept>. The sample demonstrates how to install Spark using the .NET SDK. You need to customize the script to use <bpt id=\"p32\">[</bpt>https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1<ept id=\"p32\">](https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1)</ept>.",
      "nodes": [
        {
          "content": "See <bpt id=\"p31\">[</bpt>Customize HDInsight clusters using Script Action<ept id=\"p31\">](hdinsight-hadoop-customize-cluster.md#call_scripts_using_azure_powershell)</ept>.",
          "pos": [
            0,
            170
          ]
        },
        {
          "content": "The sample demonstrates how to install Spark using the .NET SDK.",
          "pos": [
            171,
            235
          ]
        },
        {
          "content": "You need to customize the script to use <bpt id=\"p32\">[</bpt>https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1<ept id=\"p32\">](https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1)</ept>.",
          "pos": [
            236,
            507
          ]
        }
      ]
    },
    {
      "pos": [
        11114,
        11122
      ],
      "content": "See also"
    },
    {
      "pos": [
        11126,
        11221
      ],
      "content": "<bpt id=\"p33\">[</bpt>Install Giraph on HDInsight Hadoop clusters (Linux)<ept id=\"p33\">](hdinsight-hadoop-giraph-install-linux.md)</ept>"
    },
    {
      "pos": [
        11224,
        11347
      ],
      "content": "<bpt id=\"p34\">[</bpt>Create Hadoop clusters in HDInsight<ept id=\"p34\">](hdinsight-provision-clusters.md)</ept>: general information on creating HDInsight clusters."
    },
    {
      "pos": [
        11350,
        11504
      ],
      "content": "<bpt id=\"p35\">[</bpt>Customize HDInsight cluster using Script Action<ept id=\"p35\">][hdinsight-cluster-customize]</ept>: general information on customizing HDInsight clusters using Script Action."
    },
    {
      "pos": [
        11507,
        11589
      ],
      "content": "<bpt id=\"p36\">[</bpt>Develop Script Action scripts for HDInsight<ept id=\"p36\">](hdinsight-hadoop-script-actions.md)</ept>."
    },
    {
      "pos": [
        11592,
        11708
      ],
      "content": "<bpt id=\"p37\">[</bpt>Install and use Spark on HDInsight clusters<ept id=\"p37\">][hdinsight-install-spark]</ept>: Script Action sample about installing Spark."
    },
    {
      "pos": [
        11711,
        11807
      ],
      "content": "<bpt id=\"p38\">[</bpt>Install R on HDInsight clusters<ept id=\"p38\">][hdinsight-install-r]</ept>: Script Action sample about installing R."
    },
    {
      "pos": [
        11810,
        11925
      ],
      "content": "<bpt id=\"p39\">[</bpt>Install Solr on HDInsight clusters<ept id=\"p39\">](hdinsight-hadoop-solr-install.md)</ept>: Script Action sample about installing Solr."
    }
  ],
  "content": "<properties\n    pageTitle=\"Install and use Giraph on Hadoop clusters in HDInsight | Microsoft Azure\"\n    description=\"Learn how to customize HDInsight cluster with Giraph, and how to use Giraph.\"\n    services=\"hdinsight\"\n    documentationCenter=\"\"\n    authors=\"nitinme\"\n    manager=\"paulettm\"\n    editor=\"cgronlun\"\n    tags=\"azure-portal\"/>\n\n<tags\n    ms.service=\"hdinsight\"\n    ms.workload=\"big-data\"\n    ms.tgt_pltfrm=\"na\"\n    ms.devlang=\"na\"\n    ms.topic=\"article\"\n    ms.date=\"02/05/2016\"\n    ms.author=\"nitinme\"/>\n\n# Install and use Giraph in HDInsight\n\n\nLearn how to customize Windows based HDInsight cluster with Giraph using Script Action, and how to use Giraph to process large-scale graphs. For information on using Giraph with a Linux-based cluster, see [Install Giraph on HDInsight Hadoop clusters (Linux)](hdinsight-hadoop-giraph-install-linux.md).\n \nYou can install Giraph on any type of cluster (Hadoop, Storm, HBase, Spark) on Azure HDInsight by using *Script Action*. A sample script to install Giraph on an HDInsight cluster is available from a read-only Azure storage blob at [https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1](https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1). The sample script works only with HDInsight cluster version 3.1. For more information on HDInsight cluster versions, see [HDInsight cluster versions](hdinsight-component-versioning.md).\n\n**Related articles**\n\n- [Install Giraph on HDInsight Hadoop clusters (Linux)](hdinsight-hadoop-giraph-install-linux.md)\n- [Create Hadoop clusters in HDInsight](hdinsight-provision-clusters.md): general information on creating HDInsight clusters.\n- [Customize HDInsight cluster using Script Action][hdinsight-cluster-customize]: general information on customizing HDInsight clusters using Script Action.\n- [Develop Script Action scripts for HDInsight](hdinsight-hadoop-script-actions.md).\n\n## What is Giraph?\n\n<a href=\"http://giraph.apache.org/\" target=\"_blank\">Apache Giraph</a> allows you to perform graph processing by using Hadoop, and can be used with Azure HDInsight. Graphs model relationships between objects, such as the connections between routers on a large network like the Internet, or relationships between people on social networks (sometimes referred to as a social graph). Graph processing allows you to reason about the relationships between objects in a graph, such as:\n\n- Identifying potential friends based on your current relationships.\n- Identifying the shortest route between two computers in a network.\n- Calculating the page rank of webpages.\n\n\n## Install Giraph using portal\n\n[AZURE.INCLUDE [hdinsight-azure-preview-portal](../../includes/hdinsight-azure-preview-portal.md)]\n\n* [Install Giraph on HDInsight clusters](hdinsight-hadoop-giraph-install-v1.md)\n\n1. Start creating a cluster by using the **CUSTOM CREATE** option, as described at [Create Hadoop clusters in HDInsight](hdinsight-provision-clusters.md#portal).\n2. On the **Script Actions** page of the wizard, click **add script action** to provide details about the script action, as shown below:\n\n    ![Use Script Action to customize a cluster](./media/hdinsight-hadoop-giraph-install/hdi-script-action-giraph.png \"Use Script Action to customize a cluster\")\n\n    <table border='1'>\n        <tr><th>Property</th><th>Value</th></tr>\n        <tr><td>Name</td>\n            <td>Specify a name for the script action. For example, <b>Install Giraph</b>.</td></tr>\n        <tr><td>Script URI</td>\n            <td>Specify the Uniform Resource Identifier (URI) to the script that is invoked to customize the cluster. For example, <i>https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1</i></td></tr>\n        <tr><td>Node Type</td>\n            <td>Specify the nodes on which the customization script is run. You can choose <b>All nodes</b>, <b>Head nodes only</b>, or <b>Worker nodes only</b>.\n        <tr><td>Parameters</td>\n            <td>Specify the parameters, if required by the script. The script to install Giraph does not require any parameters, so you can leave this blank.</td></tr>\n    </table>\n\n    You can add more than one script action to install multiple components on the cluster. After you have added the scripts, click the checkmark to start creating the cluster.\n\n## Use Giraph\n\nWe use the SimpleShortestPathsComputation example to demonstrate the basic <a href = \"http://people.apache.org/~edwardyoon/documents/pregel.pdf\">Pregel</a> implementation for finding the shortest path between objects in a graph. Use the following steps to upload the sample data and the sample jar, run a job by using the SimpleShortestPathsComputation example, and then view the results.\n\n1. Upload a sample data file to Azure Blob storage. On your local workstation, create a new file named **tiny_graph.txt**. It should contain the following lines:\n\n        [0,0,[[1,1],[3,3]]]\n        [1,0,[[0,1],[2,2],[3,1]]]\n        [2,0,[[1,2],[4,4]]]\n        [3,0,[[0,3],[1,1],[4,4]]]\n        [4,0,[[3,4],[2,4]]]\n\n    Upload the tiny_graph.txt file to the primary storage for your HDInsight cluster. For instructions on how to upload data, see [Upload data for Hadoop jobs in HDInsight](hdinsight-upload-data.md).\n\n    This data describes a relationship between objects in a directed graph, by using the format [source\\_id, source\\_value,[[dest\\_id], [edge\\_value],...]]. Each line represents a relationship between a **source\\_id** object and one or more **dest\\_id** objects. The **edge\\_value** (or weight) can be thought of as the strength or distance of the connection between **source_id** and **dest\\_id**.\n\n    Drawn out, and using the value (or weight) as the distance between objects, the above data might look like this:\n\n    ![tiny_graph.txt drawn as circles with lines of varying distance between](./media/hdinsight-hadoop-giraph-install/giraph-graph.png)\n\n\n\n4. Run the SimpleShortestPathsComputation example. Use the following Azure PowerShell cmdlets to run the example by using the tiny_graph.txt file as input. This requires that you have installed and configured [Azure PowerShell][powershell-install].\n\n        $clusterName = \"clustername\"\n        # Giraph examples jar\n        $jarFile = \"wasb:///example/jars/giraph-examples.jar\"\n        # Arguments for this job\n        $jobArguments = \"org.apache.giraph.examples.SimpleShortestPathsComputation\",\n                        \"-ca\", \"mapred.job.tracker=headnodehost:9010\",\n                        \"-vif\", \"org.apache.giraph.io.formats.JsonLongDoubleFloatDoubleVertexInputFormat\",\n                        \"-vip\", \"wasb:///example/data/tiny_graph.txt\",\n                        \"-vof\", \"org.apache.giraph.io.formats.IdWithValueTextOutputFormat\",\n                        \"-op\",  \"wasb:///example/output/shortestpaths\",\n                        \"-w\", \"2\"\n        # Create the definition\n        $jobDefinition = New-AzureHDInsightMapReduceJobDefinition\n          -JarFile $jarFile\n          -ClassName \"org.apache.giraph.GiraphRunner\"\n          -Arguments $jobArguments\n\n        # Run the job, write output to the Azure PowerShell window\n        $job = Start-AzureHDInsightJob -Cluster $clusterName -JobDefinition $jobDefinition\n        Write-Host \"Wait for the job to complete ...\" -ForegroundColor Green\n        Wait-AzureHDInsightJob -Job $job\n        Write-Host \"STDERR\"\n        Get-AzureHDInsightJobOutput -Cluster $clusterName -JobId $job.JobId -StandardError\n        Write-Host \"Display the standard output ...\" -ForegroundColor Green\n        Get-AzureHDInsightJobOutput -Cluster $clusterName -JobId $job.JobId -StandardOutput\n\n    In the above example, replace **clustername** with the name of your HDInsight cluster that has Giraph installed.\n\n5. View the results. Once the job has finished, the results will be stored in two output files in the __wasb:///example/out/shotestpaths__ folder. The files are called __part-m-00001__ and __part-m-00002__. Perform the following steps to download and view the output:\n\n        $subscriptionName = \"<SubscriptionName>\"       # Azure subscription name\n        $storageAccountName = \"<StorageAccountName>\"   # Azure Storage account name\n        $containerName = \"<ContainerName>\"             # Blob storage container name\n\n        # Select the current subscription\n        Select-AzureSubscription $subscriptionName\n\n        # Create the Storage account context object\n        $storageAccountKey = Get-AzureStorageKey $storageAccountName | %{ $_.Primary }\n        $storageContext = New-AzureStorageContext -StorageAccountName $storageAccountName -StorageAccountKey $storageAccountKey\n\n        # Download the job output to the workstation\n        Get-AzureStorageBlobContent -Container $containerName -Blob example/output/shortestpaths/part-m-00001 -Context $storageContext -Force\n        Get-AzureStorageBlobContent -Container $containerName -Blob example/output/shortestpaths/part-m-00002 -Context $storageContext -Force\n\n    This will create the __example/output/shortestpaths__ directory structure in the current directory on your workstation, and download the two output files to that location.\n\n    Use the __Cat__ cmdlet to display the contents of the files:\n\n        Cat example/output/shortestpaths/part*\n\n    The output should appear similar to the following:\n\n\n        0   1.0\n        4   5.0\n        2   2.0\n        1   0.0\n        3   1.0\n\n    The SimpleShortestPathComputation example is hard coded to start with object ID 1 and find the shortest path to other objects. So the output should be read as `destination_id distance`, where distance is the value (or weight) of the edges traveled between object ID 1 and the target ID.\n\n    Visualizing this, you can verify the results by traveling the shortest paths between ID 1 and all other objects. Note that the shortest path between ID 1 and ID 4 is 5. This is the total distance between <span style=\"color:orange\">ID 1 and 3</span>, and then <span style=\"color:red\">ID 3 and 4</span>.\n\n    ![Drawing of objects as circles with shortest paths drawn between](./media/hdinsight-hadoop-giraph-install/giraph-graph-out.png)\n\n## Install Giraph using Aure PowerShell\n\nSee [Customize HDInsight clusters using Script Action](hdinsight-hadoop-customize-cluster.md#call_scripts_using_powershell).  The sample demonstrates how to install Spark using Azure PowerShell. You need to customize the script to use [https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1](https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1).\n\n## Install Giraph using .NET SDK\n\nSee [Customize HDInsight clusters using Script Action](hdinsight-hadoop-customize-cluster.md#call_scripts_using_azure_powershell). The sample demonstrates how to install Spark using the .NET SDK. You need to customize the script to use [https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1](https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1).\n\n\n## See also\n\n- [Install Giraph on HDInsight Hadoop clusters (Linux)](hdinsight-hadoop-giraph-install-linux.md)\n- [Create Hadoop clusters in HDInsight](hdinsight-provision-clusters.md): general information on creating HDInsight clusters.\n- [Customize HDInsight cluster using Script Action][hdinsight-cluster-customize]: general information on customizing HDInsight clusters using Script Action.\n- [Develop Script Action scripts for HDInsight](hdinsight-hadoop-script-actions.md).\n- [Install and use Spark on HDInsight clusters][hdinsight-install-spark]: Script Action sample about installing Spark.\n- [Install R on HDInsight clusters][hdinsight-install-r]: Script Action sample about installing R.\n- [Install Solr on HDInsight clusters](hdinsight-hadoop-solr-install.md): Script Action sample about installing Solr.\n\n\n\n[tools]: https://github.com/Blackmist/hdinsight-tools\n[aps]: http://azure.microsoft.com/documentation/articles/install-configure-powershell/\n\n[powershell-install]: ../powershell-install-configure.md\n[hdinsight-provision]: hdinsight-provision-clusters.md\n[hdinsight-install-r]: hdinsight-hadoop-r-scripts.md\n[hdinsight-install-spark]: hdinsight-hadoop-spark-install.md\n[hdinsight-cluster-customize]: hdinsight-hadoop-customize-cluster.md\n"
}