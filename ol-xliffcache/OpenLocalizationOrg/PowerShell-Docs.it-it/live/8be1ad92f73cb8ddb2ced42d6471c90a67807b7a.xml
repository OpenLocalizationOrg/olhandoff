{
  "nodes": [
    {
      "content": "DSC for Linux nxFile Resource",
      "pos": [
        2,
        31
      ]
    },
    {
      "pos": [
        33,
        177
      ],
      "content": "The <bpt id=\"p1\">**</bpt>nxFile<ept id=\"p1\">**</ept> resource in PowerShell Desired State Configuration (DSC) provides a mechanism to to manage files and directories on a Linux node."
    },
    {
      "content": "Syntax",
      "pos": [
        182,
        188
      ]
    },
    {
      "content": "Properties",
      "pos": [
        677,
        687
      ]
    },
    {
      "content": "Property",
      "pos": [
        692,
        700
      ]
    },
    {
      "content": "Description",
      "pos": [
        704,
        715
      ]
    },
    {
      "content": "DestinationPath",
      "pos": [
        731,
        746
      ]
    },
    {
      "content": "Specifies the location where you want to ensure the state for a file or directory.",
      "pos": [
        748,
        830
      ]
    },
    {
      "content": "SourcePath",
      "pos": [
        835,
        845
      ]
    },
    {
      "content": "Specifies the path from which to copy the file or folder resource.",
      "pos": [
        847,
        913
      ]
    },
    {
      "content": "This path may be a local path, or an <ph id=\"ph1\">`http/https/ftp`</ph> URL.",
      "pos": [
        914,
        972
      ]
    },
    {
      "content": "Remote <ph id=\"ph1\">`http/https/ftp`</ph> URLs are only supported when the value of the <bpt id=\"p1\">**</bpt>Type<ept id=\"p1\">**</ept> property is file.",
      "pos": [
        973,
        1069
      ]
    },
    {
      "content": "Ensure",
      "pos": [
        1074,
        1080
      ]
    },
    {
      "content": "Determines whether to check if the file exists.",
      "pos": [
        1082,
        1129
      ]
    },
    {
      "content": "Set this property to \"Present\" to ensure the file exists.",
      "pos": [
        1130,
        1187
      ]
    },
    {
      "content": "Set it to \"Absent\" to ensure the file does not exist.",
      "pos": [
        1188,
        1241
      ]
    },
    {
      "content": "The default value is \"Present\".",
      "pos": [
        1242,
        1273
      ]
    },
    {
      "content": "Type",
      "pos": [
        1278,
        1282
      ]
    },
    {
      "content": "Specifies whether the resource being configured is a directory or a file.",
      "pos": [
        1284,
        1357
      ]
    },
    {
      "content": "Set this property to \"directory\" to indicate that the resource is a directory.",
      "pos": [
        1358,
        1436
      ]
    },
    {
      "content": "Set it to \"file\" to indicate that the resource is a file.",
      "pos": [
        1437,
        1494
      ]
    },
    {
      "content": "The default value is \"file\"",
      "pos": [
        1495,
        1522
      ]
    },
    {
      "content": "Contents",
      "pos": [
        1527,
        1535
      ]
    },
    {
      "content": "Specifies the contents of a file, such as a particular string.",
      "pos": [
        1537,
        1599
      ]
    },
    {
      "content": "Checksum",
      "pos": [
        1604,
        1612
      ]
    },
    {
      "content": "Defines the type to use when determining whether two files are the same.",
      "pos": [
        1614,
        1686
      ]
    },
    {
      "content": "If <bpt id=\"p1\">**</bpt>Checksum<ept id=\"p1\">**</ept> is not specified, only the file or directory name is used for comparison.",
      "pos": [
        1687,
        1776
      ]
    },
    {
      "content": "Values are: \"ctime\", \"mtime\", or \"md5\".",
      "pos": [
        1777,
        1816
      ]
    },
    {
      "content": "Recurse",
      "pos": [
        1821,
        1828
      ]
    },
    {
      "content": "Indicates if subdirectories are included.",
      "pos": [
        1830,
        1871
      ]
    },
    {
      "content": "Set this property to <bpt id=\"p1\">**</bpt>$true<ept id=\"p1\">**</ept> to indicate that you want subdirectories to be included.",
      "pos": [
        1872,
        1959
      ]
    },
    {
      "content": "The default is <bpt id=\"p1\">**</bpt>$false<ept id=\"p1\">**</ept>.",
      "pos": [
        1960,
        1986
      ]
    },
    {
      "content": "<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept> This property is only valid when the <bpt id=\"p2\">**</bpt>Type<ept id=\"p2\">**</ept> property is set to directory.",
      "pos": [
        1987,
        2072
      ]
    },
    {
      "content": "Force",
      "pos": [
        2077,
        2082
      ]
    },
    {
      "content": "Certain file operations (such as overwriting a file or deleting a directory that is not empty) will result in an error.",
      "pos": [
        2084,
        2203
      ]
    },
    {
      "content": "Using the <bpt id=\"p1\">**</bpt>Force<ept id=\"p1\">**</ept> property overrides such errors.",
      "pos": [
        2204,
        2255
      ]
    },
    {
      "content": "The default value is <bpt id=\"p1\">**</bpt>$false<ept id=\"p1\">**</ept>.",
      "pos": [
        2256,
        2288
      ]
    },
    {
      "content": "Links",
      "pos": [
        2293,
        2298
      ]
    },
    {
      "content": "Specifies the desired behavior for symbolic links.",
      "pos": [
        2300,
        2350
      ]
    },
    {
      "content": "Set this property to \"follow\" to follow symbolic links and act on the links target (for example.",
      "pos": [
        2351,
        2447
      ]
    },
    {
      "content": "copy the file instead of the link).",
      "pos": [
        2448,
        2483
      ]
    },
    {
      "content": "Set this property to \"manage\" to act on the link (for example.",
      "pos": [
        2484,
        2546
      ]
    },
    {
      "content": "copy the link itself).",
      "pos": [
        2547,
        2569
      ]
    },
    {
      "content": "Set this property to \"ignore\" to ignore symbolic links.",
      "pos": [
        2570,
        2625
      ]
    },
    {
      "content": "Group",
      "pos": [
        2630,
        2635
      ]
    },
    {
      "pos": [
        2637,
        2692
      ],
      "content": "The name of the <bpt id=\"p1\">**</bpt>Group<ept id=\"p1\">**</ept> to own the file or directory."
    },
    {
      "content": "Mode",
      "pos": [
        2697,
        2701
      ]
    },
    {
      "content": "Specifies the desired permissions for the resource, in octal or symbolic notation.",
      "pos": [
        2703,
        2785
      ]
    },
    {
      "content": "(for example, 777 or rwxrwxrwx).",
      "pos": [
        2786,
        2818
      ]
    },
    {
      "content": "If using symbolic notation, do not provide the first character which indicates directory or file.",
      "pos": [
        2819,
        2916
      ]
    },
    {
      "content": "DependsOn",
      "pos": [
        2921,
        2930
      ]
    },
    {
      "content": "Indicates that the configuration of another resource must run before this resource is configured.",
      "pos": [
        2933,
        3030
      ]
    },
    {
      "content": "For example, if the <bpt id=\"p1\">**</bpt>ID<ept id=\"p1\">**</ept> of the resource configuration script block that you want to run first is <bpt id=\"p2\">**</bpt>ResourceName<ept id=\"p2\">**</ept> and its type is <bpt id=\"p3\">**</bpt>ResourceType<ept id=\"p3\">**</ept>, the syntax for using this property is <ph id=\"ph1\">`DependsOn = \"[ResourceType]ResourceName\"`</ph>.",
      "pos": [
        3031,
        3263
      ]
    },
    {
      "content": "Additional Information",
      "pos": [
        3270,
        3292
      ]
    },
    {
      "content": "Linux and Windows use different line break characters in text files by default, and this can cause unexpected results when configuring some files on a Linux computer with <bpt id=\"p1\">__</bpt>nxFile<ept id=\"p1\">__</ept>.",
      "pos": [
        3295,
        3477
      ]
    },
    {
      "content": "There are multiple ways to manage the content of a Linux file while avoiding issues caused by unexpected line break characters:",
      "pos": [
        3478,
        3605
      ]
    },
    {
      "content": "Step 1: Copy the file from a remote source (http, https, or ftp): create a file on Linux with the desired contents, and stage it on a web or ftp server accessible the node(s) you will configure.",
      "pos": [
        3607,
        3801
      ]
    },
    {
      "content": "Define the <bpt id=\"p1\">__</bpt>SourcePath<ept id=\"p1\">__</ept> property in the <bpt id=\"p2\">__</bpt>nxFile<ept id=\"p2\">__</ept> resource with the web or ftp URL to the file.",
      "pos": [
        3802,
        3900
      ]
    },
    {
      "pos": [
        4133,
        4341
      ],
      "content": "Step 2: Read the file contents in the PowerShell script with <bpt id=\"p1\">[</bpt>Get-Content<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/hh849787.aspx)</ept> after setting the <bpt id=\"p2\">__</bpt>$OFS<ept id=\"p2\">__</ept> property to use the Linux line-break character."
    },
    {
      "content": "Step 3: Use a PowerShell function to replace Windows line breaks with Linux line-break characters.",
      "pos": [
        4590,
        4688
      ]
    },
    {
      "content": "Example",
      "pos": [
        5128,
        5135
      ]
    },
    {
      "pos": [
        5137,
        5269
      ],
      "content": "The following example ensures that the directory <ph id=\"ph1\">`/opt/mydir`</ph> exists, and that a file with specified contents exists this directory."
    }
  ],
  "content": "# DSC for Linux nxFile Resource\n\nThe **nxFile** resource in PowerShell Desired State Configuration (DSC) provides a mechanism to to manage files and directories on a Linux node.\n\n## Syntax\n\n```\nnxFile <string> #ResourceName\n{\n    DestinationPath = <string>\n    [ SourcePath = <string> ]\n    [ Ensure = <string> { Absent | Present }  ]\n    [ Type = <string> { directory | file | link } ]\n    [ Contents = <string> ]\n    [ Checksum = <string> { ctime | mtime | md5 }  ]\n    [ Recurse = <bool> ]\n    [ Force = <bool> ]\n    [ Links = <string> { follow | manage } ]\n    [ Group = <string> ]\n    [ Mode = <string> ]\n    [ Owner = <string> ]\n    [ DependsOn = <string[]> ]\n\n}\n```\n\n## Properties\n\n|  Property |  Description | \n|---|---|\n| DestinationPath| Specifies the location where you want to ensure the state for a file or directory.| \n| SourcePath| Specifies the path from which to copy the file or folder resource. This path may be a local path, or an `http/https/ftp` URL. Remote `http/https/ftp` URLs are only supported when the value of the **Type** property is file.| \n| Ensure| Determines whether to check if the file exists. Set this property to \"Present\" to ensure the file exists. Set it to \"Absent\" to ensure the file does not exist. The default value is \"Present\".| \n| Type| Specifies whether the resource being configured is a directory or a file. Set this property to \"directory\" to indicate that the resource is a directory. Set it to \"file\" to indicate that the resource is a file. The default value is \"file\"| \n| Contents| Specifies the contents of a file, such as a particular string.| \n| Checksum| Defines the type to use when determining whether two files are the same. If **Checksum** is not specified, only the file or directory name is used for comparison. Values are: \"ctime\", \"mtime\", or \"md5\".| \n| Recurse| Indicates if subdirectories are included. Set this property to **$true** to indicate that you want subdirectories to be included. The default is **$false**. **Note:** This property is only valid when the **Type** property is set to directory.| \n| Force| Certain file operations (such as overwriting a file or deleting a directory that is not empty) will result in an error. Using the **Force** property overrides such errors. The default value is **$false**.| \n| Links| Specifies the desired behavior for symbolic links. Set this property to \"follow\" to follow symbolic links and act on the links target (for example. copy the file instead of the link). Set this property to \"manage\" to act on the link (for example. copy the link itself). Set this property to \"ignore\" to ignore symbolic links.| \n| Group| The name of the **Group** to own the file or directory.| \n| Mode| Specifies the desired permissions for the resource, in octal or symbolic notation. (for example, 777 or rwxrwxrwx). If using symbolic notation, do not provide the first character which indicates directory or file.| \n| DependsOn | Indicates that the configuration of another resource must run before this resource is configured. For example, if the **ID** of the resource configuration script block that you want to run first is **ResourceName** and its type is **ResourceType**, the syntax for using this property is `DependsOn = \"[ResourceType]ResourceName\"`.| \n\n## Additional Information\n\n\nLinux and Windows use different line break characters in text files by default, and this can cause unexpected results when configuring some files on a Linux computer with __nxFile__. There are multiple ways to manage the content of a Linux file while avoiding issues caused by unexpected line break characters:\n\nStep 1: Copy the file from a remote source (http, https, or ftp): create a file on Linux with the desired contents, and stage it on a web or ftp server accessible the node(s) you will configure. Define the __SourcePath__ property in the __nxFile__ resource with the web or ftp URL to the file.\n\n```\nImport-DSCResource -Module nx\nNode $Node\n{\nnxFile resolvConf\n{\n    SourcePath = \"http://10.185.85.11/conf/resolv.conf\"\n    DestinationPath = \"/etc/resolv.conf\"\n    Mode = \"644\"        \n    Type = \"file\"\n    \n}\n        \n}\n```\n\n\nStep 2: Read the file contents in the PowerShell script with [Get-Content](https://technet.microsoft.com/en-us/library/hh849787.aspx) after setting the __$OFS__ property to use the Linux line-break character.\n\n\n```\nImport-DSCResource -Module nx\nNode $Node\n{\n$OFS = \"`n\"\n$Contents = Get-Content C:\\temp\\resolv.conf\n\nnxFile resolvConf\n{\n    DestinationPath = \"/etc/resolv.conf\"\n    Mode = \"644\"        \n    Type = \"file\"\n    Contents = \"$Contents\"\n}\n\n}\n```\n\n\nStep 3: Use a PowerShell function to replace Windows line breaks with Linux line-break characters.\n\n```\nFunction LinuxString($inputStr){\n    $outputStr = $inputStr.Replace(\"`r`n\",\"`n\")\n    $ouputStr += \"`n\"\n    Return $outputStr\n}\n\nImport-DSCResource -Module nx\nNode $Node\n{\n\n$Contents = @'\nsearch contoso.com\ndomain contoso.com\nnameserver 10.185.85.11\n'@\n\n$Contents = LinuxString $Contents\n\nnxFile resolvConf\n{\n    DestinationPath = \"/etc/resolv.conf\"\n    Mode = \"644\"        \n    Type = \"file\"\n    Contents = $Contents\n    \n}\n}\n```\n\n## Example\n\nThe following example ensures that the directory `/opt/mydir` exists, and that a file with specified contents exists this directory.\n\n```\nImport-DSCResource -Module nx \n\nNode $node {\nnxFile DirectoryExample\n{\n   Ensure = \"Present\"\n   DestinationPath = \"/opt/mydir\"\n   Type = \"Directory\"\n}\n\nnxFile FileExample\n{\n    Ensure = \"Present\"\n    Destinationpath = \"/opt/mydir/myfile\"\n    Contents=@\"\n#!/bin/bash`necho \"hello world\"`n\n\"@ \n    Mode = “755”\n    DependsOn = \"[nxFile]DirectoryExample\"\n} \n}\n```\n\n"
}