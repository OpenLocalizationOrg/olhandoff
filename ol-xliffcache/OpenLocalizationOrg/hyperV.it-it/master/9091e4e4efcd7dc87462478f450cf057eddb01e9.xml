{"nodes":[{"content":"Azure Backup for SQL Server workloads using DPM | Microsoft Azure","pos":[27,92]},{"content":"An introduction to backing up SQL Server databases using the Azure Backup service","pos":[111,192]},{"content":"Azure Backup for SQL Server workloads using DPM","pos":[515,562]},{"content":"This article will lead you through the configuration steps for backup of SQL Server databases using Azure Backup.","pos":[564,677]},{"content":"To back up SQL Server databases to Azure you need an Azure account.","pos":[679,746]},{"content":"If you don’t have an account, you can create a free trial account in just couple of minutes.","pos":[747,839]},{"content":"For details, see <bpt id=\"p1\">[</bpt>Azure Free Trial<ept id=\"p1\">](https://azure.microsoft.com/pricing/free-trial/)</ept>","pos":[840,924]},{"content":"The management of SQL Server database backup to Azure and recovery from Azure involves three steps:","pos":[927,1026]},{"content":"Create a backup policy to protect SQL Server databases to Azure.","pos":[1031,1095]},{"content":"Create on-demand backup copies to Azure.","pos":[1099,1139]},{"content":"Recover the database from Azure.","pos":[1143,1175]},{"content":"Before you start","pos":[1180,1196]},{"content":"Before you begin, ensure that all the <bpt id=\"p1\">[</bpt>prerequisites<ept id=\"p1\">](../backup-azure-dpm-introduction/#prerequisites)</ept> for using Microsoft Azure Backup to protect workloads have been met.","pos":[1197,1368]},{"content":"The prerequisites cover tasks such as creating a backup vault, downloading vault credentials, installing the Azure Backup Agent and registering the server with the vault.","pos":[1369,1539]},{"content":"Create a backup policy to protect SQL Server databases to Azure","pos":[1544,1607]},{"content":"In the DPM server, configure a new backup policy for SQL Server databases by creating a new <bpt id=\"p1\">**</bpt>Protection Group<ept id=\"p1\">**</ept>.","pos":[1612,1725]},{"content":"Click the <bpt id=\"p1\">**</bpt>Protection<ept id=\"p1\">**</ept> workspace.","pos":[1726,1761]},{"pos":[1766,1813],"content":"Click <bpt id=\"p1\">**</bpt>New<ept id=\"p1\">**</ept> to create a new protection group."},{"content":"Create Protection Group","pos":[1821,1844]},{"content":"DPM shows the start screen with the guidance on creating a <bpt id=\"p1\">**</bpt>Protection Group<ept id=\"p1\">**</ept>.","pos":[1904,1984]},{"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>","pos":[1985,1999]},{"pos":[2005,2023],"content":"Select <bpt id=\"p1\">**</bpt>Servers<ept id=\"p1\">**</ept>"},{"content":"Select Protection Group Type - 'Servers'","pos":[2032,2072]},{"content":"Expand the SQL Server machine where the databases to be backed up are present.","pos":[2126,2204]},{"content":"DPM shows various data sources that can be backed up from that server.","pos":[2205,2275]},{"content":"Expand the <bpt id=\"p1\">**</bpt>All SQL Shares<ept id=\"p1\">**</ept> and select the databases (in this case we selected ReportServer$MSDPM2012 and ReportServer$MSDPM2012TempDB) to be backed up.","pos":[2276,2430]},{"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>","pos":[2431,2445]},{"content":"You will find a screen similar to the one below.","pos":[2452,2500]},{"content":"Select SQL DB","pos":[2508,2521]},{"content":"Provide name for the protection group you are going to create.","pos":[2577,2639]},{"content":"Make sure you select the  “<bpt id=\"p1\">**</bpt>I want online Protection<ept id=\"p1\">**</ept>” option.","pos":[2640,2704]},{"content":"Data Protection Method - short term disk &amp; Online Azure","pos":[2712,2767]},{"pos":[2818,2923],"content":"In the <bpt id=\"p1\">**</bpt>Specify Short-Term Goals<ept id=\"p1\">**</ept> screen, include the necessary inputs to create backup points to disk."},{"content":"Here we see that <bpt id=\"p1\">**</bpt>Retention range<ept id=\"p1\">**</ept> is set to <bpt id=\"p2\">*</bpt>5 days<ept id=\"p2\">*</ept>, <bpt id=\"p3\">**</bpt>Synchronization frequency<ept id=\"p3\">**</ept> is set to once every <bpt id=\"p4\">*</bpt>15 minutes<ept id=\"p4\">*</ept> which is the frequency at which backup is taken.","pos":[2929,3098]},{"content":"<bpt id=\"p1\">**</bpt>Express Full Backup<ept id=\"p1\">**</ept> is set to <bpt id=\"p2\">*</bpt>8:00 P.M<ept id=\"p2\">*</ept>","pos":[3099,3143]},{"content":"Short term goals","pos":[3152,3168]},{"content":"At 8:00 PM (according to the screen input ) a backup point is created every day by transferring the data that has been modified from the previous day’s 8:00 PM backup point.","pos":[3239,3412]},{"content":"This process is called <bpt id=\"p1\">**</bpt>Express Full Backup<ept id=\"p1\">**</ept>.","pos":[3413,3460]},{"content":"While the transaction logs are synchronized every 15 minutes, if there is a need to recover the database at 9:00 PM – then the point is created by replaying the logs from the last express full backup point (8pm in this case).","pos":[3461,3686]},{"pos":[3691,3705],"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>"},{"content":"DPM shows the overall storage space available and the potential disk space utilization.","pos":[3711,3798]},{"content":"Disk allocation","pos":[3806,3821]},{"content":"DPM creates one volume per data source (SQL Server database) for creating initial backup copy.","pos":[3876,3970]},{"content":"With this approach, the Logical Disk Manager (LDM) limits DPM to protect up to 300 data sources (SQL Server databases) only.","pos":[3971,4095]},{"content":"In order to avoid this DPM has implemented another approach which uses a single volume for multiple data sources.","pos":[4096,4209]},{"content":"This is enabled using the <bpt id=\"p1\">**</bpt>Co-locate data in DPM Storage Pool<ept id=\"p1\">**</ept>.","pos":[4210,4275]},{"content":"With this approach DPM can protect up to 2000 SQL databases.","pos":[4276,4336]},{"content":"DPM can account for the backup volume increase as the production data grows, if <bpt id=\"p1\">**</bpt>Automatically grow the volumes<ept id=\"p1\">**</ept> is selected.","pos":[4342,4469]},{"content":"If you uncheck <bpt id=\"p1\">**</bpt>Automatically grow the volumes<ept id=\"p1\">**</ept>, it will limit the backup storage used to back up the data sources in the protection group.","pos":[4470,4611]},{"content":"Administrators are given the choice of transferring this initial backup manually (off network) to avoid bandwidth congestion or over the network.","pos":[4616,4761]},{"content":"They can also configure the time at which the initial transfer can happen.","pos":[4762,4836]},{"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>","pos":[4837,4851]},{"content":"Initial replication method","pos":[4860,4886]},{"content":"The initial backup copy requires transfer of the entire data source (SQL Server database) from production server (SQL Server machine) to the DPM server.","pos":[4940,5092]},{"content":"This data might at times be very large and transferring this over network might exceed bandwidth.","pos":[5093,5190]},{"content":"Hence, Admins are given a choice on whether they want to transfer this initial backup <bpt id=\"p1\">**</bpt>Manually<ept id=\"p1\">**</ept> to avoid bandwidth clogging or they want it to happen <bpt id=\"p2\">**</bpt>Automatically<ept id=\"p2\">**</ept> over the network.","pos":[5191,5379]},{"content":"Also, when Admins choose <bpt id=\"p1\">**</bpt>Network<ept id=\"p1\">**</ept> they are given a choice of whether to create initial backup copy <bpt id=\"p2\">**</bpt>Now<ept id=\"p2\">**</ept> or <bpt id=\"p3\">**</bpt>Later<ept id=\"p3\">**</ept>, at a specified time.","pos":[5380,5524]},{"content":"Once the initial backup is complete, the remainder of the backups are incremental backups on top of initial backup copy which in general are very small and get transferred on the network.","pos":[5530,5717]},{"pos":[5723,5791],"content":"Choose when you want the consistency check to run and click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>"},{"content":"Consistency check","pos":[5800,5817]},{"content":"DPM can perform a consistency check to check the integrity of the backup point.","pos":[5875,5954]},{"content":"It calculates the checksum of the backup file on the production server (SQL Server machine in this scenario) and the backed up data for that file at DPM.","pos":[5955,6108]},{"content":"In the case of a conflict it is assumed that the backed up file at DPM is corrupt.","pos":[6109,6191]},{"content":"DPM rectifies the backed up data by sending the blocks corresponding to the checksum mismatch.","pos":[6192,6286]},{"content":"As the consistency check is a performance intensive operation, administrators are provided with the option of scheduling it or running it automatically.","pos":[6287,6439]},{"pos":[6445,6558],"content":"To specify online protection of the datasources, select the databases to be protected to Azure and click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>"},{"content":"Select datasources","pos":[6567,6585]},{"content":"Administrators can choose backup schedules and retention policies that suit their organization policies.","pos":[6645,6749]},{"content":"Schedule and Retention","pos":[6757,6779]},{"content":"In this example, backups are taken once a day at 12:00 PM and 8 PM (bottom part of the screen)","pos":[6835,6929]},{"content":"It’s a good practice to have a few recovery points for short term on disk for quick recovery.","pos":[6949,7042]},{"content":"This is called “operational recovery”.","pos":[7043,7081]},{"content":"Azure serves as a good offsite location with higher SLAs and guaranteed availability.","pos":[7082,7167]},{"content":"<bpt id=\"p1\">**</bpt>Best Practice<ept id=\"p1\">**</ept>: Make sure that Azure Backups are scheduled after the completion of local disk backups using DPM.","pos":[7173,7288]},{"content":"This enable the latest disk backup to be copied to Azure.","pos":[7289,7346]},{"content":"Choose the retention policy schedule.","pos":[7352,7389]},{"content":"The details on how the retention policy works are provided at <bpt id=\"p1\">[</bpt>Use Azure Backup to replace your tape infrastructure article<ept id=\"p1\">](backup-azure-backup-cloud-as-tape.md)</ept>","pos":[7390,7552]},{"content":"Retention Policy","pos":[7561,7577]},{"content":"In this example:","pos":[7642,7658]},{"content":"Backups are taken once a day at 12:00 PM and 8 PM (bottom part of the screen) and are retained for 180 days.","pos":[7666,7774]},{"content":"The backup on Saturday at 12:00 P.M.","pos":[7781,7817]},{"content":"is retained for 104 weeks","pos":[7818,7843]},{"content":"The backup on Last Saturday at 12:00 P.M.","pos":[7850,7891]},{"content":"is retained for 60 months","pos":[7892,7917]},{"content":"The backup on Last Saturday of March at 12:00 P.M.","pos":[7924,7974]},{"content":"is retained for 10 years","pos":[7975,7999]},{"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept> and select the appropriate option for transferring the initial backup copy to Azure.","pos":[8005,8104]},{"content":"You can choose <bpt id=\"p1\">**</bpt>Automatically over the network<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>Offline Backup<ept id=\"p2\">**</ept>","pos":[8105,8176]},{"pos":[8185,8297],"content":"<bpt id=\"p1\">**</bpt>Automatically over the network<ept id=\"p1\">**</ept> will transfer the backup data to Azure as per the schedule chosen for backup."},{"pos":[8304,8428],"content":"How <bpt id=\"p1\">**</bpt>Offline Backup<ept id=\"p1\">**</ept> works is explained at <bpt id=\"p2\">[</bpt>Offline Backup workflow in Azure Backup<ept id=\"p2\">](backup-azure-backup-import-export.md)</ept>"},{"pos":[8435,8533],"content":"Choose the relevant transfer mechanism to send the initial backup copy to Azure and click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>"},{"content":"Once you review the policy details in the <bpt id=\"p1\">**</bpt>Summary<ept id=\"p1\">**</ept> screen, click on the <bpt id=\"p2\">**</bpt>Create group<ept id=\"p2\">**</ept> button to complete the workflow.","pos":[8540,8664]},{"content":"You can click the <bpt id=\"p1\">**</bpt>Close<ept id=\"p1\">**</ept> button and monitor the job progress in Monitoring workspace.","pos":[8665,8753]},{"content":"Creation of Protection Group In-Progress","pos":[8761,8801]},{"content":"On demand backup of a SQL Server database","pos":[8855,8896]},{"content":"While the previous steps created a backup policy, a “recovery point” is created only when the first backup occurs.","pos":[8897,9011]},{"content":"Rather than waiting for the scheduler to kick in, the steps below will trigger the creation of a recovery point manually.","pos":[9012,9133]},{"pos":[9138,9242],"content":"Wait until the protection group status shows <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> for the database before creating the recovery point."},{"content":"Protection Group Members","pos":[9250,9274]},{"pos":[9341,9405],"content":"Right click on the database and select <bpt id=\"p1\">**</bpt>Create Recovery Point<ept id=\"p1\">**</ept>"},{"content":"Create Online Recovery Point","pos":[9414,9442]},{"content":"Choose <bpt id=\"p1\">**</bpt>Online Protection<ept id=\"p1\">**</ept> in the drop down and click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>.","pos":[9504,9567]},{"content":"This will start the creation of a recovery point in Azure.","pos":[9568,9626]},{"content":"Create recovery point","pos":[9634,9655]},{"pos":[9714,9856],"content":"You can view the job progress in the <bpt id=\"p1\">**</bpt>Monitoring<ept id=\"p1\">**</ept> workspace where you will find an in progress job like the one depicted in the next figure."},{"content":"Monitoring console","pos":[9864,9882]},{"content":"Recover a SQL Server database from Azure","pos":[9946,9986]},{"content":"The following steps are required to recover a protected entity (SQL Server database) from Azure.","pos":[9987,10083]},{"content":"Open the DPM server Management Console.","pos":[10088,10127]},{"content":"Navigate to <bpt id=\"p1\">**</bpt>Recovery<ept id=\"p1\">**</ept> workspace where you will be able to see the servers backed up by DPM.","pos":[10128,10222]},{"content":"Browse the required database (in this case ReportServer$MSDPM2012).","pos":[10223,10290]},{"content":"Select a <bpt id=\"p1\">**</bpt>Recovery from<ept id=\"p1\">**</ept> time which ends with <bpt id=\"p2\">**</bpt>Online<ept id=\"p2\">**</ept>","pos":[10291,10349]},{"content":"Select Recovery point","pos":[10358,10379]},{"pos":[10445,10496],"content":"Right click the database name and click <bpt id=\"p1\">**</bpt>Recover<ept id=\"p1\">**</ept>"},{"content":"Recover from Azure","pos":[10505,10523]},{"content":"DPM shows the details of the recovery point.","pos":[10584,10628]},{"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.","pos":[10629,10644]},{"content":"Select the recovery type <bpt id=\"p1\">**</bpt>Recover to original instance of SQL Server<ept id=\"p1\">**</ept>.","pos":[10645,10717]},{"content":"This will overwrite the database.","pos":[10718,10751]},{"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>","pos":[10752,10766]},{"content":"Recover to Original Location","pos":[10775,10803]},{"content":"In this example, DPM allows recovery of the database to another SQL Server instance or to a standalone network folder.","pos":[10873,10991]},{"content":"In the <bpt id=\"p1\">**</bpt>Specify Recovery options<ept id=\"p1\">**</ept> screen, you can select the recovery options like Network bandwidth usage throttling to throttle the bandwidth used by recovery.","pos":[10996,11159]},{"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>","pos":[11160,11174]},{"content":"In the <bpt id=\"p1\">**</bpt>Summary<ept id=\"p1\">**</ept> screen, you will see all the recovery configurations provided so far.","pos":[11180,11268]},{"content":"Click <bpt id=\"p1\">**</bpt>Recover<ept id=\"p1\">**</ept>","pos":[11269,11286]},{"content":"The Recovery status shows that the database being recovered.","pos":[11293,11353]},{"content":"You can click <bpt id=\"p1\">**</bpt>Close<ept id=\"p1\">**</ept> to close the wizard and view the progress in the <bpt id=\"p2\">**</bpt>Monitoring<ept id=\"p2\">**</ept> workspace.","pos":[11354,11452]},{"content":"Initiate recovery process","pos":[11460,11485]},{"content":"Once the recovery is completed, the database copy restored will be application consistent.","pos":[11551,11641]},{"content":"Next Steps:","pos":[11647,11658]},{"pos":[11660,11710],"content":"•   <bpt id=\"p1\">[</bpt>Azure Backup FAQ<ept id=\"p1\">](backup-azure-backup-faq.md)</ept>"}],"content":"<properties\n    pageTitle=\"Azure Backup for SQL Server workloads using DPM | Microsoft Azure\"\n    description=\"An introduction to backing up SQL Server databases using the Azure Backup service\"\n    services=\"backup\"\n    documentationCenter=\"\"\n    authors=\"giridharreddy\"\n    manager=\"shreeshd\"\n    editor=\"\"/>\n\n<tags\n    ms.service=\"backup\"\n    ms.workload=\"storage-backup-recovery\"\n    ms.tgt_pltfrm=\"na\"\n    ms.devlang=\"na\"\n    ms.topic=\"article\"\n    ms.date=\"02/08/2016\"\n    ms.author=\"giridham; jimpark;\"/>\n\n\n# Azure Backup for SQL Server workloads using DPM\n\nThis article will lead you through the configuration steps for backup of SQL Server databases using Azure Backup.\n\nTo back up SQL Server databases to Azure you need an Azure account. If you don’t have an account, you can create a free trial account in just couple of minutes. For details, see [Azure Free Trial](https://azure.microsoft.com/pricing/free-trial/).\n\nThe management of SQL Server database backup to Azure and recovery from Azure involves three steps:\n\n1. Create a backup policy to protect SQL Server databases to Azure.\n2. Create on-demand backup copies to Azure.\n3. Recover the database from Azure.\n\n## Before you start\nBefore you begin, ensure that all the [prerequisites](../backup-azure-dpm-introduction/#prerequisites) for using Microsoft Azure Backup to protect workloads have been met. The prerequisites cover tasks such as creating a backup vault, downloading vault credentials, installing the Azure Backup Agent and registering the server with the vault.\n\n## Create a backup policy to protect SQL Server databases to Azure\n\n1. In the DPM server, configure a new backup policy for SQL Server databases by creating a new **Protection Group**. Click the **Protection** workspace.\n\n2. Click **New** to create a new protection group.\n\n    ![Create Protection Group](./media/backup-azure-backup-sql/protection-group.png)\n\n3. DPM shows the start screen with the guidance on creating a **Protection Group**. Click **Next**.\n\n4. Select **Servers**.\n\n    ![Select Protection Group Type - 'Servers'](./media/backup-azure-backup-sql/pg-servers.png)\n\n5. Expand the SQL Server machine where the databases to be backed up are present. DPM shows various data sources that can be backed up from that server. Expand the **All SQL Shares** and select the databases (in this case we selected ReportServer$MSDPM2012 and ReportServer$MSDPM2012TempDB) to be backed up. Click **Next**.\n\n    You will find a screen similar to the one below.\n\n    ![Select SQL DB](./media/backup-azure-backup-sql/pg-databases.png)\n\n6. Provide name for the protection group you are going to create. Make sure you select the  “**I want online Protection**” option.\n\n    ![Data Protection Method - short term disk & Online Azure](./media/backup-azure-backup-sql/pg-name.png)\n\n7. In the **Specify Short-Term Goals** screen, include the necessary inputs to create backup points to disk.\n\n    Here we see that **Retention range** is set to *5 days*, **Synchronization frequency** is set to once every *15 minutes* which is the frequency at which backup is taken. **Express Full Backup** is set to *8:00 P.M*.\n\n    ![Short term goals](./media/backup-azure-backup-sql/pg-shortterm.png)\n\n    >[AZURE.NOTE] At 8:00 PM (according to the screen input ) a backup point is created every day by transferring the data that has been modified from the previous day’s 8:00 PM backup point. This process is called **Express Full Backup**. While the transaction logs are synchronized every 15 minutes, if there is a need to recover the database at 9:00 PM – then the point is created by replaying the logs from the last express full backup point (8pm in this case).\n\n8. Click **Next**\n\n    DPM shows the overall storage space available and the potential disk space utilization.\n\n    ![Disk allocation](./media/backup-azure-backup-sql/pg-storage.png)\n\n    DPM creates one volume per data source (SQL Server database) for creating initial backup copy. With this approach, the Logical Disk Manager (LDM) limits DPM to protect up to 300 data sources (SQL Server databases) only. In order to avoid this DPM has implemented another approach which uses a single volume for multiple data sources. This is enabled using the **Co-locate data in DPM Storage Pool**. With this approach DPM can protect up to 2000 SQL databases.\n\n    DPM can account for the backup volume increase as the production data grows, if **Automatically grow the volumes** is selected. If you uncheck **Automatically grow the volumes**, it will limit the backup storage used to back up the data sources in the protection group.\n\n9. Administrators are given the choice of transferring this initial backup manually (off network) to avoid bandwidth congestion or over the network. They can also configure the time at which the initial transfer can happen. Click **Next**.\n\n    ![Initial replication method](./media/backup-azure-backup-sql/pg-manual.png)\n\n    The initial backup copy requires transfer of the entire data source (SQL Server database) from production server (SQL Server machine) to the DPM server. This data might at times be very large and transferring this over network might exceed bandwidth. Hence, Admins are given a choice on whether they want to transfer this initial backup **Manually** to avoid bandwidth clogging or they want it to happen **Automatically** over the network. Also, when Admins choose **Network** they are given a choice of whether to create initial backup copy **Now** or **Later**, at a specified time.\n\n    Once the initial backup is complete, the remainder of the backups are incremental backups on top of initial backup copy which in general are very small and get transferred on the network.\n\n10. Choose when you want the consistency check to run and click **Next**.\n\n    ![Consistency check](./media/backup-azure-backup-sql/pg-consistent.png)\n\n    DPM can perform a consistency check to check the integrity of the backup point. It calculates the checksum of the backup file on the production server (SQL Server machine in this scenario) and the backed up data for that file at DPM. In the case of a conflict it is assumed that the backed up file at DPM is corrupt. DPM rectifies the backed up data by sending the blocks corresponding to the checksum mismatch. As the consistency check is a performance intensive operation, administrators are provided with the option of scheduling it or running it automatically.\n\n11. To specify online protection of the datasources, select the databases to be protected to Azure and click **Next**.\n\n    ![Select datasources](./media/backup-azure-backup-sql/pg-sqldatabases.png)\n\n12. Administrators can choose backup schedules and retention policies that suit their organization policies.\n\n    ![Schedule and Retention](./media/backup-azure-backup-sql/pg-schedule.png)\n\n    In this example, backups are taken once a day at 12:00 PM and 8 PM (bottom part of the screen)\n\n    >[AZURE.NOTE] It’s a good practice to have a few recovery points for short term on disk for quick recovery. This is called “operational recovery”. Azure serves as a good offsite location with higher SLAs and guaranteed availability.\n\n    **Best Practice**: Make sure that Azure Backups are scheduled after the completion of local disk backups using DPM. This enable the latest disk backup to be copied to Azure.\n\n13. Choose the retention policy schedule. The details on how the retention policy works are provided at [Use Azure Backup to replace your tape infrastructure article](backup-azure-backup-cloud-as-tape.md).\n\n    ![Retention Policy](./media/backup-azure-backup-sql/pg-retentionschedule.png)\n\n    In this example:\n\n    - Backups are taken once a day at 12:00 PM and 8 PM (bottom part of the screen) and are retained for 180 days.\n    - The backup on Saturday at 12:00 P.M. is retained for 104 weeks\n    - The backup on Last Saturday at 12:00 P.M. is retained for 60 months\n    - The backup on Last Saturday of March at 12:00 P.M. is retained for 10 years\n\n14. Click **Next** and select the appropriate option for transferring the initial backup copy to Azure. You can choose **Automatically over the network** or **Offline Backup**.\n\n    - **Automatically over the network** will transfer the backup data to Azure as per the schedule chosen for backup.\n    - How **Offline Backup** works is explained at [Offline Backup workflow in Azure Backup](backup-azure-backup-import-export.md).\n\n    Choose the relevant transfer mechanism to send the initial backup copy to Azure and click **Next**.\n\n15. Once you review the policy details in the **Summary** screen, click on the **Create group** button to complete the workflow. You can click the **Close** button and monitor the job progress in Monitoring workspace.\n\n    ![Creation of Protection Group In-Progress](./media/backup-azure-backup-sql/pg-summary.png)\n\n## On demand backup of a SQL Server database\nWhile the previous steps created a backup policy, a “recovery point” is created only when the first backup occurs. Rather than waiting for the scheduler to kick in, the steps below will trigger the creation of a recovery point manually.\n\n1. Wait until the protection group status shows **OK** for the database before creating the recovery point.\n\n    ![Protection Group Members](./media/backup-azure-backup-sql/sqlbackup-recoverypoint.png)\n\n2. Right click on the database and select **Create Recovery Point**.\n\n    ![Create Online Recovery Point](./media/backup-azure-backup-sql/sqlbackup-createrp.png)\n\n3. Choose **Online Protection** in the drop down and click **OK**. This will start the creation of a recovery point in Azure.\n\n    ![Create recovery point](./media/backup-azure-backup-sql/sqlbackup-azure.png)\n\n4. You can view the job progress in the **Monitoring** workspace where you will find an in progress job like the one depicted in the next figure.\n\n    ![Monitoring console](./media/backup-azure-backup-sql/sqlbackup-monitoring.png)\n\n## Recover a SQL Server database from Azure\nThe following steps are required to recover a protected entity (SQL Server database) from Azure.\n\n1. Open the DPM server Management Console. Navigate to **Recovery** workspace where you will be able to see the servers backed up by DPM. Browse the required database (in this case ReportServer$MSDPM2012). Select a **Recovery from** time which ends with **Online**.\n\n    ![Select Recovery point](./media/backup-azure-backup-sql/sqlbackup-restorepoint.png)\n\n2. Right click the database name and click **Recover**.\n\n    ![Recover from Azure](./media/backup-azure-backup-sql/sqlbackup-recover.png)\n\n3. DPM shows the details of the recovery point. Click **Next**. Select the recovery type **Recover to original instance of SQL Server**. This will overwrite the database. Click **Next**.\n\n    ![Recover to Original Location](./media/backup-azure-backup-sql/sqlbackup-recoveroriginal.png)\n\n    In this example, DPM allows recovery of the database to another SQL Server instance or to a standalone network folder.\n\n4. In the **Specify Recovery options** screen, you can select the recovery options like Network bandwidth usage throttling to throttle the bandwidth used by recovery. Click **Next**.\n\n5. In the **Summary** screen, you will see all the recovery configurations provided so far. Click **Recover**.\n\n    The Recovery status shows that the database being recovered. You can click **Close** to close the wizard and view the progress in the **Monitoring** workspace.\n\n    ![Initiate recovery process](./media/backup-azure-backup-sql/sqlbackup-recoverying.png)\n\n    Once the recovery is completed, the database copy restored will be application consistent.\n\n### Next Steps:\n\n•   [Azure Backup FAQ](backup-azure-backup-faq.md)\n"}