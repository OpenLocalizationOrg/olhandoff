{"nodes":[{"content":"Learn how to store and retrieve local, roaming, and temporary app data.","pos":[34,105]},{"content":"Store and retrieve settings and other app data","pos":[113,159]},{"content":"Store and retrieve settings and other app data","pos":[266,312]},{"content":"<bpt id=\"p1\">*</bpt>App data<ept id=\"p1\">*</ept> is mutable data that is specific to a particular app.","pos":[318,382]},{"content":"It includes runtime state, user preferences, and other settings.","pos":[383,447]},{"content":"App data is different from <bpt id=\"p1\">*</bpt>user data<ept id=\"p1\">*</ept>, data that the user creates and manages when using an app.","pos":[448,545]},{"content":"User data includes document or media files, email or communication transcripts, or database records holding content created by the user.","pos":[546,682]},{"content":"User data may be useful or meaningful to more than one app.","pos":[683,742]},{"content":"Often, this is data that the user wants to manipulate or transmit as an entity independent of the app itself, such as a document.","pos":[743,872]},{"content":"<bpt id=\"p1\">**</bpt>Important note about app data:  <ept id=\"p1\">**</ept>The lifetime of the app data is tied to the lifetime of the app.","pos":[874,974]},{"content":"If the app is removed, all of the app data will be lost as a consequence.","pos":[975,1048]},{"content":"Don't use app data to store user data or anything that users might perceive as valuable and irreplaceable.","pos":[1049,1155]},{"content":"We recommend that the user's libraries and Microsoft OneDrive be used to store this sort of information.","pos":[1156,1260]},{"content":"App data is ideal for storing app-specific user preferences, settings, and favorites.","pos":[1261,1346]},{"pos":[1459,1476],"content":"Types of app data"},{"content":"There are two types of app data: settings and files.","pos":[1479,1531]},{"content":"Settings","pos":[1539,1547]},{"content":"Use settings to store user preferences and application state info.","pos":[1555,1621]},{"content":"The app data API enables you to easily create and retrieve settings (we'll show you some examples later in this article).","pos":[1622,1743]},{"content":"Here are data types you can use for app settings:","pos":[1749,1798]},{"pos":[1808,1910],"content":"<bpt id=\"p1\">**</bpt>UInt8<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>Int16<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>UInt16<ept id=\"p3\">**</ept>, <bpt id=\"p4\">**</bpt>Int32<ept id=\"p4\">**</ept>, <bpt id=\"p5\">**</bpt>UInt32<ept id=\"p5\">**</ept>, <bpt id=\"p6\">**</bpt>Int64<ept id=\"p6\">**</ept>, <bpt id=\"p7\">**</bpt>UInt64<ept id=\"p7\">**</ept>, <bpt id=\"p8\">**</bpt>Single<ept id=\"p8\">**</ept>, <bpt id=\"p9\">**</bpt>Double<ept id=\"p9\">**</ept>"},{"content":"Boolean","pos":[1921,1928]},{"pos":[1939,1961],"content":"<bpt id=\"p1\">**</bpt>Char16<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>String<ept id=\"p2\">**</ept>"},{"pos":[1970,2116],"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>DateTime<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br206576)</ept>, <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>TimeSpan<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br225996)</ept>"},{"pos":[2125,2344],"content":"<bpt id=\"p1\">**</bpt>GUID<ept id=\"p1\">**</ept>, <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>Point<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/br225870)</ept>, <bpt id=\"p4\">[</bpt><bpt id=\"p5\">**</bpt>Size<ept id=\"p5\">**</ept><ept id=\"p4\">](https://msdn.microsoft.com/library/windows/apps/br225995)</ept>, <bpt id=\"p6\">[</bpt><bpt id=\"p7\">**</bpt>Rect<ept id=\"p7\">**</ept><ept id=\"p6\">](https://msdn.microsoft.com/library/windows/apps/br225994)</ept>"},{"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ApplicationDataCompositeValue<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br241588)</ept>: A set of related app settings that must be serialized and deserialized atomically.","pos":[2353,2530]},{"content":"Use composite settings to easily handle atomic updates of interdependent settings.","pos":[2531,2613]},{"content":"The system ensures the integrity of composite settings during concurrent access and roaming.","pos":[2614,2706]},{"content":"Composite settings are optimized for small amounts of data, and performance can be poor if you use them for large data sets.","pos":[2707,2831]},{"content":"Files","pos":[2838,2843]},{"content":"Use files to store binary data or to enable your own, customized serialized types.","pos":[2851,2933]},{"pos":[3112,3151],"content":"Storing app data in the app data stores"},{"content":"When an app is installed, the system gives it its own per-user data stores for settings and files.","pos":[3154,3252]},{"content":"You don't need to know where or how this data exists, because the system is responsible for managing the physical storage, ensuring that the data is kept isolated from other apps and other users.","pos":[3253,3448]},{"content":"The system also preserves the contents of these data stores when the user installs an update to your app and removes the contents of these data stores completely and cleanly when your app is uninstalled.","pos":[3449,3652]},{"content":"Within its app data store, each app has system-defined root directories: one for local files, one for roaming files, and one for temporary files.","pos":[3654,3799]},{"content":"Your app can add new files and new containers to each of these root directories.","pos":[3800,3880]},{"pos":[3984,3998],"content":"Local app data"},{"content":"Local app data should be used for any information that needs to be preserved between app sessions and is not suitable for roaming app data.","pos":[4001,4140]},{"content":"Data that is not applicable on other devices should be stored here as well.","pos":[4141,4216]},{"content":"There is no general size restriction on local data stored.","pos":[4217,4275]},{"content":"Use the local app data store for data that it does not make sense to roam and for large data sets.","pos":[4276,4374]},{"pos":[4536,4569],"content":"Retrieve the local app data store"},{"content":"Before you can read or write local app data, you must retrieve the local app data store.","pos":[4571,4659]},{"content":"To retrieve the local app data store, use the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ApplicationData.LocalSettings<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br241622)</ept> property to get the app's local settings as an <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>ApplicationDataContainer<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br241599)</ept> object.","pos":[4660,4943]},{"content":"Use the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ApplicationData.LocalFolder<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br241621)</ept> property to get the files in a <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>StorageFolder<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br227230)</ept> object.","pos":[4944,5160]},{"content":"Use the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ApplicationData.LocalCacheFolder<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn633825)</ept> property to get the folder in the local app data store where you can save files that are not included in backup and restore.","pos":[5161,5390]},{"pos":[5813,5855],"content":"Create and retrieve a simple local setting"},{"content":"To create or write a setting, use the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ApplicationDataContainer.Values<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br241615)</ept> property to access the settings in the <ph id=\"ph1\">`localSettings`</ph> container we got in the previous step.","pos":[5857,6084]},{"content":"This example creates a setting named <ph id=\"ph1\">`exampleSetting`</ph>.","pos":[6085,6139]},{"content":"To retrieve the setting, you use the same <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ApplicationDataContainer.Values<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br241615)</ept> property that you used to create the setting.","pos":[6233,6416]},{"content":"This example shows how to retrieve the setting we just created.","pos":[6417,6480]},{"pos":[6760,6803],"content":"Create and retrieve a local composite value"},{"content":"To create or write a composite value, create an <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ApplicationDataCompositeValue<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br241588)</ept> object.","pos":[6805,6954]},{"content":"This example creates a composite setting named <ph id=\"ph1\">`exampleCompositeSetting`</ph> and adds it to the <ph id=\"ph2\">`localSettings`</ph> container.","pos":[6955,7073]},{"content":"This example shows how to retrieve the composite value we just created.","pos":[7347,7418]},{"pos":[7876,7904],"content":"Create and read a local file"},{"content":"To create and update a file in the local app data store, use the file APIs, such as <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Windows.Storage.StorageFolder.CreateFileAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br227249)</ept> and <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>Windows.Storage.FileIO.WriteTextAsync<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/hh701505)</ept>.","pos":[7906,8206]},{"content":"This example creates a file named <ph id=\"ph1\">`dataFile.txt`</ph> in the <ph id=\"ph2\">`localFolder`</ph> container and writes the current date and time to the file.","pos":[8207,8336]},{"content":"The <bpt id=\"p1\">**</bpt>ReplaceExisting<ept id=\"p1\">**</ept> value from the <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>CreationCollisionOption<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/br241631)</ept> enumeration indicates to replace the file if it already exists.","pos":[8337,8527]},{"content":"To open and read a file in the local app data store, use the file APIs, such as <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Windows.Storage.StorageFolder.GetFileAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br227272)</ept>, <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>Windows.Storage.StorageFile.GetFileFromApplicationUriAsync<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/hh701741)</ept>, and <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>Windows.Storage.FileIO.ReadTextAsync<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/hh701482)</ept>.","pos":[8937,9354]},{"content":"This example opens the <ph id=\"ph1\">`dataFile.txt`</ph> file created in the previous step and reads the date from the file.","pos":[9355,9460]},{"content":"For details on loading file resources from various locations, see <bpt id=\"p1\">[</bpt>How to load file resources<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/xaml/hh965322)</ept>.","pos":[9461,9619]},{"pos":[10024,10036],"content":"Roaming data"},{"content":"If you use roaming data in your app, your users can easily keep your app's app data in sync across multiple devices.","pos":[10039,10155]},{"content":"If a user installs your app on multiple devices, the OS keeps the app data in sync, reducing the amount of setup work that the user needs to do for your app on their second device.","pos":[10156,10336]},{"content":"Roaming also enables your users to continue a task, such as composing a list, right where they left off even on a different device.","pos":[10337,10468]},{"content":"The OS replicates roaming data to the cloud when it is updated, and synchronizes the data to the other devices on which the app is installed.","pos":[10469,10610]},{"content":"The OS limits the size of the app data that each app may roam.","pos":[10612,10674]},{"content":"See <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ApplicationData.RoamingStorageQuota<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br241625)</ept>.","pos":[10675,10779]},{"content":"If the app hits this limit, none of the app's app data will be replicated to the cloud until the app's total roamed app data is less than the limit again.","pos":[10780,10934]},{"content":"For this reason, it is a best practice to use roaming data only for user preferences, links, and small data files.","pos":[10935,11049]},{"content":"Roaming data for an app is available in the cloud as long as it is accessed by the user from some device within the required time interval.","pos":[11051,11190]},{"content":"If the user does not run an app for longer than this time interval, its roaming data is removed from the cloud.","pos":[11191,11302]},{"content":"If a user uninstalls an app, its roaming data isn't automatically removed from the cloud, it's preserved.","pos":[11303,11408]},{"content":"If the user reinstalls the app within the time interval, the roaming data is synchronized from the cloud.","pos":[11409,11514]},{"content":"Roaming data do's and don'ts","pos":[11520,11548]},{"content":"Use roaming for user preferences and customizations, links, and small data files.","pos":[11554,11635]},{"content":"For example, use roaming to preserve a user's background color preference across all devices.","pos":[11636,11729]},{"content":"Use roaming to let users continue a task across devices.","pos":[11734,11790]},{"content":"For example, roam app data like the contents of an drafted email or the most recently viewed page in a reader app.","pos":[11791,11905]},{"content":"Handle the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>DataChanged<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br241620)</ept> event by updating app data.","pos":[11910,12024]},{"content":"This event occurs when app data has just finished syncing from the cloud.","pos":[12025,12098]},{"content":"Roam references to content rather than raw data.","pos":[12103,12151]},{"content":"For example, roam a URL rather than the content of an online article.","pos":[12152,12221]},{"pos":[12226,12392],"content":"For important, time critical settings, use the <bpt id=\"p1\">*</bpt>HighPriority<ept id=\"p1\">*</ept> setting associated with <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>RoamingSettings<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/br241624)</ept>."},{"content":"Don't roam app data that is specific to a device.","pos":[12397,12446]},{"content":"Some info is only pertinent locally, such as a path name to a local file resource.","pos":[12447,12529]},{"content":"If you do decide to roam local information, make sure that the app can recover if the info isn't valid on the secondary device.","pos":[12530,12657]},{"content":"Don't roam large sets of app data.","pos":[12662,12696]},{"content":"There's a limit to the amount of app data an app may roam; use <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>RoamingStorageQuota<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br241625)</ept> property to get this maximum.","pos":[12697,12873]},{"content":"If an app hits this limit, no data can roam until the size of the app data store no longer exceeds the limit.","pos":[12874,12983]},{"content":"When you design your app, consider how to put a bound on larger data so as to not exceed the limit.","pos":[12984,13083]},{"content":"For example, if saving a game state requires 10KB each, the app might only allow the user store up to 10 games.","pos":[13084,13195]},{"content":"Don't use roaming for data that relies on instant syncing.","pos":[13200,13258]},{"content":"Windows doesn't guarantee an instant sync; roaming could be significantly delayed if a user is offline or on a high latency network.","pos":[13259,13391]},{"content":"Ensure that your UI doesn't depend on instant syncing.","pos":[13392,13446]},{"content":"Don't use roam frequently changing data.","pos":[13451,13491]},{"content":"For example, if your app tracks frequently changing info, such as the position in a song by second, don't store this as roaming app data.","pos":[13492,13629]},{"content":"Instead, pick a less frequent representation that still provides a good user experience, like the currently playing song.","pos":[13630,13751]},{"pos":[13880,13902],"content":"Roaming pre-requisites"},{"content":"Any user can benefit from roaming app data if they use a Microsoft account to log on to their device.","pos":[13904,14005]},{"content":"However, users and group policy administrators can switch off roaming app data on a device at any time.","pos":[14006,14109]},{"content":"If a user chooses not to use a Microsoft account or disables roaming data capabilities, she will still be able to use your app, but app data be local to each device.","pos":[14110,14275]},{"content":"Data stored in the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>PasswordVault<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br227081)</ept> will only transition if a user has made a device “trusted”.","pos":[14277,14433]},{"content":"If a device isn't trusted, data secured in this vault will not roam.","pos":[14434,14502]},{"pos":[14622,14641],"content":"Conflict resolution"},{"content":"Roaming app data is not intended for simultaneous use on more than one device at a time.","pos":[14643,14731]},{"content":"If a conflict arises during synchronization because a particular data unit was changed on two devices, the system will always favor the value that was written last.","pos":[14732,14896]},{"content":"This ensures that the app utilizes the most up-to-date information.","pos":[14897,14964]},{"content":"If the data unit is a setting composite, conflict resolution will still occur on the level of the setting unit, which means that the composite with the latest change will be synchronized.","pos":[14965,15152]},{"pos":[15269,15287],"content":"When to write data"},{"content":"Depending on the expected lifetime of the setting, data should be written at different times.","pos":[15289,15382]},{"content":"Infrequently or slowly changing app data should be written immediately.","pos":[15383,15454]},{"content":"However, app data that changes frequently should only be written periodically at regular intervals (such as once every 5 minutes), as well as when the app is suspended.","pos":[15455,15623]},{"content":"For example, a music app might write the “current song” settings whenever a new song starts to play, however, the actual position in the song should only be written on suspend.","pos":[15624,15800]},{"pos":[15941,15967],"content":"Excessive usage protection"},{"content":"The system has various protection mechanisms in place to avoid inappropriate use of resources.","pos":[15969,16063]},{"content":"If app data does not transition as expected, it is likely that the device has been temporarily restricted.","pos":[16064,16170]},{"content":"Waiting for some time will usually resolve this situation automatically and no action is required.","pos":[16171,16269]},{"pos":[16362,16372],"content":"Versioning"},{"content":"App data can utilize versioning to upgrade from one data structure to another.","pos":[16374,16452]},{"content":"The version number is different from the app version and can be set at will.","pos":[16453,16529]},{"content":"Although not enforced, it is highly recommended that you use increasing version numbers, since undesirable complications (including data loss)could occur if you try to transition to a lower data version number that represents newer data.","pos":[16530,16767]},{"content":"App data only roams between installed apps with the same version number.","pos":[16769,16841]},{"content":"For example, devices on version 2 will transition data between each other and devices on version 3 will do the same, but no roaming will occur between a device running version 2 and a device running version 3.","pos":[16842,17051]},{"content":"If you install a new app that utilized various version numbers on other devices, the newly installed app will sync the app data associated with the highest version number.","pos":[17052,17223]},{"pos":[17337,17354],"content":"Testing and tools"},{"content":"Developers can lock their device in order to trigger a synchronization of roaming app data.","pos":[17356,17447]},{"content":"If it seems that the app data does not transition within a certain time frame, please check the following items and make sure that:","pos":[17448,17579]},{"pos":[17585,17738],"content":"Your roaming data does not exceed the maximum size (see <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>RoamingStorageQuota<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br241625)</ept> for details)."},{"content":"Your files are closed and released properly.","pos":[17743,17787]},{"content":"There are at least two devices running the same version of the app.","pos":[17792,17859]},{"pos":[18097,18155],"content":"Register to receive notification when roaming data changes"},{"content":"To use roaming app data, you need to register for roaming data changes and retrieve the roaming data containers so you can read and write settings.","pos":[18157,18304]},{"content":"Register to receive notification when roaming data changes.","pos":[18310,18369]},{"content":"The <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>DataChanged<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br241620)</ept> event notifies you when roaming data changes.","pos":[18375,18500]},{"content":"This example sets <ph id=\"ph1\">`DataChangeHandler`</ph> as the handler for roaming data changes.","pos":[18501,18579]},{"content":"Get the containers for the app's settings and files.","pos":[18901,18953]},{"pos":[18959,19220],"content":"Use the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ApplicationData.RoamingSettings<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br241624)</ept> property to get the settings and the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>ApplicationData.RoamingFolder<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br241623)</ept> property to get the files."},{"pos":[19649,19685],"content":"Create and retrieve roaming settings"},{"content":"Use the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ApplicationDataContainer.Values<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br241615)</ept> property to access the settings in the <ph id=\"ph1\">`roamingSettings`</ph> container we got in the previous section.","pos":[19687,19889]},{"content":"This example creates a simple setting named <ph id=\"ph1\">`exampleSetting`</ph> and a composite value named <ph id=\"ph2\">`composite`</ph>.","pos":[19890,19991]},{"content":"This example retrieves the settings we just created.","pos":[20470,20522]},{"pos":[21074,21107],"content":"Create and retrieve roaming files"},{"content":"To create and update a file in the roaming app data store, use the file APIs, such as <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Windows.Storage.StorageFolder.CreateFileAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br227249)</ept> and <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>Windows.Storage.FileIO.WriteTextAsync<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/hh701505)</ept>.","pos":[21109,21411]},{"content":"This example creates a file named <ph id=\"ph1\">`dataFile.txt`</ph> in the <ph id=\"ph2\">`roamingFolder`</ph> container and writes the current date and time to the file.","pos":[21412,21543]},{"content":"The <bpt id=\"p1\">**</bpt>ReplaceExisting<ept id=\"p1\">**</ept> value from the <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>CreationCollisionOption<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/br241631)</ept> enumeration indicates to replace the file if it already exists.","pos":[21544,21734]},{"content":"To open and read a file in the roaming app data store, use the file APIs, such as <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Windows.Storage.StorageFolder.GetFileAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br227272)</ept>, <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>Windows.Storage.StorageFile.GetFileFromApplicationUriAsync<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/hh701741)</ept>, and <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>Windows.Storage.FileIO.ReadTextAsync<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/hh701482)</ept>.","pos":[22148,22567]},{"content":"This example opens the <ph id=\"ph1\">`dataFile.txt`</ph> file created in the previous section and reads the date from the file.","pos":[22568,22676]},{"content":"For details on loading file resources from various locations, see <bpt id=\"p1\">[</bpt>How to load file resources<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/xaml/hh965322)</ept>.","pos":[22677,22835]},{"pos":[23261,23279],"content":"Temporary app data"},{"content":"The temporary app data store works like a cache.","pos":[23282,23330]},{"content":"Its files do not roam and could be removed at any time.","pos":[23331,23386]},{"content":"The System Maintenance task can automatically delete data stored at this location at any time.","pos":[23387,23481]},{"content":"The user can also clear files from the temporary data store using Disk Cleanup.","pos":[23482,23561]},{"content":"Temporary app data can be used for storing temporary information during an app session.","pos":[23562,23649]},{"content":"There is no guarantee that this data will persist beyond the end of the app session as the system might reclaim the used space if needed.","pos":[23650,23787]},{"content":"The location is available via the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>temporaryFolder<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br241629)</ept> property.","pos":[23788,23911]},{"pos":[24085,24122],"content":"Retrieve the temporary data container"},{"content":"Use the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ApplicationData.TemporaryFolder<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br241629)</ept> property to get the files.","pos":[24124,24254]},{"content":"The next steps use the <ph id=\"ph1\">`temporaryFolder`</ph> variable from this step.","pos":[24255,24320]},{"pos":[24622,24653],"content":"Create and read temporary files"},{"content":"To create and update a file in the temporary app data store, use the file APIs, such as <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Windows.Storage.StorageFolder.CreateFileAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br227249)</ept> and <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>Windows.Storage.FileIO.WriteTextAsync<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/hh701505)</ept>.","pos":[24655,24959]},{"content":"This example creates a file named <ph id=\"ph1\">`dataFile.txt`</ph> in the <ph id=\"ph2\">`temporaryFolder`</ph> container and writes the current date and time to the file.","pos":[24960,25093]},{"content":"The <bpt id=\"p1\">**</bpt>ReplaceExisting<ept id=\"p1\">**</ept> value from the <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>CreationCollisionOption<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/br241631)</ept> enumeration indicates to replace the file if it already exists.","pos":[25094,25284]},{"content":"To open and read a file in the temporary app data store, use the file APIs, such as <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Windows.Storage.StorageFolder.GetFileAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br227272)</ept>, <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>Windows.Storage.StorageFile.GetFileFromApplicationUriAsync<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/hh701741)</ept>, and <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>Windows.Storage.FileIO.ReadTextAsync<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/hh701482)</ept>.","pos":[25871,26292]},{"content":"This example opens the <ph id=\"ph1\">`dataFile.txt`</ph> file created in the previous step and reads the date from the file.","pos":[26293,26398]},{"content":"For details on loading file resources from various locations, see <bpt id=\"p1\">[</bpt>How to load file resources<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/xaml/hh965322)</ept>.","pos":[26399,26557]},{"pos":[27029,27062],"content":"Organize app data with containers"},{"content":"To help you organize your app data settings and files, you create containers (represented by <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ApplicationDataContainer<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br241599)</ept> objects) instead of working directly with directories.","pos":[27065,27301]},{"content":"You can add containers to the local, roaming, and temporary app data stores.","pos":[27302,27378]},{"content":"Containers can be nested up to 32 levels deep.","pos":[27379,27425]},{"content":"To create a settings container, call the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ApplicationDataContainer.CreateContainer<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br241611)</ept> method.","pos":[27427,27580]},{"content":"This example creates a local settings container named <ph id=\"ph1\">`exampleContainer`</ph> and adds a setting named <ph id=\"ph2\">`exampleSetting`</ph>.","pos":[27581,27696]},{"content":"The <bpt id=\"p1\">**</bpt>Always<ept id=\"p1\">**</ept> value from the <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>ApplicationDataCreateDisposition<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/br241616)</ept> enumeration indicates that the container is created if it doesn't already exist.","pos":[27697,27904]},{"pos":[28653,28687],"content":"Delete app settings and containers"},{"content":"To delete a simple setting that your app no longer needs, use the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ApplicationDataContainerSettings.Remove<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br241608)</ept> method.","pos":[28690,28867]},{"content":"This example deletesthe <ph id=\"ph1\">`exampleSetting`</ph> local setting that we created earlier.","pos":[28868,28947]},{"content":"To delete a composite setting, use the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ApplicationDataCompositeValue.Remove<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br241597)</ept> method.","pos":[29257,29404]},{"content":"This example deletes the local <ph id=\"ph1\">`exampleCompositeSetting`</ph> composite setting we created in an earlier example.","pos":[29405,29513]},{"content":"To delete a container, call the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ApplicationDataContainer.DeleteContainer<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br241612)</ept> method.","pos":[29835,29979]},{"content":"This example deletes the local <ph id=\"ph1\">`exampleContainer`</ph> settings container we created earlier.","pos":[29980,30068]},{"pos":[30509,30533],"content":"Versioning your app data"},{"content":"You can optionally version the app data for your app.","pos":[30536,30589]},{"content":"This would enable you to create a future version of your app that changes the format of its app data without causing compatibility problems with the previous version of your app.","pos":[30590,30768]},{"content":"The app checks the version of the app data in the data store, and if the version is less than the version the app expects, the app should update the app data to the new format and update the version.","pos":[30769,30968]},{"content":"For more info, see the<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Application.Version<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br241630)</ept> property and the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>ApplicationData.SetVersionAsync<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/hh701429)</ept> method.","pos":[30969,31195]},{"content":"Related articles","pos":[31200,31216]},{"content":"Windows.Storage.ApplicationData","pos":[31223,31254]},{"content":"Windows.Storage.ApplicationData.RoamingSettings","pos":[31321,31368]},{"content":"Windows.Storage.ApplicationData.RoamingFolder","pos":[31435,31480]},{"content":"Windows.Storage.ApplicationData.RoamingStorageQuota","pos":[31547,31598]},{"content":"Windows.Storage.ApplicationDataCompositeValue","pos":[31665,31710]}],"content":"---\nauthor: mijacobs\nDescription: Learn how to store and retrieve local, roaming, and temporary app data.\ntitle: Store and retrieve settings and other app data\nms.assetid: 41676A02-325A-455E-8565-C9EC0BC3A8FE\nlabel: App settings and data\ntemplate: detail.hbs\n---\n\n# Store and retrieve settings and other app data\n\n\n\n\n\n*App data* is mutable data that is specific to a particular app. It includes runtime state, user preferences, and other settings. App data is different from *user data*, data that the user creates and manages when using an app. User data includes document or media files, email or communication transcripts, or database records holding content created by the user. User data may be useful or meaningful to more than one app. Often, this is data that the user wants to manipulate or transmit as an entity independent of the app itself, such as a document.\n\n**Important note about app data:  **The lifetime of the app data is tied to the lifetime of the app. If the app is removed, all of the app data will be lost as a consequence. Don't use app data to store user data or anything that users might perceive as valuable and irreplaceable. We recommend that the user's libraries and Microsoft OneDrive be used to store this sort of information. App data is ideal for storing app-specific user preferences, settings, and favorites.\n\n## <span id=\"Types_of_app_data\"></span><span id=\"types_of_app_data\"></span><span id=\"TYPES_OF_APP_DATA\"></span>Types of app data\n\n\nThere are two types of app data: settings and files.\n\n-   **Settings**\n\n    Use settings to store user preferences and application state info. The app data API enables you to easily create and retrieve settings (we'll show you some examples later in this article).\n\n    Here are data types you can use for app settings:\n\n    -   **UInt8**, **Int16**, **UInt16**, **Int32**, **UInt32**, **Int64**, **UInt64**, **Single**, **Double**\n    -   **Boolean**\n    -   **Char16**, **String**\n    -   [**DateTime**](https://msdn.microsoft.com/library/windows/apps/br206576), [**TimeSpan**](https://msdn.microsoft.com/library/windows/apps/br225996)\n    -   **GUID**, [**Point**](https://msdn.microsoft.com/library/windows/apps/br225870), [**Size**](https://msdn.microsoft.com/library/windows/apps/br225995), [**Rect**](https://msdn.microsoft.com/library/windows/apps/br225994)\n    -   [**ApplicationDataCompositeValue**](https://msdn.microsoft.com/library/windows/apps/br241588): A set of related app settings that must be serialized and deserialized atomically. Use composite settings to easily handle atomic updates of interdependent settings. The system ensures the integrity of composite settings during concurrent access and roaming. Composite settings are optimized for small amounts of data, and performance can be poor if you use them for large data sets.\n-   **Files**\n\n    Use files to store binary data or to enable your own, customized serialized types.\n\n## <span id=\"Storing_app_data_in_the_app_data_stores\"></span><span id=\"storing_app_data_in_the_app_data_stores\"></span><span id=\"STORING_APP_DATA_IN_THE_APP_DATA_STORES\"></span>Storing app data in the app data stores\n\n\nWhen an app is installed, the system gives it its own per-user data stores for settings and files. You don't need to know where or how this data exists, because the system is responsible for managing the physical storage, ensuring that the data is kept isolated from other apps and other users. The system also preserves the contents of these data stores when the user installs an update to your app and removes the contents of these data stores completely and cleanly when your app is uninstalled.\n\nWithin its app data store, each app has system-defined root directories: one for local files, one for roaming files, and one for temporary files. Your app can add new files and new containers to each of these root directories.\n\n## <span id=\"Local_app_data\"></span><span id=\"local_app_data\"></span><span id=\"LOCAL_APP_DATA\"></span>Local app data\n\n\nLocal app data should be used for any information that needs to be preserved between app sessions and is not suitable for roaming app data. Data that is not applicable on other devices should be stored here as well. There is no general size restriction on local data stored. Use the local app data store for data that it does not make sense to roam and for large data sets.\n\n### <span id=\"Retrieve_the_local_app_data_store\"></span><span id=\"retrieve_the_local_app_data_store\"></span><span id=\"RETRIEVE_THE_LOCAL_APP_DATA_STORE\"></span>Retrieve the local app data store\n\nBefore you can read or write local app data, you must retrieve the local app data store. To retrieve the local app data store, use the [**ApplicationData.LocalSettings**](https://msdn.microsoft.com/library/windows/apps/br241622) property to get the app's local settings as an [**ApplicationDataContainer**](https://msdn.microsoft.com/library/windows/apps/br241599) object. Use the [**ApplicationData.LocalFolder**](https://msdn.microsoft.com/library/windows/apps/br241621) property to get the files in a [**StorageFolder**](https://msdn.microsoft.com/library/windows/apps/br227230) object. Use the [**ApplicationData.LocalCacheFolder**](https://msdn.microsoft.com/library/windows/apps/dn633825) property to get the folder in the local app data store where you can save files that are not included in backup and restore.\n\n```CSharp\nWindows.Storage.ApplicationDataContainer localSettings = \n    Windows.Storage.ApplicationData.Current.LocalSettings;\nWindows.Storage.StorageFolder localFolder = \n    Windows.Storage.ApplicationData.Current.LocalFolder;\n```\n\n### <span id=\"Create_and_retrieve_a_simple_local_setting\"></span><span id=\"create_and_retrieve_a_simple_local_setting\"></span><span id=\"CREATE_AND_RETRIEVE_A_SIMPLE_LOCAL_SETTING\"></span>Create and retrieve a simple local setting\n\nTo create or write a setting, use the [**ApplicationDataContainer.Values**](https://msdn.microsoft.com/library/windows/apps/br241615) property to access the settings in the `localSettings` container we got in the previous step. This example creates a setting named `exampleSetting`.\n\n```CSharp\n// Simple setting\n\nlocalSettings.Values[\"exampleSetting\"] = \"Hello Windows\";\n```\n\nTo retrieve the setting, you use the same [**ApplicationDataContainer.Values**](https://msdn.microsoft.com/library/windows/apps/br241615) property that you used to create the setting. This example shows how to retrieve the setting we just created.\n\n```CSharp\n// Simple setting\nObject value = localSettings.Values[\"exampleSetting\"];\n```\n\n### <span id=\"Create_and_retrieve_a_local_composite_value\"></span><span id=\"create_and_retrieve_a_local_composite_value\"></span><span id=\"CREATE_AND_RETRIEVE_A_LOCAL_COMPOSITE_VALUE\"></span>Create and retrieve a local composite value\n\nTo create or write a composite value, create an [**ApplicationDataCompositeValue**](https://msdn.microsoft.com/library/windows/apps/br241588) object. This example creates a composite setting named `exampleCompositeSetting` and adds it to the `localSettings` container.\n\n```CSharp\n// Composite setting\n\nWindows.Storage.ApplicationDataCompositeValue composite = \n    new Windows.Storage.ApplicationDataCompositeValue();\ncomposite[\"intVal\"] = 1;\ncomposite[\"strVal\"] = \"string\";\n\nlocalSettings.Values[\"exampleCompositeSetting\"] = composite;\n```\n\nThis example shows how to retrieve the composite value we just created.\n\n```CSharp\n// Composite setting\n\nWindows.Storage.ApplicationDataCompositeValue composite = \n   (Windows.Storage.ApplicationDataCompositeValue)localSettings.Values[\"exampleCompositeSetting\"];\n\nif (composite == null)\n{\n   // No data\n}\nelse\n{\n   // Access data in composite[\"intVal\"] and composite[\"strVal\"]\n}\n```\n\n### <span id=\"Create_and_read_a_local_file\"></span><span id=\"create_and_read_a_local_file\"></span><span id=\"CREATE_AND_READ_A_LOCAL_FILE\"></span>Create and read a local file\n\nTo create and update a file in the local app data store, use the file APIs, such as [**Windows.Storage.StorageFolder.CreateFileAsync**](https://msdn.microsoft.com/library/windows/apps/br227249) and [**Windows.Storage.FileIO.WriteTextAsync**](https://msdn.microsoft.com/library/windows/apps/hh701505). This example creates a file named `dataFile.txt` in the `localFolder` container and writes the current date and time to the file. The **ReplaceExisting** value from the [**CreationCollisionOption**](https://msdn.microsoft.com/library/windows/apps/br241631) enumeration indicates to replace the file if it already exists.\n\n```CSharp\nasync void WriteTimestamp()\n{\n   Windows.Globalization.DateTimeFormatting.DateTimeFormatter formatter = \n       new Windows.Globalization.DatetimeFormatting.DateTimeFormatter(\"longtime\");\n\n   StorageFile sampleFile = await localFolder.CreateFileAsync(\"dataFile.txt\", \n       CreateCollisionOption.ReplaceExisting);\n   await FileIO.WriteTextAsync(sampleFile, formatter.Format(DateTime.Now));\n}\n```\n\nTo open and read a file in the local app data store, use the file APIs, such as [**Windows.Storage.StorageFolder.GetFileAsync**](https://msdn.microsoft.com/library/windows/apps/br227272), [**Windows.Storage.StorageFile.GetFileFromApplicationUriAsync**](https://msdn.microsoft.com/library/windows/apps/hh701741), and [**Windows.Storage.FileIO.ReadTextAsync**](https://msdn.microsoft.com/library/windows/apps/hh701482). This example opens the `dataFile.txt` file created in the previous step and reads the date from the file. For details on loading file resources from various locations, see [How to load file resources](https://msdn.microsoft.com/library/windows/apps/xaml/hh965322).\n\n```CSharp\nasync void ReadTimestamp()\n{\n   try\n   {\n      StorageFile sampleFile = await localFolder.GetFileAsync(\"dataFile.txt\");\n      String timestamp = await FileIO.ReadTextAsync(sampleFile);\n      // Data is contained in timestamp\n   }\n   catch (Exception)\n   {\n      // Timestamp not found\n   }\n}\n```\n\n## <span id=\"Roaming_data\"></span><span id=\"roaming_data\"></span><span id=\"ROAMING_DATA\"></span>Roaming data\n\n\nIf you use roaming data in your app, your users can easily keep your app's app data in sync across multiple devices. If a user installs your app on multiple devices, the OS keeps the app data in sync, reducing the amount of setup work that the user needs to do for your app on their second device. Roaming also enables your users to continue a task, such as composing a list, right where they left off even on a different device. The OS replicates roaming data to the cloud when it is updated, and synchronizes the data to the other devices on which the app is installed.\n\nThe OS limits the size of the app data that each app may roam. See [**ApplicationData.RoamingStorageQuota**](https://msdn.microsoft.com/library/windows/apps/br241625). If the app hits this limit, none of the app's app data will be replicated to the cloud until the app's total roamed app data is less than the limit again. For this reason, it is a best practice to use roaming data only for user preferences, links, and small data files.\n\nRoaming data for an app is available in the cloud as long as it is accessed by the user from some device within the required time interval. If the user does not run an app for longer than this time interval, its roaming data is removed from the cloud. If a user uninstalls an app, its roaming data isn't automatically removed from the cloud, it's preserved. If the user reinstalls the app within the time interval, the roaming data is synchronized from the cloud.\n\n### Roaming data do's and don'ts\n\n-   Use roaming for user preferences and customizations, links, and small data files. For example, use roaming to preserve a user's background color preference across all devices.\n-   Use roaming to let users continue a task across devices. For example, roam app data like the contents of an drafted email or the most recently viewed page in a reader app.\n-   Handle the [**DataChanged**](https://msdn.microsoft.com/library/windows/apps/br241620) event by updating app data. This event occurs when app data has just finished syncing from the cloud.\n-   Roam references to content rather than raw data. For example, roam a URL rather than the content of an online article.\n-   For important, time critical settings, use the *HighPriority* setting associated with [**RoamingSettings**](https://msdn.microsoft.com/library/windows/apps/br241624).\n-   Don't roam app data that is specific to a device. Some info is only pertinent locally, such as a path name to a local file resource. If you do decide to roam local information, make sure that the app can recover if the info isn't valid on the secondary device.\n-   Don't roam large sets of app data. There's a limit to the amount of app data an app may roam; use [**RoamingStorageQuota**](https://msdn.microsoft.com/library/windows/apps/br241625) property to get this maximum. If an app hits this limit, no data can roam until the size of the app data store no longer exceeds the limit. When you design your app, consider how to put a bound on larger data so as to not exceed the limit. For example, if saving a game state requires 10KB each, the app might only allow the user store up to 10 games.\n-   Don't use roaming for data that relies on instant syncing. Windows doesn't guarantee an instant sync; roaming could be significantly delayed if a user is offline or on a high latency network. Ensure that your UI doesn't depend on instant syncing.\n-   Don't use roam frequently changing data. For example, if your app tracks frequently changing info, such as the position in a song by second, don't store this as roaming app data. Instead, pick a less frequent representation that still provides a good user experience, like the currently playing song.\n\n### <span id=\"Roaming_pre-requisites\"></span><span id=\"roaming_pre-requisites\"></span><span id=\"ROAMING_PRE-REQUISITES\"></span>Roaming pre-requisites\n\nAny user can benefit from roaming app data if they use a Microsoft account to log on to their device. However, users and group policy administrators can switch off roaming app data on a device at any time. If a user chooses not to use a Microsoft account or disables roaming data capabilities, she will still be able to use your app, but app data be local to each device.\n\nData stored in the [**PasswordVault**](https://msdn.microsoft.com/library/windows/apps/br227081) will only transition if a user has made a device “trusted”. If a device isn't trusted, data secured in this vault will not roam.\n\n### <span id=\"Conflict_resolution\"></span><span id=\"conflict_resolution\"></span><span id=\"CONFLICT_RESOLUTION\"></span>Conflict resolution\n\nRoaming app data is not intended for simultaneous use on more than one device at a time. If a conflict arises during synchronization because a particular data unit was changed on two devices, the system will always favor the value that was written last. This ensures that the app utilizes the most up-to-date information. If the data unit is a setting composite, conflict resolution will still occur on the level of the setting unit, which means that the composite with the latest change will be synchronized.\n\n### <span id=\"When_to_write_data\"></span><span id=\"when_to_write_data\"></span><span id=\"WHEN_TO_WRITE_DATA\"></span>When to write data\n\nDepending on the expected lifetime of the setting, data should be written at different times. Infrequently or slowly changing app data should be written immediately. However, app data that changes frequently should only be written periodically at regular intervals (such as once every 5 minutes), as well as when the app is suspended. For example, a music app might write the “current song” settings whenever a new song starts to play, however, the actual position in the song should only be written on suspend.\n\n### <span id=\"Excessive_usage_protection\"></span><span id=\"excessive_usage_protection\"></span><span id=\"EXCESSIVE_USAGE_PROTECTION\"></span>Excessive usage protection\n\nThe system has various protection mechanisms in place to avoid inappropriate use of resources. If app data does not transition as expected, it is likely that the device has been temporarily restricted. Waiting for some time will usually resolve this situation automatically and no action is required.\n\n### <span id=\"Versioning\"></span><span id=\"versioning\"></span><span id=\"VERSIONING\"></span>Versioning\n\nApp data can utilize versioning to upgrade from one data structure to another. The version number is different from the app version and can be set at will. Although not enforced, it is highly recommended that you use increasing version numbers, since undesirable complications (including data loss)could occur if you try to transition to a lower data version number that represents newer data.\n\nApp data only roams between installed apps with the same version number. For example, devices on version 2 will transition data between each other and devices on version 3 will do the same, but no roaming will occur between a device running version 2 and a device running version 3. If you install a new app that utilized various version numbers on other devices, the newly installed app will sync the app data associated with the highest version number.\n\n### <span id=\"Testing_and_tools\"></span><span id=\"testing_and_tools\"></span><span id=\"TESTING_AND_TOOLS\"></span>Testing and tools\n\nDevelopers can lock their device in order to trigger a synchronization of roaming app data. If it seems that the app data does not transition within a certain time frame, please check the following items and make sure that:\n\n-   Your roaming data does not exceed the maximum size (see [**RoamingStorageQuota**](https://msdn.microsoft.com/library/windows/apps/br241625) for details).\n-   Your files are closed and released properly.\n-   There are at least two devices running the same version of the app.\n\n\n### <span id=\"Register_to_receive_notification_when_roaming_data_changes\"></span><span id=\"register_to_receive_notification_when_roaming_data_changes\"></span><span id=\"REGISTER_TO_RECEIVE_NOTIFICATION_WHEN_ROAMING_DATA_CHANGES\"></span>Register to receive notification when roaming data changes\n\nTo use roaming app data, you need to register for roaming data changes and retrieve the roaming data containers so you can read and write settings.\n\n1.  Register to receive notification when roaming data changes.\n\n    The [**DataChanged**](https://msdn.microsoft.com/library/windows/apps/br241620) event notifies you when roaming data changes. This example sets `DataChangeHandler` as the handler for roaming data changes.\n\n```    CSharp\nvoid InitHandlers()\n    {\n       Windows.Storage.ApplicationData.Current.DataChanged += \n          new TypedEventHandler<ApplicationData, object>(DataChangeHandler);\n    }\n\n    void DataChangeHandler(Windows.Storage.ApplicationData appData, object o)\n    {\n       // TODO: Refresh your data\n    }\n```\n\n2.  Get the containers for the app's settings and files.\n\n    Use the [**ApplicationData.RoamingSettings**](https://msdn.microsoft.com/library/windows/apps/br241624) property to get the settings and the [**ApplicationData.RoamingFolder**](https://msdn.microsoft.com/library/windows/apps/br241623) property to get the files.\n\n```    CSharp\nWindows.Storage.ApplicationDataContainer roamingSettings = \n        Windows.Storage.ApplicationData.Current.RoamingSettings;\n    Windows.Storage.StorageFolder roamingFolder = \n        Windows.Storage.ApplicationData.Current.RoamingFolder;\n```\n\n### <span id=\"Create_and_retrieve_roaming_settings\"></span><span id=\"create_and_retrieve_roaming_settings\"></span><span id=\"CREATE_AND_RETRIEVE_ROAMING_SETTINGS\"></span>Create and retrieve roaming settings\n\nUse the [**ApplicationDataContainer.Values**](https://msdn.microsoft.com/library/windows/apps/br241615) property to access the settings in the `roamingSettings` container we got in the previous section. This example creates a simple setting named `exampleSetting` and a composite value named `composite`.\n\n```CSharp\n// Simple setting\n\nroamingSettings.Values[\"exampleSetting\"] = \"Hello World\";\n// High Priority setting, for example, last page position in book reader app\nroamingSettings.values[\"HighPriority\"] = \"65\";\n\n// Composite setting\n\nWindows.Storage.ApplicationDataCompositeValue composite = \n    new Windows.Storage.ApplicationDataCompositeValue();\ncomposite[\"intVal\"] = 1;\ncomposite[\"strVal\"] = \"string\";\n\nroamingSettings.Values[\"exampleCompositeSetting\"] = composite;\n\n```\n\nThis example retrieves the settings we just created.\n\n```CSharp\n// Simple setting\n\nObject value = roamingSettings.Values[\"exampleSetting\"];\n\n// Composite setting\n\nWindows.Storage.ApplicationDataCompositeValue composite = \n   (Windows.Storage.ApplicationDataCompositeValue)roamingSettings.Values[\"exampleCompositeSetting\"];\n\nif (composite == null)\n{\n   // No data\n}\nelse\n{\n   // Access data in composite[\"intVal\"] and composite[\"strVal\"]\n}\n```\n\n### <span id=\"Create_and_retrieve_roaming_files\"></span><span id=\"create_and_retrieve_roaming_files\"></span><span id=\"CREATE_AND_RETRIEVE_ROAMING_FILES\"></span>Create and retrieve roaming files\n\nTo create and update a file in the roaming app data store, use the file APIs, such as [**Windows.Storage.StorageFolder.CreateFileAsync**](https://msdn.microsoft.com/library/windows/apps/br227249) and [**Windows.Storage.FileIO.WriteTextAsync**](https://msdn.microsoft.com/library/windows/apps/hh701505). This example creates a file named `dataFile.txt` in the `roamingFolder` container and writes the current date and time to the file. The **ReplaceExisting** value from the [**CreationCollisionOption**](https://msdn.microsoft.com/library/windows/apps/br241631) enumeration indicates to replace the file if it already exists.\n\n```CSharp\nasync void WriteTimestamp()\n{\n   Windows.Globalization.DateTimeFormatting.DateTimeFormatter formatter = \n       new Windows.Globalization.DatetimeFormatting.DateTimeFormatter(\"longtime\");\n\n   StorageFile sampleFile = await roamingFolder.CreateFileAsync(\"dataFile.txt\", \n       CreationCollisionOption.ReplaceExisting);\n   await FileIO.WriteTextAsync(sampleFile, formatter.Format(DateTime.Now));\n}\n```\n\nTo open and read a file in the roaming app data store, use the file APIs, such as [**Windows.Storage.StorageFolder.GetFileAsync**](https://msdn.microsoft.com/library/windows/apps/br227272), [**Windows.Storage.StorageFile.GetFileFromApplicationUriAsync**](https://msdn.microsoft.com/library/windows/apps/hh701741), and [**Windows.Storage.FileIO.ReadTextAsync**](https://msdn.microsoft.com/library/windows/apps/hh701482). This example opens the `dataFile.txt` file created in the previous section and reads the date from the file. For details on loading file resources from various locations, see [How to load file resources](https://msdn.microsoft.com/library/windows/apps/xaml/hh965322).\n\n```CSharp\nasync void ReadTimestamp()\n{\n   try\n   {\n      StorageFile sampleFile = await roamingFolder.GetFileAsync(\"dataFile.txt\");\n      String timestamp = await FileIO.ReadTextAsync(sampleFile);\n      // Data is contained in timestamp\n   }\n   catch (Exception)\n   {\n      // Timestamp not found\n   }\n}\n```\n\n\n## <span id=\"Temporary_app_data\"></span><span id=\"temporary_app_data\"></span><span id=\"TEMPORARY_APP_DATA\"></span>Temporary app data\n\n\nThe temporary app data store works like a cache. Its files do not roam and could be removed at any time. The System Maintenance task can automatically delete data stored at this location at any time. The user can also clear files from the temporary data store using Disk Cleanup. Temporary app data can be used for storing temporary information during an app session. There is no guarantee that this data will persist beyond the end of the app session as the system might reclaim the used space if needed. The location is available via the [**temporaryFolder**](https://msdn.microsoft.com/library/windows/apps/br241629) property.\n\n### <span id=\"Retrieve_the_temporary_data_container\"></span><span id=\"retrieve_the_temporary_data_container\"></span><span id=\"RETRIEVE_THE_TEMPORARY_DATA_CONTAINER\"></span>Retrieve the temporary data container\n\nUse the [**ApplicationData.TemporaryFolder**](https://msdn.microsoft.com/library/windows/apps/br241629) property to get the files. The next steps use the `temporaryFolder` variable from this step.\n\n```CSharp\nWindows.Storage.StorageFolder temporaryFolder = ApplicationData.Current.TemporaryFolder;</code></pre></td>\n</tr>\n</tbody>\n</table>\n```\n\n### <span id=\"Create_and_read_temporary_files\"></span><span id=\"create_and_read_temporary_files\"></span><span id=\"CREATE_AND_READ_TEMPORARY_FILES\"></span>Create and read temporary files\n\nTo create and update a file in the temporary app data store, use the file APIs, such as [**Windows.Storage.StorageFolder.CreateFileAsync**](https://msdn.microsoft.com/library/windows/apps/br227249) and [**Windows.Storage.FileIO.WriteTextAsync**](https://msdn.microsoft.com/library/windows/apps/hh701505). This example creates a file named `dataFile.txt` in the `temporaryFolder` container and writes the current date and time to the file. The **ReplaceExisting** value from the [**CreationCollisionOption**](https://msdn.microsoft.com/library/windows/apps/br241631) enumeration indicates to replace the file if it already exists.\n\n<span codelanguage=\"CSharp\"></span>\n```CSharp\n<colgroup>\n<col width=\"100%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">C#</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\nasync void WriteTimestamp()\n{\n   Windows.Globalization.DateTimeFormatting.DateTimeFormatter formatter = \n       new Windows.Globalization.DatetimeFormatting.DateTimeFormatter(\"longtime\");\n\n   StorageFile sampleFile = await temporaryFolder.CreateFileAsync(\"dataFile.txt\", \n       CreateCollisionOption.ReplaceExisting);\n   await FileIO.WriteTextAsync(sampleFile, formatter.Format(DateTime.Now));\n}\n```\n\nTo open and read a file in the temporary app data store, use the file APIs, such as [**Windows.Storage.StorageFolder.GetFileAsync**](https://msdn.microsoft.com/library/windows/apps/br227272), [**Windows.Storage.StorageFile.GetFileFromApplicationUriAsync**](https://msdn.microsoft.com/library/windows/apps/hh701741), and [**Windows.Storage.FileIO.ReadTextAsync**](https://msdn.microsoft.com/library/windows/apps/hh701482). This example opens the `dataFile.txt` file created in the previous step and reads the date from the file. For details on loading file resources from various locations, see [How to load file resources](https://msdn.microsoft.com/library/windows/apps/xaml/hh965322).\n\n```CSharp\nasync void ReadTimestamp()\n{\n   try\n   {\n      StorageFile sampleFile = await temporaryFolder.GetFileAsync(\"dataFile.txt\");\n      String timestamp = await FileIO.ReadTextAsync(sampleFile);\n      // Data is contained in timestamp\n   }\n   catch (Exception)\n   {\n      // Timestamp not found\n   }\n}\n```\n\n## <span id=\"Organize_app_data_with_containers\"></span><span id=\"organize_app_data_with_containers\"></span><span id=\"ORGANIZE_APP_DATA_WITH_CONTAINERS\"></span>Organize app data with containers\n\n\nTo help you organize your app data settings and files, you create containers (represented by [**ApplicationDataContainer**](https://msdn.microsoft.com/library/windows/apps/br241599) objects) instead of working directly with directories. You can add containers to the local, roaming, and temporary app data stores. Containers can be nested up to 32 levels deep.\n\nTo create a settings container, call the [**ApplicationDataContainer.CreateContainer**](https://msdn.microsoft.com/library/windows/apps/br241611) method. This example creates a local settings container named `exampleContainer` and adds a setting named `exampleSetting`. The **Always** value from the [**ApplicationDataCreateDisposition**](https://msdn.microsoft.com/library/windows/apps/br241616) enumeration indicates that the container is created if it doesn't already exist.\n\n```CSharp\nWindows.Storage.ApplicationDataContainer localSettings = \n    Windows.Storage.ApplicationData.Current.LocalSettings;\nWindows.Storage.StorageFolder localFolder = \n    Windows.Storage.ApplicationData.Current.LocalFolder;\n\n// Setting in a container\nWindows.Storage.ApplicationDataContainer container = \n   localSettings.CreateContainer(\"exampleContainer\", Windows.Storage.ApplicationDataCreateDisposition.Always);\n\nif (localSettings.Containers.ContainsKey(\"exampleContainer\"))\n{\n   localSettings.Containers[\"exampleContainer\"].Values[\"exampleSetting\"] = \"Hello Windows\";\n}\n```\n\n## <span id=\"Delete_app_settings_and_containers\"></span><span id=\"delete_app_settings_and_containers\"></span><span id=\"DELETE_APP_SETTINGS_AND_CONTAINERS\"></span>Delete app settings and containers\n\n\nTo delete a simple setting that your app no longer needs, use the [**ApplicationDataContainerSettings.Remove**](https://msdn.microsoft.com/library/windows/apps/br241608) method. This example deletesthe `exampleSetting` local setting that we created earlier.\n\n```CSharp\nWindows.Storage.ApplicationDataContainer localSettings = \n    Windows.Storage.ApplicationData.Current.LocalSettings;\nWindows.Storage.StorageFolder localFolder = \n    Windows.Storage.ApplicationData.Current.LocalFolder;\n\n// Delete simple setting\n\nlocalSettings.Values.Remove(\"exampleSetting\");\n```\n\nTo delete a composite setting, use the [**ApplicationDataCompositeValue.Remove**](https://msdn.microsoft.com/library/windows/apps/br241597) method. This example deletes the local `exampleCompositeSetting` composite setting we created in an earlier example.\n\n```CSharp\nWindows.Storage.ApplicationDataContainer localSettings = \n    Windows.Storage.ApplicationData.Current.LocalSettings;\nWindows.Storage.StorageFolder localFolder = \n    Windows.Storage.ApplicationData.Current.LocalFolder;\n\n// Delete composite setting\n\nlocalSettings.Values.Remove(\"exampleCompositeSetting\");\n```\n\nTo delete a container, call the [**ApplicationDataContainer.DeleteContainer**](https://msdn.microsoft.com/library/windows/apps/br241612) method. This example deletes the local `exampleContainer` settings container we created earlier.\n\n```CSharp\nWindows.Storage.ApplicationDataContainer localSettings = \n    Windows.Storage.ApplicationData.Current.LocalSettings;\nWindows.Storage.StorageFolder localFolder = \n    Windows.Storage.ApplicationData.Current.LocalFolder;\n\n// Delete container\n\nlocalSettings.DeleteContainer(\"exampleContainer\");\n```\n\n## <span id=\"Versioning_your_app_data\"></span><span id=\"versioning_your_app_data\"></span><span id=\"VERSIONING_YOUR_APP_DATA\"></span>Versioning your app data\n\n\nYou can optionally version the app data for your app. This would enable you to create a future version of your app that changes the format of its app data without causing compatibility problems with the previous version of your app. The app checks the version of the app data in the data store, and if the version is less than the version the app expects, the app should update the app data to the new format and update the version. For more info, see the[**Application.Version**](https://msdn.microsoft.com/library/windows/apps/br241630) property and the [**ApplicationData.SetVersionAsync**](https://msdn.microsoft.com/library/windows/apps/hh701429) method.\n\n## Related articles\n\n* [**Windows.Storage.ApplicationData**](https://msdn.microsoft.com/library/windows/apps/br241587)\n* [**Windows.Storage.ApplicationData.RoamingSettings**](https://msdn.microsoft.com/library/windows/apps/br241624)\n* [**Windows.Storage.ApplicationData.RoamingFolder**](https://msdn.microsoft.com/library/windows/apps/br241623)\n* [**Windows.Storage.ApplicationData.RoamingStorageQuota**](https://msdn.microsoft.com/library/windows/apps/br241625)\n* [**Windows.Storage.ApplicationDataCompositeValue**](https://msdn.microsoft.com/library/windows/apps/br241588)\n\n\n"}