{"nodes":[{"content":"Describes the structure of the 3D Manufacturing Format file type and how it can be created and manipulated with the Windows.Graphics.Printing3D API.","pos":[40,188]},{"content":"Generate a 3MF package","pos":[327,349]},{"content":"Generate a 3MF package","pos":[357,379]},{"content":"Updated for UWP apps on Windows 10.","pos":[385,420]},{"content":"For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept>","pos":[421,513]},{"content":"Important APIs","pos":[521,535]},{"content":"Windows.Graphics.Printing3D","pos":[546,573]},{"content":"Some information relates to pre-released product which may be substantially modified before it's commercially released.","pos":[662,781]},{"content":"Microsoft makes no warranties, express or implied, with respect to the information provided here.","pos":[782,879]},{"pos":[883,1118],"content":"Describes the structure of the 3D Manufacturing Format document and how it can be created and manipulated with the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Windows.Graphics.Printing3D<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/windows.graphics.printing3d.aspx)</ept> API."},{"content":"What is 3MF?","pos":[1123,1135]},{"content":"The 3D Manufacturing Format is a set of conventions for using XML to describe the appearance and structure of 3D models for the purpose of manufacturing (3D printing).","pos":[1137,1304]},{"content":"It defines a set of parts (some required and some optional) and their relationships, with the goal of providing all necessary information to a 3D manufacturing device.","pos":[1305,1472]},{"content":"A data set that adheres to the 3D Manufacturing Format can be saved as a file with the .3mf extension.","pos":[1473,1575]},{"content":"In Windows 10, the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Printing3D3MFPackage<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/windows.graphics.printing3d.printing3d3mfpackage.aspx)</ept> class in the <bpt id=\"p3\">**</bpt>Windows.Graphics.Printing3D<ept id=\"p3\">**</ept> namespace is analogous to a single .3mf file, and other classes map to the particular XML elements in the file.","pos":[1577,1882]},{"content":"This guide describes how each of the main parts of a 3MF document can be created and set programmatically, how the 3MF Materials Extension can be utilized, and finally how a <bpt id=\"p1\">**</bpt>Printing3D3MFPackage<ept id=\"p1\">**</ept> object in C<ph id=\"ph1\">\\#</ph> can be converted and saved as a .3mf file.","pos":[1883,2138]},{"content":"For more information on the standards of 3MF or the 3MF Materials Extension, see the <bpt id=\"p1\">[</bpt>3MF Specification<ept id=\"p1\">](http://3mf.io/what-is-3mf/3mf-specification/)</ept>.","pos":[2139,2290]},{"content":"Core classes in the 3MF structure","pos":[2624,2657]},{"content":"The <bpt id=\"p1\">**</bpt>Printing3D3MFPackage<ept id=\"p1\">**</ept> class represents a complete 3MF document, and at the core of a 3MF document is its model part, represented by the <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>Printing3DModel<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/windows.graphics.printing3d.printing3dmodel.aspx)</ept> class.","pos":[2659,2928]},{"content":"Most of the information we wish to specify about a 3D model will be stored by setting the properties of the <bpt id=\"p1\">**</bpt>Printing3DModel<ept id=\"p1\">**</ept> class and the properties of their underlying classes.","pos":[2929,3110]},{"pos":[3122,3133],"content":"InitClasses"},{"content":"Metadata","pos":[3468,3476]},{"content":"The model part of a 3MF document can hold metadata in the form of key/value pairs of strings stored in the <bpt id=\"p1\">**</bpt>Metadata<ept id=\"p1\">**</ept> property.","pos":[3478,3607]},{"content":"There are a number of predefined names of metadata, but other pairs can be added as part of an extension (described in more detail in the <bpt id=\"p1\">[</bpt>3MF specification<ept id=\"p1\">](http://3mf.io/what-is-3mf/3mf-specification/)</ept>).","pos":[3608,3813]},{"content":"It is up to the receiver of the package (a 3D manufacturing device) to determine whether and how to handle metadata, but it is good practice to include as much basic info as possible in the 3MF package:","pos":[3814,4016]},{"pos":[4028,4036],"content":"Metadata"},{"content":"Mesh data","pos":[4105,4114]},{"content":"In the context of this guide, a mesh is a body of 3-dimensional geometry constructed from a single set of vertices (though it does not have to appear as a single solid).","pos":[4116,4285]},{"content":"A mesh part is represented by the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Printing3DMesh<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/windows.graphics.printing3d.printing3dmesh.aspx)</ept> class.","pos":[4286,4444]},{"content":"A valid mesh object must contain information about the location of all of its vertices as well as all the triangle faces that exist between certain sets of vertices.","pos":[4445,4610]},{"content":"The following method adds vertices to a mesh and then gives them locations in 3D space:","pos":[4612,4699]},{"pos":[4711,4719],"content":"Vertices"},{"content":"The next method defines all of the triangles to be drawn across these vertices:","pos":[4785,4864]},{"pos":[4876,4891],"content":"TriangleIndices"},{"pos":[4966,5157],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept> All triangles must have their indices defined in counter-clockwise order (when viewing the triangle from outside of the mesh object), so that their face-normal vectors point outward."},{"content":"When a Printing3DMesh object contains valid sets of vertices and triangles, it should then be added to the model's <bpt id=\"p1\">**</bpt>Meshes<ept id=\"p1\">**</ept> property.","pos":[5159,5294]},{"content":"All <bpt id=\"p1\">**</bpt>Printing3DMesh<ept id=\"p1\">**</ept> objects in a package must be stored under the <bpt id=\"p2\">**</bpt>Meshes<ept id=\"p2\">**</ept> property of the <bpt id=\"p3\">**</bpt>Printing3DModel<ept id=\"p3\">**</ept> class.","pos":[5295,5417]},{"pos":[5429,5436],"content":"MeshAdd"},{"content":"Create materials","pos":[5505,5521]},{"content":"A 3D model can hold data for multiple materials.","pos":[5524,5572]},{"content":"This convention is intended to take advantage of 3D manufacturing devices that can use multiple materials on a single print job.","pos":[5573,5701]},{"content":"There are also multiple <bpt id=\"p1\">*</bpt>types<ept id=\"p1\">*</ept> of material gropus, each one capable of supporting a number of different individual materals.","pos":[5702,5827]},{"content":"Each material group must have a unique reference id number, and each material within that group must also have a unique id.","pos":[5828,5951]},{"content":"The different mesh objects within a model can then reference these materials.","pos":[5953,6030]},{"content":"Furthermore, individual triangles on each mesh can specify different materials.","pos":[6031,6110]},{"content":"Further still, different materials can even be represented within a single triangle, with each triangle vertex having a different material assigned to it and the face material calculated as the gradient between them.","pos":[6111,6327]},{"content":"This guide will first show how to create different kinds of materials within their respective material groups and store them as resources on the model object.","pos":[6329,6487]},{"content":"Then, we will go about assigning different materials to individual meshes and individual triangles.","pos":[6488,6587]},{"content":"Base materials","pos":[6593,6607]},{"pos":[6609,6796],"content":"The default material type is <bpt id=\"p1\">**</bpt>Base Material<ept id=\"p1\">**</ept>, which has both a <bpt id=\"p2\">**</bpt>Color Material<ept id=\"p2\">**</ept> value (described below) and a name attribute that is intended to specify the <bpt id=\"p3\">*</bpt>type<ept id=\"p3\">*</ept> of material to use."},{"pos":[6808,6825],"content":"BaseMaterialGroup"},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  The 3D manufacturing device will determine which available physical materials map to which virtual material elements stored in the 3MF.","pos":[6900,7045]},{"content":"Material mapping doesn't have to be 1:1: if a 3D printer only uses one material, it will print the whole model in that material, regardless of which objects or faces were assigned different materials.","pos":[7046,7246]},{"content":"Color materials","pos":[7252,7267]},{"content":"<bpt id=\"p1\">**</bpt>Color Materials<ept id=\"p1\">**</ept> are similar to <bpt id=\"p2\">**</bpt>Base Materials<ept id=\"p2\">**</ept>, but they do not contain a name.","pos":[7269,7355]},{"content":"Thus, they give no instructions as to what type of material should be used by the machine.","pos":[7356,7446]},{"content":"They hold only color data, and let the machine choose the material type (and the machine may then prompt the user to choose).","pos":[7447,7572]},{"content":"In the code below, the <ph id=\"ph1\">`colrMat`</ph> objects from the previous method are used on their own.","pos":[7573,7661]},{"pos":[7673,7691],"content":"ColorMaterialGroup"},{"content":"Composite materials","pos":[7771,7790]},{"content":"<bpt id=\"p1\">**</bpt>Composite Materials<ept id=\"p1\">**</ept> simply instruct the manufacturing device to use a uniform mixture of different <bpt id=\"p2\">**</bpt>Base Materials<ept id=\"p2\">**</ept>.","pos":[7792,7914]},{"content":"Each <bpt id=\"p1\">**</bpt>Composite Material Group<ept id=\"p1\">**</ept> must reference exactly one <bpt id=\"p2\">**</bpt>Base Material Group<ept id=\"p2\">**</ept> from which to draw ingredients.","pos":[7915,8031]},{"content":"Additonally, the <bpt id=\"p1\">**</bpt>Base Materials<ept id=\"p1\">**</ept> within this group that are to be made available must be listed out in a <bpt id=\"p2\">**</bpt>Material Indices<ept id=\"p2\">**</ept> list, which each <bpt id=\"p3\">**</bpt>Composite Material<ept id=\"p3\">**</ept> will then reference when specifying the ratios (every <bpt id=\"p4\">**</bpt>Composite Material<ept id=\"p4\">**</ept> is simply a ratio of <bpt id=\"p5\">**</bpt>Base Materials<ept id=\"p5\">**</ept>).","pos":[8032,8319]},{"pos":[8331,8353],"content":"CompositeMaterialGroup"},{"content":"Texture coordinate materials","pos":[8437,8465]},{"content":"3MF supports the use of 2D images to color the surfaces of 3D models.","pos":[8467,8536]},{"content":"This way, the model can convey much more color data per triangle face (as opposed to having just one color value per triangle vertex).","pos":[8537,8671]},{"content":"Like <bpt id=\"p1\">**</bpt>Color Materials<ept id=\"p1\">**</ept>, texture coordinate materials only convery color data.","pos":[8672,8751]},{"content":"To use a 2D texture, a texture resource must first be declared:","pos":[8752,8815]},{"pos":[8827,8842],"content":"TextureResource"},{"pos":[8915,9013],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept> Texture data belongs to the 3MF Package itself, not to the model part within the package."},{"content":"Next, we must fill out <bpt id=\"p1\">**</bpt>Texture3Coord Materials<ept id=\"p1\">**</ept>.","pos":[9015,9066]},{"content":"Each of these references a texture resource and specifies a particular point on the image (in UV coordinates).","pos":[9067,9177]},{"pos":[9189,9215],"content":"Texture2CoordMaterialGroup"},{"content":"Map materials to faces","pos":[9302,9324]},{"content":"In order to dictate which materials are mapped to which vertices on each triangle, we must do some more work on the mesh object of our model (if a model contains multiple meshes, they must each have their materials assigned separately).","pos":[9326,9562]},{"content":"As mentioned above, materials are assigned per-vertex, per-triangle.","pos":[9563,9631]},{"content":"Refer to the code below to see how this information is entered and interpreted.","pos":[9632,9711]},{"pos":[9723,9738],"content":"MaterialIndices"},{"content":"Components and build","pos":[9814,9834]},{"content":"The component structure allows the user to place more than one mesh object in a printable 3D model.","pos":[9836,9935]},{"content":"A <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Printing3DComponent<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/windows.graphics.printing3d.printing3dcomponent.aspx)</ept> object contains a single mesh and a list of references to other components.","pos":[9936,10141]},{"content":"This is actually a list of <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Printing3DComponentWithMatrix<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/windows.graphics.printing3d.printing3dcomponentwithmatrix.aspx)</ept> objects.","pos":[10142,10325]},{"content":"<bpt id=\"p1\">**</bpt>Printing3DComponentWithMatrix<ept id=\"p1\">**</ept> objects each contain a <bpt id=\"p2\">**</bpt>Printing3DComponent<ept id=\"p2\">**</ept> and, importantly, a transform matrix that applies to the mesh and contained components of said <bpt id=\"p3\">**</bpt>Printing3DComponent<ept id=\"p3\">**</ept>.","pos":[10326,10526]},{"content":"For example, a model of a car might consist of a \"Body\" <bpt id=\"p1\">**</bpt>Printing3DComponent<ept id=\"p1\">**</ept> that holds the mesh for the car's body.","pos":[10528,10647]},{"content":"The \"Body\" component may then contain references to four different <bpt id=\"p1\">**</bpt>Printing3DComponentWithMatrix<ept id=\"p1\">**</ept> objects, which all reference the same <bpt id=\"p2\">**</bpt>Printing3DComponent<ept id=\"p2\">**</ept> with the \"Wheel\" mesh and contain four different transform matrices (mapping the wheels to four different positions on the car's body).","pos":[10648,10946]},{"content":"In this scenario, the \"Body\" mesh and \"Wheel\" mesh would each only need to be stored once, even though the final product would feature five meshes in total.","pos":[10947,11103]},{"content":"All <bpt id=\"p1\">**</bpt>Printing3DComponent<ept id=\"p1\">**</ept> objects must be directly referenced in the model's <bpt id=\"p2\">**</bpt>Components<ept id=\"p2\">**</ept> property.","pos":[11105,11208]},{"content":"The one particular component that is to be used in the printing job is stored in the <bpt id=\"p1\">**</bpt>Build<ept id=\"p1\">**</ept> Property.","pos":[11209,11313]},{"pos":[11325,11335],"content":"Components"},{"content":"Save package","pos":[11406,11418]},{"content":"Now that we have a model, with defined materials and components, we can save it to the package.","pos":[11419,11514]},{"pos":[11526,11537],"content":"SavePackage"},{"pos":[11606,11818],"content":"From here, we can either initiate a print job within the app (see <bpt id=\"p1\">[</bpt>3D printing from your app<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/mt204541.aspx)</ept>), or save this <bpt id=\"p2\">**</bpt>Printing3D3MFPackage<ept id=\"p2\">**</ept> as a .3mf file."},{"pos":[11820,11917],"content":"The following method takes a finished <bpt id=\"p1\">**</bpt>Printing3D3MFPackage<ept id=\"p1\">**</ept> and saves its data to a .3mf file."},{"pos":[11929,11938],"content":"SaveTo3mf"},{"content":"Related topics","pos":[12008,12022]},{"content":"3D printing from your app","pos":[12025,12050]}],"content":"---\nauthor: PatrickFarley\nDescription: 'Describes the structure of the 3D Manufacturing Format file type and how it can be created and manipulated with the Windows.Graphics.Printing3D API.'\nMS-HAID: 'dev\\_devices\\_sensors.generate\\_3mf'\nMSHAttr: 'PreferredLib:/library/windows/apps'\nSearch.Product: eADQiWindows 10XVcnh\ntitle: Generate a 3MF package\n---\n\n# Generate a 3MF package\n\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\n\n**Important APIs**\n\n-   [**Windows.Graphics.Printing3D**](https://msdn.microsoft.com/library/windows/apps/windows.graphics.printing3d.aspx)\n\n\\[Some information relates to pre-released product which may be substantially modified before it's commercially released. Microsoft makes no warranties, express or implied, with respect to the information provided here.\\]\n\nDescribes the structure of the 3D Manufacturing Format document and how it can be created and manipulated with the [**Windows.Graphics.Printing3D**](https://msdn.microsoft.com/library/windows/apps/windows.graphics.printing3d.aspx) API.\n\n## What is 3MF?\n\nThe 3D Manufacturing Format is a set of conventions for using XML to describe the appearance and structure of 3D models for the purpose of manufacturing (3D printing). It defines a set of parts (some required and some optional) and their relationships, with the goal of providing all necessary information to a 3D manufacturing device. A data set that adheres to the 3D Manufacturing Format can be saved as a file with the .3mf extension.\n\nIn Windows 10, the [**Printing3D3MFPackage**](https://msdn.microsoft.com/library/windows/apps/windows.graphics.printing3d.printing3d3mfpackage.aspx) class in the **Windows.Graphics.Printing3D** namespace is analogous to a single .3mf file, and other classes map to the particular XML elements in the file. This guide describes how each of the main parts of a 3MF document can be created and set programmatically, how the 3MF Materials Extension can be utilized, and finally how a **Printing3D3MFPackage** object in C\\# can be converted and saved as a .3mf file. For more information on the standards of 3MF or the 3MF Materials Extension, see the [3MF Specification](http://3mf.io/what-is-3mf/3mf-specification/).\n\n<!-- >**Note** This guide describes how to construct a 3MF document from scratch. If you wish to make changes to an already existing 3MF document provided in the form of a .3mf file, you simply need to convert it to a **Printing3D3MFPackage** and alter the contained classes/properties in the same way (see [link]) below). -->\n\n\n## Core classes in the 3MF structure\n\nThe **Printing3D3MFPackage** class represents a complete 3MF document, and at the core of a 3MF document is its model part, represented by the [**Printing3DModel**](https://msdn.microsoft.com/library/windows/apps/windows.graphics.printing3d.printing3dmodel.aspx) class. Most of the information we wish to specify about a 3D model will be stored by setting the properties of the **Printing3DModel** class and the properties of their underlying classes.\n\n[!code-cs[InitClasses](./code/3dprinthowto/cs/Generate3MFMethods.cs#SnippetInitClasses)]\n\n<!-- >**Note** We do not yet associate the **Printing3D3MFPackage** with its corresponding **Printing3DModel** object. Only after fleshing out the **Printing3DModel** with all of the information we wish to specify will we make that association (see [link]). -->\n\n## Metadata\n\nThe model part of a 3MF document can hold metadata in the form of key/value pairs of strings stored in the **Metadata** property. There are a number of predefined names of metadata, but other pairs can be added as part of an extension (described in more detail in the [3MF specification](http://3mf.io/what-is-3mf/3mf-specification/)). It is up to the receiver of the package (a 3D manufacturing device) to determine whether and how to handle metadata, but it is good practice to include as much basic info as possible in the 3MF package:\n\n[!code-cs[Metadata](./code/3dprinthowto/cs/Generate3MFMethods.cs#SnippetMetadata)]\n\n## Mesh data\n\nIn the context of this guide, a mesh is a body of 3-dimensional geometry constructed from a single set of vertices (though it does not have to appear as a single solid). A mesh part is represented by the [**Printing3DMesh**](https://msdn.microsoft.com/library/windows/apps/windows.graphics.printing3d.printing3dmesh.aspx) class. A valid mesh object must contain information about the location of all of its vertices as well as all the triangle faces that exist between certain sets of vertices.\n\nThe following method adds vertices to a mesh and then gives them locations in 3D space:\n\n[!code-cs[Vertices](./code/3dprinthowto/cs/Generate3MFMethods.cs#SnippetVertices)]\n\nThe next method defines all of the triangles to be drawn across these vertices:\n\n[!code-cs[TriangleIndices](./code/3dprinthowto/cs/Generate3MFMethods.cs#SnippetTriangleIndices)]\n\n> **Note** All triangles must have their indices defined in counter-clockwise order (when viewing the triangle from outside of the mesh object), so that their face-normal vectors point outward.\n\nWhen a Printing3DMesh object contains valid sets of vertices and triangles, it should then be added to the model's **Meshes** property. All **Printing3DMesh** objects in a package must be stored under the **Meshes** property of the **Printing3DModel** class.\n\n[!code-cs[MeshAdd](./code/3dprinthowto/cs/Generate3MFMethods.cs#SnippetMeshAdd)]\n\n\n## Create materials\n\n\nA 3D model can hold data for multiple materials. This convention is intended to take advantage of 3D manufacturing devices that can use multiple materials on a single print job. There are also multiple *types* of material gropus, each one capable of supporting a number of different individual materals. Each material group must have a unique reference id number, and each material within that group must also have a unique id.\n\nThe different mesh objects within a model can then reference these materials. Furthermore, individual triangles on each mesh can specify different materials. Further still, different materials can even be represented within a single triangle, with each triangle vertex having a different material assigned to it and the face material calculated as the gradient between them.\n\nThis guide will first show how to create different kinds of materials within their respective material groups and store them as resources on the model object. Then, we will go about assigning different materials to individual meshes and individual triangles.\n\n### Base materials\n\nThe default material type is **Base Material**, which has both a **Color Material** value (described below) and a name attribute that is intended to specify the *type* of material to use.\n\n[!code-cs[BaseMaterialGroup](./code/3dprinthowto/cs/Generate3MFMethods.cs#SnippetBaseMaterialGroup)]\n\n**Note**  The 3D manufacturing device will determine which available physical materials map to which virtual material elements stored in the 3MF. Material mapping doesn't have to be 1:1: if a 3D printer only uses one material, it will print the whole model in that material, regardless of which objects or faces were assigned different materials.\n\n### Color materials\n\n**Color Materials** are similar to **Base Materials**, but they do not contain a name. Thus, they give no instructions as to what type of material should be used by the machine. They hold only color data, and let the machine choose the material type (and the machine may then prompt the user to choose). In the code below, the `colrMat` objects from the previous method are used on their own.\n\n[!code-cs[ColorMaterialGroup](./code/3dprinthowto/cs/Generate3MFMethods.cs#SnippetColorMaterialGroup)]\n\n### Composite materials\n\n**Composite Materials** simply instruct the manufacturing device to use a uniform mixture of different **Base Materials**. Each **Composite Material Group** must reference exactly one **Base Material Group** from which to draw ingredients. Additonally, the **Base Materials** within this group that are to be made available must be listed out in a **Material Indices** list, which each **Composite Material** will then reference when specifying the ratios (every **Composite Material** is simply a ratio of **Base Materials**).\n\n[!code-cs[CompositeMaterialGroup](./code/3dprinthowto/cs/Generate3MFMethods.cs#SnippetCompositeMaterialGroup)]\n\n### Texture coordinate materials\n\n3MF supports the use of 2D images to color the surfaces of 3D models. This way, the model can convey much more color data per triangle face (as opposed to having just one color value per triangle vertex). Like **Color Materials**, texture coordinate materials only convery color data. To use a 2D texture, a texture resource must first be declared:\n\n[!code-cs[TextureResource](./code/3dprinthowto/cs/Generate3MFMethods.cs#SnippetTextureResource)]\n\n**Note** Texture data belongs to the 3MF Package itself, not to the model part within the package.\n\nNext, we must fill out **Texture3Coord Materials**. Each of these references a texture resource and specifies a particular point on the image (in UV coordinates).\n\n[!code-cs[Texture2CoordMaterialGroup](./code/3dprinthowto/cs/Generate3MFMethods.cs#SnippetTexture2CoordMaterialGroup)]\n\n## Map materials to faces\n\nIn order to dictate which materials are mapped to which vertices on each triangle, we must do some more work on the mesh object of our model (if a model contains multiple meshes, they must each have their materials assigned separately). As mentioned above, materials are assigned per-vertex, per-triangle. Refer to the code below to see how this information is entered and interpreted.\n\n[!code-cs[MaterialIndices](./code/3dprinthowto/cs/Generate3MFMethods.cs#SnippetMaterialIndices)]\n\n## Components and build\n\nThe component structure allows the user to place more than one mesh object in a printable 3D model. A [**Printing3DComponent**](https://msdn.microsoft.com/library/windows/apps/windows.graphics.printing3d.printing3dcomponent.aspx) object contains a single mesh and a list of references to other components. This is actually a list of [**Printing3DComponentWithMatrix**](https://msdn.microsoft.com/library/windows/apps/windows.graphics.printing3d.printing3dcomponentwithmatrix.aspx) objects. **Printing3DComponentWithMatrix** objects each contain a **Printing3DComponent** and, importantly, a transform matrix that applies to the mesh and contained components of said **Printing3DComponent**.\n\nFor example, a model of a car might consist of a \"Body\" **Printing3DComponent** that holds the mesh for the car's body. The \"Body\" component may then contain references to four different **Printing3DComponentWithMatrix** objects, which all reference the same **Printing3DComponent** with the \"Wheel\" mesh and contain four different transform matrices (mapping the wheels to four different positions on the car's body). In this scenario, the \"Body\" mesh and \"Wheel\" mesh would each only need to be stored once, even though the final product would feature five meshes in total.\n\nAll **Printing3DComponent** objects must be directly referenced in the model's **Components** property. The one particular component that is to be used in the printing job is stored in the **Build** Property.\n\n[!code-cs[Components](./code/3dprinthowto/cs/Generate3MFMethods.cs#SnippetComponents)]\n\n## Save package\nNow that we have a model, with defined materials and components, we can save it to the package.\n\n[!code-cs[SavePackage](./code/3dprinthowto/cs/Generate3MFMethods.cs#SnippetSavePackage)]\n\nFrom here, we can either initiate a print job within the app (see [3D printing from your app](https://msdn.microsoft.com/library/windows/apps/mt204541.aspx)), or save this **Printing3D3MFPackage** as a .3mf file.\n\nThe following method takes a finished **Printing3D3MFPackage** and saves its data to a .3mf file.\n\n[!code-cs[SaveTo3mf](./code/3dprinthowto/cs/Generate3MFMethods.cs#SnippetSaveTo3mf)]\n\n## Related topics\n\n[3D printing from your app](https://msdn.microsoft.com/windows/uwp/devices-sensors/3d-print-from-app)\n\n \n\n \n"}