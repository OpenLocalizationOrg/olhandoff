{"nodes":[{"content":"Deploy and debug a Universal Windows Platform (UWP) app converted from a Windows desktop application (Win32, WPF, and Windows Forms) by using the Desktop Conversion extensions.","pos":[33,209]},{"content":"Deploy and debug a Universal Windows Platform (UWP) app converted from a Windows desktop application","pos":[254,354]},{"content":"Deploy and debug your converted UWP app (Project Centennial)","pos":[362,422]},{"content":"Some information relates to pre-released product which may be substantially modified before it's commercially released.","pos":[426,545]},{"content":"Microsoft makes no warranties, express or implied, with respect to the information provided here.","pos":[546,643]},{"content":"This topic contains info to help you be successful deploying and debugging your app after converting it.","pos":[647,751]},{"content":"Also, if you're curious about some of the internals of the Desktop Conversion extensions, then this topic is for you.","pos":[752,869]},{"content":"Debug your converted UWP app","pos":[874,902]},{"content":"You have two main options for debugging your converted app using Visual Studio.","pos":[904,983]},{"content":"Attach to process","pos":[989,1006]},{"content":"When Microsoft Visual Studio is running \"as administrator\", the <bpt id=\"p1\">__</bpt>Start Debugging<ept id=\"p1\">__</ept> and <bpt id=\"p2\">__</bpt>Start Without Debugging<ept id=\"p2\">__</ept> commands will work for a converted app's project, but the launched app will run with <bpt id=\"p3\">[</bpt>medium integrity level<ept id=\"p3\">](https://msdn.microsoft.com/library/bb625963)</ept>.","pos":[1008,1279]},{"content":"That is, it will <bpt id=\"p1\">_</bpt>not<ept id=\"p1\">_</ept> have elevated privileges.","pos":[1280,1328]},{"content":"To confer administrator privileges onto the launched app, first you need to launch the \"as administrator\" via a shortcut or a tile.","pos":[1329,1460]},{"content":"Once the app is running, from an instance of Microsoft Visual Studio running \"as administrator\", invoke the <bpt id=\"p1\">__</bpt>Attach to Process<ept id=\"p1\">__</ept> and select your app's process from the dialog.","pos":[1461,1637]},{"content":"F5 debug","pos":[1643,1651]},{"content":"Visual Studio now supports a new packaging project that enables you to automatically copy any updates you make when you build your application into the AppX package created when you ran the converter on your application’s installer.","pos":[1653,1885]},{"content":"Once you configure the packaging projectyou can now also use F5 to debug directly into the AppX package.","pos":[1886,1990]},{"content":"Here's how to get started:","pos":[1993,2019]},{"content":"First, ensure you're set up to use Centennial.","pos":[2025,2071]},{"content":"For instructions, see <bpt id=\"p1\">[</bpt>Desktop App Converter Preview (Project Centennial)<ept id=\"p1\">](https://msdn.microsoft.com/windows/uwp/porting/desktop-to-uwp-run-desktop-app-converter)</ept>.","pos":[2072,2236]},{"content":"Run the converter and then installer for your Win32 application.","pos":[2242,2306]},{"content":"The converter captures the layout, and any changes made to the registry and outputs an Appx with manifest and registery.dat to virtualize the registry:","pos":[2307,2458]},{"content":"alt","pos":[2462,2465]},{"pos":[2506,2633],"content":"Install and launch <bpt id=\"p1\">[</bpt>Visual Studio \"15\" Preview 2<ept id=\"p1\">](https://www.visualstudio.com/downloads/visual-studio-next-downloads-vs.aspx)</ept>."},{"pos":[2639,2769],"content":"Install the Desktop to UWP Packaging VSIX project from the <bpt id=\"p1\">[</bpt>Visual Studio Gallery<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=797871)</ept>."},{"content":"Open the corresponding Win32 solution that was converted in Visual Studio.","pos":[2775,2849]},{"content":"Add the new packaging project to your solution by right clicking on the solution and choosing \"Add New Project\".","pos":[2855,2967]},{"content":"Then pick the Desktop to UWP Packaging Project under Setup and Deployment:","pos":[2968,3042]},{"content":"alt","pos":[3050,3053]},{"content":"The resulting project will be added to your solution:","pos":[3095,3148]},{"content":"alt","pos":[3156,3159]},{"content":"In the Packaging project, the AppXFileList provides a mapping of files into the AppX layout.","pos":[3201,3293]},{"content":"References begins empty, but should be manually set to the .exe project for build ordering.","pos":[3294,3385]},{"content":"The DesktopToUWPPackaging project has a property page which allows you to configure the AppX package root and which tile to execute:","pos":[3391,3523]},{"content":"alt","pos":[3531,3534]},{"content":"Set the PackageLayout to the root location of the AppX that was created by the converter (above).","pos":[3576,3673]},{"content":"Then pick which tile to execute.","pos":[3674,3706]},{"content":"Open and edit the AppXFileList.xml.","pos":[3712,3747]},{"content":"This file defines how to copy the output of the Win32 debug build into the AppX layout  the converter built.","pos":[3748,3856]},{"content":"By default, we have a placeholder in the file with an example tag and comment:","pos":[3857,3935]},{"content":"Below is an example of creating the mapping.","pos":[4384,4428]},{"content":"In this case, we copy the .exe and .dll from the Win32 build location into the package layout location.","pos":[4429,4532]},{"content":"The file is defined as follows:","pos":[5356,5387]},{"pos":[5394,5497],"content":"First, we define <bpt id=\"p1\">*</bpt>MyProjectOutputPath<ept id=\"p1\">*</ept> to point at the location where the Win32 project is building to:"},{"content":"Then, each <bpt id=\"p1\">*</bpt>LayoutFile<ept id=\"p1\">*</ept> specifies a file to copy from the Win32 build location to the Appx Package layout.","pos":[5835,5941]},{"content":"In this case first a .exe, then a .dll are copied.","pos":[5942,5992]},{"content":"Set the packaging project the start-up project.","pos":[6566,6613]},{"content":"This will copy the Win32 files into the AppX and then launch the debugger when the project is built and run.","pos":[6614,6722]},{"content":"alt","pos":[6732,6735]},{"content":"Finally, you can now set a breakpoint in the Win32 code and hit F5 to launch the debugger.","pos":[6777,6867]},{"content":"It will copy any updates you have made to your Win32 application across to the AppX package and allow you to debug directly from within Visual Studio.","pos":[6868,7018]},{"content":"If you update your application, you'll need to use MakeAppX to repackage your app again.","pos":[7024,7112]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>App packager (MakeAppx.exe)<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/windows/desktop/hh446767(v=vs.85).aspx)</ept>.","pos":[7113,7250]},{"content":"If you have multiple build configurations (for instance for release and debug), you can add the following to the AppXFileList.xml file to copy the Win32 build from different locations:","pos":[7253,7437]},{"content":"You can also use conditional compilation to enable particular code paths if you update your application to UWP but also still want to build it for Win32.","pos":[7831,7984]},{"content":"In the example below the code will only be compiled for DesktopUWP and will show a tile using the WinRT API.","pos":[7991,8099]},{"content":"You can use Configuration Manager to add the new build configuration:","pos":[8612,8681]},{"content":"alt","pos":[8689,8692]},{"content":"alt","pos":[8736,8739]},{"content":"Then under the project properties add support for conditional compilation symbols:","pos":[8781,8863]},{"content":"alt","pos":[8871,8874]},{"content":"You can now toggle the build target to DesktopUWP if you want to build to target the UWP API you added.","pos":[8916,9019]},{"content":"Deploy your converted UWP app","pos":[9024,9053]},{"content":"To deploy your app during development, run the following PowerShell cmdlet:","pos":[9055,9130]},{"content":"To update your app's .exe or .dll files, simply replace the existing files in your package with the new ones, increase the version number in AppxManifest.xml, and then run the above command again.","pos":[9183,9379]},{"content":"Note the following:","pos":[9381,9400]},{"content":"Any drive that you install your converted app on to must be formatted to NTFS format.","pos":[9403,9488]},{"content":"A converted app always runs as the interactive user.","pos":[9490,9542]},{"content":"This has particular significance for a .NET app whose manifest specifies an execution level of <bpt id=\"p1\">__</bpt>requireAdministrator<ept id=\"p1\">__</ept>.","pos":[9543,9663]},{"content":"If the interactive user has administrator privileges then a UAC prompt will be displayed <bpt id=\"p1\">_</bpt>each time the app is launched<ept id=\"p1\">_</ept>.","pos":[9664,9785]},{"content":"For standard users, the app will fail to launch.","pos":[9786,9834]},{"content":"If you try to run the Add-AppxPackage cmdlet on a machine where you haven't imported the cert you created, you'll get an error.","pos":[9836,9963]},{"content":"Before you deploy your app, you'll need to sign it with a certificate.","pos":[9965,10035]},{"content":"For information on creating a certificate, see <bpt id=\"p1\">[</bpt>Sign your .Appx Package<ept id=\"p1\">](https://msdn.microsoft.com/windows/uwp/porting/desktop-to-uwp-run-desktop-app-converter#deploy-your-converted-appx)</ept>.","pos":[10036,10225]},{"content":"Here's how you import a certificate that you created previously.","pos":[10228,10292]},{"content":"You can install it directly, or you can install it from an appx that you've signed, like the customer will.","pos":[10293,10400]},{"pos":[10405,10527],"content":"In File Explorer, right click an appx that you've signed with a test cert and choose <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> from the context menu."},{"pos":[10532,10576],"content":"Click or tap the <bpt id=\"p1\">**</bpt>Digital Signatures<ept id=\"p1\">**</ept> tab."},{"pos":[10581,10636],"content":"Click or tap on the certificate and choose <bpt id=\"p1\">**</bpt>Details<ept id=\"p1\">**</ept>."},{"pos":[10641,10675],"content":"Click or tap <bpt id=\"p1\">**</bpt>View Certificate<ept id=\"p1\">**</ept>."},{"pos":[10680,10717],"content":"Click or tap <bpt id=\"p1\">**</bpt>Install Certificate<ept id=\"p1\">**</ept>."},{"pos":[10722,10780],"content":"In the <bpt id=\"p1\">**</bpt>Store Location<ept id=\"p1\">**</ept> group, select <bpt id=\"p2\">**</bpt>Local Machine<ept id=\"p2\">**</ept>."},{"pos":[10785,10844],"content":"Click or tap <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept> to confirm the UAC dialog."},{"pos":[10849,10982],"content":"In the next screen of the Certificate Import Wizard, change the selected option to <bpt id=\"p1\">**</bpt>Place all certificates in the following store<ept id=\"p1\">**</ept>."},{"content":"Click or tap <bpt id=\"p1\">**</bpt>Browse<ept id=\"p1\">**</ept>.","pos":[10987,11011]},{"content":"In the Select Certificate Store window, scroll down and select <bpt id=\"p1\">**</bpt>Trusted People<ept id=\"p1\">**</ept> and click or tap <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>.","pos":[11012,11118]},{"content":"Click or tap <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.","pos":[11123,11145]},{"content":"A new screen appears.","pos":[11146,11167]},{"content":"Click or tap <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept>.","pos":[11168,11192]},{"content":"A confirmation dialog should appear.","pos":[11197,11233]},{"content":"If so, click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","pos":[11234,11254]},{"content":"If a different dialog indicates that there is a problem with the certificate, you may need to do some certificate troubleshooting.","pos":[11255,11385]},{"content":"For Windows to trust the certificate, the certificate must be located in either the <bpt id=\"p1\">**</bpt>Certificates (Local Computer) &gt; Trusted Root Certification Authorities &gt; Certificates<ept id=\"p1\">**</ept> node or the <bpt id=\"p2\">**</bpt>Certificates (Local Computer) &gt; Trusted People &gt; Certificates<ept id=\"p2\">**</ept> node.","pos":[11387,11644]},{"content":"Only certificates in these two locations can validate the certificate trust in the context of the local machine.","pos":[11645,11757]},{"content":"Otherwise, an error message that resembles the following string appears:","pos":[11758,11830]},{"content":"Behind the scenes","pos":[12151,12168]},{"content":"When you run your converted app, your UWP app package is launched from \\Program Files\\WindowsApps<ph id=\"ph1\">\\\\&amp;lt;</ph><bpt id=\"p1\">_</bpt>package name<ept id=\"p1\">_</ept><ph id=\"ph2\">&amp;gt;\\\\&amp;lt;</ph><bpt id=\"p2\">_</bpt>appname<ept id=\"p2\">_</ept><ph id=\"ph3\">&amp;gt;</ph>.exe.","pos":[12170,12315]},{"content":"If you look there, you'll see that your app has an app package manifest (named AppxManifest.xml), which references a special xml namespace that's used for converted apps.","pos":[12316,12486]},{"content":"Inside that manifest file is an <bpt id=\"p1\">__</bpt><ph id=\"ph1\">&amp;lt;</ph>EntryPoint<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p1\">__</ept> element, which references a full-trust app.","pos":[12487,12585]},{"content":"When that app is launched, it does not run inside an app container, but instead it runs as the user as it normally would.","pos":[12586,12707]},{"content":"But the app runs in a special environment where any accesses that the app makes to the file system and to the Registry are redirected.","pos":[12709,12843]},{"content":"The file named Registry.dat is used for Registry redirection.","pos":[12844,12905]},{"content":"It's actually a Registry hive, so you can view it in the Windows Registry Editor (Regedit).","pos":[12906,12997]},{"content":"Note, that this mechanism means that you can't use the Registry for inter-process communication.","pos":[12998,13094]},{"content":"The Registry wasn't designed for, and is not well-suited to, that practice in any case.","pos":[13095,13182]},{"content":"When it comes to the file system, the only thing redirected is the AppData folder, and it is redirected to the same location that app data is stored for all UWP apps.","pos":[13183,13349]},{"content":"This location is known as the local app data store, and you access it by using the <bpt id=\"p1\">[</bpt>ApplicationData.LocalFolder<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br241621)</ept> property.","pos":[13350,13530]},{"content":"This way, your code is already ported to read and write app data in the correct place without you doing anything.","pos":[13531,13644]},{"content":"And you can also write there directly.","pos":[13645,13683]},{"content":"One benefit of file system redirection is a cleaner uninstall experience.","pos":[13684,13757]},{"content":"Inside a folder named VFS, you will see folders that contain the DLLs that your app has dependencies on.","pos":[13759,13863]},{"content":"These DLLs are installed into system folders for the classic desktop version of your app.","pos":[13864,13953]},{"content":"But, as a UWP app, the DLLs are local to your app.","pos":[13954,14004]},{"content":"This way, there are no versioning problems when UWP apps are installed and uninstalled.","pos":[14005,14092]},{"content":"See also","pos":[14097,14105]},{"content":"Convert your desktop application to a Universal Windows Platform (UWP) app","pos":[14107,14181]},{"content":"Desktop App Converter Preview (Project Centennial)","pos":[14253,14303]},{"content":"Manually convert your Windows desktop application to a Universal Windows Platform (UWP) app","pos":[14396,14487]},{"content":"Desktop app bridge to UWP code samples on GitHub","pos":[14578,14626]}],"content":"---\nauthor: awkoren\nDescription: Deploy and debug a Universal Windows Platform (UWP) app converted from a Windows desktop application (Win32, WPF, and Windows Forms) by using the Desktop Conversion extensions.\nSearch.Product: eADQiWindows 10XVcnh\ntitle: Deploy and debug a Universal Windows Platform (UWP) app converted from a Windows desktop application\n---\n\n# Deploy and debug your converted UWP app (Project Centennial)\n\n\\[Some information relates to pre-released product which may be substantially modified before it's commercially released. Microsoft makes no warranties, express or implied, with respect to the information provided here.\\]\n\nThis topic contains info to help you be successful deploying and debugging your app after converting it. Also, if you're curious about some of the internals of the Desktop Conversion extensions, then this topic is for you.\n\n## Debug your converted UWP app\n\nYou have two main options for debugging your converted app using Visual Studio.\n\n### Attach to process\n\nWhen Microsoft Visual Studio is running \"as administrator\", the __Start Debugging__ and __Start Without Debugging__ commands will work for a converted app's project, but the launched app will run with [medium integrity level](https://msdn.microsoft.com/library/bb625963). That is, it will _not_ have elevated privileges. To confer administrator privileges onto the launched app, first you need to launch the \"as administrator\" via a shortcut or a tile. Once the app is running, from an instance of Microsoft Visual Studio running \"as administrator\", invoke the __Attach to Process__ and select your app's process from the dialog.\n\n### F5 debug\n\nVisual Studio now supports a new packaging project that enables you to automatically copy any updates you make when you build your application into the AppX package created when you ran the converter on your application’s installer. Once you configure the packaging projectyou can now also use F5 to debug directly into the AppX package. \n\nHere's how to get started: \n\n1. First, ensure you're set up to use Centennial. For instructions, see [Desktop App Converter Preview (Project Centennial)](https://msdn.microsoft.com/windows/uwp/porting/desktop-to-uwp-run-desktop-app-converter). \n\n2. Run the converter and then installer for your Win32 application. The converter captures the layout, and any changes made to the registry and outputs an Appx with manifest and registery.dat to virtualize the registry:\n\n![alt](images/desktop-to-uwp/debug-1.png)\n\n3. Install and launch [Visual Studio \"15\" Preview 2](https://www.visualstudio.com/downloads/visual-studio-next-downloads-vs.aspx). \n\n4. Install the Desktop to UWP Packaging VSIX project from the [Visual Studio Gallery](http://go.microsoft.com/fwlink/?LinkId=797871). \n\n5. Open the corresponding Win32 solution that was converted in Visual Studio.\n \n6. Add the new packaging project to your solution by right clicking on the solution and choosing \"Add New Project\". Then pick the Desktop to UWP Packaging Project under Setup and Deployment:\n\n    ![alt](images/desktop-to-uwp/debug-2.png)\n\n    The resulting project will be added to your solution:\n\n    ![alt](images/desktop-to-uwp/debug-3.png)\n\n    In the Packaging project, the AppXFileList provides a mapping of files into the AppX layout. References begins empty, but should be manually set to the .exe project for build ordering. \n\n7. The DesktopToUWPPackaging project has a property page which allows you to configure the AppX package root and which tile to execute:\n\n    ![alt](images/desktop-to-uwp/debug-4.png)\n\n    Set the PackageLayout to the root location of the AppX that was created by the converter (above). Then pick which tile to execute.\n\n8.  Open and edit the AppXFileList.xml. This file defines how to copy the output of the Win32 debug build into the AppX layout  the converter built. By default, we have a placeholder in the file with an example tag and comment:\n\n    ```XML\n    <?xml version=\"1.0\" encoding=\"utf-8\"?>\n    <Project ToolsVersion=\"4.0\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">\n      <ItemGroup>\n    <!— Use the following syntax to copy debug output to the AppX layout\n       <AppxPackagedFile Include=\"$(outdir)\\App.exe\">\n          <PackagePath>App.exe</PackagePath>\n        </AppxPackagedFile> \n        See http://etc...\n    -->\n      </ItemGroup>\n    </Project>\n    ```\n\n    Below is an example of creating the mapping. In this case, we copy the .exe and .dll from the Win32 build location into the package layout location. \n\n    ```XML\n    <?xml version=\"1.0\" encoding=utf-8\"?>\n    <Project ToolsVersion=14.0\" xmlns=\"http://scehmas.microsoft.com/developer/msbuild/2003\">\n        <PropertyGroup>\n            <MyProjectOutputPath>C:\\{path}</MyProjectOutputPath>\n        </PropertyGroup>\n        <ItemGroup>\n            <LayoutFile Include=\"$(MyProjectOutputPath)\\ProjectTracker.exe\">\n                <PackagePath>$(PackageLayout)\\VFS\\Program Files (x86)\\Contoso Software\\Project Tracker\\ProjectTracker.exe</PackagePath>\n            </LayoutFile>\n            <LayoutFile Include=\"$(MyProjectOutputPath)\\ProjectTracker.Models.dll\">\n                <PackagePath>$(PackageLayout)\\VFS\\Program Files (x86)\\Contoso Software\\Project Tracker\\ProjectTracker.Models.dll</PackagePath>\n            </LayoutFile>\n        </ItemGroup>\n    </Project>\n    ```\n\n    The file is defined as follows: \n\n    First, we define *MyProjectOutputPath* to point at the location where the Win32 project is building to:\n\n    ```XML\n    <?xml version=\"1.0\" encoding=\"utf-8\"?>\n    <Project ToolsVersion=\"14.0\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">\n        <PropertyGroup>\n            <MyProjectOutputPath>C:\\Users\\peterfar\\Desktop\\ProjectTracker\\ProjectTracker\\bin\\DesktopUWP</MyProjectOutputPath>\n        </PropertyGroup>\n    ```\n\n    Then, each *LayoutFile* specifies a file to copy from the Win32 build location to the Appx Package layout. In this case first a .exe, then a .dll are copied. \n\n    ```XML\n        <ItemGroup>\n            <LayoutFile Include=\"$(MyProjectOutputPath)\\ProjectTracker.exe\">\n                <PackagePath>$(PackageLayout)\\VFS\\Program Files (x86)\\Contoso Software\\Project Tracker\\ProjectTracker.exe</PackagePath>\n            </LayoutFile>\n            <LayoutFile Include=\"$(MyProjectOutputPath)\\ProjectTracker.Models.dll\">\n                <PackagePath>$(PackageLayout)\\VFS\\Program Files (x86)\\Contoso Software\\Project Tracker\\ProjectTracker.Models.dll</PackagePath>\n            </LayoutFile>\n        </ItemGroup>\n    </Project>\n    ```\n\n9. Set the packaging project the start-up project. This will copy the Win32 files into the AppX and then launch the debugger when the project is built and run.  \n\n    ![alt](images/desktop-to-uwp/debug-5.png)\n\n10. Finally, you can now set a breakpoint in the Win32 code and hit F5 to launch the debugger. It will copy any updates you have made to your Win32 application across to the AppX package and allow you to debug directly from within Visual Studio.\n\n11. If you update your application, you'll need to use MakeAppX to repackage your app again. For more information, see [App packager (MakeAppx.exe)](https://msdn.microsoft.com/en-us/library/windows/desktop/hh446767(v=vs.85).aspx). \n\nIf you have multiple build configurations (for instance for release and debug), you can add the following to the AppXFileList.xml file to copy the Win32 build from different locations:\n\n```XML\n<PropertyGroup>\n    <MyProjectOutputPath Condition=\"$(Configuration) == 'DesktopUWP'\">C:\\Users\\peterfar\\Desktop\\ProjectTracker\\ProjectTracker\\bin\\DesktopUWP>\n    </MyProjectOutputPath>\n    <MyProjectOutputPath Condition=\"$(Configuration) == 'ReleaseDesktopUWP'\"> C:\\Users\\peterfar\\Desktop\\ProjectTracker\\ProjectTracker\\bin\\ReleaseDesktopUWP</MyProjectOutputPath>\n</PropertyGroup>\n```\n\nYou can also use conditional compilation to enable particular code paths if you update your application to UWP but also still want to build it for Win32. \n\n1.  In the example below the code will only be compiled for DesktopUWP and will show a tile using the WinRT API. \n\n    ```C#\n    [Conditional(\"DesktopUWP\")]\n    private void showtile()\n    {\n        XmlDocument tileXml = TileUpdateManager.GetTemplateContent(TileTemplateType.TileSquare150x150Text01);\n        XmlNodeList textNodes = tileXml.GetElementsByTagName(\"text\");\n        textNodes[0].InnerText = string.Format(\"Welcome to DesktopUWP!\");\n        TileNotification tileNotification = new TileNotification(tileXml);\n        TileUpdateManager.CreateTileUpdaterForApplication().Update(tileNotification);\n    }\n    ```\n\n2.  You can use Configuration Manager to add the new build configuration:\n\n    ![alt](images/desktop-to-uwp/debug-6.png)\n\n    ![alt](images/desktop-to-uwp/debug-7.png)\n\n3.  Then under the project properties add support for conditional compilation symbols:\n\n    ![alt](images/desktop-to-uwp/debug-8.png)\n\n4.  You can now toggle the build target to DesktopUWP if you want to build to target the UWP API you added.\n\n## Deploy your converted UWP app\n\nTo deploy your app during development, run the following PowerShell cmdlet: \n\n```Add-AppxPackage –Register AppxManifest.xml```\n\nTo update your app's .exe or .dll files, simply replace the existing files in your package with the new ones, increase the version number in AppxManifest.xml, and then run the above command again.\n\nNote the following: \n\nAny drive that you install your converted app on to must be formatted to NTFS format.\n\nA converted app always runs as the interactive user. This has particular significance for a .NET app whose manifest specifies an execution level of __requireAdministrator__. If the interactive user has administrator privileges then a UAC prompt will be displayed _each time the app is launched_. For standard users, the app will fail to launch.\n\nIf you try to run the Add-AppxPackage cmdlet on a machine where you haven't imported the cert you created, you'll get an error.\n\nBefore you deploy your app, you'll need to sign it with a certificate. For information on creating a certificate, see [Sign your .Appx Package](https://msdn.microsoft.com/windows/uwp/porting/desktop-to-uwp-run-desktop-app-converter#deploy-your-converted-appx). \n\nHere's how you import a certificate that you created previously. You can install it directly, or you can install it from an appx that you've signed, like the customer will.\n1.  In File Explorer, right click an appx that you've signed with a test cert and choose **Properties** from the context menu.\n2.  Click or tap the **Digital Signatures** tab.\n3.  Click or tap on the certificate and choose **Details**.\n4.  Click or tap **View Certificate**.\n5.  Click or tap **Install Certificate**.\n6.  In the **Store Location** group, select **Local Machine**.\n7.  Click or tap **Next** and **OK** to confirm the UAC dialog.\n8.  In the next screen of the Certificate Import Wizard, change the selected option to **Place all certificates in the following store**.\n9.  Click or tap **Browse**. In the Select Certificate Store window, scroll down and select **Trusted People** and click or tap **OK**.\n10. Click or tap **Next**. A new screen appears. Click or tap **Finish**.\n11. A confirmation dialog should appear. If so, click **OK**. If a different dialog indicates that there is a problem with the certificate, you may need to do some certificate troubleshooting.\n\nFor Windows to trust the certificate, the certificate must be located in either the **Certificates (Local Computer) > Trusted Root Certification Authorities > Certificates** node or the **Certificates (Local Computer) > Trusted People > Certificates** node. Only certificates in these two locations can validate the certificate trust in the context of the local machine. Otherwise, an error message that resembles the following string appears:\n```CMD\n\"Add-AppxPackage : Deployment failed with HRESULT: 0x800B0109, A certificate chain processed,\nbut terminated in a rootcertificate which is not trusted by the trust provider.\n(Exception from HRESULT: 0x800B0109) error 0x800B0109: The root certificate of the signature\nin the app package must be trusted.\"\n```\n\n### Behind the scenes\n\nWhen you run your converted app, your UWP app package is launched from \\Program Files\\WindowsApps\\\\&lt;_package name_&gt;\\\\&lt;_appname_&gt;.exe. If you look there, you'll see that your app has an app package manifest (named AppxManifest.xml), which references a special xml namespace that's used for converted apps. Inside that manifest file is an __&lt;EntryPoint&gt;__ element, which references a full-trust app. When that app is launched, it does not run inside an app container, but instead it runs as the user as it normally would.\n\nBut the app runs in a special environment where any accesses that the app makes to the file system and to the Registry are redirected. The file named Registry.dat is used for Registry redirection. It's actually a Registry hive, so you can view it in the Windows Registry Editor (Regedit). Note, that this mechanism means that you can't use the Registry for inter-process communication. The Registry wasn't designed for, and is not well-suited to, that practice in any case. When it comes to the file system, the only thing redirected is the AppData folder, and it is redirected to the same location that app data is stored for all UWP apps. This location is known as the local app data store, and you access it by using the [ApplicationData.LocalFolder](https://msdn.microsoft.com/library/windows/apps/br241621) property. This way, your code is already ported to read and write app data in the correct place without you doing anything. And you can also write there directly. One benefit of file system redirection is a cleaner uninstall experience.\n\nInside a folder named VFS, you will see folders that contain the DLLs that your app has dependencies on. These DLLs are installed into system folders for the classic desktop version of your app. But, as a UWP app, the DLLs are local to your app. This way, there are no versioning problems when UWP apps are installed and uninstalled.\n\n## See also\n[Convert your desktop application to a Universal Windows Platform (UWP) app](https://msdn.microsoft.com/windows/uwp/porting/desktop-to-uwp-root)\n\n[Desktop App Converter Preview (Project Centennial)](https://msdn.microsoft.com/windows/uwp/porting/desktop-to-uwp-run-desktop-app-converter)\n\n[Manually convert your Windows desktop application to a Universal Windows Platform (UWP) app](https://msdn.microsoft.com/en-us/windows/uwp/porting/desktop-to-uwp-manual-conversion)\n\n[Desktop app bridge to UWP code samples on GitHub](https://github.com/Microsoft/DesktopBridgeToUWP-Samples)"}