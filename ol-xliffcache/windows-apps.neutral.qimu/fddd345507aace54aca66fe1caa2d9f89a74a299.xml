{"nodes":[{"content":"Explains how to define a ResourceDictionary element and keyed resources, and how XAML resources relate to other resources that you define as part of your app or app package.","pos":[33,206]},{"content":"ResourceDictionary and XAML resource references","pos":[384,431]},{"content":"ResourceDictionary and XAML resource references","pos":[564,611]},{"content":"You can define the UI or resources for your app using XAML.","pos":[615,674]},{"content":"Resources are typically definitions of some object that you expect to use more than once.","pos":[675,764]},{"content":"To refer to a XAML resource later, you specify a key for a resource that acts like its name.","pos":[765,857]},{"content":"You can reference a resource throughout an app or from any XAML page within it.","pos":[858,937]},{"content":"You can define your resources using a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ResourceDictionary<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208794)</ept> element from the Windows Runtime XAML.","pos":[938,1097]},{"content":"Then, you can reference your resources by using a <bpt id=\"p1\">[</bpt>StaticResource markup extension<ept id=\"p1\">](../xaml-platform/staticresource-markup-extension.md)</ept> or <bpt id=\"p2\">[</bpt>ThemeResource markup extension<ept id=\"p2\">](../xaml-platform/themeresource-markup-extension.md)</ept>.","pos":[1098,1323]},{"content":"The XAML elements you might want to declare most often as XAML resources include <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Style<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208849)</ept>, <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>ControlTemplate<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br209391)</ept>, animation components, and <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>Brush<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/br228076)</ept> subclasses.","pos":[1325,1665]},{"content":"Here, we explain how to define a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ResourceDictionary<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208794)</ept> and keyed resources, and how XAML resources relate to other resources that you define as part of your app or app package.","pos":[1666,1903]},{"content":"We also explain resource dictionary advanced features such as <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>MergedDictionaries<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208801)</ept> and <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>ThemeDictionaries<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br208807)</ept>.","pos":[1904,2135]},{"content":"Prerequisites","pos":[2139,2152]},{"pos":[2156,2290],"content":"We assume that you understand XAML markup and have read the <bpt id=\"p1\">[</bpt>XAML overview<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/mt185595)</ept>."},{"content":"Define and use XAML resources","pos":[2295,2324]},{"content":"XAML resources are objects that are referenced from markup more than once.","pos":[2326,2400]},{"content":"Resources are defined in a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ResourceDictionary<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208794)</ept>, typically in a separate file or at the top of the markup page, like this.","pos":[2401,2585]},{"content":"In this example:","pos":[3035,3051]},{"pos":[3094,3128],"content":"- Defines the resource dictionary."},{"pos":[3146,3193],"content":"- Defines the resource with the key \"greeting\"."},{"pos":[3226,3459],"content":"- Looks up the resource with the key \"greeting\", which is assigned to the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Text<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br209676)</ept> property of the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>TextBlock<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br209652)</ept>."},{"pos":[3463,3782],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>Don't confuse the concepts related to <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>ResourceDictionary<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/br208794)</ept> with the <bpt id=\"p4\">**</bpt>Resource<ept id=\"p4\">**</ept> build action, resource (.resw) files, or other \"resources\" that are discussed in the context of structuring the code project that produces your app package."},{"content":"Resources don't have to be strings; they can be any shareable object, such as styles, templates, brushes, and colors.","pos":[3784,3901]},{"content":"However, controls, shapes, and other <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>FrameworkElement<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208706)</ept>s are not shareable, so they can't be declared as reusable resources.","pos":[3902,4088]},{"content":"For more info about sharing, see the <bpt id=\"p1\">[</bpt>XAML resources must be shareable<ept id=\"p1\">](#xaml_resources_must_be_sharable)</ept> section later in this topic.","pos":[4089,4223]},{"content":"Here, both a brush and a string are declared as resources and used by controls in a page.","pos":[4225,4314]},{"content":"All resources need to have a key.","pos":[4918,4951]},{"content":"Usually that key is a string defined with <ph id=\"ph1\">`x:Key=”myString”`</ph>.","pos":[4952,5013]},{"content":"However, there are a few other ways to specify a key:","pos":[5014,5067]},{"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Style<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208849)</ept> and <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>ControlTemplate<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br209391)</ept> require a <bpt id=\"p5\">**</bpt>TargetType<ept id=\"p5\">**</ept>, and will use the <bpt id=\"p6\">**</bpt>TargetType<ept id=\"p6\">**</ept> as the key if <bpt id=\"p7\">[</bpt>x:Key<ept id=\"p7\">](https://msdn.microsoft.com/library/windows/apps/mt204787)</ept> is not specified.","pos":[5073,5382]},{"content":"In this case, the key is the actual Type object, not a string.","pos":[5383,5445]},{"content":"(See examples below)","pos":[5446,5466]},{"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>DataTemplate<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br242348)</ept> resources that have a <bpt id=\"p3\">**</bpt>TargetType<ept id=\"p3\">**</ept> will use the <bpt id=\"p4\">**</bpt>TargetType<ept id=\"p4\">**</ept> as the key if <bpt id=\"p5\">[</bpt>x:Key<ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/mt204787)</ept> is not specified.","pos":[5471,5710]},{"content":"In this case, the key is the actual Type object, not a string.","pos":[5711,5773]},{"content":"<bpt id=\"p1\">[</bpt>x:Name<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/mt204788)</ept> can be used instead of <bpt id=\"p2\">[</bpt>x:Key<ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/mt204787)</ept>.","pos":[5778,5934]},{"content":"However, x:Name also generates a code behind field for the resource.","pos":[5935,6003]},{"content":"As a result, x:Name is less efficient than x:Key because that field needs to be initialized when the page is loaded.","pos":[6004,6120]},{"content":"The <bpt id=\"p1\">[</bpt>StaticResource markup extension<ept id=\"p1\">](../xaml-platform/staticresource-markup-extension.md)</ept> can retrieve resources only with a string name (<bpt id=\"p2\">[</bpt>x:Key<ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/mt204787)</ept> or <bpt id=\"p3\">[</bpt>x:Name<ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/mt204788)</ept>).","pos":[6122,6398]},{"content":"However, the XAML framework also looks for implicit style resources (those which use <bpt id=\"p1\">**</bpt>TargetType<ept id=\"p1\">**</ept> rather than x:Key or x:Name) when it decides which style &amp; template to use for a control that hasn't set the <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>Style<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/br208743)</ept> and <bpt id=\"p4\">[</bpt><bpt id=\"p5\">**</bpt>ContentTemplate<ept id=\"p5\">**</ept><ept id=\"p4\">](https://msdn.microsoft.com/library/windows/apps/br209369)</ept> or <bpt id=\"p6\">[</bpt><bpt id=\"p7\">**</bpt>ItemTemplate<ept id=\"p7\">**</ept><ept id=\"p6\">](https://msdn.microsoft.com/library/windows/apps/br242830)</ept> properties.","pos":[6399,6853]},{"pos":[6855,7239],"content":"Here, the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Style<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208849)</ept> has an implicit key of <bpt id=\"p3\">**</bpt>typeof(Button)<ept id=\"p3\">**</ept>, and since the <bpt id=\"p4\">[</bpt><bpt id=\"p5\">**</bpt>Button<ept id=\"p5\">**</ept><ept id=\"p4\">](https://msdn.microsoft.com/library/windows/apps/br209265)</ept> at the bottom of the page doesn't specify a <bpt id=\"p6\">[</bpt><bpt id=\"p7\">**</bpt>Style<ept id=\"p7\">**</ept><ept id=\"p6\">](https://msdn.microsoft.com/library/windows/apps/br208743)</ept> property, it looks for a style with key of <bpt id=\"p8\">**</bpt>typeof(Button)<ept id=\"p8\">**</ept>:"},{"pos":[7730,7875],"content":"For more info about implicit styles and how they work, see <bpt id=\"p1\">[</bpt>Styling controls<ept id=\"p1\">](styling-controls.md)</ept> and <bpt id=\"p2\">[</bpt>Control templates<ept id=\"p2\">](control-templates.md)</ept>."},{"content":"Look up resources in code","pos":[7880,7905]},{"content":"You access members of the resource dictionary like any other dictionary.","pos":[7907,7979]},{"content":"<bpt id=\"p1\">**</bpt>Caution<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>When you perform a resource lookup in code, only the resources in the <ph id=\"ph2\">`Page.Resources`</ph> dictionary are looked at.","pos":[7983,8118]},{"content":"Unlike the <bpt id=\"p1\">[</bpt>StaticResource markup extension<ept id=\"p1\">](../xaml-platform/staticresource-markup-extension.md)</ept>, the code doesn't fall back to the <ph id=\"ph1\">`Application.Resources`</ph> dictionary if the resources aren’t found in the first dictionary.","pos":[8119,8341]},{"pos":[8346,8447],"content":"This example shows how to retrieve the <ph id=\"ph1\">`redButtonStyle`</ph> resource out of a page’s resource dictionary:"},{"pos":[9053,9184],"content":"To look up app-wide resources from code, use <bpt id=\"p1\">**</bpt>Application.Current.Resources<ept id=\"p1\">**</ept> to get the app's resource dictionary, as shown here."},{"content":"You can also add an application resource in code.","pos":[9863,9912]},{"content":"There are two things to keep in mind when doing this.","pos":[9914,9967]},{"content":"First, you need to add the resources before any page tries to use the resource.","pos":[9973,10052]},{"content":"Second, you can’t add resources in the App’s constructor.","pos":[10057,10114]},{"pos":[10116,10280],"content":"You can avoid both problems if you add the resource in the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Application.OnLaunched<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br242335)</ept> method, like this."},{"content":"Every FrameworkElement can have a ResourceDictionary","pos":[10762,10814]},{"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>FrameworkElement<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208706)</ept> is a base class that controls inherit from, and it has a <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>Resources<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br208740)</ept> property.","pos":[10816,11037]},{"content":"So, you can add a local resource dictionary to any <bpt id=\"p1\">**</bpt>FrameworkElement<ept id=\"p1\">**</ept>.","pos":[11038,11110]},{"content":"Here, a resource dictionary is added to a page element.","pos":[11112,11167]},{"content":"Here, both the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Page<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br227503)</ept> and the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>Border<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br209250)</ept> have resource dictionaries, and they both have a resource called \"greeting\".","pos":[11706,11945]},{"content":"The <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>TextBlock<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br209652)</ept> is inside the <bpt id=\"p3\">**</bpt>Border<ept id=\"p3\">**</ept>, so its resource lookup looks first to the <bpt id=\"p4\">**</bpt>Border<ept id=\"p4\">**</ept>’s resources, then the <bpt id=\"p5\">**</bpt>Page<ept id=\"p5\">**</ept>’s resources, and then the <bpt id=\"p6\">[</bpt><bpt id=\"p7\">**</bpt>Application<ept id=\"p7\">**</ept><ept id=\"p6\">](https://msdn.microsoft.com/library/windows/apps/br242324)</ept> resources.","pos":[11946,12246]},{"content":"The <bpt id=\"p1\">**</bpt>TextBlock<ept id=\"p1\">**</ept> will read \"Hola mundo\".","pos":[12247,12288]},{"content":"To access that element’s resources from code, use that element’s <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Resources<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208740)</ept> property.","pos":[12290,12438]},{"content":"Accessing a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>FrameworkElement<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208706)</ept>’s resources in code, rather than XAML, will look only in that dictionary, not in parent element’s dictionaries.","pos":[12439,12643]},{"content":"Merged resource dictionaries","pos":[13326,13354]},{"pos":[13356,13458],"content":"A <bpt id=\"p1\">*</bpt>merged resource dictionary<ept id=\"p1\">*</ept> combines one resource dictionary into another, usually in another file."},{"pos":[13462,13644],"content":"<bpt id=\"p1\">**</bpt>Tip<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>You can create a resource dictionary file in Microsoft Visual Studio by using the <bpt id=\"p2\">**</bpt>Add <ph id=\"ph2\">&amp;gt;</ph> New Item… <ph id=\"ph3\">&amp;gt;</ph> Resource Dictionary<ept id=\"p2\">**</ept> option from the <bpt id=\"p3\">**</bpt>Project<ept id=\"p3\">**</ept> menu."},{"content":"Here, you define a resource dictionary in a separate XAML file called Dictionary1.xaml.","pos":[13646,13733]},{"content":"To use that dictionary, you merge it with your page’s dictionary:","pos":[14034,14099]},{"content":"Here's what happens in this example.","pos":[14741,14777]},{"content":"In <ph id=\"ph1\">`&lt;Page.Resources&gt;`</ph>, you declare <ph id=\"ph2\">`&lt;ResourceDictionary&gt;`</ph>.","pos":[14778,14836]},{"content":"The XAML framework implicitly creates a resource dictionary for you when you add resources to <ph id=\"ph1\">`&lt;Page.Resources&gt;`</ph>; however, in this case, you don’t want just any resource dictionary, you want one that contains merged dictionaries.","pos":[14837,15066]},{"content":"So you declare <ph id=\"ph1\">`&lt;ResourceDictionary&gt;`</ph>, then add things to its <ph id=\"ph2\">`&lt;ResourceDictionary.MergedDictionaries&gt;`</ph> collection.","pos":[15068,15183]},{"content":"Each of those entries takes the form <ph id=\"ph1\">`&lt;ResourceDictionary Source=\"Dictionary1.xaml\"/&gt;`</ph>.","pos":[15184,15271]},{"content":"To add more than one dictionary, just add a <ph id=\"ph1\">`&lt;ResourceDictionary Source=\"Dictionary2.xaml\"/&gt;`</ph> entry after the first entry.","pos":[15272,15394]},{"content":"After <ph id=\"ph1\">`&lt;ResourceDictionary.MergedDictionaries&gt;…&lt;/ResourceDictionary.MergedDictionaries&gt;`</ph>, you can optionally put additional resources in your main dictionary.","pos":[15396,15554]},{"content":"You use resources from a merged to dictionary just like a regular dictionary.","pos":[15555,15632]},{"content":"In the example above, <ph id=\"ph1\">`{StaticResource brush}`</ph> finds the resource in the child/merged dictionary (Dictionary1.xaml), while <ph id=\"ph2\">`{StaticResource greeting}`</ph> finds its resource in the main page dictionary.","pos":[15633,15831]},{"content":"In the resource-lookup sequence, a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>MergedDictionaries<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208801)</ept> dictionary is checked only after a check of all the other keyed resources of that <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>ResourceDictionary<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br208794)</ept>.","pos":[15833,16116]},{"content":"After searching that level, the lookup reaches the merged dictionaries, and each item in <bpt id=\"p1\">**</bpt>MergedDictionaries<ept id=\"p1\">**</ept> is checked.","pos":[16117,16240]},{"content":"If multiple merged dictionaries exist, these dictionaries are checked in the inverse of the order in which they are declared in the <bpt id=\"p1\">**</bpt>MergedDictionaries<ept id=\"p1\">**</ept> property.","pos":[16241,16405]},{"content":"In the following example, if both Dictionary2.xaml and Dictionary1.xaml declared the same key, the key from Dictionary2.xaml is used first because it's last in the <bpt id=\"p1\">**</bpt>MergedDictionaries<ept id=\"p1\">**</ept> set.","pos":[16406,16597]},{"content":"Within the scope of any one <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ResourceDictionary<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208794)</ept>, the dictionary is checked for key uniqueness.","pos":[17224,17381]},{"content":"However, that scope does not extend across different items in different <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>MergedDictionaries<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208801)</ept> files.","pos":[17382,17543]},{"content":"You can use the combination of the lookup sequence and lack of unique key enforcement across merged-dictionary scopes to create a fallback value sequence of <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ResourceDictionary<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208794)</ept> resources.","pos":[17545,17795]},{"content":"For example, you might store user preferences for a particular brush color in the last merged resource dictionary in the sequence, using a resource dictionary that synchronizes to your app's state and user preference data.","pos":[17796,18018]},{"content":"However, if no user preferences exist yet, you can define that same key string for a <bpt id=\"p1\">**</bpt>ResourceDictionary<ept id=\"p1\">**</ept> resource in the initial <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>MergedDictionaries<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/br208801)</ept> file, and it can serve as the fallback value.","pos":[18019,18279]},{"content":"Remember that any value you provide in a primary resource dictionary is always checked before the merged dictionaries are checked, so if you want to use the fallback technique, don't define that resource in a primary resource dictionary.","pos":[18280,18517]},{"content":"Theme resources and theme dictionaries","pos":[18522,18560]},{"pos":[18562,18781],"content":"A <bpt id=\"p1\">[</bpt>ThemeResource<ept id=\"p1\">](../xaml-platform/themeresource-markup-extension.md)</ept> is similar to a <bpt id=\"p2\">[</bpt>StaticResource<ept id=\"p2\">](../xaml-platform/staticresource-markup-extension.md)</ept>, but the resource lookup is reevaluated when the theme changes."},{"pos":[18783,18936],"content":"In this example, you set the foreground of a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>TextBlock<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br209652)</ept> to a value from the current theme."},{"content":"A theme dictionary is a special type of merged dictionary that holds the resources that vary with the theme a user is currently using on his or her device.","pos":[19072,19227]},{"content":"For example, the \"light\" theme might use a white color brush whereas the \"dark\" theme might use a dark color brush.","pos":[19228,19343]},{"content":"The brush changes the resource that it resolves to, but otherwise the composition of a control that uses the brush as a resource could be the same.","pos":[19344,19491]},{"content":"To reproduce the theme-switching behavior in your own templates and styles, instead of using <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>MergedDictionaries<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208801)</ept> as the property to merge items into the main dictionaries, use the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>ThemeDictionaries<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br208807)</ept> property.","pos":[19492,19826]},{"content":"Each <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ResourceDictionary<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208794)</ept> element within <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>ThemeDictionaries<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br208807)</ept> must have an <bpt id=\"p5\">[</bpt>x:Key<ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/mt204787)</ept> value.","pos":[19828,20098]},{"content":"The value is a string that names the relevant theme—for example, \"Default\", \"Dark\", \"Light\", or \"HighContrast\".","pos":[20099,20210]},{"content":"Typically, <ph id=\"ph1\">`Dictionary1`</ph> and <ph id=\"ph2\">`Dictionary2`</ph> will define resources that have the same names but different values.","pos":[20211,20322]},{"content":"Here, you use red text for the light theme and blue text for the dark theme.","pos":[20324,20400]},{"pos":[20985,21138],"content":"In this example, you set the foreground of a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>TextBlock<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br209652)</ept> to a value from the current theme."},{"content":"For theme dictionaries, the active dictionary to be used for resource lookup changes dynamically, whenever <bpt id=\"p1\">[</bpt>ThemeResource markup extension<ept id=\"p1\">](../xaml-platform/themeresource-markup-extension.md)</ept> is used to make the reference and the system detects a theme change.","pos":[21790,22050]},{"content":"The lookup behavior that is done by the system is based on mapping the active theme to the <bpt id=\"p1\">[</bpt>x:Key<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/mt204787)</ept> of a specific theme dictionary.","pos":[22051,22239]},{"content":"It can be useful to examine the way that the theme dictionaries are structured in the default XAML design resources, which parallel the templates that the Windows Runtime uses by default for its controls.","pos":[22241,22445]},{"content":"Open the XAML files in <ph id=\"ph1\">\\\\</ph>(Program Files)<ph id=\"ph2\">\\\\</ph>Windows Kits<ph id=\"ph3\">\\\\</ph>10<ph id=\"ph4\">\\\\</ph>DesignTime<ph id=\"ph5\">\\\\</ph>CommonConfiguration<ph id=\"ph6\">\\\\</ph>Neutral<ph id=\"ph7\">\\\\</ph>UAP<ph id=\"ph8\">\\\\&amp;lt;</ph>SDK version<ph id=\"ph9\">&amp;gt;\\\\</ph>Generic using a text editor or your IDE.","pos":[22446,22614]},{"content":"Note how the theme dictionaries are defined first in generic.xaml, and how each theme dictionary defines the same keys.","pos":[22615,22734]},{"content":"Each such key is then referenced by elements of composition in the various keyed elements that are outside the theme dictionaries and defined later in the XAML.","pos":[22735,22895]},{"content":"There's also a separate themeresources.xaml file for design that contains only the theme resources and extra templates, not the default control templates.","pos":[22896,23050]},{"content":"The theme areas are duplicates of what you'd see in generic.xaml.","pos":[23051,23116]},{"content":"When you use XAML design tools to edit copies of styles and templates, the design tools extract sections from the XAML design resource dictionaries and place them as local copies of XAML dictionary elements that are part of your app and project.","pos":[23118,23363]},{"pos":[23365,23521],"content":"For more info and for a list of the theme-specific and system resources that are available to your app, see <bpt id=\"p1\">[</bpt>XAML theme resources<ept id=\"p1\">](xaml-theme-resources.md)</ept>."},{"content":"Lookup behavior for XAML resource references","pos":[23526,23570]},{"content":"<bpt id=\"p1\">*</bpt>Lookup behavior<ept id=\"p1\">*</ept> is the term that describes how the XAML resources system tries to find a XAML resource.","pos":[23572,23677]},{"content":"The lookup occurs when a key is referenced as a XAML resource reference from somewhere in the app's XAML.","pos":[23678,23783]},{"content":"First, the resources system has predictable behavior for where it will check for the existence of a resource based on scope.","pos":[23784,23908]},{"content":"If a resource isn't found in the initial scope, the scope expands.","pos":[23909,23975]},{"content":"The lookup behavior continues on throughout the locations and scopes that a XAML resource could possibly be defined by an app or by the system.","pos":[23976,24119]},{"content":"If all possible resource lookup attempts fail, an error often results.","pos":[24120,24190]},{"content":"It's usually possible to eliminate these errors during the development process.","pos":[24191,24270]},{"content":"The lookup behavior for XAML resource references starts with the object where the actual usage is applied and its own <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Resources<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208740)</ept> property.","pos":[24272,24473]},{"content":"If a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ResourceDictionary<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208794)</ept> exists there, that <bpt id=\"p3\">**</bpt>ResourceDictionary<ept id=\"p3\">**</ept> is checked for an item that has the requested key.","pos":[24474,24654]},{"content":"This first level of lookup is rarely relevant because you usually do not define and then reference a resource on the same object.","pos":[24655,24784]},{"content":"In fact, a <bpt id=\"p1\">**</bpt>Resources<ept id=\"p1\">**</ept> property often doesn't exist here.","pos":[24785,24844]},{"content":"You can make XAML resource references from nearly anywhere in XAML; you aren't limited to properties of <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>FrameworkElement<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208706)</ept> subclasses.","pos":[24845,25041]},{"content":"The lookup sequence then checks the next parent object in the runtime object tree of the app.","pos":[25043,25136]},{"content":"If a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>FrameworkElement.Resources<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208740)</ept> exists and holds a <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>ResourceDictionary<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br208794)</ept>, the dictionary item with the specified key string is requested.","pos":[25137,25399]},{"content":"If the resource is found, the lookup sequence stops and the object is provided to the location where the reference was made.","pos":[25400,25524]},{"content":"Otherwise, the lookup behavior advances to the next parent level towards the object tree root.","pos":[25525,25619]},{"content":"The search continues recursively upwards until the root element of the XAML is reached, exhausting the search of all possible immediate resource locations.","pos":[25620,25775]},{"pos":[25779,25992],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>It is a common practice to define all the immediate resources at the root level of a page, both to take advantage of this resource-lookup behavior and also as a convention of XAML markup style."},{"content":"If the requested resource is not found in the immediate resources, the next lookup step is to check the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Application.Resources<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br242338)</ept> property.","pos":[25997,26196]},{"content":"<bpt id=\"p1\">**</bpt>Application.Resources<ept id=\"p1\">**</ept> is the best place to put any app-specific resources that are referenced by multiple pages in your app's navigation structure.","pos":[26197,26348]},{"content":"Control templates have another possible location in the reference lookup: theme dictionaries.","pos":[26350,26443]},{"content":"A theme dictionary is a single XAML file that has a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ResourceDictionary<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208794)</ept> element as its root.","pos":[26444,26599]},{"content":"The theme dictionary might be a merged dictionary from <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Application.Resources<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br242338)</ept>.","pos":[26600,26741]},{"content":"The theme dictionary might also be the control-specific theme dictionary for a templated custom control.","pos":[26742,26846]},{"content":"Finally, there is a resource lookup against platform resources.","pos":[26848,26911]},{"content":"Platform resources include the control templates that are defined for each of the system UI themes, and which define the default appearance of all the controls that you use for UI in a Windows Runtime app.","pos":[26912,27117]},{"content":"Platform resources also include a set of named resources that relate to system-wide appearance and themes.","pos":[27118,27224]},{"content":"These resources are technically a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>MergedDictionaries<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208801)</ept> item, and thus are available for lookup from XAML or code once the app has loaded.","pos":[27225,27424]},{"content":"For example, the system theme resources include a resource named \"SystemColorWindowTextColor\" that provides a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Color<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh673723)</ept> definition to match app text color to a system window's text color that comes from the operating system and user preferences.","pos":[27425,27730]},{"content":"Other XAML styles for your app can refer to this style, or your code can get a resource lookup value (and cast it to <bpt id=\"p1\">**</bpt>Color<ept id=\"p1\">**</ept> in the example case).","pos":[27731,27879]},{"pos":[27881,28063],"content":"For more info and for a list of the theme-specific and system resources that are available to a Windows Store app that uses XAML, see <bpt id=\"p1\">[</bpt>XAML theme resources<ept id=\"p1\">](xaml-theme-resources.md)</ept>."},{"content":"If the requested key is still not found in any of these locations, a XAML parsing error/exception occurs.","pos":[28065,28170]},{"content":"In certain circumstances, the XAML parse exception may be a run-time exception that is not detected either by a XAML markup compile action, or by a XAML design environment.","pos":[28171,28343]},{"content":"Because of the tiered lookup behavior for resource dictionaries, you can deliberately define multiple resource items that each have the same string value as the key, as long as each resource is defined at a different level.","pos":[28345,28568]},{"content":"In other words, although keys must be unique within any given <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ResourceDictionary<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208794)</ept>, the uniqueness requirement does not extend to the lookup behavior sequence as a whole.","pos":[28569,28801]},{"content":"During lookup, only the first such object that's successfully retrieved is used for the XAML resource reference, and then the lookup stops.","pos":[28802,28941]},{"content":"You could use this behavior to request the same XAML resource by key at various positions within your app's XAML but get different resources back, depending on the scope from which the XAML resource reference was made and how that particular lookup behaves.","pos":[28942,29199]},{"content":"Forward references within a ResourceDictionary","pos":[29205,29251]},{"content":"XAML resource references within a particular resource dictionary must reference a resource that has already been defined with a key, and that resource must appear lexically before the resource reference.","pos":[29254,29457]},{"content":"Forward references cannot be resolved by a XAML resource reference.","pos":[29458,29525]},{"content":"For this reason, if you use XAML resource references from within another resource, you must design your resource dictionary structure so that the resources that are used by other resources are defined first in a resource dictionary.","pos":[29526,29758]},{"content":"Resources defined at the app level cannot make references to immediate resources.","pos":[29760,29841]},{"content":"This is equivalent to attempting a forward reference, because the app resources are actually processed first (when the app first starts, and before any navigation-page content is loaded).","pos":[29842,30029]},{"content":"However, any immediate resource can make a reference to an app resource, and this can be a useful technique for avoiding forward-reference situations.","pos":[30030,30180]},{"content":"XAML resources must be shareable","pos":[30185,30217]},{"pos":[30220,30364],"content":"For an object to exist in a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ResourceDictionary<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208794)</ept>, that object must be <bpt id=\"p3\">*</bpt>shareable<ept id=\"p3\">*</ept>."},{"content":"Being shareable is required because, when the object tree of an app is constructed and used at run time, objects cannot exist at multiple locations in the tree.","pos":[30366,30526]},{"content":"Internally, the resource system creates copies of resource values to use in the object graph of your app when each XAML resource is requested.","pos":[30527,30669]},{"pos":[30671,30835],"content":"A <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ResourceDictionary<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208794)</ept> and Windows Runtime XAML in general supports these objects for shareable usage:"},{"pos":[30841,31040],"content":"Styles and templates (<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Style<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208849)</ept> and classes derived from <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>FrameworkTemplate<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br208753)</ept>)"},{"pos":[31045,31238],"content":"Brushes and colors (classes derived from <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Brush<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br228076)</ept>, and <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>Color<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/hh673723)</ept> values)"},{"pos":[31243,31343],"content":"Animation types including <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Storyboard<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br210490)</ept>"},{"pos":[31348,31462],"content":"Transforms (classes derived from <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GeneralTransform<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br210034)</ept>)"},{"pos":[31467,31614],"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Matrix<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br210127)</ept> and <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>Matrix3D<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br243266)</ept>"},{"pos":[31619,31695],"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Point<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br225870)</ept> values"},{"pos":[31700,31898],"content":"Certain other UI-related structures such as <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Thickness<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208864)</ept> and <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>CornerRadius<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br242343)</ept>"},{"content":"XAML intrinsic data types","pos":[31904,31929]},{"content":"You can also use custom types as a shareable resource if you follow the necessary implementation patterns.","pos":[31990,32096]},{"content":"You define such classes in your backing code (or in runtime components that you include) and then instantiate those classes in XAML as a resource.","pos":[32097,32243]},{"content":"Examples are object data sources and <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>IValueConverter<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br209903)</ept> implementations for data binding.","pos":[32244,32394]},{"content":"Custom types must have a default constructor, because that's what a XAML parser uses to instantiate a class.","pos":[32396,32504]},{"content":"Custom types used as resources can't have the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>UIElement<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208911)</ept> class in their inheritance, because a <bpt id=\"p3\">**</bpt>UIElement<ept id=\"p3\">**</ept> can never be shareable (it's always intended to represent exactly one UI element that exists at one position in the object graph of your runtime app).","pos":[32505,32827]},{"content":"UserControl usage scope","pos":[32832,32855]},{"content":"A <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>UserControl<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br227647)</ept> element has a special situation for resource-lookup behavior because it has the inherent concepts of a definition scope and a usage scope.","pos":[32858,33074]},{"content":"A <bpt id=\"p1\">**</bpt>UserControl<ept id=\"p1\">**</ept> that makes a XAML resource reference from its definition scope must be able to support the lookup of that resource within its own definition-scope lookup sequence—that is, it cannot access app resources.","pos":[33075,33296]},{"content":"From a <bpt id=\"p1\">**</bpt>UserControl<ept id=\"p1\">**</ept> usage scope, a resource reference is treated as being within the lookup sequence towards its usage page root (just like any other resource reference made from an object in a loaded object tree) and can access app resources.","pos":[33297,33543]},{"content":"ResourceDictionary and XamlReader.Load","pos":[33548,33586]},{"content":"You can use a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ResourceDictionary<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208794)</ept> as either the root or a part of the XAML input for the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>XamlReader.Load<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br228048)</ept> method.","pos":[33588,33827]},{"content":"You can also include XAML resource references in that XAML if all such references are completely self-contained in the XAML submitted for loading.","pos":[33828,33974]},{"content":"<bpt id=\"p1\">**</bpt>XamlReader.Load<ept id=\"p1\">**</ept> parses the XAML in a context that is not aware of any other <bpt id=\"p2\">**</bpt>ResourceDictionary<ept id=\"p2\">**</ept> objects, not even <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>Application.Resources<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br242338)</ept>.","pos":[33975,34182]},{"content":"Also, don't use <ph id=\"ph1\">`{ThemeResource}`</ph> from within XAML submitted to <bpt id=\"p1\">**</bpt>XamlReader.Load<ept id=\"p1\">**</ept>.","pos":[34183,34267]},{"content":"Using a ResourceDictionary from code","pos":[34272,34308]},{"content":"Most of the scenarios for a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ResourceDictionary<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208794)</ept> are handled exclusively in XAML.","pos":[34310,34453]},{"content":"You declare the <bpt id=\"p1\">**</bpt>ResourceDictionary<ept id=\"p1\">**</ept> container and the resources within as a XAML file or set of XAML nodes in a UI definition file.","pos":[34454,34588]},{"content":"And then you use XAML resource references to request those resources from other parts of XAML.","pos":[34589,34683]},{"content":"Still, there are certain scenarios where your app might want to adjust the contents of a <bpt id=\"p1\">**</bpt>ResourceDictionary<ept id=\"p1\">**</ept> using code that executes while the app is running, or at least to query the contents of a <bpt id=\"p2\">**</bpt>ResourceDictionary<ept id=\"p2\">**</ept> to see if a resource is already defined.","pos":[34684,34949]},{"content":"These code calls are made on a <bpt id=\"p1\">**</bpt>ResourceDictionary<ept id=\"p1\">**</ept> instance, so you must first retrieve one—either an immediate <bpt id=\"p2\">**</bpt>ResourceDictionary<ept id=\"p2\">**</ept> somewhere in the object tree by getting <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>FrameworkElement.Resources<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br208740)</ept>, or <ph id=\"ph1\">`Application.Current.Resources`</ph>.","pos":[34950,35255]},{"content":"In C<ph id=\"ph1\">\\#</ph> or Microsoft Visual Basic code, you can reference a resource in a given <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ResourceDictionary<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208794)</ept> by using the indexer (<bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>Item<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/jj603134)</ept>).","pos":[35257,35511]},{"content":"A <bpt id=\"p1\">**</bpt>ResourceDictionary<ept id=\"p1\">**</ept> is a string-keyed dictionary, so the indexer uses the string key instead of an integer index.","pos":[35512,35630]},{"content":"In Visual C++ component extensions (C++/CX) code, use <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Lookup<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208800)</ept>.","pos":[35631,35756]},{"content":"When using code to examine or change a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ResourceDictionary<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208794)</ept>, the behavior for APIs like <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>Lookup<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br208800)</ept> or <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>Item<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/jj603134)</ept> does not traverse from immediate resources to app resources; that's a XAML parser behavior that only happens as XAML pages are loaded.","pos":[35758,36185]},{"content":"At run time, scope for keys is self-contained to the <bpt id=\"p1\">**</bpt>ResourceDictionary<ept id=\"p1\">**</ept> instance that you are using at the time.","pos":[36186,36302]},{"content":"However, that scope does extend into <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>MergedDictionaries<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208801)</ept>.","pos":[36303,36423]},{"content":"Also, if you request a key that does not exist in the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ResourceDictionary<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208794)</ept>, there may not be an error; the return value may simply be provided as <bpt id=\"p3\">**</bpt>null<ept id=\"p3\">**</ept>.","pos":[36425,36642]},{"content":"You may still get an error, though, if you try to use the returned <bpt id=\"p1\">**</bpt>null<ept id=\"p1\">**</ept> as a value.","pos":[36643,36730]},{"content":"The error would come from the property's setter, not your <bpt id=\"p1\">**</bpt>ResourceDictionary<ept id=\"p1\">**</ept> call.","pos":[36731,36817]},{"content":"The only way you'd avoid an error is if the property accepted <bpt id=\"p1\">**</bpt>null<ept id=\"p1\">**</ept> as a valid value.","pos":[36818,36906]},{"content":"Note how this behavior contrasts with XAML lookup behavior at XAML parse time; a failure to resolve the provided key from XAML at parse time results in a XAML parse error, even in cases where the property could have accepted <bpt id=\"p1\">**</bpt>null<ept id=\"p1\">**</ept>.","pos":[36907,37141]},{"content":"Merged resource dictionaries are included into the index scope of the primary resource dictionary that references the merged dictionary at run time.","pos":[37143,37291]},{"content":"In other words, you can use <bpt id=\"p1\">**</bpt>Item<ept id=\"p1\">**</ept> or <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>Lookup<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/br208800)</ept> of the primary dictionary to find any objects that were actually defined in the merged dictionary.","pos":[37292,37501]},{"content":"In this case, the lookup behavior does resemble the parse-time XAML lookup behavior: if there are multiple objects in merged dictionaries that each have the same key, the object from the last-added dictionary is returned.","pos":[37502,37723]},{"content":"You are permitted to add items to an existing <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ResourceDictionary<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208794)</ept> by calling <bpt id=\"p3\">**</bpt>Add<ept id=\"p3\">**</ept> (C<ph id=\"ph1\">\\#</ph> or Visual Basic) or <bpt id=\"p4\">[</bpt><bpt id=\"p5\">**</bpt>Insert<ept id=\"p5\">**</ept><ept id=\"p4\">](https://msdn.microsoft.com/library/windows/apps/br208799)</ept> (C++/CX).","pos":[37725,37978]},{"content":"You could add the items to either immediate resources or app resources.","pos":[37979,38050]},{"content":"Either of these API calls requires a key, which satisfies the requirement that each item in a <bpt id=\"p1\">**</bpt>ResourceDictionary<ept id=\"p1\">**</ept> must have a key.","pos":[38051,38184]},{"content":"However, items that you add to a <bpt id=\"p1\">**</bpt>ResourceDictionary<ept id=\"p1\">**</ept> at run time are not relevant to XAML resource references.","pos":[38185,38298]},{"content":"The necessary lookup for XAML resource references happens when that XAML is first parsed as the app is loaded (or a theme change is detected).","pos":[38299,38441]},{"content":"Resources added to collections at run time weren't available then, and altering the <bpt id=\"p1\">**</bpt>ResourceDictionary<ept id=\"p1\">**</ept> doesn't invalidate an already retrieved resource from it even if you change the value of that resource.","pos":[38442,38652]},{"content":"You also can remove items from a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ResourceDictionary<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208794)</ept> at run time, make copies of some or all items, or other operations.","pos":[38654,38837]},{"content":"The members listing for <bpt id=\"p1\">**</bpt>ResourceDictionary<ept id=\"p1\">**</ept> indicates which APIs are available.","pos":[38838,38920]},{"content":"Note that because <bpt id=\"p1\">**</bpt>ResourceDictionary<ept id=\"p1\">**</ept> has a projected API to support its underlying collection interfaces, your API options differ depending on whether you are using C<ph id=\"ph1\">\\#</ph> or Visual Basic versus C++/CX.","pos":[38921,39124]},{"content":"ResourceDictionary and localization","pos":[39129,39164]},{"content":"A XAML <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ResourceDictionary<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208794)</ept> might initially contain strings that are to be localized.","pos":[39167,39314]},{"content":"If so, store these strings as project resources instead of in a <bpt id=\"p1\">**</bpt>ResourceDictionary<ept id=\"p1\">**</ept>.","pos":[39315,39402]},{"content":"Take the strings out of the XAML, and instead give the owning element an <bpt id=\"p1\">[</bpt>x:Uid directive<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/mt204791)</ept> value.","pos":[39403,39558]},{"content":"Then, define a resource in a resources file.","pos":[39559,39603]},{"content":"Provide a resource name in the form <bpt id=\"p1\">*</bpt>XUIDValue<ept id=\"p1\">*</ept>.<bpt id=\"p2\">*</bpt>PropertyName<ept id=\"p2\">*</ept> and a resource value of the string that should be localized.","pos":[39604,39727]},{"content":"Custom resource lookup","pos":[39732,39754]},{"content":"For advanced scenarios, you can implement a class that can have different behavior than the XAML resource reference lookup behavior described in this topic.","pos":[39756,39912]},{"content":"To do this, you implement the class <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>CustomXamlResourceLoader<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br243327)</ept>, and then you can access that behavior by using the <bpt id=\"p3\">[</bpt>CustomResource markup extension<ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/mt185580)</ept> for resource references rather than using <bpt id=\"p4\">[</bpt>StaticResource<ept id=\"p4\">](../xaml-platform/staticresource-markup-extension.md)</ept> or <bpt id=\"p5\">[</bpt>ThemeResource<ept id=\"p5\">](../xaml-platform/themeresource-markup-extension.md)</ept>.","pos":[39913,40365]},{"content":"Most apps won't have scenarios that require this.","pos":[40366,40415]},{"content":"For more info, see <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>CustomXamlResourceLoader<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br243327)</ept>.","pos":[40416,40524]},{"content":"Related topics","pos":[40531,40545]},{"content":"ResourceDictionary","pos":[40550,40568]},{"content":"XAML overview","pos":[40632,40645]},{"content":"StaticResource markup extension","pos":[40707,40738]},{"content":"ThemeResource markup extension","pos":[40795,40825]},{"content":"XAML theme resources","pos":[40881,40901]},{"content":"Styling controls","pos":[40930,40946]},{"content":"x:Key attribute","pos":[40971,40986]}],"content":"---\nauthor: Jwmsft\nDescription: 'Explains how to define a ResourceDictionary element and keyed resources, and how XAML resources relate to other resources that you define as part of your app or app package.'\nMS-HAID: 'dev\\_ctrl\\_layout\\_txt.resourcedictionary\\_and\\_xaml\\_resource\\_references'\nMSHAttr: 'PreferredLib:/library/windows/apps'\nSearch.Product: eADQiWindows 10XVcnh\ntitle: ResourceDictionary and XAML resource references\nms.assetid: E3CBFA3D-6AF5-44E1-B9F9-C3D3EA8A25CE\nlabel: ResourceDictionary and XAML resource references\ntemplate: detail.hbs\n---\n\n# ResourceDictionary and XAML resource references\n\n\n\nYou can define the UI or resources for your app using XAML. Resources are typically definitions of some object that you expect to use more than once. To refer to a XAML resource later, you specify a key for a resource that acts like its name. You can reference a resource throughout an app or from any XAML page within it. You can define your resources using a [**ResourceDictionary**](https://msdn.microsoft.com/library/windows/apps/br208794) element from the Windows Runtime XAML. Then, you can reference your resources by using a [StaticResource markup extension](../xaml-platform/staticresource-markup-extension.md) or [ThemeResource markup extension](../xaml-platform/themeresource-markup-extension.md).\n\nThe XAML elements you might want to declare most often as XAML resources include [**Style**](https://msdn.microsoft.com/library/windows/apps/br208849), [**ControlTemplate**](https://msdn.microsoft.com/library/windows/apps/br209391), animation components, and [**Brush**](https://msdn.microsoft.com/library/windows/apps/br228076) subclasses. Here, we explain how to define a [**ResourceDictionary**](https://msdn.microsoft.com/library/windows/apps/br208794) and keyed resources, and how XAML resources relate to other resources that you define as part of your app or app package. We also explain resource dictionary advanced features such as [**MergedDictionaries**](https://msdn.microsoft.com/library/windows/apps/br208801) and [**ThemeDictionaries**](https://msdn.microsoft.com/library/windows/apps/br208807).\n\n**Prerequisites**\n\nWe assume that you understand XAML markup and have read the [XAML overview](https://msdn.microsoft.com/library/windows/apps/mt185595).\n\n## Define and use XAML resources\n\nXAML resources are objects that are referenced from markup more than once. Resources are defined in a [**ResourceDictionary**](https://msdn.microsoft.com/library/windows/apps/br208794), typically in a separate file or at the top of the markup page, like this.\n\n```XAML\n<Page\n    x:Class=\"MSDNSample.MainPage\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\">\n\n    <Page.Resources>\n        <x:String x:Key=\"greeting\">Hello world</x:String>\n        <x:String x:Key=\"goodbye\">Goodbye world</x:String>\n    </Page.Resources>\n\n    <TextBlock Text=\"{StaticResource greeting}\" Foreground=\"Gray\" VerticalAlignment=\"Center\"/>\n</Page>\n```\n\nIn this example:\n\n-   `<Page.Resources>…</Page.Resources>` - Defines the resource dictionary.\n-   `<x:String>` - Defines the resource with the key \"greeting\".\n-   `{StaticResource greeting}` - Looks up the resource with the key \"greeting\", which is assigned to the [**Text**](https://msdn.microsoft.com/library/windows/apps/br209676) property of the [**TextBlock**](https://msdn.microsoft.com/library/windows/apps/br209652).\n\n> **Note**&nbsp;&nbsp;Don't confuse the concepts related to [**ResourceDictionary**](https://msdn.microsoft.com/library/windows/apps/br208794) with the **Resource** build action, resource (.resw) files, or other \"resources\" that are discussed in the context of structuring the code project that produces your app package.\n\nResources don't have to be strings; they can be any shareable object, such as styles, templates, brushes, and colors. However, controls, shapes, and other [**FrameworkElement**](https://msdn.microsoft.com/library/windows/apps/br208706)s are not shareable, so they can't be declared as reusable resources. For more info about sharing, see the [XAML resources must be shareable](#xaml_resources_must_be_sharable) section later in this topic.\n\nHere, both a brush and a string are declared as resources and used by controls in a page.\n\n```XAML\n<Page\n    x:Class=\"SpiderMSDN.MainPage\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\">\n\n    <Page.Resources>\n        <SolidColorBrush x:Key=\"myFavoriteColor\" Color=\"green\"/>\n        <x:String x:Key=\"greeting\">Hello world</x:String>\n    </Page.Resources>\n\n    <TextBlock Foreground=\"{StaticResource myFavoriteColor}\" Text=\"{StaticResource greeting}\" VerticalAlignment=\"Top\"/>\n    <Button Foreground=\"{StaticResource myFavoriteColor}\" Content=\"{StaticResource greeting}\" VerticalAlignment=\"Center\"/>\n</Page>\n```\n\nAll resources need to have a key. Usually that key is a string defined with `x:Key=”myString”`. However, there are a few other ways to specify a key:\n\n-   [**Style**](https://msdn.microsoft.com/library/windows/apps/br208849) and [**ControlTemplate**](https://msdn.microsoft.com/library/windows/apps/br209391) require a **TargetType**, and will use the **TargetType** as the key if [x:Key](https://msdn.microsoft.com/library/windows/apps/mt204787) is not specified. In this case, the key is the actual Type object, not a string. (See examples below)\n-   [**DataTemplate**](https://msdn.microsoft.com/library/windows/apps/br242348) resources that have a **TargetType** will use the **TargetType** as the key if [x:Key](https://msdn.microsoft.com/library/windows/apps/mt204787) is not specified. In this case, the key is the actual Type object, not a string.\n-   [x:Name](https://msdn.microsoft.com/library/windows/apps/mt204788) can be used instead of [x:Key](https://msdn.microsoft.com/library/windows/apps/mt204787). However, x:Name also generates a code behind field for the resource. As a result, x:Name is less efficient than x:Key because that field needs to be initialized when the page is loaded.\n\nThe [StaticResource markup extension](../xaml-platform/staticresource-markup-extension.md) can retrieve resources only with a string name ([x:Key](https://msdn.microsoft.com/library/windows/apps/mt204787) or [x:Name](https://msdn.microsoft.com/library/windows/apps/mt204788)). However, the XAML framework also looks for implicit style resources (those which use **TargetType** rather than x:Key or x:Name) when it decides which style & template to use for a control that hasn't set the [**Style**](https://msdn.microsoft.com/library/windows/apps/br208743) and [**ContentTemplate**](https://msdn.microsoft.com/library/windows/apps/br209369) or [**ItemTemplate**](https://msdn.microsoft.com/library/windows/apps/br242830) properties.\n\nHere, the [**Style**](https://msdn.microsoft.com/library/windows/apps/br208849) has an implicit key of **typeof(Button)**, and since the [**Button**](https://msdn.microsoft.com/library/windows/apps/br209265) at the bottom of the page doesn't specify a [**Style**](https://msdn.microsoft.com/library/windows/apps/br208743) property, it looks for a style with key of **typeof(Button)**:\n\n```XAML\n<Page\n    x:Class=\"MSDNSample.MainPage\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\">\n\n    <Page.Resources>\n        <Style TargetType=\"Button\">\n              <Setter Property=\"Background\" Value=\"red\"/>\n        </Style>\n    </Page.Resources> \n       <!-- This button will have a red background. -->\n       <Button Content=\"Button\" Height=\"100\" VerticalAlignment=\"Center\" Width=\"100\"/>\n</Page>\n```\n\nFor more info about implicit styles and how they work, see [Styling controls](styling-controls.md) and [Control templates](control-templates.md).\n\n## Look up resources in code\n\nYou access members of the resource dictionary like any other dictionary.\n\n> **Caution**&nbsp;&nbsp;When you perform a resource lookup in code, only the resources in the `Page.Resources` dictionary are looked at. Unlike the [StaticResource markup extension](../xaml-platform/staticresource-markup-extension.md), the code doesn't fall back to the `Application.Resources` dictionary if the resources aren’t found in the first dictionary.\n\n \n\nThis example shows how to retrieve the `redButtonStyle` resource out of a page’s resource dictionary:\n\n```XAML\n<Page\n    x:Class=\"MSDNSample.MainPage\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\">\n\n    <Page.Resources>\n        <Style TargetType=\"Button\" x:Key=\"redButtonStyle\">\n            <Setter Property=\"Background\" Value=\"red\"/>\n        </Style>\n    </Page.Resources>\n</Page>\n```\n\n```CSharp\n    public sealed partial class MainPage : Page\n    {\n        public MainPage()\n        {\n            this.InitializeComponent();\n            Style redButtonStyle = (Style)this.Resources[\"redButtonStyle\"];\n        }\n    }\n```\n\nTo look up app-wide resources from code, use **Application.Current.Resources** to get the app's resource dictionary, as shown here.\n\n```XAML\n<Application\n    x:Class=\"MSDNSample.App\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:local=\"using:SpiderMSDN\">\n    <Application.Resources>\n        <Style TargetType=\"Button\" x:Key=\"appButtonStyle\">\n            <Setter Property=\"Background\" Value=\"red\"/>\n        </Style>\n    </Application.Resources>\n\n</Application>\n```\n\n```CSharp\n    public sealed partial class MainPage : Page\n    {\n        public MainPage()\n        {\n            this.InitializeComponent();\n            Style appButtonStyle = (Style)Application.Current.Resources[\"appButtonStyle\"];\n        }\n    }\n```\n\nYou can also add an application resource in code.\n\nThere are two things to keep in mind when doing this.\n\n-   First, you need to add the resources before any page tries to use the resource.\n-   Second, you can’t add resources in the App’s constructor.\n\nYou can avoid both problems if you add the resource in the [**Application.OnLaunched**](https://msdn.microsoft.com/library/windows/apps/br242335) method, like this.\n\n```CSharp\n// App.xaml.cs\n    \nsealed partial class App : Application\n{\n    protected override void OnLaunched(LaunchActivatedEventArgs e)\n    {\n        Frame rootFrame = Window.Current.Content as Frame;\n        if (rootFrame == null)\n        {\n            SolidColorBrush brush = new SolidColorBrush(Windows.UI.Color.FromArgb(255, 0, 255, 0)); // green\n            this.Resources[\"brush\"] = brush;\n            // … Other code that VS generates for you …\n        }\n    }\n}\n```\n\n## Every FrameworkElement can have a ResourceDictionary\n\n[**FrameworkElement**](https://msdn.microsoft.com/library/windows/apps/br208706) is a base class that controls inherit from, and it has a [**Resources**](https://msdn.microsoft.com/library/windows/apps/br208740) property. So, you can add a local resource dictionary to any **FrameworkElement**.\n\nHere, a resource dictionary is added to a page element.\n\n```XAML\n<Page\n    x:Class=\"MSDNSample.MainPage\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\">\n\n    <Page.Resources>\n        <x:String x:Key=\"greeting\">Hello world</x:String>\n    </Page.Resources>\n\n    <Border>\n        <Border.Resources>\n            <x:String x:Key=\"greeting\">Hola mundo</x:String>\n        </Border.Resources>\n        <TextBlock Text=\"{StaticResource greeting}\" Foreground=\"Gray\" VerticalAlignment=\"Center\"/>\n    </Border>\n</Page>\n\n```\n\nHere, both the [**Page**](https://msdn.microsoft.com/library/windows/apps/br227503) and the [**Border**](https://msdn.microsoft.com/library/windows/apps/br209250) have resource dictionaries, and they both have a resource called \"greeting\". The [**TextBlock**](https://msdn.microsoft.com/library/windows/apps/br209652) is inside the **Border**, so its resource lookup looks first to the **Border**’s resources, then the **Page**’s resources, and then the [**Application**](https://msdn.microsoft.com/library/windows/apps/br242324) resources. The **TextBlock** will read \"Hola mundo\".\n\nTo access that element’s resources from code, use that element’s [**Resources**](https://msdn.microsoft.com/library/windows/apps/br208740) property. Accessing a [**FrameworkElement**](https://msdn.microsoft.com/library/windows/apps/br208706)’s resources in code, rather than XAML, will look only in that dictionary, not in parent element’s dictionaries.\n\n```XAML\n<Page\n    x:Class=\"MSDNSample.MainPage\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\">\n\n    <Page.Resources>\n        <x:String x:Key=\"greeting\">Hello world</x:String>\n    </Page.Resources>\n\n    <Border x:Name=\"border\">\n        <Border.Resources>\n            <x:String x:Key=\"greeting\">Hola mundo</x:String>\n        </Border.Resources>\n    </Border>\n</Page>\n\n```\n\n```CSharp\n    public sealed partial class MainPage : Page\n    {\n        public MainPage()\n        {\n            this.InitializeComponent();\n            string str = (string)border.Resources[\"greeting\"];\n        }\n    }\n```\n\n## Merged resource dictionaries\n\nA *merged resource dictionary* combines one resource dictionary into another, usually in another file.\n\n> **Tip**&nbsp;&nbsp;You can create a resource dictionary file in Microsoft Visual Studio by using the **Add &gt; New Item… &gt; Resource Dictionary** option from the **Project** menu.\n\nHere, you define a resource dictionary in a separate XAML file called Dictionary1.xaml.\n\n```XAML\n<!-- Dictionary1.xaml -->\n<ResourceDictionary\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" \n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:local=\"using:MSDNSample\">\n\n    <SolidColorBrush x:Key=\"brush\" Color=\"Red\"/>\n\n</ResourceDictionary>\n\n```\n\nTo use that dictionary, you merge it with your page’s dictionary:\n\n```XAML\n<Page\n    x:Class=\"MSDNSample.MainPage\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\">\n    <Page.Resources>\n        <ResourceDictionary>\n            <ResourceDictionary.MergedDictionaries>\n                <ResourceDictionary Source=\"Dictionary1.xaml\"/>\n            </ResourceDictionary.MergedDictionaries>\n\n            <x:String x:Key=\"greeting\">Hello world</x:String>\n\n        </ResourceDictionary>\n    </Page.Resources>\n\n    <TextBlock Foreground=\"{StaticResource brush}\" Text=\"{StaticResource greeting}\" VerticalAlignment=\"Center\"/>\n</Page>\n```\n\nHere's what happens in this example. In `<Page.Resources>`, you declare `<ResourceDictionary>`. The XAML framework implicitly creates a resource dictionary for you when you add resources to `<Page.Resources>`; however, in this case, you don’t want just any resource dictionary, you want one that contains merged dictionaries.\n\nSo you declare `<ResourceDictionary>`, then add things to its `<ResourceDictionary.MergedDictionaries>` collection. Each of those entries takes the form `<ResourceDictionary Source=\"Dictionary1.xaml\"/>`. To add more than one dictionary, just add a `<ResourceDictionary Source=\"Dictionary2.xaml\"/>` entry after the first entry.\n\nAfter `<ResourceDictionary.MergedDictionaries>…</ResourceDictionary.MergedDictionaries>`, you can optionally put additional resources in your main dictionary. You use resources from a merged to dictionary just like a regular dictionary. In the example above, `{StaticResource brush}` finds the resource in the child/merged dictionary (Dictionary1.xaml), while `{StaticResource greeting}` finds its resource in the main page dictionary.\n\nIn the resource-lookup sequence, a [**MergedDictionaries**](https://msdn.microsoft.com/library/windows/apps/br208801) dictionary is checked only after a check of all the other keyed resources of that [**ResourceDictionary**](https://msdn.microsoft.com/library/windows/apps/br208794). After searching that level, the lookup reaches the merged dictionaries, and each item in **MergedDictionaries** is checked. If multiple merged dictionaries exist, these dictionaries are checked in the inverse of the order in which they are declared in the **MergedDictionaries** property. In the following example, if both Dictionary2.xaml and Dictionary1.xaml declared the same key, the key from Dictionary2.xaml is used first because it's last in the **MergedDictionaries** set.\n\n```XAML\n<Page\n    x:Class=\"MSDNSample.MainPage\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\">\n    <Page.Resources>\n        <ResourceDictionary>\n            <ResourceDictionary.MergedDictionaries>\n                <ResourceDictionary Source=\"Dictionary1.xaml\"/>\n                <ResourceDictionary Source=\"Dictionary2.xaml\"/>\n            </ResourceDictionary.MergedDictionaries>\n        </ResourceDictionary>\n    </Page.Resources>\n\n    <TextBlock Foreground=\"{StaticResource brush}\" Text=\"greetings!\" VerticalAlignment=\"Center\"/>\n</Page>\n```\n\nWithin the scope of any one [**ResourceDictionary**](https://msdn.microsoft.com/library/windows/apps/br208794), the dictionary is checked for key uniqueness. However, that scope does not extend across different items in different [**MergedDictionaries**](https://msdn.microsoft.com/library/windows/apps/br208801) files.\n\nYou can use the combination of the lookup sequence and lack of unique key enforcement across merged-dictionary scopes to create a fallback value sequence of [**ResourceDictionary**](https://msdn.microsoft.com/library/windows/apps/br208794) resources. For example, you might store user preferences for a particular brush color in the last merged resource dictionary in the sequence, using a resource dictionary that synchronizes to your app's state and user preference data. However, if no user preferences exist yet, you can define that same key string for a **ResourceDictionary** resource in the initial [**MergedDictionaries**](https://msdn.microsoft.com/library/windows/apps/br208801) file, and it can serve as the fallback value. Remember that any value you provide in a primary resource dictionary is always checked before the merged dictionaries are checked, so if you want to use the fallback technique, don't define that resource in a primary resource dictionary.\n\n## Theme resources and theme dictionaries\n\nA [ThemeResource](../xaml-platform/themeresource-markup-extension.md) is similar to a [StaticResource](../xaml-platform/staticresource-markup-extension.md), but the resource lookup is reevaluated when the theme changes.\n\nIn this example, you set the foreground of a [**TextBlock**](https://msdn.microsoft.com/library/windows/apps/br209652) to a value from the current theme.\n\n```XAML\n<TextBlock Text=\"hello world\" Foreground=\"{ThemeResource FocusVisualWhiteStrokeThemeBrush}\" VerticalAlignment=\"Center\"/>\n```\n\nA theme dictionary is a special type of merged dictionary that holds the resources that vary with the theme a user is currently using on his or her device. For example, the \"light\" theme might use a white color brush whereas the \"dark\" theme might use a dark color brush. The brush changes the resource that it resolves to, but otherwise the composition of a control that uses the brush as a resource could be the same. To reproduce the theme-switching behavior in your own templates and styles, instead of using [**MergedDictionaries**](https://msdn.microsoft.com/library/windows/apps/br208801) as the property to merge items into the main dictionaries, use the [**ThemeDictionaries**](https://msdn.microsoft.com/library/windows/apps/br208807) property.\n\nEach [**ResourceDictionary**](https://msdn.microsoft.com/library/windows/apps/br208794) element within [**ThemeDictionaries**](https://msdn.microsoft.com/library/windows/apps/br208807) must have an [x:Key](https://msdn.microsoft.com/library/windows/apps/mt204787) value. The value is a string that names the relevant theme—for example, \"Default\", \"Dark\", \"Light\", or \"HighContrast\". Typically, `Dictionary1` and `Dictionary2` will define resources that have the same names but different values.\n\nHere, you use red text for the light theme and blue text for the dark theme.\n\n```XAML\n<!-- Dictionary1.xaml -->\n<ResourceDictionary\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" \n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:local=\"using:MSDNSample\">\n\n    <SolidColorBrush x:Key=\"brush\" Color=\"Red\"/>\n\n</ResourceDictionary>\n\n<!—Dictionary2.xaml -->\n<ResourceDictionary\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" \n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:local=\"using:MSDNSample\">\n\n    <SolidColorBrush x:Key=\"brush\" Color=\"blue\"/>\n\n</ResourceDictionary>\n```\n\nIn this example, you set the foreground of a [**TextBlock**](https://msdn.microsoft.com/library/windows/apps/br209652) to a value from the current theme.\n\n```XAML\n<Page\n    x:Class=\"MSDNSample.MainPage\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\">\n    <Page.Resources>\n        <ResourceDictionary>\n            <ResourceDictionary.ThemeDictionaries>\n                <ResourceDictionary Source=\"Dictionary1.xaml\" x:Key=\"Light\"/>\n                <ResourceDictionary Source=\"Dictionary2.xaml\" x:Key=\"Dark\"/>\n            </ResourceDictionary.ThemeDictionaries>\n        </ResourceDictionary>\n    </Page.Resources>\n    <TextBlock Foreground=\"{StaticResource brush}\" Text=\"hello world\" VerticalAlignment=\"Center\"/>\n</Page>\n```\n\nFor theme dictionaries, the active dictionary to be used for resource lookup changes dynamically, whenever [ThemeResource markup extension](../xaml-platform/themeresource-markup-extension.md) is used to make the reference and the system detects a theme change. The lookup behavior that is done by the system is based on mapping the active theme to the [x:Key](https://msdn.microsoft.com/library/windows/apps/mt204787) of a specific theme dictionary.\n\nIt can be useful to examine the way that the theme dictionaries are structured in the default XAML design resources, which parallel the templates that the Windows Runtime uses by default for its controls. Open the XAML files in \\\\(Program Files)\\\\Windows Kits\\\\10\\\\DesignTime\\\\CommonConfiguration\\\\Neutral\\\\UAP\\\\&lt;SDK version&gt;\\\\Generic using a text editor or your IDE. Note how the theme dictionaries are defined first in generic.xaml, and how each theme dictionary defines the same keys. Each such key is then referenced by elements of composition in the various keyed elements that are outside the theme dictionaries and defined later in the XAML. There's also a separate themeresources.xaml file for design that contains only the theme resources and extra templates, not the default control templates. The theme areas are duplicates of what you'd see in generic.xaml.\n\nWhen you use XAML design tools to edit copies of styles and templates, the design tools extract sections from the XAML design resource dictionaries and place them as local copies of XAML dictionary elements that are part of your app and project.\n\nFor more info and for a list of the theme-specific and system resources that are available to your app, see [XAML theme resources](xaml-theme-resources.md).\n\n## Lookup behavior for XAML resource references\n\n*Lookup behavior* is the term that describes how the XAML resources system tries to find a XAML resource. The lookup occurs when a key is referenced as a XAML resource reference from somewhere in the app's XAML. First, the resources system has predictable behavior for where it will check for the existence of a resource based on scope. If a resource isn't found in the initial scope, the scope expands. The lookup behavior continues on throughout the locations and scopes that a XAML resource could possibly be defined by an app or by the system. If all possible resource lookup attempts fail, an error often results. It's usually possible to eliminate these errors during the development process.\n\nThe lookup behavior for XAML resource references starts with the object where the actual usage is applied and its own [**Resources**](https://msdn.microsoft.com/library/windows/apps/br208740) property. If a [**ResourceDictionary**](https://msdn.microsoft.com/library/windows/apps/br208794) exists there, that **ResourceDictionary** is checked for an item that has the requested key. This first level of lookup is rarely relevant because you usually do not define and then reference a resource on the same object. In fact, a **Resources** property often doesn't exist here. You can make XAML resource references from nearly anywhere in XAML; you aren't limited to properties of [**FrameworkElement**](https://msdn.microsoft.com/library/windows/apps/br208706) subclasses.\n\nThe lookup sequence then checks the next parent object in the runtime object tree of the app. If a [**FrameworkElement.Resources**](https://msdn.microsoft.com/library/windows/apps/br208740) exists and holds a [**ResourceDictionary**](https://msdn.microsoft.com/library/windows/apps/br208794), the dictionary item with the specified key string is requested. If the resource is found, the lookup sequence stops and the object is provided to the location where the reference was made. Otherwise, the lookup behavior advances to the next parent level towards the object tree root. The search continues recursively upwards until the root element of the XAML is reached, exhausting the search of all possible immediate resource locations.\n\n> **Note**&nbsp;&nbsp;It is a common practice to define all the immediate resources at the root level of a page, both to take advantage of this resource-lookup behavior and also as a convention of XAML markup style.\n\n \n\nIf the requested resource is not found in the immediate resources, the next lookup step is to check the [**Application.Resources**](https://msdn.microsoft.com/library/windows/apps/br242338) property. **Application.Resources** is the best place to put any app-specific resources that are referenced by multiple pages in your app's navigation structure.\n\nControl templates have another possible location in the reference lookup: theme dictionaries. A theme dictionary is a single XAML file that has a [**ResourceDictionary**](https://msdn.microsoft.com/library/windows/apps/br208794) element as its root. The theme dictionary might be a merged dictionary from [**Application.Resources**](https://msdn.microsoft.com/library/windows/apps/br242338). The theme dictionary might also be the control-specific theme dictionary for a templated custom control.\n\nFinally, there is a resource lookup against platform resources. Platform resources include the control templates that are defined for each of the system UI themes, and which define the default appearance of all the controls that you use for UI in a Windows Runtime app. Platform resources also include a set of named resources that relate to system-wide appearance and themes. These resources are technically a [**MergedDictionaries**](https://msdn.microsoft.com/library/windows/apps/br208801) item, and thus are available for lookup from XAML or code once the app has loaded. For example, the system theme resources include a resource named \"SystemColorWindowTextColor\" that provides a [**Color**](https://msdn.microsoft.com/library/windows/apps/hh673723) definition to match app text color to a system window's text color that comes from the operating system and user preferences. Other XAML styles for your app can refer to this style, or your code can get a resource lookup value (and cast it to **Color** in the example case).\n\nFor more info and for a list of the theme-specific and system resources that are available to a Windows Store app that uses XAML, see [XAML theme resources](xaml-theme-resources.md).\n\nIf the requested key is still not found in any of these locations, a XAML parsing error/exception occurs. In certain circumstances, the XAML parse exception may be a run-time exception that is not detected either by a XAML markup compile action, or by a XAML design environment.\n\nBecause of the tiered lookup behavior for resource dictionaries, you can deliberately define multiple resource items that each have the same string value as the key, as long as each resource is defined at a different level. In other words, although keys must be unique within any given [**ResourceDictionary**](https://msdn.microsoft.com/library/windows/apps/br208794), the uniqueness requirement does not extend to the lookup behavior sequence as a whole. During lookup, only the first such object that's successfully retrieved is used for the XAML resource reference, and then the lookup stops. You could use this behavior to request the same XAML resource by key at various positions within your app's XAML but get different resources back, depending on the scope from which the XAML resource reference was made and how that particular lookup behaves.\n\n##  Forward references within a ResourceDictionary\n\n\nXAML resource references within a particular resource dictionary must reference a resource that has already been defined with a key, and that resource must appear lexically before the resource reference. Forward references cannot be resolved by a XAML resource reference. For this reason, if you use XAML resource references from within another resource, you must design your resource dictionary structure so that the resources that are used by other resources are defined first in a resource dictionary.\n\nResources defined at the app level cannot make references to immediate resources. This is equivalent to attempting a forward reference, because the app resources are actually processed first (when the app first starts, and before any navigation-page content is loaded). However, any immediate resource can make a reference to an app resource, and this can be a useful technique for avoiding forward-reference situations.\n\n## XAML resources must be shareable\n\n\nFor an object to exist in a [**ResourceDictionary**](https://msdn.microsoft.com/library/windows/apps/br208794), that object must be *shareable*.\n\nBeing shareable is required because, when the object tree of an app is constructed and used at run time, objects cannot exist at multiple locations in the tree. Internally, the resource system creates copies of resource values to use in the object graph of your app when each XAML resource is requested.\n\nA [**ResourceDictionary**](https://msdn.microsoft.com/library/windows/apps/br208794) and Windows Runtime XAML in general supports these objects for shareable usage:\n\n-   Styles and templates ([**Style**](https://msdn.microsoft.com/library/windows/apps/br208849) and classes derived from [**FrameworkTemplate**](https://msdn.microsoft.com/library/windows/apps/br208753))\n-   Brushes and colors (classes derived from [**Brush**](https://msdn.microsoft.com/library/windows/apps/br228076), and [**Color**](https://msdn.microsoft.com/library/windows/apps/hh673723) values)\n-   Animation types including [**Storyboard**](https://msdn.microsoft.com/library/windows/apps/br210490)\n-   Transforms (classes derived from [**GeneralTransform**](https://msdn.microsoft.com/library/windows/apps/br210034))\n-   [**Matrix**](https://msdn.microsoft.com/library/windows/apps/br210127) and [**Matrix3D**](https://msdn.microsoft.com/library/windows/apps/br243266)\n-   [**Point**](https://msdn.microsoft.com/library/windows/apps/br225870) values\n-   Certain other UI-related structures such as [**Thickness**](https://msdn.microsoft.com/library/windows/apps/br208864) and [**CornerRadius**](https://msdn.microsoft.com/library/windows/apps/br242343)\n-   [XAML intrinsic data types](https://msdn.microsoft.com/library/windows/apps/mt186448)\n\nYou can also use custom types as a shareable resource if you follow the necessary implementation patterns. You define such classes in your backing code (or in runtime components that you include) and then instantiate those classes in XAML as a resource. Examples are object data sources and [**IValueConverter**](https://msdn.microsoft.com/library/windows/apps/br209903) implementations for data binding.\n\nCustom types must have a default constructor, because that's what a XAML parser uses to instantiate a class. Custom types used as resources can't have the [**UIElement**](https://msdn.microsoft.com/library/windows/apps/br208911) class in their inheritance, because a **UIElement** can never be shareable (it's always intended to represent exactly one UI element that exists at one position in the object graph of your runtime app).\n\n## UserControl usage scope\n\n\nA [**UserControl**](https://msdn.microsoft.com/library/windows/apps/br227647) element has a special situation for resource-lookup behavior because it has the inherent concepts of a definition scope and a usage scope. A **UserControl** that makes a XAML resource reference from its definition scope must be able to support the lookup of that resource within its own definition-scope lookup sequence—that is, it cannot access app resources. From a **UserControl** usage scope, a resource reference is treated as being within the lookup sequence towards its usage page root (just like any other resource reference made from an object in a loaded object tree) and can access app resources.\n\n## ResourceDictionary and XamlReader.Load\n\nYou can use a [**ResourceDictionary**](https://msdn.microsoft.com/library/windows/apps/br208794) as either the root or a part of the XAML input for the [**XamlReader.Load**](https://msdn.microsoft.com/library/windows/apps/br228048) method. You can also include XAML resource references in that XAML if all such references are completely self-contained in the XAML submitted for loading. **XamlReader.Load** parses the XAML in a context that is not aware of any other **ResourceDictionary** objects, not even [**Application.Resources**](https://msdn.microsoft.com/library/windows/apps/br242338). Also, don't use `{ThemeResource}` from within XAML submitted to **XamlReader.Load**.\n\n## Using a ResourceDictionary from code\n\nMost of the scenarios for a [**ResourceDictionary**](https://msdn.microsoft.com/library/windows/apps/br208794) are handled exclusively in XAML. You declare the **ResourceDictionary** container and the resources within as a XAML file or set of XAML nodes in a UI definition file. And then you use XAML resource references to request those resources from other parts of XAML. Still, there are certain scenarios where your app might want to adjust the contents of a **ResourceDictionary** using code that executes while the app is running, or at least to query the contents of a **ResourceDictionary** to see if a resource is already defined. These code calls are made on a **ResourceDictionary** instance, so you must first retrieve one—either an immediate **ResourceDictionary** somewhere in the object tree by getting [**FrameworkElement.Resources**](https://msdn.microsoft.com/library/windows/apps/br208740), or `Application.Current.Resources`.\n\nIn C\\# or Microsoft Visual Basic code, you can reference a resource in a given [**ResourceDictionary**](https://msdn.microsoft.com/library/windows/apps/br208794) by using the indexer ([**Item**](https://msdn.microsoft.com/library/windows/apps/jj603134)). A **ResourceDictionary** is a string-keyed dictionary, so the indexer uses the string key instead of an integer index. In Visual C++ component extensions (C++/CX) code, use [**Lookup**](https://msdn.microsoft.com/library/windows/apps/br208800).\n\nWhen using code to examine or change a [**ResourceDictionary**](https://msdn.microsoft.com/library/windows/apps/br208794), the behavior for APIs like [**Lookup**](https://msdn.microsoft.com/library/windows/apps/br208800) or [**Item**](https://msdn.microsoft.com/library/windows/apps/jj603134) does not traverse from immediate resources to app resources; that's a XAML parser behavior that only happens as XAML pages are loaded. At run time, scope for keys is self-contained to the **ResourceDictionary** instance that you are using at the time. However, that scope does extend into [**MergedDictionaries**](https://msdn.microsoft.com/library/windows/apps/br208801).\n\nAlso, if you request a key that does not exist in the [**ResourceDictionary**](https://msdn.microsoft.com/library/windows/apps/br208794), there may not be an error; the return value may simply be provided as **null**. You may still get an error, though, if you try to use the returned **null** as a value. The error would come from the property's setter, not your **ResourceDictionary** call. The only way you'd avoid an error is if the property accepted **null** as a valid value. Note how this behavior contrasts with XAML lookup behavior at XAML parse time; a failure to resolve the provided key from XAML at parse time results in a XAML parse error, even in cases where the property could have accepted **null**.\n\nMerged resource dictionaries are included into the index scope of the primary resource dictionary that references the merged dictionary at run time. In other words, you can use **Item** or [**Lookup**](https://msdn.microsoft.com/library/windows/apps/br208800) of the primary dictionary to find any objects that were actually defined in the merged dictionary. In this case, the lookup behavior does resemble the parse-time XAML lookup behavior: if there are multiple objects in merged dictionaries that each have the same key, the object from the last-added dictionary is returned.\n\nYou are permitted to add items to an existing [**ResourceDictionary**](https://msdn.microsoft.com/library/windows/apps/br208794) by calling **Add** (C\\# or Visual Basic) or [**Insert**](https://msdn.microsoft.com/library/windows/apps/br208799) (C++/CX). You could add the items to either immediate resources or app resources. Either of these API calls requires a key, which satisfies the requirement that each item in a **ResourceDictionary** must have a key. However, items that you add to a **ResourceDictionary** at run time are not relevant to XAML resource references. The necessary lookup for XAML resource references happens when that XAML is first parsed as the app is loaded (or a theme change is detected). Resources added to collections at run time weren't available then, and altering the **ResourceDictionary** doesn't invalidate an already retrieved resource from it even if you change the value of that resource.\n\nYou also can remove items from a [**ResourceDictionary**](https://msdn.microsoft.com/library/windows/apps/br208794) at run time, make copies of some or all items, or other operations. The members listing for **ResourceDictionary** indicates which APIs are available. Note that because **ResourceDictionary** has a projected API to support its underlying collection interfaces, your API options differ depending on whether you are using C\\# or Visual Basic versus C++/CX.\n\n## ResourceDictionary and localization\n\n\nA XAML [**ResourceDictionary**](https://msdn.microsoft.com/library/windows/apps/br208794) might initially contain strings that are to be localized. If so, store these strings as project resources instead of in a **ResourceDictionary**. Take the strings out of the XAML, and instead give the owning element an [x:Uid directive](https://msdn.microsoft.com/library/windows/apps/mt204791) value. Then, define a resource in a resources file. Provide a resource name in the form *XUIDValue*.*PropertyName* and a resource value of the string that should be localized.\n\n## Custom resource lookup\n\nFor advanced scenarios, you can implement a class that can have different behavior than the XAML resource reference lookup behavior described in this topic. To do this, you implement the class [**CustomXamlResourceLoader**](https://msdn.microsoft.com/library/windows/apps/br243327), and then you can access that behavior by using the [CustomResource markup extension](https://msdn.microsoft.com/library/windows/apps/mt185580) for resource references rather than using [StaticResource](../xaml-platform/staticresource-markup-extension.md) or [ThemeResource](../xaml-platform/themeresource-markup-extension.md). Most apps won't have scenarios that require this. For more info, see [**CustomXamlResourceLoader**](https://msdn.microsoft.com/library/windows/apps/br243327).\n\n \n## Related topics\n\n[**ResourceDictionary**](https://msdn.microsoft.com/library/windows/apps/br208794)\n\n[XAML overview](https://msdn.microsoft.com/library/windows/apps/mt185595)\n\n[StaticResource markup extension](../xaml-platform/staticresource-markup-extension.md)\n\n[ThemeResource markup extension](../xaml-platform/themeresource-markup-extension.md)\n\n[XAML theme resources](xaml-theme-resources.md)\n\n[Styling controls](styling-controls.md)\n\n[x:Key attribute](https://msdn.microsoft.com/library/windows/apps/mt204787)\n\n \n\n \n\n\n\n"}