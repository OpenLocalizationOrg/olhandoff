{"nodes":[{"content":"Learn how to use the AdControl class to display banner ads in a Silverlight app for Windows Phone 8.1 or Windows Phone 8.0.","pos":[86,209]},{"content":"AdControl in Windows Phone Silverlight","pos":[217,255]},{"content":"AdControl in Windows Phone Silverlight","pos":[264,302]},{"content":"Updated for UWP apps on Windows 10.","pos":[308,343]},{"content":"For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept>","pos":[344,436]},{"pos":[441,646],"content":"This walkthrough shows how to use the <bpt id=\"p1\">[</bpt>AdControl<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh524191.aspx)</ept> class to display banner ads in a Silverlight app for Windows Phone 8.1 or Windows Phone 8.0."},{"content":"Prerequisites","pos":[651,664]},{"pos":[669,805],"content":"Install the <bpt id=\"p1\">[</bpt>Microsoft Store Engagement and Monetization SDK<ept id=\"p1\">](http://aka.ms/store-em-sdk)</ept> with Visual Studio 2015 or Visual Studio 2013."},{"content":"Add the advertising assembly references","pos":[811,850]},{"content":"The Microsoft Advertising assemblies for Windows Phone Silverlight projects are not installed locally with the Microsoft Store Engagement and Monetization SDK.","pos":[852,1011]},{"content":"Before you can get started updating your code, you must first use <bpt id=\"p1\">**</bpt>Connected Services<ept id=\"p1\">**</ept> with the ad mediation support in the Microsoft Store Engagement and Monetization SDK to download these assemblies and reference them in your project.","pos":[1012,1250]},{"pos":[1256,1322],"content":"In Visual Studio, click <bpt id=\"p1\">**</bpt>Project<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Add Connected Service<ept id=\"p2\">**</ept>."},{"pos":[1328,1420],"content":"In the <bpt id=\"p1\">**</bpt>Add Connected Service<ept id=\"p1\">**</ept> dialog, click <bpt id=\"p2\">**</bpt>Ad Mediator<ept id=\"p2\">**</ept> and then click <bpt id=\"p3\">**</bpt>Configure<ept id=\"p3\">**</ept>."},{"pos":[1426,1494],"content":"Click <bpt id=\"p1\">**</bpt>Select ad networks<ept id=\"p1\">**</ept>, select <bpt id=\"p2\">**</bpt>Microsoft Advertising<ept id=\"p2\">**</ept> only."},{"content":"At this point, all the necessary Microsoft advertising assemblies for Silverlight are downloaded to your local project via NuGet packages, and references to these assemblies are automatically added to your project.","pos":[1500,1714]},{"content":"A reference to the ad mediation assembly is also added to your project.","pos":[1715,1786]},{"content":"You will remove the ad mediation assembly reference in a later step, because it is not necessary for this scenario.","pos":[1787,1902]},{"content":"In the <bpt id=\"p1\">**</bpt>Select ad networks<ept id=\"p1\">**</ept> dialog, click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>.","pos":[1908,1959]},{"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> again in the following <bpt id=\"p2\">**</bpt>Fetching status<ept id=\"p2\">**</ept> confirmation page, and finally click <bpt id=\"p3\">**</bpt>Add<ept id=\"p3\">**</ept> to close the <bpt id=\"p4\">**</bpt>Ad Mediator<ept id=\"p4\">**</ept> dialog.","pos":[1960,2097]},{"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, expand the <bpt id=\"p2\">**</bpt>References<ept id=\"p2\">**</ept> node.","pos":[2103,2160]},{"content":"Right-click <bpt id=\"p1\">**</bpt>Microsoft.AdMediator.WindowsPhone81SL.MicrosoftAdvertising<ept id=\"p1\">**</ept> and click <bpt id=\"p2\">**</bpt>Remove<ept id=\"p2\">**</ept>.","pos":[2161,2257]},{"content":"This assembly reference is not necessary for this scenario.","pos":[2258,2317]},{"content":"Code your app","pos":[2322,2335]},{"pos":[2342,2440],"content":"Add the following capabilities to the in the <bpt id=\"p1\">**</bpt>Capabilities<ept id=\"p1\">**</ept> node in your WMAppManifest.xml file."},{"pos":[2607,2663],"content":"For this example, your <bpt id=\"p1\">**</bpt>Capabilities<ept id=\"p1\">**</ept> node looks like:"},{"content":"(Optional) Save your project.","pos":[3157,3186]},{"content":"Click on the <bpt id=\"p1\">**</bpt>Save All<ept id=\"p1\">**</ept> icon or under the <bpt id=\"p2\">**</bpt>File<ept id=\"p2\">**</ept> menu click <bpt id=\"p3\">**</bpt>Save All<ept id=\"p3\">**</ept>.","pos":[3187,3264]},{"content":"Add the <bpt id=\"p1\">**</bpt>Internet (Client &amp; Server)<ept id=\"p1\">**</ept> capability to the Package.appxmanifest file in your project.","pos":[3270,3369]},{"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, double click <bpt id=\"p2\">**</bpt>Package.appxmanifest<ept id=\"p2\">**</ept>.","pos":[3370,3434]},{"content":"wp81silverlightmarkup<ph id=\"ph1\">\\-</ph>solutionexplorer<ph id=\"ph2\">\\-</ph>packageappxmanifest","pos":[3442,3502]},{"content":"In the <bpt id=\"p1\">**</bpt>Editor<ept id=\"p1\">**</ept>, click the <bpt id=\"p2\">**</bpt>Capabilities<ept id=\"p2\">**</ept> tab.","pos":[3561,3611]},{"content":"Check the <bpt id=\"p1\">**</bpt>Internet (Client &amp; Server)<ept id=\"p1\">**</ept> box.","pos":[3612,3657]},{"content":"(Optional) Save your project.","pos":[3663,3692]},{"content":"Click on the <bpt id=\"p1\">**</bpt>Save All<ept id=\"p1\">**</ept> icon or under the <bpt id=\"p2\">**</bpt>File<ept id=\"p2\">**</ept> menu click <bpt id=\"p3\">**</bpt>Save All<ept id=\"p3\">**</ept>.","pos":[3693,3770]},{"pos":[3776,3893],"content":"Modify the Silverlight markup in the MainPage.xaml file to include the <bpt id=\"p1\">**</bpt>Microsoft.Advertising.Mobile.UI<ept id=\"p1\">**</ept> namespace."},{"content":"The header of your page will have the following code:","pos":[4025,4078]},{"content":"In the <bpt id=\"p1\">**</bpt>Grid<ept id=\"p1\">**</ept> tag, add the following code for the <bpt id=\"p2\">**</bpt>AdControl<ept id=\"p2\">**</ept>.","pos":[4330,4396]},{"content":"Assign the <bpt id=\"p1\">**</bpt>ApplicationId<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>AdUnitId<ept id=\"p2\">**</ept> properties to the test values provided in <bpt id=\"p3\">[</bpt>Test mode values<ept id=\"p3\">](test-mode-values.md)</ept>, and adjust the <bpt id=\"p4\">**</bpt>Height<ept id=\"p4\">**</ept> and <bpt id=\"p5\">**</bpt>Width<ept id=\"p5\">**</ept> properties to one of the <bpt id=\"p6\">[</bpt>supported ad sizes for banner ads<ept id=\"p6\">](supported-ad-sizes-for-banner-ads.md)</ept>.","pos":[4397,4665]},{"content":"Note","pos":[4675,4679]},{"content":"You will replace the test <bpt id=\"p1\">**</bpt>ApplicationId<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>AdUnitId<ept id=\"p2\">**</ept> values with live values before submitting your app for submission.","pos":[4688,4815]},{"content":"Build and run your project.","pos":[5153,5180]},{"content":"Confirm that your app displays an ad, similar to the following:","pos":[5181,5244]},{"content":"wp81silverlight<ph id=\"ph1\">\\-</ph>emulatorwithad","pos":[5252,5283]},{"content":"Release your app with live ads using Dev Center","pos":[5341,5388]},{"content":"In the Dev Center dashboard, go to the <bpt id=\"p1\">**</bpt>Monetization<ept id=\"p1\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p2\">**</bpt>Monetize with ads<ept id=\"p2\">**</ept> page for your app, and <bpt id=\"p3\">[</bpt>create a standalone Microsoft Advertising unit<ept id=\"p3\">](../publish/monetize-with-ads.md)</ept>.","pos":[5395,5583]},{"content":"For the ad unit type, specify <bpt id=\"p1\">**</bpt>Banner<ept id=\"p1\">**</ept>.","pos":[5584,5625]},{"content":"Make note of both the ad unit ID and the application ID.","pos":[5626,5682]},{"pos":[5688,5820],"content":"In your code, replace the test ad unit values (<bpt id=\"p1\">**</bpt>applicationId<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>adUnitId<ept id=\"p2\">**</ept>) with the live values you generated in Dev Center."},{"pos":[5826,5919],"content":"<bpt id=\"p1\">[</bpt>Submit your app<ept id=\"p1\">](../publish/app-submissions.md)</ept> to the Store using the Dev Center dashboard."},{"pos":[5925,6045],"content":"Review your <bpt id=\"p1\">[</bpt>advertising performance reports<ept id=\"p1\">](../publish/advertising-performance-report.md)</ept> in the Dev Center dashboard."}],"content":"---\nauthor: mcleanbyron\nms.assetid: c0450f7b-5c81-4d8c-92ef-2b1190d18af7\ndescription: Learn how to use the AdControl class to display banner ads in a Silverlight app for Windows Phone 8.1 or Windows Phone 8.0.\ntitle: AdControl in Windows Phone Silverlight\n\n---\n\n# AdControl in Windows Phone Silverlight\n\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\nThis walkthrough shows how to use the [AdControl](https://msdn.microsoft.com/library/windows/apps/hh524191.aspx) class to display banner ads in a Silverlight app for Windows Phone 8.1 or Windows Phone 8.0.\n\n## Prerequisites\n\n*  Install the [Microsoft Store Engagement and Monetization SDK](http://aka.ms/store-em-sdk) with Visual Studio 2015 or Visual Studio 2013.\n\n\n## Add the advertising assembly references\n\nThe Microsoft Advertising assemblies for Windows Phone Silverlight projects are not installed locally with the Microsoft Store Engagement and Monetization SDK. Before you can get started updating your code, you must first use **Connected Services** with the ad mediation support in the Microsoft Store Engagement and Monetization SDK to download these assemblies and reference them in your project.\n\n1.  In Visual Studio, click **Project** and **Add Connected Service**.\n\n2.  In the **Add Connected Service** dialog, click **Ad Mediator** and then click **Configure**.\n\n3.  Click **Select ad networks**, select **Microsoft Advertising** only.\n\n    At this point, all the necessary Microsoft advertising assemblies for Silverlight are downloaded to your local project via NuGet packages, and references to these assemblies are automatically added to your project. A reference to the ad mediation assembly is also added to your project. You will remove the ad mediation assembly reference in a later step, because it is not necessary for this scenario.\n\n4.  In the **Select ad networks** dialog, click **OK**. Click **OK** again in the following **Fetching status** confirmation page, and finally click **Add** to close the **Ad Mediator** dialog.\n\n5.  In **Solution Explorer**, expand the **References** node. Right-click **Microsoft.AdMediator.WindowsPhone81SL.MicrosoftAdvertising** and click **Remove**. This assembly reference is not necessary for this scenario.\n\n## Code your app\n\n\n1.  Add the following capabilities to the in the **Capabilities** node in your WMAppManifest.xml file.\n\n    ``` syntax\n    <Capability Name=\"ID_CAP_IDENTITY_USER\"/>\n    <Capability Name=\"ID_CAP_MEDIALIB_PHOTO\"/>\n    <Capability Name=\"ID_CAP_PHONEDIALER\"/>\n    ```\n\n    For this example, your **Capabilities** node looks like:\n\n    ``` syntax\n        <Capabilities>\n          <Capability Name=\"ID_CAP_NETWORKING\"/>\n          <Capability Name=\"ID_CAP_MEDIALIB_AUDIO\"/>\n          <Capability Name=\"ID_CAP_MEDIALIB_PLAYBACK\"/>\n          <Capability Name=\"ID_CAP_SENSORS\"/>\n          <Capability Name=\"ID_CAP_WEBBROWSERCOMPONENT\"/>\n          <Capability Name=\"ID_CAP_IDENTITY_USER\"/>\n          <Capability Name=\"ID_CAP_MEDIALIB_PHOTO\"/>\n          <Capability Name=\"ID_CAP_PHONEDIALER\"/>\n        </Capabilities>\n    ```\n\n2.  (Optional) Save your project. Click on the **Save All** icon or under the **File** menu click **Save All**.\n\n3.  Add the **Internet (Client & Server)** capability to the Package.appxmanifest file in your project. In **Solution Explorer**, double click **Package.appxmanifest**.\n\n    ![wp81silverlightmarkup\\-solutionexplorer\\-packageappxmanifest](images/13-b98c2a1a-69c3-4018-be0a-6ce010e703e7.jpg)\n\n    In the **Editor**, click the **Capabilities** tab. Check the **Internet (Client & Server)** box.\n\n4.  (Optional) Save your project. Click on the **Save All** icon or under the **File** menu click **Save All**.\n\n5.  Modify the Silverlight markup in the MainPage.xaml file to include the **Microsoft.Advertising.Mobile.UI** namespace.\n\n    ``` syntax\n    xmlns:UI=\"clr-namespace:Microsoft.Advertising.Mobile.UI;assembly=Microsoft.Advertising.Mobile.UI\"\n    ```\n\n    The header of your page will have the following code:\n\n    ``` syntax\n        xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\n        xmlns:UI=\"clr-namespace:Microsoft.Advertising.Mobile.UI;assembly=Microsoft.Advertising.Mobile.UI\"\n        x:Class=\"PhoneApp1.MainPage\"\n    ```\n\n6.  In the **Grid** tag, add the following code for the **AdControl**. Assign the **ApplicationId** and **AdUnitId** properties to the test values provided in [Test mode values](test-mode-values.md), and adjust the **Height** and **Width** properties to one of the [supported ad sizes for banner ads](supported-ad-sizes-for-banner-ads.md).\n\n    > **Note**  \n    You will replace the test **ApplicationId** and **AdUnitId** values with live values before submitting your app for submission.\n\n    ``` syntax\n    <Grid x:Name=\"ContentPanel\" Grid.Row=\"1\">\n\n      <UI:AdControl\n             ApplicationId=\"3f83fe91-d6be-434d-a0ae-7351c5a997f1\"\n             AdUnitId=\"10865270\"\n             HorizontalAlignment=\"Left\"\n             Height=\"80\"\n             VerticalAlignment=\"Top\"\n             Width=\"480\"/>\n\n    </Grid>\n    ```\n\n7.  Build and run your project. Confirm that your app displays an ad, similar to the following:\n\n    ![wp81silverlight\\-emulatorwithad](images/13-8db1492f-ae1d-439b-9b78-bed8e22fe996.jpg)\n\n## Release your app with live ads using Dev Center\n\n\n1.  In the Dev Center dashboard, go to the **Monetization** &gt; **Monetize with ads** page for your app, and [create a standalone Microsoft Advertising unit](../publish/monetize-with-ads.md). For the ad unit type, specify **Banner**. Make note of both the ad unit ID and the application ID.\n\n2.  In your code, replace the test ad unit values (**applicationId** and **adUnitId**) with the live values you generated in Dev Center.\n\n3.  [Submit your app](../publish/app-submissions.md) to the Store using the Dev Center dashboard.\n\n4.  Review your [advertising performance reports](../publish/advertising-performance-report.md) in the Dev Center dashboard.\n\n\n \n"}