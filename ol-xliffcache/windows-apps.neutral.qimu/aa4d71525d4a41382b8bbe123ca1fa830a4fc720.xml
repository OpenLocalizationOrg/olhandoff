{"nodes":[{"content":"In addition to using voice commands within Cortana to access system features, you can also use voice commands through Cortana to launch a foreground app and specify an action or command to execute within the app.","pos":[47,259]},{"content":"Launch a foreground app with voice commands in Cortana","pos":[267,321]},{"content":"Activate a foreground app with voice commands through Cortana","pos":[438,499]},{"content":"In addition to using voice commands within <bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> to access system features, you can also extend <bpt id=\"p2\">**</bpt>Cortana<ept id=\"p2\">**</ept> with features and functionality from your app.","pos":[501,661]},{"content":"Using voice commands, your app can be activated to the foreground and an action or command executed within the app.","pos":[662,777]},{"content":"Important APIs","pos":[782,796]},{"content":"Windows.ApplicationModel.VoiceCommands","pos":[807,845]},{"content":"VCD elements and attributes v1.2","pos":[914,946]},{"content":"When an app handles a voice command in the foreground, it takes focus and Cortana is dismissed.","pos":[1010,1105]},{"content":"If you prefer, you can activate your app and execute a command as a background task.","pos":[1106,1190]},{"content":"In this case, Cortana retains focus and your app returns all feedback and results through the <bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> canvas and the <bpt id=\"p2\">**</bpt>Cortana<ept id=\"p2\">**</ept> voice.","pos":[1191,1330]},{"pos":[1332,1590],"content":"Voice commands that require additional context or user input (such as sending a message to a specific contact) are best handled in a foreground app, while basic commands (such as listing upcoming trips) can be handled in <bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> through a background app."},{"pos":[1592,1790],"content":"If you want to activate an app in the background using voice commands, see <bpt id=\"p1\">[</bpt>Activate a background app with voice commands through Cortana<ept id=\"p1\">](launch-a-background-app-with-voice-commands-in-cortana.md)</ept>."},{"pos":[1794,1968],"content":"**Note**  \nA voice command is a single utterance with a specific intent, defined in a Voice Command Definition (VCD) file, directed at an installed app through **Cortana**.","leadings":["","> "],"nodes":[{"content":"Note","pos":[2,6]},{"content":"A voice command is a single utterance with a specific intent, defined in a Voice Command Definition (VCD) file, directed at an installed app through <bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept>.","pos":[11,172]}]},{"content":"A VCD file defines one or more voice commands, each with a unique intent.","pos":[1972,2045]},{"content":"A voice command definition can vary in complexity.","pos":[2049,2099]},{"content":"It can support anything from a single, constrained utterance to a collection of more flexible, natural language utterances, all denoting the same intent.","pos":[2100,2253]},{"pos":[2255,2455],"content":"To demonstrate foreground app features, we'll use a trip planning and management app named <bpt id=\"p1\">**</bpt>Adventure Works<ept id=\"p1\">**</ept> from the <bpt id=\"p2\">[</bpt>Cortana voice command sample<ept id=\"p2\">](http://go.microsoft.com/fwlink/p/?LinkID=619899)</ept>."},{"content":"To create a new <bpt id=\"p1\">**</bpt>Adventure Works<ept id=\"p1\">**</ept> trip without <bpt id=\"p2\">**</bpt>Cortana<ept id=\"p2\">**</ept>, a user would launch the app and navigate to the <bpt id=\"p3\">**</bpt>New trip<ept id=\"p3\">**</ept> page.","pos":[2457,2585]},{"content":"To view an existing trip, a user would launch the app, navigate to the <bpt id=\"p1\">**</bpt>Upcoming trips<ept id=\"p1\">**</ept> page, and select the trip.","pos":[2586,2702]},{"content":"Using voice commands through <bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept>, the user can instead just say, \"Adventure Works add a trip\" or \"Add a trip on Adventure Works\" to launch the app and navigate to the <bpt id=\"p2\">**</bpt>New trip<ept id=\"p2\">**</ept> page.","pos":[2704,2897]},{"content":"In turn, saying \"Adventure Works, show my trip to London\" will launch the app and navigate to the <bpt id=\"p1\">**</bpt>Trip<ept id=\"p1\">**</ept> detail page, shown here.","pos":[2898,3029]},{"content":"cortana launching foreground app","pos":[3033,3065]},{"content":"These are the basic steps to add voice-command functionality and integrate Cortana with your app using speech or keyboard input:","pos":[3119,3247]},{"content":"Create a VCD file.","pos":[3253,3271]},{"content":"This is an XML document that defines all the spoken commands that the user can say to initiate actions or invoke commands when activating your app.","pos":[3272,3419]},{"content":"See <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>VCD elements and attributes v1.2<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn706593)</ept>.","pos":[3420,3521]},{"content":"Register the command sets in the VCD file when the app is launched.","pos":[3526,3593]},{"content":"Handle the activation-by-voice-command, navigation within the app, and execution of the command.","pos":[3598,3694]},{"content":"Prerequisites:","pos":[3698,3712]},{"content":"If you're new to developing Universal Windows Platform (UWP) apps, have a look through these topics to get familiar with the technologies discussed here.","pos":[3718,3871]},{"content":"Create your first app","pos":[3878,3899]},{"pos":[3963,4080],"content":"Learn about events with <bpt id=\"p1\">[</bpt>Events and routed events overview<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/mt185584)</ept>"},{"content":"User experience guidelines:","pos":[4084,4111]},{"pos":[4117,4425],"content":"See <bpt id=\"p1\">[</bpt>Cortana design guidelines<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn974233)</ept> for info about how to integrate your app with <bpt id=\"p2\">**</bpt>Cortana<ept id=\"p2\">**</ept> and <bpt id=\"p3\">[</bpt>Speech design guidelines<ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn596121)</ept> for helpful tips on designing a useful and engaging speech-enabled app."},{"pos":[4642,4693],"content":"Create a new solution with project in Visual Studio"},{"content":"Launch Microsoft Visual Studio 2015.","pos":[4700,4736]},{"content":"The Visual Studio 2015 Start page appears.","pos":[4742,4784]},{"pos":[4790,4841],"content":"On the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu, select <bpt id=\"p2\">**</bpt>New<ept id=\"p2\">**</ept><ph id=\"ph1\"> &gt; </ph><bpt id=\"p3\">**</bpt>Project<ept id=\"p3\">**</ept>."},{"content":"The <bpt id=\"p1\">**</bpt>New Project<ept id=\"p1\">**</ept> dialog appears.","pos":[4847,4882]},{"content":"The left pane of the dialog lets you select the type of templates to display.","pos":[4883,4960]},{"content":"In the left pane, expand <bpt id=\"p1\">**</bpt>Installed &gt; Templates &gt; Visual C<ph id=\"ph1\">\\#</ph> &gt; Windows<ept id=\"p1\">**</ept>, then pick the <bpt id=\"p2\">**</bpt>Universal<ept id=\"p2\">**</ept> template group.","pos":[4966,5084]},{"content":"The dialog's center pane displays a list of project templates for Universal Windows Platform (UWP) apps.","pos":[5085,5189]},{"pos":[5194,5268],"content":"In the center pane, select the <bpt id=\"p1\">**</bpt>Blank App (Universal Windows)<ept id=\"p1\">**</ept> template."},{"content":"The <bpt id=\"p1\">**</bpt>Blank App<ept id=\"p1\">**</ept> template creates a minimal UWP app that compiles and runs, but contains no user-interface controls or data.","pos":[5274,5399]},{"content":"You add controls to the app over the course of this tutorial.","pos":[5400,5461]},{"content":"In the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> text box, type your project name.","pos":[5467,5516]},{"content":"For this example, we use \"AdventureWorks\".","pos":[5517,5559]},{"pos":[5564,5599],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> to create the project."},{"pos":[5605,5695],"content":"Microsoft Visual Studio creates your project and displays it in the <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>."},{"pos":[5949,6013],"content":"Add image assets to project and specify them in the app manifest"},{"content":"UWP apps can automatically select the most appropriate images based on specific settings and device capabilities (high contrast, effective pixels, locale, and so on).","pos":[6021,6187]},{"content":"All you need to do is provide the images and ensure you use the appropriate naming convention and folder organization within the app project for the different resource versions.","pos":[6188,6365]},{"content":"If you don't provide the recommended resource versions, accessibility, localization, and image quality can suffer, depending on the user's preferences, abilities, device type, and location.","pos":[6366,6555]},{"pos":[6557,6768],"content":"For more detail on image resources for high contrast and scale factors, see <bpt id=\"p1\">[</bpt>Guidelines for tile and icon assets<ept id=\"p1\">](https://msdn.microsoft.com/windows/uwp/controls-and-patterns/tiles-and-notifications-app-assets)</ept>."},{"content":"You name resources using qualifiers.","pos":[6770,6806]},{"content":"Resource qualifiers are folder and filename modifiers that identify the context in which a particular version of a resource should be used.","pos":[6807,6946]},{"content":"The standard naming convention is <ph id=\"ph1\">`foldername/qualifiername-value[_qualifiername-value]/filename.qualifiername-value[_qualifiername-value].ext`</ph>.","pos":[6948,7092]},{"content":"For example, <ph id=\"ph1\">`images/en-US/logo.scale-100_contrast-white.png`</ph>, which can be referred to in code using just the root folder and the filename: <ph id=\"ph2\">`images/logo.png`</ph>.","pos":[7093,7252]},{"content":"See <bpt id=\"p1\">[</bpt>How to name resources using qualifiers<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/xaml/hh965324.aspx)</ept>.","pos":[7253,7366]},{"content":"We recommend that you mark the default language on string resource files (such as <ph id=\"ph1\">`en-US\\resources.resw`</ph>) and the default scale factor on images (such as <ph id=\"ph2\">`logo.scale-100.png`</ph>), even if you do not currently plan to provide localized or multiple resolution resources.","pos":[7368,7633]},{"content":"However, at a minimum, we recommend that you provide assets for 100, 200, and 400 scale factors.","pos":[7634,7730]},{"content":"*Important","pos":[7734,7744]},{"pos":[7748,7883],"content":"The app icon used in the title area of the <bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> canvas is the Square44x44Logo icon specified in the \"Package.appxmanifest\" file."},{"pos":[8001,8018],"content":"Create a VCD file"},{"content":"In Visual Studio, right-click your primary project name, select <bpt id=\"p1\">**</bpt>Add &gt; New Item<ept id=\"p1\">**</ept>.","pos":[8023,8106]},{"content":"Add an <bpt id=\"p1\">**</bpt>XML File<ept id=\"p1\">**</ept>.","pos":[8107,8127]},{"pos":[8131,8288],"content":"Type a name for the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>VCD<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn706593)</ept> file (for this example, \"AdventureWorksCommands.xml\"), and click Add."},{"pos":[8293,8403],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, select the <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>VCD<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/dn706593)</ept> file."},{"pos":[8408,8538],"content":"In the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window, set <bpt id=\"p2\">**</bpt>Build action<ept id=\"p2\">**</ept> to <bpt id=\"p3\">**</bpt>Content<ept id=\"p3\">**</ept>, and then set <bpt id=\"p4\">**</bpt>Copy to output directory<ept id=\"p4\">**</ept> to <bpt id=\"p5\">**</bpt>Copy if newer<ept id=\"p5\">**</ept>."},{"pos":[8651,8668],"content":"Edit the VCD file"},{"pos":[8671,8792],"content":"Add a <bpt id=\"p1\">**</bpt>VoiceCommands<ept id=\"p1\">**</ept> element with an <bpt id=\"p2\">**</bpt>xmlns<ept id=\"p2\">**</ept> attribute pointing to <ph id=\"ph1\">`http://schemas.microsoft.com/voicecommands/1.2`</ph>."},{"pos":[8797,8985],"content":"For each language supported by your app, create a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>CommandSet<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn722331)</ept> element that contains the voice commands supported by your app."},{"content":"You can declare multiple <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>CommandSet<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn722331)</ept> elements, each with a different <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>xml:lang<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn722331)</ept> attribute so your app to be used in different markets.","pos":[8989,9248]},{"content":"For example, an app for the United States might have a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>CommandSet<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn722331)</ept> for English and a <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>CommandSet<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn722331)</ept> for Spanish.","pos":[9249,9484]},{"content":"Caution","pos":[9493,9500]},{"content":"To activate an app and initiate an action using a voice command, the app must register a VCD file that contains a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>CommandSet<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn722331)</ept> with a language that matches the speech language selected by the user for their device.","pos":[9507,9783]},{"content":"The speech language is located in <bpt id=\"p1\">**</bpt>Settings &gt; System &gt; Speech &gt; Speech Language<ept id=\"p1\">**</ept>.","pos":[9784,9867]},{"pos":[9872,9935],"content":"Add a <bpt id=\"p1\">**</bpt>Command<ept id=\"p1\">**</ept> element for each command you want to support."},{"pos":[9939,10073],"content":"Each <bpt id=\"p1\">**</bpt>Command<ept id=\"p1\">**</ept> declared in a <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>VCD<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/dn706593)</ept> file must include this information:"},{"pos":[10079,10168],"content":"A <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> attribute that your application uses to identify the voice command at runtime."},{"content":"An <bpt id=\"p1\">**</bpt>Example<ept id=\"p1\">**</ept> element that contains a phrase describing how a user can invoke the command.","pos":[10174,10265]},{"content":"<bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> shows this example when the user says \"What can I say?\", \"Help\", or they tap <bpt id=\"p2\">**</bpt>See more<ept id=\"p2\">**</ept>.","pos":[10266,10368]},{"content":"A <bpt id=\"p1\">**</bpt>ListenFor<ept id=\"p1\">**</ept> element that contains the words or phrases that your app recognizes as a command.","pos":[10379,10476]},{"content":"Each <bpt id=\"p1\">**</bpt>ListenFor<ept id=\"p1\">**</ept> element can contain references to one or more <bpt id=\"p2\">**</bpt>PhraseList<ept id=\"p2\">**</ept> elements that contain specific words relevant to the command.","pos":[10477,10618]},{"content":"Note","pos":[10625,10629]},{"content":"<bpt id=\"p1\">  **</bpt>ListenFor<ept id=\"p1\">**</ept> elements cannot be programmatically modified.","pos":[10634,10695]},{"content":"However, <bpt id=\"p1\">**</bpt>PhraseList<ept id=\"p1\">**</ept> elements associated with <bpt id=\"p2\">**</bpt>ListenFor<ept id=\"p2\">**</ept> elements can be programmatically modified.","pos":[10696,10801]},{"content":"Applications should modify the content of the <bpt id=\"p1\">**</bpt>PhraseList<ept id=\"p1\">**</ept> at runtime based on the data set generated as the user uses the app.","pos":[10802,10931]},{"content":"See <bpt id=\"p1\">[</bpt>Dynamically modify Voice Command Definition (VCD) phrase lists<ept id=\"p1\">](dynamically-modify-voice-command-definition--vcd--phrase-lists.md)</ept>.","pos":[10932,11068]},{"pos":[11076,11190],"content":"A <bpt id=\"p1\">**</bpt>Feedback<ept id=\"p1\">**</ept> element that contains the text for <bpt id=\"p2\">**</bpt>Cortana<ept id=\"p2\">**</ept> to display and speak as the application is launched."},{"content":"A <bpt id=\"p1\">**</bpt>Navigate<ept id=\"p1\">**</ept> element indicates that the voice command activates the app to the foreground.","pos":[11192,11284]},{"content":"In this example, the <ph id=\"ph1\">```showTripToDestination```</ph> command is a foreground task.","pos":[11285,11363]},{"content":"A <bpt id=\"p1\">**</bpt>VoiceCommandService<ept id=\"p1\">**</ept> element indicates that the voice command activates the app in the background.","pos":[11365,11468]},{"content":"The value of the <bpt id=\"p1\">**</bpt>Target<ept id=\"p1\">**</ept> attribute of this element should match the value of the <bpt id=\"p2\">**</bpt>Name<ept id=\"p2\">**</ept> attribute of the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>uap:AppService<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn934779)</ept> element in the package.appxmanifest file.","pos":[11469,11699]},{"content":"In this example, the <ph id=\"ph1\">```whenIsTripToDestination```</ph> and <ph id=\"ph2\">```cancelTripToDestination```</ph> commands are background tasks that specify the name of the app service as \"AdventureWorksVoiceCommandService\".","pos":[11700,11895]},{"pos":[11897,12029],"content":"For more detail, see the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>VCD elements and attributes v1.2<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn706593)</ept> reference."},{"pos":[12031,12198],"content":"Here's a portion of the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>VCD<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn706593)</ept> file that defines the en-us voice commands for the <bpt id=\"p3\">**</bpt>Adventure Works<ept id=\"p3\">**</ept> app."},{"pos":[14159,14183],"content":"Install the VCD commands"},{"content":"Your app must run once to install the VCD.","pos":[14186,14228]},{"content":"Note","pos":[14236,14240]},{"content":"Voice command data is not preserved across app installations.","pos":[14245,14306]},{"content":"To ensure the voice command data for your app remains intact, consider initializing your VCD file each time your app is launched or activated, or maintain a setting that indicates if the VCD is currently installed.","pos":[14307,14521]},{"content":"In the \"app.xaml.cs\" file:","pos":[14523,14549]},{"content":"Add the following using directive:","pos":[14554,14588]},{"content":"Mark the \"OnLaunched\" method with the async modifier.","pos":[14631,14684]},{"pos":[14773,15042],"content":"Call <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>InstallCommandDefinitionsFromStorageFileAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn708205)</ept> in the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>OnLaunched<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br242335)</ept> handler to register the voice commands that the system should recognize."},{"pos":[15046,15178],"content":"In the Adventure Works sample, we first define a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>StorageFile<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br227171)</ept> object."},{"pos":[15183,15333],"content":"We then call <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GetFileAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br227272)</ept> to initialize it with our \"AdventureWorksCommands.xml\" file."},{"pos":[15337,15553],"content":"This <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>StorageFile<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br227171)</ept> object is then passed to <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>InstallCommandDefinitionsFromStorageFileAsync<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn708205)</ept>."},{"pos":[16424,16468],"content":"Handle activation and execute voice commands"},{"content":"Specify how your app responds to subsequent voice command activations (after it has been launched at least once and the voice command sets have been installed).","pos":[16470,16630]},{"content":"Confirm that your app was activated by a voice command.","pos":[16636,16691]},{"pos":[16697,17055],"content":"Override the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Application.OnActivated<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br242330)</ept> event and check whether <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>IActivatedEventArgs<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br224727)</ept>.<bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>Kind<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/br224728)</ept> is <bpt id=\"p7\">[</bpt><bpt id=\"p8\">**</bpt>VoiceCommand<ept id=\"p8\">**</ept><ept id=\"p7\">](https://msdn.microsoft.com/library/windows/apps/br224693)</ept>."},{"content":"Determine the name of the command and what was spoken.","pos":[17061,17115]},{"pos":[17121,17532],"content":"Get a reference to a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>VoiceCommandActivatedEventArgs<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn609755)</ept> object from the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>IActivatedEventArgs<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br224727)</ept> and query the <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>Result<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/dn609758)</ept> property for a <bpt id=\"p7\">[</bpt><bpt id=\"p8\">**</bpt>SpeechRecognitionResult<ept id=\"p8\">**</ept><ept id=\"p7\">](https://msdn.microsoft.com/library/windows/apps/dn631432)</ept> object."},{"pos":[17538,17833],"content":"To determine what the user said, check the value of <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Text<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn631441)</ept> or the semantic properties of the recognized phrase in the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>SpeechRecognitionSemanticInterpretation<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn631443)</ept> dictionary."},{"content":"Take the appropriate action in your app, such as navigating to the desired page.","pos":[17839,17919]},{"content":"For this example, we refer back to the VCD in Step 3: Edit the VCD file.","pos":[17921,17993]},{"content":"Once we get the speech-recognition result for the voice command, we get the command name from the first value in the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>RulePath<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn631438)</ept> array.","pos":[17995,18191]},{"content":"As the VCD file defined more than one possible voice command, we need to compare the value against the command names in the VCD and take the appropriate action.","pos":[18192,18352]},{"content":"The most common action an application can take is to navigate to a page with content relevant to the context of the voice command.","pos":[18354,18484]},{"content":"For this example, we navigate to a <bpt id=\"p1\">**</bpt>TripPage<ept id=\"p1\">**</ept> page and pass in the value of the voice command, how the command was input, and the recognized \"destination\" phrase (if applicable).","pos":[18485,18665]},{"content":"Alternatively, the app could send a navigation parameter to the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>SpeechRecognitionResult<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn631432)</ept> when navigating to the page.","pos":[18666,18846]},{"content":"You can find out whether the voice command that launched your app was actually spoken, or whether it was typed in as text, from the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>SpeechRecognitionSemanticInterpretation.Properties<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn631445)</ept> dictionary using the <bpt id=\"p3\">**</bpt>commandMode<ept id=\"p3\">**</ept> key.","pos":[18848,19136]},{"content":"The value of that key will be either \"voice\" or \"text\".","pos":[19137,19192]},{"content":"If the value of the key is \"voice\", consider using speech synthesis (<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Windows.Media.SpeechSynthesis<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn278951)</ept>) in your app to provide the user with spoken feedback.","pos":[19193,19410]},{"content":"Use the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>SpeechRecognitionSemanticInterpretation.Properties<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn631445)</ept> to find out the content spoken in the <bpt id=\"p3\">**</bpt>PhraseList<ept id=\"p3\">**</ept> or <bpt id=\"p4\">**</bpt>PhraseTopic<ept id=\"p4\">**</ept> constraints of a <bpt id=\"p5\">**</bpt>ListenFor<ept id=\"p5\">**</ept> element.","pos":[19412,19646]},{"content":"The dictionary key is the value of the <bpt id=\"p1\">**</bpt>Label<ept id=\"p1\">**</ept> attribute of the <bpt id=\"p2\">**</bpt>PhraseList<ept id=\"p2\">**</ept> or <bpt id=\"p3\">**</bpt>PhraseTopic<ept id=\"p3\">**</ept> element.","pos":[19647,19755]},{"content":"Here, we show how to access the value of <bpt id=\"p1\">**</bpt>{destination}<ept id=\"p1\">**</ept> phrase.","pos":[19756,19822]},{"pos":[25499,25515],"content":"Related articles"},{"content":"Developers","pos":[25520,25530]},{"content":"Cortana interactions","pos":[25536,25556]},{"content":"Define custom recognition constraints","pos":[25586,25623]},{"content":"VCD elements and attributes v1.2","pos":[25672,25704]},{"content":"Designers","pos":[25769,25778]},{"content":"Cortana design guidelines","pos":[25784,25809]},{"content":"Speech design guidelines","pos":[25872,25896]},{"content":"Samples","pos":[25959,25966]},{"content":"Cortana voice command sample","pos":[25972,26000]}],"content":"---\nauthor: Karl-Bridge-Microsoft\nDescription: In addition to using voice commands within Cortana to access system features, you can also use voice commands through Cortana to launch a foreground app and specify an action or command to execute within the app.\ntitle: Launch a foreground app with voice commands in Cortana\nms.assetid: 8D3D1F66-7D17-4DD1-B426-DCCBD534EF00\nlabel: Cortana-Launch a foreground app\ntemplate: detail.hbs\n---\n\n# Activate a foreground app with voice commands through Cortana\n\nIn addition to using voice commands within **Cortana** to access system features, you can also extend **Cortana** with features and functionality from your app. Using voice commands, your app can be activated to the foreground and an action or command executed within the app. \n\n**Important APIs**\n\n-   [**Windows.ApplicationModel.VoiceCommands**](https://msdn.microsoft.com/library/windows/apps/dn706594)\n-   [**VCD elements and attributes v1.2**](https://msdn.microsoft.com/library/windows/apps/dn706593)\n\n\nWhen an app handles a voice command in the foreground, it takes focus and Cortana is dismissed. If you prefer, you can activate your app and execute a command as a background task. In this case, Cortana retains focus and your app returns all feedback and results through the **Cortana** canvas and the **Cortana** voice.\n\nVoice commands that require additional context or user input (such as sending a message to a specific contact) are best handled in a foreground app, while basic commands (such as listing upcoming trips) can be handled in **Cortana** through a background app.\n\nIf you want to activate an app in the background using voice commands, see [Activate a background app with voice commands through Cortana](launch-a-background-app-with-voice-commands-in-cortana.md).\n\n> **Note**  \n> A voice command is a single utterance with a specific intent, defined in a Voice Command Definition (VCD) file, directed at an installed app through **Cortana**.\n\n> A VCD file defines one or more voice commands, each with a unique intent.\n\n> A voice command definition can vary in complexity. It can support anything from a single, constrained utterance to a collection of more flexible, natural language utterances, all denoting the same intent.\n\nTo demonstrate foreground app features, we'll use a trip planning and management app named **Adventure Works** from the [Cortana voice command sample](http://go.microsoft.com/fwlink/p/?LinkID=619899).\n\nTo create a new **Adventure Works** trip without **Cortana**, a user would launch the app and navigate to the **New trip** page. To view an existing trip, a user would launch the app, navigate to the **Upcoming trips** page, and select the trip.\n\nUsing voice commands through **Cortana**, the user can instead just say, \"Adventure Works add a trip\" or \"Add a trip on Adventure Works\" to launch the app and navigate to the **New trip** page. In turn, saying \"Adventure Works, show my trip to London\" will launch the app and navigate to the **Trip** detail page, shown here.\n\n![cortana launching foreground app](images/cortana-foreground-with-adventureworks.png)\n\nThese are the basic steps to add voice-command functionality and integrate Cortana with your app using speech or keyboard input:\n\n1.  Create a VCD file. This is an XML document that defines all the spoken commands that the user can say to initiate actions or invoke commands when activating your app. See [**VCD elements and attributes v1.2**](https://msdn.microsoft.com/library/windows/apps/dn706593).\n2.  Register the command sets in the VCD file when the app is launched.\n3.  Handle the activation-by-voice-command, navigation within the app, and execution of the command.\n\n**Prerequisites:  **\n\nIf you're new to developing Universal Windows Platform (UWP) apps, have a look through these topics to get familiar with the technologies discussed here.\n\n-   [Create your first app](https://msdn.microsoft.com/library/windows/apps/bg124288)\n-   Learn about events with [Events and routed events overview](https://msdn.microsoft.com/library/windows/apps/mt185584)\n\n**User experience guidelines:  **\n\nSee [Cortana design guidelines](https://msdn.microsoft.com/library/windows/apps/dn974233) for info about how to integrate your app with **Cortana** and [Speech design guidelines](https://msdn.microsoft.com/library/windows/apps/dn596121) for helpful tips on designing a useful and engaging speech-enabled app.\n\n## <span id=\"Create_a_new_solution_with_project_in_Visual_Studio\"></span><span id=\"create_a_new_solution_with__project_in_visual_studio\"></span><span id=\"CREATE_A_NEW_SOLUTION_WITH__PROJECT_IN_VISUAL_STUDIO\"></span>Create a new solution with project in Visual Studio\n\n\n1.  Launch Microsoft Visual Studio 2015.\n\n    The Visual Studio 2015 Start page appears.\n\n2.  On the **File** menu, select **New** > **Project**.\n\n    The **New Project** dialog appears. The left pane of the dialog lets you select the type of templates to display.\n\n3.  In the left pane, expand **Installed > Templates > Visual C\\# > Windows**, then pick the **Universal** template group. The dialog's center pane displays a list of project templates for Universal Windows Platform (UWP) apps.\n4.  In the center pane, select the **Blank App (Universal Windows)** template.\n\n    The **Blank App** template creates a minimal UWP app that compiles and runs, but contains no user-interface controls or data. You add controls to the app over the course of this tutorial.\n\n5.  In the **Name** text box, type your project name. For this example, we use \"AdventureWorks\".\n6.  Click **OK** to create the project.\n\n    Microsoft Visual Studio creates your project and displays it in the **Solution Explorer**.\n\n## <span id=\"Add_image_assets_to_project_and_specify_them_in_the_app_manifest\"></span><span id=\"add_image_assets_to_project_and_specify_them_in_the_app_manifest\"></span><span id=\"ADD_IMAGE_ASSETS_TO_PROJECT_AND_SPECIFY_THEM_IN_THE_APP_MANIFEST\"></span>Add image assets to project and specify them in the app manifest\n      \nUWP apps can automatically select the most appropriate images based on specific settings and device capabilities (high contrast, effective pixels, locale, and so on). All you need to do is provide the images and ensure you use the appropriate naming convention and folder organization within the app project for the different resource versions. If you don't provide the recommended resource versions, accessibility, localization, and image quality can suffer, depending on the user's preferences, abilities, device type, and location.\n\nFor more detail on image resources for high contrast and scale factors, see [Guidelines for tile and icon assets](https://msdn.microsoft.com/windows/uwp/controls-and-patterns/tiles-and-notifications-app-assets).\n\nYou name resources using qualifiers. Resource qualifiers are folder and filename modifiers that identify the context in which a particular version of a resource should be used.\n\nThe standard naming convention is `foldername/qualifiername-value[_qualifiername-value]/filename.qualifiername-value[_qualifiername-value].ext`. For example, `images/en-US/logo.scale-100_contrast-white.png`, which can be referred to in code using just the root folder and the filename: `images/logo.png`. See [How to name resources using qualifiers](https://msdn.microsoft.com/library/windows/apps/xaml/hh965324.aspx).\n\nWe recommend that you mark the default language on string resource files (such as `en-US\\resources.resw`) and the default scale factor on images (such as `logo.scale-100.png`), even if you do not currently plan to provide localized or multiple resolution resources. However, at a minimum, we recommend that you provide assets for 100, 200, and 400 scale factors.\n\n> *Important\n\n> The app icon used in the title area of the **Cortana** canvas is the Square44x44Logo icon specified in the \"Package.appxmanifest\" file. \n    \n## <span id=\"Create_a_VCD_file\"></span><span id=\"create_a_vcd_file\"></span><span id=\"CREATE_A_VCD_FILE\"></span>Create a VCD file\n\n1. In Visual Studio, right-click your primary project name, select **Add > New Item**. Add an **XML File**.\n2. Type a name for the [**VCD**](https://msdn.microsoft.com/library/windows/apps/dn706593) file (for this example, \"AdventureWorksCommands.xml\"), and click Add. \n3. In **Solution Explorer**, select the [**VCD**](https://msdn.microsoft.com/library/windows/apps/dn706593) file.\n4.  In the **Properties** window, set **Build action** to **Content**, and then set **Copy to output directory** to **Copy if newer**.\n\n## <span id=\"Edit_the_VCD_file\"></span><span id=\"edit_the_vcd_file\"></span><span id=\"EDIT_THE_VCD_FILE\"></span>Edit the VCD file\n\n\nAdd a **VoiceCommands** element with an **xmlns** attribute pointing to `http://schemas.microsoft.com/voicecommands/1.2`.\n\n2. For each language supported by your app, create a [**CommandSet**](https://msdn.microsoft.com/library/windows/apps/dn722331) element that contains the voice commands supported by your app.\n\n  You can declare multiple [**CommandSet**](https://msdn.microsoft.com/library/windows/apps/dn722331) elements, each with a different [**xml:lang**](https://msdn.microsoft.com/library/windows/apps/dn722331) attribute so your app to be used in different markets. For example, an app for the United States might have a [**CommandSet**](https://msdn.microsoft.com/library/windows/apps/dn722331) for English and a [**CommandSet**](https://msdn.microsoft.com/library/windows/apps/dn722331) for Spanish.\n\n  >  **Caution**  \n  To activate an app and initiate an action using a voice command, the app must register a VCD file that contains a [**CommandSet**](https://msdn.microsoft.com/library/windows/apps/dn722331) with a language that matches the speech language selected by the user for their device. The speech language is located in **Settings > System > Speech > Speech Language**.\n\n3. Add a **Command** element for each command you want to support.\n\n  Each **Command** declared in a [**VCD**](https://msdn.microsoft.com/library/windows/apps/dn706593) file must include this information:\n\n  - A **Name** attribute that your application uses to identify the voice command at runtime. \n  - An **Example** element that contains a phrase describing how a user can invoke the command. **Cortana** shows this example when the user says \"What can I say?\", \"Help\", or they tap **See more**.    \n  -   A **ListenFor** element that contains the words or phrases that your app recognizes as a command. Each **ListenFor** element can contain references to one or more **PhraseList** elements that contain specific words relevant to the command.\n  > **Note**  \n  **ListenFor** elements cannot be programmatically modified. However, **PhraseList** elements associated with **ListenFor** elements can be programmatically modified. Applications should modify the content of the **PhraseList** at runtime based on the data set generated as the user uses the app. See [Dynamically modify Voice Command Definition (VCD) phrase lists](dynamically-modify-voice-command-definition--vcd--phrase-lists.md).\n\n  -   A **Feedback** element that contains the text for **Cortana** to display and speak as the application is launched.\n\nA **Navigate** element indicates that the voice command activates the app to the foreground. In this example, the ```showTripToDestination``` command is a foreground task.\n\nA **VoiceCommandService** element indicates that the voice command activates the app in the background. The value of the **Target** attribute of this element should match the value of the **Name** attribute of the [**uap:AppService**](https://msdn.microsoft.com/library/windows/apps/dn934779) element in the package.appxmanifest file. In this example, the ```whenIsTripToDestination``` and ```cancelTripToDestination``` commands are background tasks that specify the name of the app service as \"AdventureWorksVoiceCommandService\".\n\nFor more detail, see the [**VCD elements and attributes v1.2**](https://msdn.microsoft.com/library/windows/apps/dn706593) reference.\n\nHere's a portion of the [**VCD**](https://msdn.microsoft.com/library/windows/apps/dn706593) file that defines the en-us voice commands for the **Adventure Works** app.\n\n```xml\n<?xml version=\"1.0\" encoding=\"utf-8\" ?>\n<VoiceCommands xmlns=\"http://schemas.microsoft.com/voicecommands/1.2\">\n  <CommandSet xml:lang=\"en-us\" Name=\"AdventureWorksCommandSet_en-us\">\n    <AppName> Adventure Works </AppName>\n    <Example> Show trip to London </Example>\n\n    <Command Name=\"showTripToDestination\">\n      <Example> Show trip to London </Example>\n      <ListenFor RequireAppName=\"BeforeOrAfterPhrase\"> show [my] trip to {destination} </ListenFor>\n      <ListenFor RequireAppName=\"ExplicitlySpecified\"> show [my] {builtin:AppName} trip to {destination} </ListenFor>\n      <Feedback> Showing trip to {destination} </Feedback>\n      <Navigate />\n    </Command>\n\n    <Command Name=\"whenIsTripToDestination\">\n      <Example> When is my trip to Las Vegas?</Example>\n      <ListenFor RequireAppName=\"BeforeOrAfterPhrase\"> when is [my] trip to {destination}</ListenFor>\n      <ListenFor RequireAppName=\"ExplicitlySpecified\"> when is [my] {builtin:AppName} trip to {destination} </ListenFor>\n      <Feedback> Looking for trip to {destination}</Feedback>\n      <VoiceCommandService Target=\"AdventureWorksVoiceCommandService\"/>\n    </Command>\n    \n    <Command Name=\"cancelTripToDestination\">\n      <Example> Cancel my trip to Las Vegas </Example>\n      <ListenFor RequireAppName=\"BeforeOrAfterPhrase\"> cancel [my] trip to {destination}</ListenFor>\n      <ListenFor RequireAppName=\"ExplicitlySpecified\"> cancel [my] {builtin:AppName} trip to {destination} </ListenFor>\n      <Feedback> Cancelling trip to {destination}</Feedback>\n      <VoiceCommandService Target=\"AdventureWorksVoiceCommandService\"/>\n    </Command>\n\n    <PhraseList Label=\"destination\">\n      <Item>London</Item>\n      <Item>Las Vegas</Item>\n      <Item>Melbourne</Item>\n      <Item>Yosemite National Park</Item>\n    </PhraseList>\n  </CommandSet>\n```\n\n## <span id=\"Install_the_VCD_commands\"></span><span id=\"install_the_vcd_commands\"></span><span id=\"INSTALL_THE_VCD_COMMANDS\"></span>Install the VCD commands\n\n\nYour app must run once to install the VCD. \n\n>  **Note**  \nVoice command data is not preserved across app installations. To ensure the voice command data for your app remains intact, consider initializing your VCD file each time your app is launched or activated, or maintain a setting that indicates if the VCD is currently installed.\n\nIn the \"app.xaml.cs\" file:\n\n1. Add the following using directive:  \n```csharp\nusing Windows.Storage;\n```\n2. Mark the \"OnLaunched\" method with the async modifier.  \n```csharp\nprotected async override void OnLaunched(LaunchActivatedEventArgs e)\n```\n3. Call [**InstallCommandDefinitionsFromStorageFileAsync**](https://msdn.microsoft.com/library/windows/apps/dn708205) in the [**OnLaunched**](https://msdn.microsoft.com/library/windows/apps/br242335) handler to register the voice commands that the system should recognize.\n\n  In the Adventure Works sample, we first define a [**StorageFile**](https://msdn.microsoft.com/library/windows/apps/br227171) object. \n\n  We then call [**GetFileAsync**](https://msdn.microsoft.com/library/windows/apps/br227272) to initialize it with our \"AdventureWorksCommands.xml\" file.\n\n  This [**StorageFile**](https://msdn.microsoft.com/library/windows/apps/br227171) object is then passed to [**InstallCommandDefinitionsFromStorageFileAsync**](https://msdn.microsoft.com/library/windows/apps/dn708205).    \n```csharp\ntry\n{\n  // Install the main VCD. \n  StorageFile vcdStorageFile = \n    await Package.Current.InstalledLocation.GetFileAsync(\n      @\"AdventureWorksCommands.xml\");\n\n  await Windows.ApplicationModel.VoiceCommands.VoiceCommandDefinitionManager.\n    InstallCommandDefinitionsFromStorageFileAsync(vcdStorageFile);\n\n  // Update phrase list.\n  ViewModel.ViewModelLocator locator = App.Current.Resources[\"ViewModelLocator\"] as ViewModel.ViewModelLocator;\n  if(locator != null)\n  {\n     await locator.TripViewModel.UpdateDestinationPhraseList();\n  }\n}\ncatch (Exception ex)\n{\n  System.Diagnostics.Debug.WriteLine(\"Installing Voice Commands Failed: \" + ex.ToString());\n}\n```\n\n## <span id=\"Handle_activation_and_execute_voice_commands\"></span><span id=\"handle_activation_and_execute_voice_commands\"></span><span id=\"HANDLE_ACTIVATION_AND_EXECUTE_VOICE_COMMANDS\"></span>Handle activation and execute voice commands\n\nSpecify how your app responds to subsequent voice command activations (after it has been launched at least once and the voice command sets have been installed).\n\n1.  Confirm that your app was activated by a voice command.\n\n    Override the [**Application.OnActivated**](https://msdn.microsoft.com/library/windows/apps/br242330) event and check whether [**IActivatedEventArgs**](https://msdn.microsoft.com/library/windows/apps/br224727).[**Kind**](https://msdn.microsoft.com/library/windows/apps/br224728) is [**VoiceCommand**](https://msdn.microsoft.com/library/windows/apps/br224693).\n\n2.  Determine the name of the command and what was spoken.\n\n    Get a reference to a [**VoiceCommandActivatedEventArgs**](https://msdn.microsoft.com/library/windows/apps/dn609755) object from the [**IActivatedEventArgs**](https://msdn.microsoft.com/library/windows/apps/br224727) and query the [**Result**](https://msdn.microsoft.com/library/windows/apps/dn609758) property for a [**SpeechRecognitionResult**](https://msdn.microsoft.com/library/windows/apps/dn631432) object.\n\n    To determine what the user said, check the value of [**Text**](https://msdn.microsoft.com/library/windows/apps/dn631441) or the semantic properties of the recognized phrase in the [**SpeechRecognitionSemanticInterpretation**](https://msdn.microsoft.com/library/windows/apps/dn631443) dictionary.\n\n3.  Take the appropriate action in your app, such as navigating to the desired page.\n\nFor this example, we refer back to the VCD in Step 3: Edit the VCD file.\n\nOnce we get the speech-recognition result for the voice command, we get the command name from the first value in the [**RulePath**](https://msdn.microsoft.com/library/windows/apps/dn631438) array. As the VCD file defined more than one possible voice command, we need to compare the value against the command names in the VCD and take the appropriate action.\n\nThe most common action an application can take is to navigate to a page with content relevant to the context of the voice command. For this example, we navigate to a **TripPage** page and pass in the value of the voice command, how the command was input, and the recognized \"destination\" phrase (if applicable). Alternatively, the app could send a navigation parameter to the [**SpeechRecognitionResult**](https://msdn.microsoft.com/library/windows/apps/dn631432) when navigating to the page.\n\nYou can find out whether the voice command that launched your app was actually spoken, or whether it was typed in as text, from the [**SpeechRecognitionSemanticInterpretation.Properties**](https://msdn.microsoft.com/library/windows/apps/dn631445) dictionary using the **commandMode** key. The value of that key will be either \"voice\" or \"text\". If the value of the key is \"voice\", consider using speech synthesis ([**Windows.Media.SpeechSynthesis**](https://msdn.microsoft.com/library/windows/apps/dn278951)) in your app to provide the user with spoken feedback.\n\nUse the [**SpeechRecognitionSemanticInterpretation.Properties**](https://msdn.microsoft.com/library/windows/apps/dn631445) to find out the content spoken in the **PhraseList** or **PhraseTopic** constraints of a **ListenFor** element. The dictionary key is the value of the **Label** attribute of the **PhraseList** or **PhraseTopic** element. Here, we show how to access the value of **{destination}** phrase.\n\n``` csharp\n/// <summary>\n/// Entry point for an application activated by some means other than normal launching. \n/// This includes voice commands, URI, share target from another app, and so on. \n/// \n/// NOTE:\n/// A previous version of the VCD file might remain in place \n/// if you modify it and update the app through the store. \n/// Activations might include commands from older versions of your VCD. \n/// Try to handle these commands gracefully.\n/// </summary>\n/// <param name=\"args\">Details about the activation method.</param>\nprotected override void OnActivated(IActivatedEventArgs args)\n{\n    base.OnActivated(args);\n\n    Type navigationToPageType;\n    ViewModel.TripVoiceCommand? navigationCommand = null;\n\n    // Voice command activation.\n    if (args.Kind == ActivationKind.VoiceCommand)\n    {\n        // Event args can represent many different activation types. \n        // Cast it so we can get the parameters we care about out.\n        var commandArgs = args as VoiceCommandActivatedEventArgs;\n\n        Windows.Media.SpeechRecognition.SpeechRecognitionResult speechRecognitionResult = commandArgs.Result;\n\n        // Get the name of the voice command and the text spoken. \n        // See VoiceCommands.xml for supported voice commands.\n        string voiceCommandName = speechRecognitionResult.RulePath[0];\n        string textSpoken = speechRecognitionResult.Text;\n\n        // commandMode indicates whether the command was entered using speech or text.\n        // Apps should respect text mode by providing silent (text) feedback.\n        string commandMode = this.SemanticInterpretation(\"commandMode\", speechRecognitionResult);\n        \n        switch (voiceCommandName)\n        {\n            case \"showTripToDestination\":\n                // Access the value of {destination} in the voice command.\n                string destination = this.SemanticInterpretation(\"destination\", speechRecognitionResult);\n\n                // Create a navigation command object to pass to the page. \n                navigationCommand = new ViewModel.TripVoiceCommand(\n                    voiceCommandName,\n                    commandMode,\n                    textSpoken,\n                    destination);\n\n                // Set the page to navigate to for this voice command.\n                navigationToPageType = typeof(View.TripDetails);\n                break;\n            default:\n                // If we can't determine what page to launch, go to the default entry point.\n                navigationToPageType = typeof(View.TripListView);\n                break;\n        }\n    }\n    // Protocol activation occurs when a card is clicked within Cortana (using a background task).\n    else if (args.Kind == ActivationKind.Protocol)\n    {\n        // Extract the launch context. In this case, we're just using the destination from the phrase set (passed\n        // along in the background task inside Cortana), which makes no attempt to be unique. A unique id or \n        // identifier is ideal for more complex scenarios. We let the destination page check if the \n        // destination trip still exists, and navigate back to the trip list if it doesn't.\n        var commandArgs = args as ProtocolActivatedEventArgs;\n        Windows.Foundation.WwwFormUrlDecoder decoder = new Windows.Foundation.WwwFormUrlDecoder(commandArgs.Uri.Query);\n        var destination = decoder.GetFirstValueByName(\"LaunchContext\");\n\n        navigationCommand = new ViewModel.TripVoiceCommand(\n                                \"protocolLaunch\",\n                                \"text\",\n                                \"destination\",\n                                destination);\n\n        navigationToPageType = typeof(View.TripDetails);\n    }\n    else\n    {\n        // If we were launched via any other mechanism, fall back to the main page view.\n        // Otherwise, we'll hang at a splash screen.\n        navigationToPageType = typeof(View.TripListView);\n    }\n\n    // Repeat the same basic initialization as OnLaunched() above, taking into account whether\n    // or not the app is already active.\n    Frame rootFrame = Window.Current.Content as Frame;\n\n    // Do not repeat app initialization when the Window already has content,\n    // just ensure that the window is active.\n    if (rootFrame == null)\n    {\n        // Create a frame to act as the navigation context and navigate to the first page.\n        rootFrame = new Frame();\n        App.NavigationService = new NavigationService(rootFrame);\n\n        rootFrame.NavigationFailed += OnNavigationFailed;\n\n        // Place the frame in the current window.\n        Window.Current.Content = rootFrame;\n    }\n\n    // Since we're expecting to always show a details page, navigate even if \n    // a content frame is in place (unlike OnLaunched).\n    // Navigate to either the main trip list page, or if a valid voice command\n    // was provided, to the details page for that trip.\n    rootFrame.Navigate(navigationToPageType, navigationCommand);\n\n    // Ensure the current window is active\n    Window.Current.Activate();\n}\n\n/// <summary>\n/// Returns the semantic interpretation of a speech result. \n/// Returns null if there is no interpretation for that key.\n/// </summary>\n/// <param name=\"interpretationKey\">The interpretation key.</param>\n/// <param name=\"speechRecognitionResult\">The speech recognition result to get the semantic interpretation from.</param>\n/// <returns></returns>\nprivate string SemanticInterpretation(string interpretationKey, SpeechRecognitionResult speechRecognitionResult)\n{\n  return speechRecognitionResult.SemanticInterpretation.Properties[interpretationKey].FirstOrDefault();\n}\n```\n\n## <span id=\"related_topics\"></span>Related articles\n\n\n**Developers**\n* [Cortana interactions](cortana-interactions.md)\n* [Define custom recognition constraints](define-custom-recognition-constraints.md)\n* [**VCD elements and attributes v1.2**](https://msdn.microsoft.com/library/windows/apps/dn706593)\n\n**Designers**\n* [Cortana design guidelines](https://msdn.microsoft.com/library/windows/apps/dn974233)\n* [Speech design guidelines](https://msdn.microsoft.com/library/windows/apps/dn596121)\n\n**Samples**\n* [Cortana voice command sample](http://go.microsoft.com/fwlink/p/?LinkID=619899)\n \n\n \n\n\n\n\n"}