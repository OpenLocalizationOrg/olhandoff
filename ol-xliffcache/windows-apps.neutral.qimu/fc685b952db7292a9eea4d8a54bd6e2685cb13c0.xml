{"nodes":[{"content":"You can use a RichEditBox control to enter and edit rich text documents that contain formatted text, hyperlinks, and images.","pos":[32,156]},{"content":"You can make a RichEditBox read-only by setting its IsReadOnly property to true.","pos":[157,237]},{"content":"RichEditBox","pos":[245,256]},{"content":"Rich edit box","pos":[354,367]},{"content":"You can use a RichEditBox control to enter and edit rich text documents that contain formatted text, hyperlinks, and images.","pos":[368,492]},{"content":"You can make a RichEditBox read-only by setting its IsReadOnly property to <bpt id=\"p1\">**</bpt>true<ept id=\"p1\">**</ept>.","pos":[493,577]},{"pos":[636,650],"content":"Important APIs"},{"content":"RichEditBox class","pos":[666,683]},{"content":"Document property","pos":[790,807]},{"content":"IsReadOnly property","pos":[923,942]},{"content":"IsSpellCheckEnabled property","pos":[1060,1088]},{"content":"Is this the right control?","pos":[1212,1238]},{"content":"Use a <bpt id=\"p1\">**</bpt>RichEditBox<ept id=\"p1\">**</ept> to display and edit text files.","pos":[1240,1293]},{"content":"You don't use a RichEditBox to get user input into you app the way you use other standard text input boxes.","pos":[1294,1401]},{"content":"Rather, you use it to work with text files that are separate from your app.","pos":[1402,1477]},{"content":"You typically save text entered into a RichEditBox to a .rtf file.","pos":[1478,1544]},{"content":"If the primary purpose of the multi-line text box is for creating documents (such as blog entries or the contents of an email message), and those documents require rich text, use a rich text box.","pos":[1549,1744]},{"content":"If you want users to be able to format their text, use a rich text box.","pos":[1749,1820]},{"content":"When capturing text that will only be consumed and not redisplayed to users, use a plain text input control.","pos":[1825,1933]},{"content":"For all other scenarios, use a plain text input control.","pos":[1938,1994]},{"pos":[1996,2099],"content":"For more info about choosing the right text control, see the <bpt id=\"p1\">[</bpt>Text controls<ept id=\"p1\">](text-controls.md)</ept> article."},{"content":"Examples","pos":[2104,2112]},{"content":"This rich edit box has a rich text document open in it.","pos":[2114,2169]},{"content":"The formatting and file buttons aren't part of the rich edit box, but you should provide at least a minimal set of styling buttons and implement their actions.","pos":[2170,2329]},{"content":"A rich text box with an open document","pos":[2333,2370]},{"content":"Create a rich edit box","pos":[2402,2424]},{"content":"By default, the RichEditBox supports spell checking.","pos":[2426,2478]},{"content":"To disable the spell checker, set the <bpt id=\"p1\">[</bpt>IsSpellCheckEnabled<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/xaml/windows.ui.xaml.controls.richeditbox.isspellcheckenabled.aspx)</ept> property to <bpt id=\"p2\">**</bpt>false<ept id=\"p2\">**</ept>.","pos":[2479,2677]},{"content":"For more info, see Guidelines and checklist for spell checking.","pos":[2678,2741]},{"content":"You use the <bpt id=\"p1\">[</bpt>Document<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/xaml/windows.ui.xaml.controls.richeditbox.document.aspx)</ept> property of the RichEditBox to get its content.","pos":[2743,2918]},{"content":"The content of a RichEditBox is a <bpt id=\"p1\">[</bpt>Windows.UI.Text.ITextDocument<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/xaml/bb774052.aspx)</ept> object, unlike the RichTextBlock control, which uses <bpt id=\"p2\">[</bpt>Windows.UI.Xaml.Documents.Block<ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/xaml/windows.ui.xaml.documents.block.aspx)</ept> objects as its content.","pos":[2919,3254]},{"content":"The ITextDocument interface provides a way to load and save the document to a stream, retrieve text ranges, get the active selection, undo and redo changes, set default formatting attributes, and so on.","pos":[3255,3457]},{"content":"This example shows how to edit, load, and save a Rich Text Format (.rtf) file in a RichEditBox.","pos":[3459,3554]},{"content":"Choose the right keyboard for your text control","pos":[9113,9160]},{"content":"To help users to enter data using the touch keyboard, or Soft Input Panel (SIP), you can set the input scope of the text control to match the kind of data the user is expected to enter.","pos":[9162,9347]},{"content":"The default keyboard layout is usually appropriate for working with rich text documents.","pos":[9348,9436]},{"pos":[9438,9536],"content":"For more info about how to use input scopes, see <bpt id=\"p1\">[</bpt>Use input scope to change the touch keyboard<ept id=\"p1\">]()</ept>."},{"content":"Recommendations","pos":[9541,9556]},{"content":"When you create a rich text box, provide styling buttons and implement their actions.","pos":[9562,9647]},{"content":"Use a font that's consistent with the style of your app.","pos":[9652,9708]},{"content":"Make the height of the text control tall enough to accommodate typical entries.","pos":[9713,9792]},{"content":"Don't let your text input controls grow in height while users type.","pos":[9797,9864]},{"content":"Don't use a multi-line text box when users only need a single line.","pos":[9869,9936]},{"content":"Don't use a rich text control if a plain text control is adequate.","pos":[9941,10007]},{"content":"Related articles","pos":[10016,10032]},{"content":"Text controls","pos":[10035,10048]},{"content":"For designers","pos":[10071,10084]},{"content":"Guidelines for spell checking","pos":[10090,10119]},{"content":"Adding search","pos":[10158,10171]},{"content":"Guidelines for text input","pos":[10234,10259]},{"content":"For developers (XAML)","pos":[10282,10303]},{"content":"TextBox class","pos":[10311,10324]},{"content":"Windows.UI.Xaml.Controls PasswordBox class","pos":[10391,10433]}],"content":"---\nauthor: Jwmsft\nDescription: You can use a RichEditBox control to enter and edit rich text documents that contain formatted text, hyperlinks, and images. You can make a RichEditBox read-only by setting its IsReadOnly property to true.\ntitle: RichEditBox\nms.assetid: 4AFC0DFA-3B89-434D-9F86-4309CCFF7839\nlabel: Rich edit box\ntemplate: detail.hbs\n---\n# Rich edit box\nYou can use a RichEditBox control to enter and edit rich text documents that contain formatted text, hyperlinks, and images. You can make a RichEditBox read-only by setting its IsReadOnly property to **true**.\n\n<span class=\"sidebar_heading\" style=\"font-weight: bold;\">Important APIs</span>\n\n-   [**RichEditBox class**](https://msdn.microsoft.com/library/windows/apps/xaml/windows.ui.xaml.controls.richeditbox.aspx)\n-   [**Document property**](https://msdn.microsoft.com/library/windows/apps/xaml/windows.ui.xaml.controls.richeditbox.document.aspx)\n-   [**IsReadOnly property**](https://msdn.microsoft.com/library/windows/apps/xaml/windows.ui.xaml.controls.richeditbox.isreadonly.aspx)\n-   [**IsSpellCheckEnabled property**](https://msdn.microsoft.com/library/windows/apps/xaml/windows.ui.xaml.controls.richeditbox.isspellcheckenabled.aspx)\n\n## Is this the right control?\n\nUse a **RichEditBox** to display and edit text files. You don't use a RichEditBox to get user input into you app the way you use other standard text input boxes. Rather, you use it to work with text files that are separate from your app. You typically save text entered into a RichEditBox to a .rtf file.\n-   If the primary purpose of the multi-line text box is for creating documents (such as blog entries or the contents of an email message), and those documents require rich text, use a rich text box.\n-   If you want users to be able to format their text, use a rich text box.\n-   When capturing text that will only be consumed and not redisplayed to users, use a plain text input control.\n-   For all other scenarios, use a plain text input control.\n\nFor more info about choosing the right text control, see the [Text controls](text-controls.md) article.\n\n## Examples\n\nThis rich edit box has a rich text document open in it. The formatting and file buttons aren't part of the rich edit box, but you should provide at least a minimal set of styling buttons and implement their actions.\n\n![A rich text box with an open document](images/rich-edit-box.png)\n\n## Create a rich edit box\n\nBy default, the RichEditBox supports spell checking. To disable the spell checker, set the [IsSpellCheckEnabled](https://msdn.microsoft.com/library/windows/apps/xaml/windows.ui.xaml.controls.richeditbox.isspellcheckenabled.aspx) property to **false**. For more info, see Guidelines and checklist for spell checking.\n\nYou use the [Document](https://msdn.microsoft.com/library/windows/apps/xaml/windows.ui.xaml.controls.richeditbox.document.aspx) property of the RichEditBox to get its content. The content of a RichEditBox is a [Windows.UI.Text.ITextDocument](https://msdn.microsoft.com/library/windows/apps/xaml/bb774052.aspx) object, unlike the RichTextBlock control, which uses [Windows.UI.Xaml.Documents.Block](https://msdn.microsoft.com/library/windows/apps/xaml/windows.ui.xaml.documents.block.aspx) objects as its content. The ITextDocument interface provides a way to load and save the document to a stream, retrieve text ranges, get the active selection, undo and redo changes, set default formatting attributes, and so on.\n\nThis example shows how to edit, load, and save a Rich Text Format (.rtf) file in a RichEditBox.\n\n```xaml\n<RelativePanel Margin=\"20\" HorizontalAlignment=\"Stretch\">\n    <RelativePanel.Resources>\n        <Style TargetType=\"AppBarButton\">\n            <Setter Property=\"IsCompact\" Value=\"True\"/>\n        </Style>\n    </RelativePanel.Resources>\n    <AppBarButton x:Name=\"openFileButton\" Icon=\"OpenFile\" \n                  Click=\"OpenButton_Click\" ToolTipService.ToolTip=\"Open file\"/>\n    <AppBarButton Icon=\"Save\" Click=\"SaveButton_Click\" \n                  ToolTipService.ToolTip=\"Save file\" \n                  RelativePanel.RightOf=\"openFileButton\" Margin=\"8,0,0,0\"/>\n\n    <AppBarButton Icon=\"Bold\" Click=\"BoldButton_Click\" ToolTipService.ToolTip=\"Bold\" \n                  RelativePanel.LeftOf=\"italicButton\" Margin=\"0,0,8,0\"/>\n    <AppBarButton x:Name=\"italicButton\" Icon=\"Italic\" Click=\"ItalicButton_Click\" \n                  ToolTipService.ToolTip=\"Italic\" RelativePanel.LeftOf=\"underlineButton\" Margin=\"0,0,8,0\"/>\n    <AppBarButton x:Name=\"underlineButton\" Icon=\"Underline\" Click=\"UnderlineButton_Click\" \n                  ToolTipService.ToolTip=\"Underline\" RelativePanel.AlignRightWithPanel=\"True\"/>\n\n    <RichEditBox x:Name=\"editor\" Height=\"200\" RelativePanel.Below=\"openFileButton\" \n                 RelativePanel.AlignLeftWithPanel=\"True\" RelativePanel.AlignRightWithPanel=\"True\"/>\n</RelativePanel>\n```\n\n\n```csharp\nprivate async void OpenButton_Click(object sender, RoutedEventArgs e)\n{\n    // Open a text file.\n    Windows.Storage.Pickers.FileOpenPicker open =\n        new Windows.Storage.Pickers.FileOpenPicker();\n    open.SuggestedStartLocation =\n        Windows.Storage.Pickers.PickerLocationId.DocumentsLibrary;\n    open.FileTypeFilter.Add(\".rtf\");\n\n    Windows.Storage.StorageFile file = await open.PickSingleFileAsync();\n\n    if (file != null)\n    {\n        try\n        {\n            Windows.Storage.Streams.IRandomAccessStream randAccStream =\n        await file.OpenAsync(Windows.Storage.FileAccessMode.Read);\n\n            // Load the file into the Document property of the RichEditBox.\n            editor.Document.LoadFromStream(Windows.UI.Text.TextSetOptions.FormatRtf, randAccStream);\n        }\n        catch (Exception)\n        {\n            ContentDialog errorDialog = new ContentDialog()\n            {\n                Title = \"File open error\",\n                Content = \"Sorry, I couldn't open the file.\",\n                PrimaryButtonText = \"Ok\"\n            };\n\n            await errorDialog.ShowAsync();\n        }\n    }\n}\n\nprivate async void SaveButton_Click(object sender, RoutedEventArgs e)\n{\n    Windows.Storage.Pickers.FileSavePicker savePicker = new Windows.Storage.Pickers.FileSavePicker();\n    savePicker.SuggestedStartLocation = Windows.Storage.Pickers.PickerLocationId.DocumentsLibrary;\n\n    // Dropdown of file types the user can save the file as\n    savePicker.FileTypeChoices.Add(\"Rich Text\", new List<string>() { \".rtf\" });\n\n    // Default file name if the user does not type one in or select a file to replace\n    savePicker.SuggestedFileName = \"New Document\";\n\n    Windows.Storage.StorageFile file = await savePicker.PickSaveFileAsync();\n    if (file != null)\n    {\n        // Prevent updates to the remote version of the file until we \n        // finish making changes and call CompleteUpdatesAsync.\n        Windows.Storage.CachedFileManager.DeferUpdates(file);\n        // write to file\n        Windows.Storage.Streams.IRandomAccessStream randAccStream =\n            await file.OpenAsync(Windows.Storage.FileAccessMode.ReadWrite);\n\n        editor.Document.SaveToStream(Windows.UI.Text.TextGetOptions.FormatRtf, randAccStream);\n\n        // Let Windows know that we're finished changing the file so the \n        // other app can update the remote version of the file.\n        Windows.Storage.Provider.FileUpdateStatus status = await Windows.Storage.CachedFileManager.CompleteUpdatesAsync(file);\n        if (status != Windows.Storage.Provider.FileUpdateStatus.Complete)\n        {\n            Windows.UI.Popups.MessageDialog errorBox =\n                new Windows.UI.Popups.MessageDialog(\"File \" + file.Name + \" couldn't be saved.\");\n            await errorBox.ShowAsync();\n        }\n    }\n}\n\nprivate void BoldButton_Click(object sender, RoutedEventArgs e)\n{\n    Windows.UI.Text.ITextSelection selectedText = editor.Document.Selection;\n    if (selectedText != null)\n    {\n        Windows.UI.Text.ITextCharacterFormat charFormatting = selectedText.CharacterFormat;\n        charFormatting.Bold = Windows.UI.Text.FormatEffect.Toggle;\n        selectedText.CharacterFormat = charFormatting;\n    }\n}\n\nprivate void ItalicButton_Click(object sender, RoutedEventArgs e)\n{\n    Windows.UI.Text.ITextSelection selectedText = editor.Document.Selection;\n    if (selectedText != null)\n    {\n        Windows.UI.Text.ITextCharacterFormat charFormatting = selectedText.CharacterFormat;\n        charFormatting.Italic = Windows.UI.Text.FormatEffect.Toggle;\n        selectedText.CharacterFormat = charFormatting;\n    }\n}\n\nprivate void UnderlineButton_Click(object sender, RoutedEventArgs e)\n{\n    Windows.UI.Text.ITextSelection selectedText = editor.Document.Selection;\n    if (selectedText != null)\n    {\n        Windows.UI.Text.ITextCharacterFormat charFormatting = selectedText.CharacterFormat;\n        if (charFormatting.Underline == Windows.UI.Text.UnderlineType.None)\n        {\n            charFormatting.Underline = Windows.UI.Text.UnderlineType.Single;\n        }\n        else {\n            charFormatting.Underline = Windows.UI.Text.UnderlineType.None;\n        }\n        selectedText.CharacterFormat = charFormatting;\n    }\n}\n```\n\n## Choose the right keyboard for your text control\n\nTo help users to enter data using the touch keyboard, or Soft Input Panel (SIP), you can set the input scope of the text control to match the kind of data the user is expected to enter. The default keyboard layout is usually appropriate for working with rich text documents.\n\nFor more info about how to use input scopes, see [Use input scope to change the touch keyboard]().\n\n## Recommendations\n\n-   When you create a rich text box, provide styling buttons and implement their actions.\n-   Use a font that's consistent with the style of your app.\n-   Make the height of the text control tall enough to accommodate typical entries.\n-   Don't let your text input controls grow in height while users type.\n-   Don't use a multi-line text box when users only need a single line.\n-   Don't use a rich text control if a plain text control is adequate.\n\n\n\n\n\n## Related articles\n\n[Text controls](text-controls.md)\n\n**For designers**\n- [Guidelines for spell checking](spell-checking-and-prediction.md)\n- [Adding search](https://msdn.microsoft.com/library/windows/apps/hh465231)\n- [Guidelines for text input](text-controls.md)\n\n**For developers (XAML)**\n- [**TextBox class**](https://msdn.microsoft.com/library/windows/apps/br209683)\n- [**Windows.UI.Xaml.Controls PasswordBox class**](https://msdn.microsoft.com/library/windows/apps/br227519)\n\n"}