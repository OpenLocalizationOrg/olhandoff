{"nodes":[{"content":"Learn how to launch an interstitial ad using JavaScript/HTML.","pos":[86,147]},{"content":"Interstitial ad sample code in JavaScript","pos":[155,196]},{"content":"Interstitial ad sample code in JavaScript","pos":[205,246]},{"content":"Updated for UWP apps on Windows 10.","pos":[252,287]},{"content":"For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept>","pos":[288,380]},{"content":"This topic shows how to launch an interstitial ad using JavaScript/HTML.","pos":[385,457]},{"content":"For step-by-step instructions that show how to configure your project to use this code, see <bpt id=\"p1\">[</bpt>Interstitial ads<ept id=\"p1\">](interstitial-ads.md)</ept>.","pos":[458,590]},{"content":"For a complete sample project that demonstrates how to add video interstitial ads to a JavaScript/HTML app, see the <bpt id=\"p1\">[</bpt>advertising samples on GitHub<ept id=\"p1\">](http://aka.ms/githubads)</ept>.","pos":[591,764]},{"content":"Code example","pos":[769,781]},{"content":"This JavaScript/HTML sample shows the code in a Universal Windows Platform (UWP) app that implements an interstitial ad.","pos":[784,904]},{"content":"For this sample, create a new Visual Studio 2015 project using the JavaScript Universal Windows Blank App Template.","pos":[905,1020]},{"content":"This code uses a button to fire an event that launches the interstitial ad.","pos":[1022,1097]},{"content":"The default.js and default.html files generated by Visual Studio have been modified and are shown below.","pos":[1098,1202]},{"content":"The script.js file, shown below, is added to the project under the <bpt id=\"p1\">**</bpt>js<ept id=\"p1\">**</ept> folder/path.","pos":[1203,1289]},{"pos":[1291,1382],"content":"Replace the text in the <bpt id=\"p1\">**</bpt>applicationId<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>adUnitId<ept id=\"p2\">**</ept> assignments with working values."},{"content":"script.js","pos":[1388,1397]},{"content":"default.js","pos":[4790,4800]},{"content":"default.html (Windows 10)","pos":[6194,6219]},{"content":"default.html (Windows 8.x)","pos":[7010,7036]},{"content":"Related topics","pos":[7831,7845]},{"content":"Advertising samples on GitHub","pos":[7850,7879]}],"content":"---\nauthor: mcleanbyron\nms.assetid: 646977ed-1705-4ea7-a3db-a6b9aac70703\ndescription: Learn how to launch an interstitial ad using JavaScript/HTML.\ntitle: Interstitial ad sample code in JavaScript\n\n---\n\n# Interstitial ad sample code in JavaScript\n\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\nThis topic shows how to launch an interstitial ad using JavaScript/HTML. For step-by-step instructions that show how to configure your project to use this code, see [Interstitial ads](interstitial-ads.md). For a complete sample project that demonstrates how to add video interstitial ads to a JavaScript/HTML app, see the [advertising samples on GitHub](http://aka.ms/githubads).\n\n## Code example\n\n\nThis JavaScript/HTML sample shows the code in a Universal Windows Platform (UWP) app that implements an interstitial ad. For this sample, create a new Visual Studio 2015 project using the JavaScript Universal Windows Blank App Template.\n\nThis code uses a button to fire an event that launches the interstitial ad. The default.js and default.html files generated by Visual Studio have been modified and are shown below. The script.js file, shown below, is added to the project under the **js** folder/path.\n\nReplace the text in the **applicationId** and **adUnitId** assignments with working values.\n\n### script.js\n\n``` syntax\n(function () {\n    \"use strict\";\n\n    // Assign applicationId and adUnitId.\n    // Test values. Replace test values with live values before submitting an app to the store.\n    var applicationId = \"d25517cb-12d4-4699-8bdc-52040c712cab\";\n    var adUnitId = \"11389925\";\n\n    var intAd = null;\n\n    window.startInterstitial = function () {\n        writeText(\"<br>Interstitial Ads in JavaScript Windows 10 Apps\");\n        registerEvents();\n\n        // We know the opportunity to show an ad is coming soon (because this silly game is\n        // so short), so prepare the ad now. In a real app, you should request the interstitial\n        // close to when you think it will be shown, but with enough advance time to make the\n        // request and prepare the ad (say 30 seconds to a few minutes).\n        prepareInterstitial();\n\n        writeText(\"Press the Button to show the interstitial ad.\");\n    };\n\n    var registerEvents = function () {\n        button1.addEventListener(\"click\", onButtonClick);\n    };\n\n    var onButtonClick = function (evt) {\n        if (intAd && intAd.state !== MicrosoftNSJS.Advertising.InterstitialAdState.showing) {\n            showInterstitial();\n        }\n    }\n\n    var restart = function () {\n        if (intAd) {\n            intAd.dispose();\n        }\n        intAd = null;\n        window.startInterstitial();\n    };\n\n    var clearText = function (msg) {\n        description.innerHTML = \"\";\n    };\n\n    var writeText = function (msg) {\n        description.innerHTML = description.innerHTML + msg + \"<br>\";\n        description.scrollTop = description.scrollHeight;\n    };\n\n    var prepareInterstitial = function () {\n        if (!intAd) {\n            intAd = new MicrosoftNSJS.Advertising.InterstitialAd();\n\n            intAd.onErrorOccurred = errorOccurredHandler;\n            intAd.onAdReady = adReadyHandler;\n            intAd.onCancelled = cancelledHandler;\n            intAd.onCompleted = completedHandler;\n\n            intAd.requestAd(MicrosoftNSJS.Advertising.InterstitialAdType.video, applicationId, adUnitId);\n        }\n    };\n\n    var showInterstitial = function () {\n        if (intAd && intAd.state === MicrosoftNSJS.Advertising.InterstitialAdState.ready) {\n            intAd.show();\n        } else {\n            // No ad is available to show. Allow user to try again anyway\n            clearText();\n            writeText(\"<br>Unable to show an ad. Check the error log. You can try again.\");\n            restart();\n        }\n    };\n\n    var errorOccurredHandler = function (sender, args) {\n        console.log(\"error: \" + args.errorMessage + \" (\" + args.errorCode + \")\");\n        if (!isPlaying) {\n            clearText();\n            writeText(\"<br>Unable to show an ad. Check the error log. You can try again.\");\n            restart();\n        }\n    };\n\n    var adReadyHandler = function (sender) {\n        console.log(\"ad ready\");\n    };\n\n    var cancelledHandler = function (sender) {\n        console.log(\"ad cancelled\");\n        writeText(\"<br>You must watch the entire ad to continue. <b>Press the Button to watch the\n\nad.</b>\");\n        intAd.dispose();\n        intAd = null;\n        prepareInterstitial();\n    };\n\n    var completedHandler = function (sender) {\n        console.log(\"ad complete\");\n        clearText();\n        writeText(\"<br>Thanks for watching the ad! You can try again!\");\n        restart();\n    };\n\n})();\n```\n\n### default.js\n\n``` syntax\n// For an introduction to the Blank template, see the following documentation:\n// http://go.microsoft.com/fwlink/?LinkId=232509\n(function () {\n    \"use strict\";\n\n    var app = WinJS.Application;\n    var activation = Windows.ApplicationModel.Activation;\n\n    app.onactivated = function (args) {\n        if (args.detail.kind === activation.ActivationKind.launch) {\n            if (args.detail.previousExecutionState !== activation.ApplicationExecutionState.terminated) {\n                // TODO: This application has been newly launched. Initialize your application here.\n            } else {\n                // TODO: This application was suspended and then terminated.\n                // To create a smooth user experience, restore application state here so that it looks like the app never stopped running.\n            }\n\n            startInterstitial();\n\n            args.setPromise(WinJS.UI.processAll());\n        }\n    };\n\n    app.oncheckpoint = function (args) {\n        // TODO: This application is about to be suspended. Save any state that needs to persist across suspensions here.\n        // You might use the WinJS.Application.sessionState object, which is automatically saved and restored across suspension.\n        // If you need to complete an asynchronous operation before your application is suspended, call args.setPromise().\n    };\n\n    app.start();\n})();\n```\n\n### default.html (Windows 10)\n\n``` syntax\n<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"utf-8\" />\n    <title>App3JSInterstitial</title>\n\n    <!-- WinJS references -->\n    <link href=\"WinJS/css/ui-dark.css\" rel=\"stylesheet\" />\n    <script src=\"WinJS/js/base.js\"></script>\n    <script src=\"WinJS/js/ui.js\"></script>\n\n    <!-- App3JSInterstitial references -->\n    <link href=\"/css/default.css\" rel=\"stylesheet\" />\n    <script src=\"/js/default.js\"></script>\n    <script src=\"/js/script.js\"></script>\n\n    <!-- ad.js src for Windows 10 -->\n    <script src=\"//Microsoft.Advertising.JS/ad.js\"></script>\n</head>\n<body class=\"win-type-body\">\n    <button id=\"button1\" onclick=\"onButtonClick\" class=\"win-button\">Interstitial</button>\n    <div id=\"description\" style=\"height:100%; overflow:auto\"></div>\n</body>\n</html>\n```\n\n### default.html (Windows 8.x)\n\n``` syntax\n<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"utf-8\" />\n    <title>App3JSInterstitial</title>\n\n    <!-- WinJS references -->\n    <link href=\"WinJS/css/ui-dark.css\" rel=\"stylesheet\" />\n    <script src=\"WinJS/js/base.js\"></script>\n    <script src=\"WinJS/js/ui.js\"></script>\n\n    <!-- App3JSInterstitial references -->\n    <link href=\"/css/default.css\" rel=\"stylesheet\" />\n    <script src=\"/js/default.js\"></script>\n    <script src=\"/js/script.js\"></script>\n\n    <!-- ad.js src for Windows 8.x -->\n    <script src=\"//Microsoft.Advertising.JS/ads/ad.js\"></script>\n</head>\n<body class=\"win-type-body\">\n    <button id=\"button1\" onclick=\"onButtonClick\" class=\"win-button\">Interstitial</button>\n    <div id=\"description\" style=\"height:100%; overflow:auto\"></div>\n</body>\n</html>\n```\n\n## Related topics\n\n* [Advertising samples on GitHub](http://aka.ms/githubads)\n\n \n"}