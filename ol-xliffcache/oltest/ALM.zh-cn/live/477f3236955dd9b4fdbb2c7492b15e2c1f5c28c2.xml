<markdown_skeleton_root>
  <block_element>
    <ArrayOfMarkdownBlockBase xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="ba6a6880-49a0-4bd5-a086-dd702a0001a1"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>e08187a1-04fd-4366-9a35-1f6dcd018cd5</SegmentId>
            <InternalNormalItem
              internal_item_id="4982cdc8-3318-4553-b13f-30c1578097e0"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="ce022793-5f29-487d-9da7-6fb3c77497a1"
        item_type="Header"
        item_footer="footer_not_set">
        <header_type>Star</header_type>
        <header_level>1</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="33180a00-c85a-4704-b9d3-eb3564fa0fa5"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>29045529-3a2c-4680-87a5-e03ff5f7fb6a</SegmentId>
            <InternalNormalItem
              internal_item_id="08ca25ed-1655-440a-a436-b7248740efc4"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="a5611f42-12d2-476d-b75d-579e91a6f9c2"
        item_type="Header"
        item_footer="footer_not_set">
        <header_type>Star</header_type>
        <header_level>2</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="b7e29e1b-ac39-47aa-802b-169891dd8c82"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>d6dac6f1-9bb3-4d38-afed-3f2926f2e2da</SegmentId>
            <InternalNormalItem
              internal_item_id="ebba486f-c0d1-4853-a0e8-049782317470"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
            <LinkItem
              internal_item_id="f81a0eed-668c-4555-8842-10b91ce18136"
              internal_item_type="Link">
              <internal_items />
              <internal_link_type>Inline</internal_link_type>
              <internal_link_text>Windows build agent</internal_link_text>
              <internal_link_url>/Library/vs/alm/Build/agents/windows.md</internal_link_url>
              <internal_link_title />
            </LinkItem>
            <InternalNormalItem
              internal_item_id="f3fa62f2-6d3d-440f-810c-144b3314528e"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownListBlock"
        item_id="bc63c230-c705-4584-8a26-0b02bdb32262"
        item_type="List"
        item_footer="">
        <inner_list_items>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="2a8c438e-68e3-4e6a-bb9d-0091aaff5920"
              item_type="NormalParagraph"
              item_footer="footer_not_set">
              <paragraph_segments>
                <MarkdownSegment>
                  <SegmentId>fa903a7d-d1e8-4c1b-9e7e-0e04712e66db</SegmentId>
                  <InternalNormalItem
                    internal_item_id="2f023714-6bc7-4931-b419-217bbf3b5bc4"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>0. </Identifier>
          </ListItem>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="61f9d74c-8d5e-4633-8051-63ecc443476b"
              item_type="NormalParagraph"
              item_footer="footer_not_set">
              <paragraph_segments>
                <MarkdownSegment>
                  <SegmentId>cf0d2903-d0ab-43bd-91b1-f6908fbeb123</SegmentId>
                  <InternalNormalItem
                    internal_item_id="338c416d-f93d-4c5b-be05-25d372be5aa6"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
                <MarkdownSegment>
                  <SegmentId>0de75f01-6ce9-4ef9-add4-98b8bc8b4b40</SegmentId>
                  <ImageItem
                    internal_item_id="0aa7ca68-d8c5-4809-93b5-ae4a8b0f1343"
                    internal_item_type="Image">
                    <internal_items />
                    <internal_Image_type>Inline</internal_Image_type>
                    <internal_link_text>Add step</internal_link_text>
                    <internal_link_url>../_shared/_img/BldStepAddBegin.png</internal_link_url>
                    <internal_link_title />
                  </ImageItem>
                  <InternalNormalItem
                    internal_item_id="3b8115cb-4a2b-4e6c-888a-b609fc3f7c19"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                  <ImageItem
                    internal_item_id="401d429e-410a-4285-be13-31d5bb49dbf9"
                    internal_item_type="Image">
                    <internal_items />
                    <internal_Image_type>Inline</internal_Image_type>
                    <internal_link_text>Add PowerShell step</internal_link_text>
                    <internal_link_url>_img/BldScriptPSAdd.png</internal_link_url>
                    <internal_link_title />
                  </ImageItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>0. </Identifier>
          </ListItem>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="d89f8dd5-e5a4-43b9-b5d0-7164778de196"
              item_type="NormalParagraph"
              item_footer="footer_not_set">
              <paragraph_segments>
                <MarkdownSegment>
                  <SegmentId>37819da5-edae-4ae1-9813-4be9371a69cb</SegmentId>
                  <InternalNormalItem
                    internal_item_id="c3e3887e-47be-4347-9063-7020ab5b5205"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>0. </Identifier>
          </ListItem>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="e9b5fce3-b3a3-4980-a6e4-23613e1c1e18"
              item_type="NormalParagraph"
              item_footer="footer_not_set">
              <paragraph_segments>
                <MarkdownSegment>
                  <SegmentId>c2cb350e-85d1-4e6b-9186-3da943ebeb2f</SegmentId>
                  <InternalNormalItem
                    internal_item_id="55b1da3f-7b87-4477-85fb-7ba2c0865fcb"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>0. </Identifier>
          </ListItem>
        </inner_list_items>
        <ListType>Number</ListType>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="cd031782-68e3-4904-81d0-f55c7f46f1dd"
        item_type="Header"
        item_footer="footer_not_set">
        <header_type>Star</header_type>
        <header_level>2</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="6c3b950a-4137-419b-a821-292339d0513b"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>a43d4b3d-d650-4bef-97be-3d1b366dba4f</SegmentId>
            <InternalNormalItem
              internal_item_id="90569e4a-24f3-4799-99df-3705d93e07f9"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="974b6a2f-8a10-4746-8148-ad2a75c6b94a"
        item_type="FencedCodeBlock"
        item_footer="">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block>##-----------------------------------------------------------------------
## &lt;copyright file="ApplyVersionToAssemblies.ps1"&gt;(c) Microsoft Corporation. This source is subject to the Microsoft Permissive License. See http://www.microsoft.com/resources/sharedsource/licensingbasics/sharedsourcelicenses.mspx. All other rights reserved.&lt;/copyright&gt;
##-----------------------------------------------------------------------
# Look for a 0.0.0.0 pattern in the build number. 
# If found use it to version the assemblies.
#
# For example, if the 'Build number format' build process parameter 
# $(BuildDefinitionName)_$(Year:yyyy).$(Month).$(DayOfMonth)$(Rev:.r)
# then your build numbers come out like this:
# "Build HelloWorld_2013.07.19.1"
# This script would then apply version 2013.07.19.1 to your assemblies.

# Enable -Verbose option
[CmdletBinding()]

# Regular expression pattern to find the version in the build number 
# and then apply it to the assemblies
$VersionRegex = "\d+\.\d+\.\d+\.\d+"

# If this script is not running on a build server, remind user to 
# set environment variables so that this script can be debugged
if(-not ($Env:BUILD_SOURCESDIRECTORY -and $Env:BUILD_BUILDNUMBER))
{
    Write-Error "You must set the following environment variables"
    Write-Error "to test this script interactively."
    Write-Host '$Env:BUILD_SOURCESDIRECTORY - For example, enter something like:'
    Write-Host '$Env:BUILD_SOURCESDIRECTORY = "C:\code\FabrikamTFVC\HelloWorld"'
    Write-Host '$Env:BUILD_BUILDNUMBER - For example, enter something like:'
    Write-Host '$Env:BUILD_BUILDNUMBER = "Build HelloWorld_0000.00.00.0"'
    exit 1
}

# Make sure path to source code directory is available
if (-not $Env:BUILD_SOURCESDIRECTORY)
{
    Write-Error ("BUILD_SOURCESDIRECTORY environment variable is missing.")
    exit 1
}
elseif (-not (Test-Path $Env:BUILD_SOURCESDIRECTORY))
{
    Write-Error "BUILD_SOURCESDIRECTORY does not exist: $Env:BUILD_SOURCESDIRECTORY"
    exit 1
}
Write-Verbose "BUILD_SOURCESDIRECTORY: $Env:BUILD_SOURCESDIRECTORY"

# Make sure there is a build number
if (-not $Env:BUILD_BUILDNUMBER)
{
    Write-Error ("BUILD_BUILDNUMBER environment variable is missing.")
    exit 1
}
Write-Verbose "BUILD_BUILDNUMBER: $Env:BUILD_BUILDNUMBER"

# Get and validate the version data
$VersionData = [regex]::matches($Env:BUILD_BUILDNUMBER,$VersionRegex)
switch($VersionData.Count)
{
   0        
      { 
         Write-Error "Could not find version number data in BUILD_BUILDNUMBER."
         exit 1
      }
   1 {}
   default 
      { 
         Write-Warning "Found more than instance of version data in BUILD_BUILDNUMBER." 
         Write-Warning "Will assume first instance is version."
      }
}
$NewVersion = $VersionData[0]
Write-Verbose "Version: $NewVersion"

# Apply the version to the assembly property files
$files = gci $Env:BUILD_SOURCESDIRECTORY -recurse -include "*Properties*","My Project" | 
    ?{ $_.PSIsContainer } | 
    foreach { gci -Path $_.FullName -Recurse -include AssemblyInfo.* }
if($files)
{
    Write-Verbose "Will apply $NewVersion to $($files.count) files."

    foreach ($file in $files) {
        $filecontent = Get-Content($file)
        attrib $file -r
        $filecontent -replace $VersionRegex, $NewVersion | Out-File $file
        Write-Verbose "$file.FullName - version applied"
    }
}
else
{
    Write-Warning "Found no files."
}</code_block>
        <fenced_code_lang>ps</fenced_code_lang>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="982c8e00-07ae-4fb6-92a6-3bdbdbb75317"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>bf51fd19-c254-448e-a074-9caac5cefc15</SegmentId>
            <InternalNormalItem
              internal_item_id="4b4e3f6f-8c06-49db-b965-b061f25aa3eb"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="8fb1782b-85c4-467a-860a-37daeb4148fe"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>1a2897e1-e079-47a8-8fb0-addf7ec8ad3f</SegmentId>
            <ImageItem
              internal_item_id="0b393851-f9a6-4cba-b015-55d80d13ad54"
              internal_item_type="Image">
              <internal_items />
              <internal_Image_type>Inline</internal_Image_type>
              <internal_link_text>Apply version to assemblies build step</internal_link_text>
              <internal_link_url>_img/BldScriptPSExmpVerAssembliesBuildStep.png</internal_link_url>
              <internal_link_title />
            </ImageItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="317fd16d-6a4d-435d-b8d4-f5574c53f47e"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>34aabfc9-dd25-47b9-b68f-bb1d56f5e5df</SegmentId>
            <InternalNormalItem
              internal_item_id="16823ab0-7c91-4173-b185-96154cc48e63"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="4c69f10c-0b74-4013-b0c4-254acdf2f5bc"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>bba509be-c33b-4667-b093-48b561648910</SegmentId>
            <ImageItem
              internal_item_id="d4ec4c42-896a-49d9-b34e-d71067b3e7e3"
              internal_item_type="Image">
              <internal_items />
              <internal_Image_type>Inline</internal_Image_type>
              <internal_link_text>Build number format</internal_link_text>
              <internal_link_url>_img/BldScriptPSExmpVerAssembliesBuildNumFormat.png</internal_link_url>
              <internal_link_title />
            </ImageItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="35b92d1e-e81e-4547-ac62-7824ee31fe6c"
        item_type="FencedCodeBlock"
        item_footer="">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block>$(BuildDefinitionName)_$(Year:yyyy).$(Month).$(DayOfMonth)$(Rev:.r)</code_block>
        <fenced_code_lang />
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="00acaf66-fd67-4ee9-ab3e-f055bf95df53"
        item_type="Header"
        item_footer="footer_not_set">
        <header_type>Star</header_type>
        <header_level>2</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="b23b27b7-672a-4252-b04f-57daa00af459"
        item_type="Header"
        item_footer="footer_not_set">
        <header_type>Star</header_type>
        <header_level>4</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="50277363-b569-443d-820c-4be519f7dd0a"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>2fbc071d-587d-49e9-8ac3-799e4c2cc173</SegmentId>
            <LinkItem
              internal_item_id="71e0c895-40b0-4891-a91b-ab4de493e1af"
              internal_item_type="Link">
              <internal_items />
              <internal_link_type>Inline</internal_link_type>
              <internal_link_text>Predefined variables you can use in your scripts</internal_link_text>
              <internal_link_url>variables.md</internal_link_url>
              <internal_link_title />
            </LinkItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="1d390a53-1e05-4435-ae59-0d3fec78cb9f"
        item_type="Header"
        item_footer="footer_not_set">
        <header_type>Star</header_type>
        <header_level>4</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="0fe86411-3d60-4566-91a0-4d99f90bd4e3"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>3debd653-7a19-4205-a4f0-a2aaeace3d0f</SegmentId>
            <InternalNormalItem
              internal_item_id="3f9d62aa-1fbf-4751-8283-c4c078c5f404"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="4da3d3d0-3cf5-4a69-b3f6-9a908376fb1d"
        item_type="Header"
        item_footer="footer_not_set">
        <header_type>Star</header_type>
        <header_level>4</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="7dcef1e2-d483-4a9a-a135-948c51778177"
        item_type="NormalParagraph"
        item_footer="&#xA;&#xA;">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>c1be2e3b-2c7c-4c8d-8a15-533377ecc047</SegmentId>
            <InternalNormalItem
              internal_item_id="882c9da8-25bc-45bc-9306-bb364e5b9285"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment>
            <SegmentId>b944b528-4b43-4b5d-9b23-345d5b3b518c</SegmentId>
            <InternalNormalItem
              internal_item_id="384b0890-dc70-4124-934a-6b2eaa5dbd51"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
    </ArrayOfMarkdownBlockBase>
  </block_element>
  <references>
    <ArrayOfMarkdownLinkedReference xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
  </references>
</markdown_skeleton_root>