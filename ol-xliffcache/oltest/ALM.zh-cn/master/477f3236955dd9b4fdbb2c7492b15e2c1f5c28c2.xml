<markdown_skeleton_root>
  <block_element>
    <ArrayOfMarkdownBlockBase xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="90c2774f-f5f2-41ce-8c67-417c42b85264"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>bb10c898-9605-4aae-9054-b25ea3414cd9</SegmentId>
            <InternalNormalItem
              internal_item_id="9dbc6b95-666c-4719-a74b-92249f9ae1b0"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="e2cb6c50-ede4-457f-b017-e3672edb930b"
        item_type="Header"
        item_footer="footer_not_set">
        <header_type>Star</header_type>
        <header_level>1</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="c6ff08da-5919-480f-ad1d-9739c7f701a8"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>2050cb8f-fac9-409a-be42-afbf8f2f6d16</SegmentId>
            <InternalNormalItem
              internal_item_id="e4cf144a-4aa1-4f46-913c-25873dbea297"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="c56e5712-6845-49ae-93b4-6631f39cbc1e"
        item_type="Header"
        item_footer="footer_not_set">
        <header_type>Star</header_type>
        <header_level>2</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="f19745bb-90e4-498f-8737-e9fc5c123048"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>2549ef3c-b5dd-446d-a857-f012b05aa0b6</SegmentId>
            <InternalNormalItem
              internal_item_id="7a953329-72ec-41ef-ad51-eb6da52085d3"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
            <LinkItem
              internal_item_id="556f5c98-458c-4708-b4cf-e3fe0b7edd9b"
              internal_item_type="Link">
              <internal_items />
              <internal_link_type>Inline</internal_link_type>
              <internal_link_text>Windows build agent</internal_link_text>
              <internal_link_url>/Library/vs/alm/Build/agents/windows.md</internal_link_url>
              <internal_link_title />
            </LinkItem>
            <InternalNormalItem
              internal_item_id="efca2064-7be4-4903-9be8-dd86964b8d22"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownListBlock"
        item_id="3b9b7065-2571-42c2-85e6-b0c3d01c7fa2"
        item_type="List"
        item_footer="">
        <inner_list_items>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="595cfbb3-807d-436c-81cf-e004630f648c"
              item_type="NormalParagraph"
              item_footer="footer_not_set">
              <paragraph_segments>
                <MarkdownSegment>
                  <SegmentId>a40edb72-cbdc-4d68-b780-8a5c7b30c42b</SegmentId>
                  <InternalNormalItem
                    internal_item_id="bf33d9fb-06a8-46de-ae48-f1e4da441234"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>0. </Identifier>
          </ListItem>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="82b2be3f-8352-44aa-9deb-39a422145dc2"
              item_type="NormalParagraph"
              item_footer="footer_not_set">
              <paragraph_segments>
                <MarkdownSegment>
                  <SegmentId>e3a508d4-62f8-489a-937e-2ba33fa67eaf</SegmentId>
                  <InternalNormalItem
                    internal_item_id="24fbf598-414f-4651-9392-822e3b658e3b"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
                <MarkdownSegment>
                  <SegmentId>875ae273-51cf-438b-a33b-2c1f59eec1ed</SegmentId>
                  <ImageItem
                    internal_item_id="2dd5259c-942f-43e2-ab48-70ebb1fb11ce"
                    internal_item_type="Image">
                    <internal_items />
                    <internal_Image_type>Inline</internal_Image_type>
                    <internal_link_text>Add step</internal_link_text>
                    <internal_link_url>../_shared/_img/BldStepAddBegin.png</internal_link_url>
                    <internal_link_title />
                  </ImageItem>
                  <InternalNormalItem
                    internal_item_id="f087ef5a-d822-4270-ac59-d4234f1b9820"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                  <ImageItem
                    internal_item_id="6b61a151-1c20-4b29-ba28-fb17b6d4fd0d"
                    internal_item_type="Image">
                    <internal_items />
                    <internal_Image_type>Inline</internal_Image_type>
                    <internal_link_text>Add PowerShell step</internal_link_text>
                    <internal_link_url>_img/BldScriptPSAdd.png</internal_link_url>
                    <internal_link_title />
                  </ImageItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>0. </Identifier>
          </ListItem>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="4c59b69c-7e7f-4d49-8abc-d16a7bafae38"
              item_type="NormalParagraph"
              item_footer="footer_not_set">
              <paragraph_segments>
                <MarkdownSegment>
                  <SegmentId>9f2046c5-42d7-4ac6-97c6-0c5daea02ab9</SegmentId>
                  <InternalNormalItem
                    internal_item_id="9318929e-ef83-4dd1-8f7d-faea151baabf"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>0. </Identifier>
          </ListItem>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="b6f82c0c-47d4-4f07-ad0d-d2b4fb14106d"
              item_type="NormalParagraph"
              item_footer="footer_not_set">
              <paragraph_segments>
                <MarkdownSegment>
                  <SegmentId>2b8ec14e-6f70-42c6-a44e-13fc7fe16ebd</SegmentId>
                  <InternalNormalItem
                    internal_item_id="6ab31f41-3a82-4033-95a7-f3b98dd432c4"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>0. </Identifier>
          </ListItem>
        </inner_list_items>
        <ListType>Number</ListType>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="5e93e2f9-5792-4072-91bb-fe60bdb12431"
        item_type="Header"
        item_footer="footer_not_set">
        <header_type>Star</header_type>
        <header_level>2</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="82b5eefa-7982-469e-9ee0-7764ecfae7a4"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>17a04b59-bb92-42ad-9d42-e9cf13bcf67f</SegmentId>
            <InternalNormalItem
              internal_item_id="36633256-f699-4e70-a400-3179f086317c"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="8b2265df-6cdc-4c10-9a68-938072c3aba8"
        item_type="FencedCodeBlock"
        item_footer="">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block>##-----------------------------------------------------------------------
## &lt;copyright file="ApplyVersionToAssemblies.ps1"&gt;(c) Microsoft Corporation. This source is subject to the Microsoft Permissive License. See http://www.microsoft.com/resources/sharedsource/licensingbasics/sharedsourcelicenses.mspx. All other rights reserved.&lt;/copyright&gt;
##-----------------------------------------------------------------------
# Look for a 0.0.0.0 pattern in the build number. 
# If found use it to version the assemblies.
#
# For example, if the 'Build number format' build process parameter 
# $(BuildDefinitionName)_$(Year:yyyy).$(Month).$(DayOfMonth)$(Rev:.r)
# then your build numbers come out like this:
# "Build HelloWorld_2013.07.19.1"
# This script would then apply version 2013.07.19.1 to your assemblies.

# Enable -Verbose option
[CmdletBinding()]

# Regular expression pattern to find the version in the build number 
# and then apply it to the assemblies
$VersionRegex = "\d+\.\d+\.\d+\.\d+"

# If this script is not running on a build server, remind user to 
# set environment variables so that this script can be debugged
if(-not ($Env:BUILD_SOURCESDIRECTORY -and $Env:BUILD_BUILDNUMBER))
{
    Write-Error "You must set the following environment variables"
    Write-Error "to test this script interactively."
    Write-Host '$Env:BUILD_SOURCESDIRECTORY - For example, enter something like:'
    Write-Host '$Env:BUILD_SOURCESDIRECTORY = "C:\code\FabrikamTFVC\HelloWorld"'
    Write-Host '$Env:BUILD_BUILDNUMBER - For example, enter something like:'
    Write-Host '$Env:BUILD_BUILDNUMBER = "Build HelloWorld_0000.00.00.0"'
    exit 1
}

# Make sure path to source code directory is available
if (-not $Env:BUILD_SOURCESDIRECTORY)
{
    Write-Error ("BUILD_SOURCESDIRECTORY environment variable is missing.")
    exit 1
}
elseif (-not (Test-Path $Env:BUILD_SOURCESDIRECTORY))
{
    Write-Error "BUILD_SOURCESDIRECTORY does not exist: $Env:BUILD_SOURCESDIRECTORY"
    exit 1
}
Write-Verbose "BUILD_SOURCESDIRECTORY: $Env:BUILD_SOURCESDIRECTORY"

# Make sure there is a build number
if (-not $Env:BUILD_BUILDNUMBER)
{
    Write-Error ("BUILD_BUILDNUMBER environment variable is missing.")
    exit 1
}
Write-Verbose "BUILD_BUILDNUMBER: $Env:BUILD_BUILDNUMBER"

# Get and validate the version data
$VersionData = [regex]::matches($Env:BUILD_BUILDNUMBER,$VersionRegex)
switch($VersionData.Count)
{
   0        
      { 
         Write-Error "Could not find version number data in BUILD_BUILDNUMBER."
         exit 1
      }
   1 {}
   default 
      { 
         Write-Warning "Found more than instance of version data in BUILD_BUILDNUMBER." 
         Write-Warning "Will assume first instance is version."
      }
}
$NewVersion = $VersionData[0]
Write-Verbose "Version: $NewVersion"

# Apply the version to the assembly property files
$files = gci $Env:BUILD_SOURCESDIRECTORY -recurse -include "*Properties*","My Project" | 
    ?{ $_.PSIsContainer } | 
    foreach { gci -Path $_.FullName -Recurse -include AssemblyInfo.* }
if($files)
{
    Write-Verbose "Will apply $NewVersion to $($files.count) files."

    foreach ($file in $files) {
        $filecontent = Get-Content($file)
        attrib $file -r
        $filecontent -replace $VersionRegex, $NewVersion | Out-File $file
        Write-Verbose "$file.FullName - version applied"
    }
}
else
{
    Write-Warning "Found no files."
}</code_block>
        <fenced_code_lang>ps</fenced_code_lang>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="15c70908-3d4e-4df9-80e1-96f4c4544f1e"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>ffa81602-a50b-4967-a5f8-d21f56575b94</SegmentId>
            <InternalNormalItem
              internal_item_id="a670b49a-d47f-482f-aca9-c9386969cb74"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="6cead1fd-5bfb-4482-ac1a-d7649350e7eb"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>65acc67c-d293-41f8-98c5-c462501d981f</SegmentId>
            <ImageItem
              internal_item_id="584a650a-2b30-4951-824d-3aef1c4bcb19"
              internal_item_type="Image">
              <internal_items />
              <internal_Image_type>Inline</internal_Image_type>
              <internal_link_text>Apply version to assemblies build step</internal_link_text>
              <internal_link_url>_img/BldScriptPSExmpVerAssembliesBuildStep.png</internal_link_url>
              <internal_link_title />
            </ImageItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="98b4e963-f84e-4dc3-9c75-ca7f4b285de5"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>7d6b905b-b95e-498d-b8cf-53fc6cb31951</SegmentId>
            <InternalNormalItem
              internal_item_id="57bbdd41-ca71-4700-b7ad-c99c515fb48b"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="8759532d-34a2-42f1-88c5-d3b2fde9cd3a"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>96854031-51c0-4cd2-959a-799e99abf15a</SegmentId>
            <ImageItem
              internal_item_id="fdc07782-706e-49e2-bd06-ded93c1305a0"
              internal_item_type="Image">
              <internal_items />
              <internal_Image_type>Inline</internal_Image_type>
              <internal_link_text>Build number format</internal_link_text>
              <internal_link_url>_img/BldScriptPSExmpVerAssembliesBuildNumFormat.png</internal_link_url>
              <internal_link_title />
            </ImageItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="b993b1b1-0dff-402c-9646-3c083f4d56f1"
        item_type="FencedCodeBlock"
        item_footer="">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block>$(BuildDefinitionName)_$(Year:yyyy).$(Month).$(DayOfMonth)$(Rev:.r)</code_block>
        <fenced_code_lang />
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="e36f1de1-2e54-409a-8ba5-05b6ab1e0edf"
        item_type="Header"
        item_footer="footer_not_set">
        <header_type>Star</header_type>
        <header_level>2</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="d3ab5225-a607-4050-94e0-aa0c72604c9a"
        item_type="Header"
        item_footer="footer_not_set">
        <header_type>Star</header_type>
        <header_level>4</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="898af622-b07c-4e65-8da8-a19e85aa319b"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>6034c234-77a6-4b5c-ad1c-5abd3bd7a494</SegmentId>
            <LinkItem
              internal_item_id="08b53746-711f-4057-a0dc-e242cd599b68"
              internal_item_type="Link">
              <internal_items />
              <internal_link_type>Inline</internal_link_type>
              <internal_link_text>Predefined variables you can use in your scripts</internal_link_text>
              <internal_link_url>variables.md</internal_link_url>
              <internal_link_title />
            </LinkItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="52191978-522c-4a36-8e4b-e3a7d15c5666"
        item_type="Header"
        item_footer="footer_not_set">
        <header_type>Star</header_type>
        <header_level>4</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="79596582-8ee9-432b-867e-a7902dd5bd08"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>9f88b2c3-77d3-43e0-b046-fd810e082c12</SegmentId>
            <InternalNormalItem
              internal_item_id="b4244c92-4730-43b0-8ea4-00934c8f06dd"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="3711446e-6915-4f5f-ad3c-7ee4fa0689d1"
        item_type="Header"
        item_footer="footer_not_set">
        <header_type>Star</header_type>
        <header_level>4</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="00559ff7-e443-4380-9689-33a34c7728de"
        item_type="NormalParagraph"
        item_footer="&#xA;&#xA;">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>5df63f59-daad-46f0-8f0f-8132bdc4731f</SegmentId>
            <InternalNormalItem
              internal_item_id="9cc55c07-29e2-442b-9659-40d82d4d7869"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment>
            <SegmentId>73a92346-3dce-4889-ab65-215f5e2e2dec</SegmentId>
            <InternalNormalItem
              internal_item_id="ff87df5a-abc3-4cda-9886-70c05251f30e"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
    </ArrayOfMarkdownBlockBase>
  </block_element>
  <references>
    <ArrayOfMarkdownLinkedReference xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
  </references>
</markdown_skeleton_root>