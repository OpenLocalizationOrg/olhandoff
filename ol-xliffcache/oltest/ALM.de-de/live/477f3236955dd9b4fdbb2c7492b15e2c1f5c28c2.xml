<markdown_skeleton_root>
  <block_element>
    <ArrayOfMarkdownBlockBase xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="dafa5502-82bf-4d07-a7b9-c44a28bafd01"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>8a313c3c-d7d6-44a4-8611-523af4ad530c</SegmentId>
            <InternalNormalItem
              internal_item_id="a22c0522-7b6d-4bff-a7c7-1a4f181c7c8e"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="17e6264a-a31d-473e-ba0e-91628e37caab"
        item_type="Header"
        item_footer="footer_not_set">
        <header_type>Star</header_type>
        <header_level>1</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="54c2ffa2-1d29-4c27-a449-2c5aa571af32"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>c0750ca5-ba90-487e-9f3c-21e91389c625</SegmentId>
            <InternalNormalItem
              internal_item_id="74a0107c-c482-4bb3-a84c-943e0c29bb30"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="bdeae992-14da-4ba2-9893-fcee603051e6"
        item_type="Header"
        item_footer="footer_not_set">
        <header_type>Star</header_type>
        <header_level>2</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="c0c428a9-7284-476c-880f-f1220a7c1b62"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>573f08db-57c8-4df7-a00f-aaf7ff09a7a3</SegmentId>
            <InternalNormalItem
              internal_item_id="f212c397-197c-4b08-956d-beceb7c0c4d1"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
            <LinkItem
              internal_item_id="76f6e0ec-08bb-4bc5-8d32-04768a70e38a"
              internal_item_type="Link">
              <internal_items />
              <internal_link_type>Inline</internal_link_type>
              <internal_link_text>Windows build agent</internal_link_text>
              <internal_link_url>/Library/vs/alm/Build/agents/windows.md</internal_link_url>
              <internal_link_title />
            </LinkItem>
            <InternalNormalItem
              internal_item_id="df8cffd9-4d21-410f-80ed-7e59a2e1d032"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownListBlock"
        item_id="ae346742-51c1-477d-8a6f-379fd568ec71"
        item_type="List"
        item_footer="">
        <inner_list_items>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="52de22f5-b374-4582-b651-4297c0c47064"
              item_type="NormalParagraph"
              item_footer="footer_not_set">
              <paragraph_segments>
                <MarkdownSegment>
                  <SegmentId>d306db77-ab1e-45b4-bba0-c2d4fac2d56a</SegmentId>
                  <InternalNormalItem
                    internal_item_id="c6682485-d381-4079-b6a5-cc178eefad2a"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>0. </Identifier>
          </ListItem>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="240041a8-f635-4c27-96b0-5d65ba724f1d"
              item_type="NormalParagraph"
              item_footer="footer_not_set">
              <paragraph_segments>
                <MarkdownSegment>
                  <SegmentId>bd215fcf-462f-49d2-8993-fe2a4e7d23e2</SegmentId>
                  <InternalNormalItem
                    internal_item_id="c6460b72-bf01-49c3-8808-576710262eed"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
                <MarkdownSegment>
                  <SegmentId>693d2634-ddad-4fee-b4af-8bbf8b138283</SegmentId>
                  <ImageItem
                    internal_item_id="307ad3be-febd-4f07-86b3-dc43c083ccc0"
                    internal_item_type="Image">
                    <internal_items />
                    <internal_Image_type>Inline</internal_Image_type>
                    <internal_link_text>Add step</internal_link_text>
                    <internal_link_url>../_shared/_img/BldStepAddBegin.png</internal_link_url>
                    <internal_link_title />
                  </ImageItem>
                  <InternalNormalItem
                    internal_item_id="ae7cdfd6-2b0a-4ccb-9417-436c157f1506"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                  <ImageItem
                    internal_item_id="0737cead-c691-4348-836c-588d5af012a3"
                    internal_item_type="Image">
                    <internal_items />
                    <internal_Image_type>Inline</internal_Image_type>
                    <internal_link_text>Add PowerShell step</internal_link_text>
                    <internal_link_url>_img/BldScriptPSAdd.png</internal_link_url>
                    <internal_link_title />
                  </ImageItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>0. </Identifier>
          </ListItem>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="edbba183-7141-4c6a-9109-a2158b69239c"
              item_type="NormalParagraph"
              item_footer="footer_not_set">
              <paragraph_segments>
                <MarkdownSegment>
                  <SegmentId>97561a18-f2ff-49b5-a306-b0b997f803e9</SegmentId>
                  <InternalNormalItem
                    internal_item_id="ddcadd69-2b05-4d13-85e0-dac2f62ee181"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>0. </Identifier>
          </ListItem>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="9f2c7dec-920d-4f61-b91f-9a42e1e3c6e3"
              item_type="NormalParagraph"
              item_footer="footer_not_set">
              <paragraph_segments>
                <MarkdownSegment>
                  <SegmentId>6c551d55-4693-4738-82f3-eb272d2e7da2</SegmentId>
                  <InternalNormalItem
                    internal_item_id="bb934b1a-09f2-4727-a733-034c275eec41"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>0. </Identifier>
          </ListItem>
        </inner_list_items>
        <ListType>Number</ListType>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="1a889c22-7714-4da8-b1f4-404d7593885c"
        item_type="Header"
        item_footer="footer_not_set">
        <header_type>Star</header_type>
        <header_level>2</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="32f49db5-4d3c-4976-a94e-956bd42d0f02"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>5e1edfbc-634b-4051-b114-a7b0769ff07f</SegmentId>
            <InternalNormalItem
              internal_item_id="91f70d26-d542-4db9-bf93-cae618bfce4c"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="bd760be6-daab-4568-b31c-339200dc8c36"
        item_type="FencedCodeBlock"
        item_footer="">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block>##-----------------------------------------------------------------------
## &lt;copyright file="ApplyVersionToAssemblies.ps1"&gt;(c) Microsoft Corporation. This source is subject to the Microsoft Permissive License. See http://www.microsoft.com/resources/sharedsource/licensingbasics/sharedsourcelicenses.mspx. All other rights reserved.&lt;/copyright&gt;
##-----------------------------------------------------------------------
# Look for a 0.0.0.0 pattern in the build number. 
# If found use it to version the assemblies.
#
# For example, if the 'Build number format' build process parameter 
# $(BuildDefinitionName)_$(Year:yyyy).$(Month).$(DayOfMonth)$(Rev:.r)
# then your build numbers come out like this:
# "Build HelloWorld_2013.07.19.1"
# This script would then apply version 2013.07.19.1 to your assemblies.

# Enable -Verbose option
[CmdletBinding()]

# Regular expression pattern to find the version in the build number 
# and then apply it to the assemblies
$VersionRegex = "\d+\.\d+\.\d+\.\d+"

# If this script is not running on a build server, remind user to 
# set environment variables so that this script can be debugged
if(-not ($Env:BUILD_SOURCESDIRECTORY -and $Env:BUILD_BUILDNUMBER))
{
    Write-Error "You must set the following environment variables"
    Write-Error "to test this script interactively."
    Write-Host '$Env:BUILD_SOURCESDIRECTORY - For example, enter something like:'
    Write-Host '$Env:BUILD_SOURCESDIRECTORY = "C:\code\FabrikamTFVC\HelloWorld"'
    Write-Host '$Env:BUILD_BUILDNUMBER - For example, enter something like:'
    Write-Host '$Env:BUILD_BUILDNUMBER = "Build HelloWorld_0000.00.00.0"'
    exit 1
}

# Make sure path to source code directory is available
if (-not $Env:BUILD_SOURCESDIRECTORY)
{
    Write-Error ("BUILD_SOURCESDIRECTORY environment variable is missing.")
    exit 1
}
elseif (-not (Test-Path $Env:BUILD_SOURCESDIRECTORY))
{
    Write-Error "BUILD_SOURCESDIRECTORY does not exist: $Env:BUILD_SOURCESDIRECTORY"
    exit 1
}
Write-Verbose "BUILD_SOURCESDIRECTORY: $Env:BUILD_SOURCESDIRECTORY"

# Make sure there is a build number
if (-not $Env:BUILD_BUILDNUMBER)
{
    Write-Error ("BUILD_BUILDNUMBER environment variable is missing.")
    exit 1
}
Write-Verbose "BUILD_BUILDNUMBER: $Env:BUILD_BUILDNUMBER"

# Get and validate the version data
$VersionData = [regex]::matches($Env:BUILD_BUILDNUMBER,$VersionRegex)
switch($VersionData.Count)
{
   0        
      { 
         Write-Error "Could not find version number data in BUILD_BUILDNUMBER."
         exit 1
      }
   1 {}
   default 
      { 
         Write-Warning "Found more than instance of version data in BUILD_BUILDNUMBER." 
         Write-Warning "Will assume first instance is version."
      }
}
$NewVersion = $VersionData[0]
Write-Verbose "Version: $NewVersion"

# Apply the version to the assembly property files
$files = gci $Env:BUILD_SOURCESDIRECTORY -recurse -include "*Properties*","My Project" | 
    ?{ $_.PSIsContainer } | 
    foreach { gci -Path $_.FullName -Recurse -include AssemblyInfo.* }
if($files)
{
    Write-Verbose "Will apply $NewVersion to $($files.count) files."

    foreach ($file in $files) {
        $filecontent = Get-Content($file)
        attrib $file -r
        $filecontent -replace $VersionRegex, $NewVersion | Out-File $file
        Write-Verbose "$file.FullName - version applied"
    }
}
else
{
    Write-Warning "Found no files."
}</code_block>
        <fenced_code_lang>ps</fenced_code_lang>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="1d88c414-684a-4d5d-9860-da5d939df90a"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>b7f91a0d-3799-4eff-9644-dbc06021e0f0</SegmentId>
            <InternalNormalItem
              internal_item_id="61128df3-a70d-41ba-9d00-6fe7f6315364"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="e78b6b09-c293-41aa-b3ba-462365a4bfc3"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>563edc9c-6566-45da-962f-b441dd370ef1</SegmentId>
            <ImageItem
              internal_item_id="f738812d-76ae-4be8-882d-aaa87292aeba"
              internal_item_type="Image">
              <internal_items />
              <internal_Image_type>Inline</internal_Image_type>
              <internal_link_text>Apply version to assemblies build step</internal_link_text>
              <internal_link_url>_img/BldScriptPSExmpVerAssembliesBuildStep.png</internal_link_url>
              <internal_link_title />
            </ImageItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="09cb3632-9b03-4519-b48a-0553d1aa94bd"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>38f7bf90-8427-4d60-8532-f3828571da42</SegmentId>
            <InternalNormalItem
              internal_item_id="9a266ae1-783e-437b-a3e8-05b7a84bbb18"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="56ac6727-0e12-4f94-8a08-b2283c9d36cf"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>a15da9b2-deaa-46c2-995a-5b123762980f</SegmentId>
            <ImageItem
              internal_item_id="37f750f4-ee60-46c0-a11c-9aa95c6b97f8"
              internal_item_type="Image">
              <internal_items />
              <internal_Image_type>Inline</internal_Image_type>
              <internal_link_text>Build number format</internal_link_text>
              <internal_link_url>_img/BldScriptPSExmpVerAssembliesBuildNumFormat.png</internal_link_url>
              <internal_link_title />
            </ImageItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="6b181a91-015f-4d68-bc06-a38d1a1deddc"
        item_type="FencedCodeBlock"
        item_footer="">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block>$(BuildDefinitionName)_$(Year:yyyy).$(Month).$(DayOfMonth)$(Rev:.r)</code_block>
        <fenced_code_lang />
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="2535bef7-ebb8-4468-9032-878f5e0a2d93"
        item_type="Header"
        item_footer="footer_not_set">
        <header_type>Star</header_type>
        <header_level>2</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="4e35d8e6-24b3-4aa8-bbd8-5de198948670"
        item_type="Header"
        item_footer="footer_not_set">
        <header_type>Star</header_type>
        <header_level>4</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="3635dd39-77a2-4223-9a8a-4f905a3a0690"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>a8197e93-894b-434d-a800-f0d54f2b17b4</SegmentId>
            <LinkItem
              internal_item_id="b31c93e1-b53d-4f87-8267-65f25cf3395e"
              internal_item_type="Link">
              <internal_items />
              <internal_link_type>Inline</internal_link_type>
              <internal_link_text>Predefined variables you can use in your scripts</internal_link_text>
              <internal_link_url>variables.md</internal_link_url>
              <internal_link_title />
            </LinkItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="80c3efba-7647-49ce-ad8f-f56396744106"
        item_type="Header"
        item_footer="footer_not_set">
        <header_type>Star</header_type>
        <header_level>4</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="4df0c10c-7336-46ce-a25a-b8f5dd55c201"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>89f54188-0335-4348-9b55-74f5a1e1597f</SegmentId>
            <InternalNormalItem
              internal_item_id="4384a756-0bf5-4d47-9e34-f9560dee087a"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="305d351e-9462-4a19-b1cb-aa8ab017a6ea"
        item_type="Header"
        item_footer="footer_not_set">
        <header_type>Star</header_type>
        <header_level>4</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="38a6d5c5-88d1-4531-9e74-4e6890c67c4d"
        item_type="NormalParagraph"
        item_footer="&#xA;&#xA;">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>4b660ce2-417d-4eae-8423-9dbca64593e5</SegmentId>
            <InternalNormalItem
              internal_item_id="1a22108e-6a41-4fab-b24b-71303f4d35a3"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment>
            <SegmentId>c53b97e3-6efb-4c90-a01b-e23ea7638108</SegmentId>
            <InternalNormalItem
              internal_item_id="405d47eb-b92a-40aa-acb4-303c6caae6f5"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
    </ArrayOfMarkdownBlockBase>
  </block_element>
  <references>
    <ArrayOfMarkdownLinkedReference xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
  </references>
</markdown_skeleton_root>