<markdown_skeleton_root>
  <block_element>
    <ArrayOfMarkdownBlockBase xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="2b5fea07-5e59-410b-8f48-86a2e86f5386"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>22c7fd82-c9f3-4ddc-b5c4-d2bea027f107</SegmentId>
            <InternalNormalItem
              internal_item_id="f25aed32-5be3-42fc-995c-580022a80a7a"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="9752cab0-9a71-41bd-83e0-ca86c3663ab9"
        item_type="Header"
        item_footer="footer_not_set">
        <header_type>Star</header_type>
        <header_level>1</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="6a0d0fed-9202-4b73-aeb0-114804a3c9c2"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>4d5f6db2-4fca-439d-97b4-68646aae630c</SegmentId>
            <InternalNormalItem
              internal_item_id="9dc62e07-fec5-45d9-a770-885a69361490"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="994947eb-7287-4048-b9aa-1ab1d015c6b5"
        item_type="Header"
        item_footer="footer_not_set">
        <header_type>Star</header_type>
        <header_level>2</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="f5b5ec4d-bc5b-4727-8b62-e004fdfbd544"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>c4ccde4c-8b9b-4db6-bec0-63b37ddf80c6</SegmentId>
            <InternalNormalItem
              internal_item_id="b8800226-de53-4aea-b7d5-d3f0f96bd407"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
            <LinkItem
              internal_item_id="bfc8d27e-7986-461f-9cbe-e26cfdc25a79"
              internal_item_type="Link">
              <internal_items />
              <internal_link_type>Inline</internal_link_type>
              <internal_link_text>Windows build agent</internal_link_text>
              <internal_link_url>/Library/vs/alm/Build/agents/windows.md</internal_link_url>
              <internal_link_title />
            </LinkItem>
            <InternalNormalItem
              internal_item_id="e4bc904a-5125-424c-8a4a-41dae16616e7"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownListBlock"
        item_id="100be67a-ecf6-4dd1-a6d9-a93147b29f53"
        item_type="List"
        item_footer="">
        <inner_list_items>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="b5e6047d-692f-4983-bbc8-ea8d211215eb"
              item_type="NormalParagraph"
              item_footer="footer_not_set">
              <paragraph_segments>
                <MarkdownSegment>
                  <SegmentId>857e4b9a-884f-4936-ad48-5f9cc063b2e9</SegmentId>
                  <InternalNormalItem
                    internal_item_id="0bc75d19-8361-448d-a010-034396f4fff2"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>0. </Identifier>
          </ListItem>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="0d749fbc-9fbb-4c33-96a2-485d1ebc5e81"
              item_type="NormalParagraph"
              item_footer="footer_not_set">
              <paragraph_segments>
                <MarkdownSegment>
                  <SegmentId>1382dee7-55da-4a99-b206-3c6526c3d80c</SegmentId>
                  <InternalNormalItem
                    internal_item_id="115a0bf8-3d3b-42cd-9939-fc6642595d23"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
                <MarkdownSegment>
                  <SegmentId>770626b9-f562-4f14-831a-eac79f6c850b</SegmentId>
                  <ImageItem
                    internal_item_id="96038a75-7f01-4473-98d3-423353418ce3"
                    internal_item_type="Image">
                    <internal_items />
                    <internal_Image_type>Inline</internal_Image_type>
                    <internal_link_text>Add step</internal_link_text>
                    <internal_link_url>../_shared/_img/BldStepAddBegin.png</internal_link_url>
                    <internal_link_title />
                  </ImageItem>
                  <InternalNormalItem
                    internal_item_id="4a569105-ca29-4d36-9d24-e5d0173b584c"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                  <ImageItem
                    internal_item_id="ff2ad724-6972-4f62-b66d-bf7c1bf63a0a"
                    internal_item_type="Image">
                    <internal_items />
                    <internal_Image_type>Inline</internal_Image_type>
                    <internal_link_text>Add PowerShell step</internal_link_text>
                    <internal_link_url>_img/BldScriptPSAdd.png</internal_link_url>
                    <internal_link_title />
                  </ImageItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>0. </Identifier>
          </ListItem>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="44c8cfde-2c55-4966-9eda-a151068e2f64"
              item_type="NormalParagraph"
              item_footer="footer_not_set">
              <paragraph_segments>
                <MarkdownSegment>
                  <SegmentId>d0b74ac1-476c-4b08-8baa-9f837b300078</SegmentId>
                  <InternalNormalItem
                    internal_item_id="996f23eb-cc91-4ba4-bb29-631b1f98add9"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>0. </Identifier>
          </ListItem>
          <ListItem>
            <MarkdownParagraphBlock
              item_id="885ad0b4-854c-400e-bf8c-347650e24f81"
              item_type="NormalParagraph"
              item_footer="footer_not_set">
              <paragraph_segments>
                <MarkdownSegment>
                  <SegmentId>bb19f4fc-bfbc-4e0a-9379-4b99c68306c1</SegmentId>
                  <InternalNormalItem
                    internal_item_id="3c7bb8c9-6421-45bb-a412-3386aa18fa55"
                    internal_item_type="Normal">
                    <internal_items />
                  </InternalNormalItem>
                </MarkdownSegment>
              </paragraph_segments>
            </MarkdownParagraphBlock>
            <Identifier>0. </Identifier>
          </ListItem>
        </inner_list_items>
        <ListType>Number</ListType>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="0cad1874-4ed5-41ad-b254-c3987645847d"
        item_type="Header"
        item_footer="footer_not_set">
        <header_type>Star</header_type>
        <header_level>2</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="8187f417-d557-4af8-a414-e9e639847965"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>60778cd4-febe-4e6e-9303-30566423ff96</SegmentId>
            <InternalNormalItem
              internal_item_id="52ed0e36-beb6-489a-a2f3-7a17e072b200"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="ba7052f9-d62c-4bb5-b63a-84538b8a320e"
        item_type="FencedCodeBlock"
        item_footer="">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block>##-----------------------------------------------------------------------
## &lt;copyright file="ApplyVersionToAssemblies.ps1"&gt;(c) Microsoft Corporation. This source is subject to the Microsoft Permissive License. See http://www.microsoft.com/resources/sharedsource/licensingbasics/sharedsourcelicenses.mspx. All other rights reserved.&lt;/copyright&gt;
##-----------------------------------------------------------------------
# Look for a 0.0.0.0 pattern in the build number. 
# If found use it to version the assemblies.
#
# For example, if the 'Build number format' build process parameter 
# $(BuildDefinitionName)_$(Year:yyyy).$(Month).$(DayOfMonth)$(Rev:.r)
# then your build numbers come out like this:
# "Build HelloWorld_2013.07.19.1"
# This script would then apply version 2013.07.19.1 to your assemblies.

# Enable -Verbose option
[CmdletBinding()]

# Regular expression pattern to find the version in the build number 
# and then apply it to the assemblies
$VersionRegex = "\d+\.\d+\.\d+\.\d+"

# If this script is not running on a build server, remind user to 
# set environment variables so that this script can be debugged
if(-not ($Env:BUILD_SOURCESDIRECTORY -and $Env:BUILD_BUILDNUMBER))
{
    Write-Error "You must set the following environment variables"
    Write-Error "to test this script interactively."
    Write-Host '$Env:BUILD_SOURCESDIRECTORY - For example, enter something like:'
    Write-Host '$Env:BUILD_SOURCESDIRECTORY = "C:\code\FabrikamTFVC\HelloWorld"'
    Write-Host '$Env:BUILD_BUILDNUMBER - For example, enter something like:'
    Write-Host '$Env:BUILD_BUILDNUMBER = "Build HelloWorld_0000.00.00.0"'
    exit 1
}

# Make sure path to source code directory is available
if (-not $Env:BUILD_SOURCESDIRECTORY)
{
    Write-Error ("BUILD_SOURCESDIRECTORY environment variable is missing.")
    exit 1
}
elseif (-not (Test-Path $Env:BUILD_SOURCESDIRECTORY))
{
    Write-Error "BUILD_SOURCESDIRECTORY does not exist: $Env:BUILD_SOURCESDIRECTORY"
    exit 1
}
Write-Verbose "BUILD_SOURCESDIRECTORY: $Env:BUILD_SOURCESDIRECTORY"

# Make sure there is a build number
if (-not $Env:BUILD_BUILDNUMBER)
{
    Write-Error ("BUILD_BUILDNUMBER environment variable is missing.")
    exit 1
}
Write-Verbose "BUILD_BUILDNUMBER: $Env:BUILD_BUILDNUMBER"

# Get and validate the version data
$VersionData = [regex]::matches($Env:BUILD_BUILDNUMBER,$VersionRegex)
switch($VersionData.Count)
{
   0        
      { 
         Write-Error "Could not find version number data in BUILD_BUILDNUMBER."
         exit 1
      }
   1 {}
   default 
      { 
         Write-Warning "Found more than instance of version data in BUILD_BUILDNUMBER." 
         Write-Warning "Will assume first instance is version."
      }
}
$NewVersion = $VersionData[0]
Write-Verbose "Version: $NewVersion"

# Apply the version to the assembly property files
$files = gci $Env:BUILD_SOURCESDIRECTORY -recurse -include "*Properties*","My Project" | 
    ?{ $_.PSIsContainer } | 
    foreach { gci -Path $_.FullName -Recurse -include AssemblyInfo.* }
if($files)
{
    Write-Verbose "Will apply $NewVersion to $($files.count) files."

    foreach ($file in $files) {
        $filecontent = Get-Content($file)
        attrib $file -r
        $filecontent -replace $VersionRegex, $NewVersion | Out-File $file
        Write-Verbose "$file.FullName - version applied"
    }
}
else
{
    Write-Warning "Found no files."
}</code_block>
        <fenced_code_lang>ps</fenced_code_lang>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="fa4f0eb8-7e50-476f-ab3a-b89435a801df"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>9ec7b581-2df9-4bcb-a6ab-4ee99cd42c9e</SegmentId>
            <InternalNormalItem
              internal_item_id="d4b023d1-f9f1-4341-b7e7-eb0c2fcf001f"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="f3a06f1e-297b-4605-b0bb-3afeec29adc5"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>8eae1f1c-79ab-45c3-af21-da20df3c991c</SegmentId>
            <ImageItem
              internal_item_id="f29bfb66-f261-406a-b494-f1bee4170524"
              internal_item_type="Image">
              <internal_items />
              <internal_Image_type>Inline</internal_Image_type>
              <internal_link_text>Apply version to assemblies build step</internal_link_text>
              <internal_link_url>_img/BldScriptPSExmpVerAssembliesBuildStep.png</internal_link_url>
              <internal_link_title />
            </ImageItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="d398b404-9f60-4245-acb3-cfde13e1c06b"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>e6f7d8ae-0253-478e-aa6f-2b8a2b48ff48</SegmentId>
            <InternalNormalItem
              internal_item_id="dd72d579-3c65-47dd-9395-450b662d5198"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="d0ea2aef-42c1-4d88-8a1f-10c7f810f2c7"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>35c2338e-c402-4dd5-8b6d-0be2b35674b0</SegmentId>
            <ImageItem
              internal_item_id="cb8eed82-4163-4033-88bf-1c77024a7668"
              internal_item_type="Image">
              <internal_items />
              <internal_Image_type>Inline</internal_Image_type>
              <internal_link_text>Build number format</internal_link_text>
              <internal_link_url>_img/BldScriptPSExmpVerAssembliesBuildNumFormat.png</internal_link_url>
              <internal_link_title />
            </ImageItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownFencedCodeBlock"
        item_id="8c0b4ce2-808d-4e42-a2fa-9e4907075ea2"
        item_type="FencedCodeBlock"
        item_footer="">
        <codeblock_wraper>```</codeblock_wraper>
        <code_block>$(BuildDefinitionName)_$(Year:yyyy).$(Month).$(DayOfMonth)$(Rev:.r)</code_block>
        <fenced_code_lang />
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="80b91964-7a03-43a3-9ad8-14b9911ddc56"
        item_type="Header"
        item_footer="footer_not_set">
        <header_type>Star</header_type>
        <header_level>2</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="40c01dea-cc5b-400c-8775-4b94414e953c"
        item_type="Header"
        item_footer="footer_not_set">
        <header_type>Star</header_type>
        <header_level>4</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="7195b641-6e54-4c2f-9063-933dae5be125"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>4eb96b7a-09c1-4802-a6ec-eef55f9224a8</SegmentId>
            <LinkItem
              internal_item_id="d6efa2a3-c43c-4d37-a1ba-b493fe35fe4a"
              internal_item_type="Link">
              <internal_items />
              <internal_link_type>Inline</internal_link_type>
              <internal_link_text>Predefined variables you can use in your scripts</internal_link_text>
              <internal_link_url>variables.md</internal_link_url>
              <internal_link_title />
            </LinkItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="584f246b-8c6d-45e3-a66f-e8a21bff481b"
        item_type="Header"
        item_footer="footer_not_set">
        <header_type>Star</header_type>
        <header_level>4</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="0ebc302a-d149-460e-a60e-141221675867"
        item_type="NormalParagraph"
        item_footer="">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>ca9ec3ec-da72-430c-9777-14fcfc35c410</SegmentId>
            <InternalNormalItem
              internal_item_id="d7b9d340-ddde-4b60-a115-26d5bae24589"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownHeaderBlock"
        item_id="0d268130-4822-472c-af77-f045e2e3d210"
        item_type="Header"
        item_footer="footer_not_set">
        <header_type>Star</header_type>
        <header_level>4</header_level>
      </MarkdownBlockBase>
      <MarkdownBlockBase
        xsi:type="MarkdownParagraphBlock"
        item_id="d4e7da9a-40e8-4cc0-8d51-16df78c3f263"
        item_type="NormalParagraph"
        item_footer="&#xA;&#xA;">
        <paragraph_segments>
          <MarkdownSegment>
            <SegmentId>c0f38123-bd92-4163-a29b-7327d34d4ce4</SegmentId>
            <InternalNormalItem
              internal_item_id="976adb9e-785d-4549-a158-8cb33b286b0f"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
          <MarkdownSegment>
            <SegmentId>1cc4815d-9c87-4713-b336-7ea38a860f10</SegmentId>
            <InternalNormalItem
              internal_item_id="5ca491b9-5c1f-45ac-afa3-f783452fccf5"
              internal_item_type="Normal">
              <internal_items />
            </InternalNormalItem>
          </MarkdownSegment>
        </paragraph_segments>
      </MarkdownBlockBase>
    </ArrayOfMarkdownBlockBase>
  </block_element>
  <references>
    <ArrayOfMarkdownLinkedReference xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
  </references>
</markdown_skeleton_root>