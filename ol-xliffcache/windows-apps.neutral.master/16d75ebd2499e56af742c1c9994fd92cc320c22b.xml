{"nodes":[{"content":"Prepare your Windows desktop application (like Win32, WPF, and Windows Forms) for conversion to a Universal Windows Platform (UWP) app by using the Desktop Conversion extensions.","pos":[33,211]},{"content":"Convert your desktop application to a Universal Windows Platform (UWP) app","pos":[256,330]},{"content":"Convert your desktop application to a Universal Windows Platform (UWP) app","pos":[338,412]},{"content":"Some information relates to pre-released product which may be substantially modified before it's commercially released.","pos":[416,535]},{"content":"Microsoft makes no warranties, express or implied, with respect to the information provided here.","pos":[536,633]},{"content":"Prepare your Windows desktop application (like Win32, WPF, and Windows Forms) for conversion to a Universal Windows Platform (UWP) app by using the Desktop Conversion extensions.","pos":[637,815]},{"content":"Benefits of converting your application to UWP","pos":[820,866]},{"content":"UWP using Desktop Conversion extensions is a bridge that enables you to convert your classic desktop application (like Win32, Windows Forms, and WPF) or game to a Universal Windows Platform (UWP) app or game.","pos":[868,1076]},{"content":"For more info, see <bpt id=\"p1\">[</bpt>Guide to UWP apps<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn894631.aspx)</ept>.","pos":[1077,1179]},{"content":"After conversion, your classic desktop app is packaged, serviced, and deployed in the form of a UWP app package (an .appx or an .appxbundle) targeting Windows 10 Desktop.","pos":[1180,1350]},{"content":"There are two parts to the technology that enables desktop apps to be converted to UWP packages.","pos":[1352,1448]},{"content":"The first is the Desktop App Converter, which takes your existing binaries and repackages them as a UWP package.","pos":[1449,1561]},{"content":"Your code is still the same, it's just packaged differently.","pos":[1562,1622]},{"content":"The second piece comprises runtime technologies in the Windows Anniversary update that enable a UWP package to have executables that run as full trust instead of in an app container.","pos":[1623,1805]},{"content":"This technology also gives a converted app a package identity, which is required to use some UWP APIs.","pos":[1806,1908]},{"content":"Here are some of the benefits of converting your classic desktop app.","pos":[1910,1979]},{"content":"Your app's installation experience is much smoother for your customers.","pos":[1983,2054]},{"content":"You can deploy it to computers using sideloading (see <bpt id=\"p1\">[</bpt>Sideload LOB apps in Windows 10<ept id=\"p1\">](https://technet.microsoft.com/library/mt269549.aspx)</ept>), and it leaves no trace behind after being uninstalled.","pos":[2055,2252]},{"content":"Longer term, you'll also be able to publish your app to the Windows Store.","pos":[2253,2327]},{"content":"Because your converted app has package identity, you can call more UWP APIs, even from the full-trust partition, than you could before.","pos":[2331,2466]},{"content":"At your own pace, you can add UWP features to your app's package, like a XAML user-interface, live tile updates, UWP background tasks, app services, and many more.","pos":[2470,2633]},{"content":"All of the functionality available to any other UWP app is available to your app.","pos":[2634,2715]},{"content":"If you choose to move all of your app's functionality out of the full-trust partition of the app and into the app container partition, then your app will be able to run on any Windows 10 device.","pos":[2719,2913]},{"content":"As a UWP app, your app is able to do the things it could do as a classic desktop app.","pos":[2917,3002]},{"content":"It interacts with a virtualized view of the registry and file system that's indistinguishable from the actual registry and file system.","pos":[3003,3138]},{"content":"Your app can participate in the Windows Store's built-in licensing and automatic update facilities.","pos":[3142,3241]},{"content":"Automatic update is a highly reliable and efficient mechanism, because only the changed parts of files are downloaded.","pos":[3242,3360]},{"content":"Preparing your desktop app for conversion to UWP","pos":[3365,3413]},{"content":"You may not need to do much to get your app ready for the conversion process.","pos":[3414,3491]},{"content":"Remember that the Windows Store handles licensing and automatic updating for you, so you can remove those features from your codebase.","pos":[3492,3626]},{"content":"If any of these situations applies to your application, you need to address this issue before conversion.","pos":[3627,3732]},{"content":"<bpt id=\"p1\">__</bpt>Your app uses a version of .NET earlier than 4.6.1<ept id=\"p1\">__</ept>.","pos":[3736,3791]},{"content":"Only .NET 4.6.1 is supported.","pos":[3792,3821]},{"content":"You must retarget your app to .NET 4.6.1 before converting.","pos":[3822,3881]},{"content":"<bpt id=\"p1\">__</bpt>Your app always runs with elevated security privileges<ept id=\"p1\">__</ept>.","pos":[3886,3945]},{"content":"Your app needs to work while running as the interactive user.","pos":[3946,4007]},{"content":"Users who install your app from the Windows Store may not be system administrators, so requiring your app to run elevated means that it won't run correctly for standard users.","pos":[4008,4183]},{"content":"<bpt id=\"p1\">__</bpt>Your app requires a kernel-mode driver or a Windows service<ept id=\"p1\">__</ept>.","pos":[4187,4251]},{"content":"The bridge is suitable for an app, but it does not support a kernel-mode driver or a Windows service that needs to run under a system account.","pos":[4252,4394]},{"content":"Instead of a Windows service, use a <bpt id=\"p1\">[</bpt>background task<ept id=\"p1\">](https://msdn.microsoft.com/windows/uwp/launch-resume/create-and-register-a-background-task)</ept>.","pos":[4395,4541]},{"content":"<bpt id=\"p1\">__</bpt>Your app's modules are loaded in-process to processes that are not in your AppX package<ept id=\"p1\">__</ept>.","pos":[4545,4637]},{"content":"This isn't permitted, which means that in-process extensions, like <bpt id=\"p1\">[</bpt>shell extensions<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/desktop/dd758089.aspx)</ept>, aren't supported.","pos":[4638,4808]},{"content":"But if you have two apps in the same package, you can do inter-process communication between them.","pos":[4809,4907]},{"content":"<bpt id=\"p1\">__</bpt>Your app uses a custom Application User Model ID (AUMID)<ept id=\"p1\">__</ept>.","pos":[4911,4972]},{"content":"If your process calls <bpt id=\"p1\">[</bpt>SetCurrentProcessExplicitAppUserModelID<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/desktop/dd378422.aspx)</ept> to set its own AUMID, then it may only use the AUMID generated for it by the app model environment/AppX package.","pos":[4973,5215]},{"content":"You can't define custom AUMIDs.","pos":[5216,5247]},{"content":"<bpt id=\"p1\">__</bpt>Your app modifies the HKEY_LOCAL_MACHINE (HKLM) registry hive<ept id=\"p1\">__</ept>.","pos":[5251,5317]},{"content":"Any attempt by your app to create an HKLM key, or to open one for modification, will result in an access-denied failure.","pos":[5318,5438]},{"content":"Remember that your app has its own private virtualized view of the registry, so the notion of a user- and machine-wide registry hive (which is what HKLM is) does not apply.","pos":[5439,5611]},{"content":"You will need to find another way of achieving what you were using HKLM for, like writing to HKEY_CURRENT_USER (HKCU) instead.","pos":[5612,5738]},{"content":"<bpt id=\"p1\">__</bpt>Your app uses a ddeexec registry subkey as a means of launching another app<ept id=\"p1\">__</ept>.","pos":[5742,5822]},{"content":"Instead, use one of the DelegateExecute verb handlers as configured by the various Activatable* extensions in your <bpt id=\"p1\">[</bpt>app package manifest<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br211474.aspx)</ept>.","pos":[5823,6024]},{"content":"<bpt id=\"p1\">__</bpt>Your app writes to the AppData folder with the intention of sharing data with another app<ept id=\"p1\">__</ept>.","pos":[6028,6122]},{"content":"After conversion, AppData is redirected to the local app data store, which is a private store for each UWP app.","pos":[6123,6234]},{"content":"Use a different means of inter-process data sharing.","pos":[6235,6287]},{"content":"For more info, see <bpt id=\"p1\">[</bpt>Store and retrieve settings and other app data<ept id=\"p1\">](https://msdn.microsoft.com/windows/uwp/app-settings/store-and-retrieve-app-data)</ept>.","pos":[6288,6437]},{"content":"<bpt id=\"p1\">__</bpt>Your app writes to the install directory for your app<ept id=\"p1\">__</ept>.","pos":[6441,6499]},{"content":"For example, your app writes to a log file that you put in the same directory as your exe.","pos":[6500,6590]},{"content":"This isn't supported, so you'll need to find another location, like the local app data store.","pos":[6591,6684]},{"content":"<bpt id=\"p1\">__</bpt>Your app installation requires user interaction<ept id=\"p1\">__</ept>.","pos":[6688,6740]},{"content":"Your app installer must be able to run silently, and it must install all of its prerequisites that aren't on by default on a clean OS image.","pos":[6741,6881]},{"content":"<bpt id=\"p1\">__</bpt>Your app uses the Current Working Directory<ept id=\"p1\">__</ept>.","pos":[6885,6933]},{"content":"At runtime, your converted app won't get the same Working Directory that you previously specified in your desktop .LNK shortcut.","pos":[6934,7062]},{"content":"You need to change your CWD at runtime if having the correct directory is important for your app to function correctly.","pos":[7063,7182]},{"content":"<bpt id=\"p1\">__</bpt>Your app requires UIAccess<ept id=\"p1\">__</ept>.","pos":[7186,7217]},{"content":"If your application specifies <ph id=\"ph1\">`UIAccess=true`</ph> in the <ph id=\"ph2\">`requestedExecutionLevel`</ph> element of the UAC manifest, conversion to UWP isn't supported currently.","pos":[7218,7370]},{"content":"For more info, see <bpt id=\"p1\">[</bpt>UI Automation Security Overview<ept id=\"p1\">](https://msdn.microsoft.com/library/ms742884.aspx)</ept>.","pos":[7371,7474]},{"content":"<bpt id=\"p1\">__</bpt>Your app exposes COM objects or GAC assemblies for use by other processes<ept id=\"p1\">__</ept>.","pos":[7478,7556]},{"content":"In the current release, your app cannot expose COM objects or GAC assemblies for use by processes originating from executables external to your AppX package.","pos":[7557,7714]},{"content":"Processes from within the package can register and use COM objects and GAC assemblies as normal, but they will not be visible externally.","pos":[7715,7852]},{"content":"This means interop scenarios like OLE will not function if invoked by external processes.","pos":[7853,7942]},{"content":"<bpt id=\"p1\">__</bpt>Your app is linking C runtime libraries in an unsupported manner<ept id=\"p1\">__</ept>.","pos":[7947,8016]},{"content":"The Microsoft C/C++ runtime library provides routines for programming for the Microsoft Windows operating system.","pos":[8017,8130]},{"content":"These routines automate many common programming tasks that are not provided by the C and C++ languages.","pos":[8131,8234]},{"content":"If your app utilizes C/C++ runtime library, you need to ensure it is linked in a supported manner.","pos":[8235,8333]},{"content":"Visual Studio 2015 supports both dynamic linking, to let your code use common DLL files, or static linking, to link the library directly into your code, to the current version of the CRT.","pos":[8344,8531]},{"content":"If possible, we recommend your app use dynamic linking with VS 2015.","pos":[8532,8600]},{"content":"Support in previous versions of Visual Studio varies.","pos":[8607,8660]},{"content":"See the following table for details:","pos":[8661,8697]},{"pos":[8704,9221],"content":"<table>\n  <th>Visual Studio version</td><th>Dynamic linking</th><th>Static linking</th></th>\n  <tr><td>2005 (VC 8)</td><td>Not supported</td><td>Supported</td>\n  <tr><td>2008 (VC 9)</td><td>Not supported</td><td>Supported</td>\n  <tr><td>2010 (VC 10)</td><td>Supported</td><td>Supported</td>\n  <tr><td>2012 (VC 11)</td><td>Supported</td><td>Not supported</td>\n  <tr><td>2013 (VC 12)</td><td>Supported</td><td>Not supported</td>\n  <tr><td>2015 (VC 14)</td><td>Supported</td><td>Supported</td>\n  </table>","leadings":["","  ","  ","  ","  ","  ","  ","  ","  "],"nodes":[{"content":"Visual Studio version","pos":[14,35]},{"content":"Dynamic linking","pos":[44,59]},{"content":"Static linking","pos":[68,82]},{"content":"2005 (VC 8)","pos":[103,114]},{"content":"Not supported","pos":[123,136]},{"content":"Supported","pos":[145,154]},{"content":"2008 (VC 9)","pos":[170,181]},{"content":"Not supported","pos":[190,203]},{"content":"Supported","pos":[212,221]},{"content":"2010 (VC 10)","pos":[237,249]},{"content":"Supported","pos":[258,267]},{"content":"Supported","pos":[276,285]},{"content":"2012 (VC 11)","pos":[301,313]},{"content":"Supported","pos":[322,331]},{"content":"Not supported","pos":[340,353]},{"content":"2013 (VC 12)","pos":[369,381]},{"content":"Supported","pos":[390,399]},{"content":"Not supported","pos":[408,421]},{"content":"2015 (VC 14)","pos":[437,449]},{"content":"Supported","pos":[458,467]},{"content":"Supported","pos":[476,485]}]},{"content":"Note: In all cases, you must link to the latest publically available CRT.","pos":[9231,9304]},{"content":"<bpt id=\"p1\">__</bpt>Your app installs and loads assemblies from the Windows side-by-side folder<ept id=\"p1\">__</ept>.","pos":[9308,9388]},{"content":"For example, your app uses C runtimes libraries VC8 or VC9 and is dynamically linking them from Windows side-by-side folder, meaning your code is using the common DLL files from a shared folder.","pos":[9389,9583]},{"content":"This is not supported.","pos":[9584,9606]},{"content":"You will need to statically link them by linking to the redistributable library files directly into your code.","pos":[9607,9717]},{"content":"In this section","pos":[9723,9738]},{"content":"Topic","pos":[9742,9747]},{"content":"Description","pos":[9750,9761]},{"content":"Desktop App Converter Preview (Project Centennial)","pos":[9791,9841]},{"content":"Shows how to run Desktop App Converter.","pos":[9890,9929]},{"content":"You probably won't need to do much, if anything, to get your app ready for the conversion process.","pos":[9930,10028]},{"content":"Manually convert your Windows desktop application to a Universal Windows Platform (UWP) app","pos":[10034,10125]},{"content":"Learn how to create an app package and manifest to manually.","pos":[10166,10226]},{"content":"Deploy and debug your converted UWP app","pos":[10232,10271]},{"content":"Contains info to help you be successful deploying and debugging your app after converting it.","pos":[10311,10404]},{"content":"Also, if you're curious about some of the internals of the Desktop Conversion extensions, this topic is for you.","pos":[10405,10517]},{"content":"Desktop app bridge to UWP code samples","pos":[10523,10561]},{"content":"Code samples on GitHub demonstrating features of converted apps.","pos":[10622,10686]}],"content":"---\nauthor: awkoren\nDescription: Prepare your Windows desktop application (like Win32, WPF, and Windows Forms) for conversion to a Universal Windows Platform (UWP) app by using the Desktop Conversion extensions.\nSearch.Product: eADQiWindows 10XVcnh\ntitle: Convert your desktop application to a Universal Windows Platform (UWP) app\n---\n\n# Convert your desktop application to a Universal Windows Platform (UWP) app\n\n\\[Some information relates to pre-released product which may be substantially modified before it's commercially released. Microsoft makes no warranties, express or implied, with respect to the information provided here.\\]\n\nPrepare your Windows desktop application (like Win32, WPF, and Windows Forms) for conversion to a Universal Windows Platform (UWP) app by using the Desktop Conversion extensions.\n\n## Benefits of converting your application to UWP\n\nUWP using Desktop Conversion extensions is a bridge that enables you to convert your classic desktop application (like Win32, Windows Forms, and WPF) or game to a Universal Windows Platform (UWP) app or game. For more info, see [Guide to UWP apps](https://msdn.microsoft.com/library/windows/apps/dn894631.aspx). After conversion, your classic desktop app is packaged, serviced, and deployed in the form of a UWP app package (an .appx or an .appxbundle) targeting Windows 10 Desktop.\n\nThere are two parts to the technology that enables desktop apps to be converted to UWP packages. The first is the Desktop App Converter, which takes your existing binaries and repackages them as a UWP package. Your code is still the same, it's just packaged differently. The second piece comprises runtime technologies in the Windows Anniversary update that enable a UWP package to have executables that run as full trust instead of in an app container. This technology also gives a converted app a package identity, which is required to use some UWP APIs.\n\nHere are some of the benefits of converting your classic desktop app.\n\n* Your app's installation experience is much smoother for your customers. You can deploy it to computers using sideloading (see [Sideload LOB apps in Windows 10](https://technet.microsoft.com/library/mt269549.aspx)), and it leaves no trace behind after being uninstalled. Longer term, you'll also be able to publish your app to the Windows Store.\n\n* Because your converted app has package identity, you can call more UWP APIs, even from the full-trust partition, than you could before.\n\n* At your own pace, you can add UWP features to your app's package, like a XAML user-interface, live tile updates, UWP background tasks, app services, and many more. All of the functionality available to any other UWP app is available to your app.\n\n* If you choose to move all of your app's functionality out of the full-trust partition of the app and into the app container partition, then your app will be able to run on any Windows 10 device.\n\n* As a UWP app, your app is able to do the things it could do as a classic desktop app. It interacts with a virtualized view of the registry and file system that's indistinguishable from the actual registry and file system.\n\n* Your app can participate in the Windows Store's built-in licensing and automatic update facilities. Automatic update is a highly reliable and efficient mechanism, because only the changed parts of files are downloaded.\n\n## Preparing your desktop app for conversion to UWP\nYou may not need to do much to get your app ready for the conversion process. Remember that the Windows Store handles licensing and automatic updating for you, so you can remove those features from your codebase. If any of these situations applies to your application, you need to address this issue before conversion.\n\n+ __Your app uses a version of .NET earlier than 4.6.1__. Only .NET 4.6.1 is supported. You must retarget your app to .NET 4.6.1 before converting. \n\n+ __Your app always runs with elevated security privileges__. Your app needs to work while running as the interactive user. Users who install your app from the Windows Store may not be system administrators, so requiring your app to run elevated means that it won't run correctly for standard users.\n\n+ __Your app requires a kernel-mode driver or a Windows service__. The bridge is suitable for an app, but it does not support a kernel-mode driver or a Windows service that needs to run under a system account. Instead of a Windows service, use a [background task](https://msdn.microsoft.com/windows/uwp/launch-resume/create-and-register-a-background-task).\n\n+ __Your app's modules are loaded in-process to processes that are not in your AppX package__. This isn't permitted, which means that in-process extensions, like [shell extensions](https://msdn.microsoft.com/library/windows/desktop/dd758089.aspx), aren't supported. But if you have two apps in the same package, you can do inter-process communication between them.\n\n+ __Your app uses a custom Application User Model ID (AUMID)__. If your process calls [SetCurrentProcessExplicitAppUserModelID](https://msdn.microsoft.com/library/windows/desktop/dd378422.aspx) to set its own AUMID, then it may only use the AUMID generated for it by the app model environment/AppX package. You can't define custom AUMIDs.\n\n+ __Your app modifies the HKEY_LOCAL_MACHINE (HKLM) registry hive__. Any attempt by your app to create an HKLM key, or to open one for modification, will result in an access-denied failure. Remember that your app has its own private virtualized view of the registry, so the notion of a user- and machine-wide registry hive (which is what HKLM is) does not apply. You will need to find another way of achieving what you were using HKLM for, like writing to HKEY_CURRENT_USER (HKCU) instead.\n\n+ __Your app uses a ddeexec registry subkey as a means of launching another app__. Instead, use one of the DelegateExecute verb handlers as configured by the various Activatable* extensions in your [app package manifest](https://msdn.microsoft.com/library/windows/apps/br211474.aspx).\n\n+ __Your app writes to the AppData folder with the intention of sharing data with another app__. After conversion, AppData is redirected to the local app data store, which is a private store for each UWP app. Use a different means of inter-process data sharing. For more info, see [Store and retrieve settings and other app data](https://msdn.microsoft.com/windows/uwp/app-settings/store-and-retrieve-app-data).\n\n+ __Your app writes to the install directory for your app__. For example, your app writes to a log file that you put in the same directory as your exe. This isn't supported, so you'll need to find another location, like the local app data store.\n\n+ __Your app installation requires user interaction__. Your app installer must be able to run silently, and it must install all of its prerequisites that aren't on by default on a clean OS image.\n\n+ __Your app uses the Current Working Directory__. At runtime, your converted app won't get the same Working Directory that you previously specified in your desktop .LNK shortcut. You need to change your CWD at runtime if having the correct directory is important for your app to function correctly.\n\n+ __Your app requires UIAccess__. If your application specifies `UIAccess=true` in the `requestedExecutionLevel` element of the UAC manifest, conversion to UWP isn't supported currently. For more info, see [UI Automation Security Overview](https://msdn.microsoft.com/library/ms742884.aspx).\n\n+ __Your app exposes COM objects or GAC assemblies for use by other processes__. In the current release, your app cannot expose COM objects or GAC assemblies for use by processes originating from executables external to your AppX package. Processes from within the package can register and use COM objects and GAC assemblies as normal, but they will not be visible externally. This means interop scenarios like OLE will not function if invoked by external processes. \n\n+ __Your app is linking C runtime libraries in an unsupported manner__. The Microsoft C/C++ runtime library provides routines for programming for the Microsoft Windows operating system. These routines automate many common programming tasks that are not provided by the C and C++ languages. If your app utilizes C/C++ runtime library, you need to ensure it is linked in a supported manner. \n    \n    Visual Studio 2015 supports both dynamic linking, to let your code use common DLL files, or static linking, to link the library directly into your code, to the current version of the CRT. If possible, we recommend your app use dynamic linking with VS 2015. \n\n    Support in previous versions of Visual Studio varies. See the following table for details: \n\n    <table>\n    <th>Visual Studio version</td><th>Dynamic linking</th><th>Static linking</th></th>\n    <tr><td>2005 (VC 8)</td><td>Not supported</td><td>Supported</td>\n    <tr><td>2008 (VC 9)</td><td>Not supported</td><td>Supported</td>\n    <tr><td>2010 (VC 10)</td><td>Supported</td><td>Supported</td>\n    <tr><td>2012 (VC 11)</td><td>Supported</td><td>Not supported</td>\n    <tr><td>2013 (VC 12)</td><td>Supported</td><td>Not supported</td>\n    <tr><td>2015 (VC 14)</td><td>Supported</td><td>Supported</td>\n    </table>\n    \n    Note: In all cases, you must link to the latest publically available CRT.\n\n+ __Your app installs and loads assemblies from the Windows side-by-side folder__. For example, your app uses C runtimes libraries VC8 or VC9 and is dynamically linking them from Windows side-by-side folder, meaning your code is using the common DLL files from a shared folder. This is not supported. You will need to statically link them by linking to the redistributable library files directly into your code.\n\n\n## In this section\n\n| Topic | Description |\n|-------|-------------|\n| [Desktop App Converter Preview (Project Centennial)](desktop-to-uwp-run-desktop-app-converter.md) | Shows how to run Desktop App Converter. You probably won't need to do much, if anything, to get your app ready for the conversion process. |\n| [Manually convert your Windows desktop application to a Universal Windows Platform (UWP) app](desktop-to-uwp-manual-conversion.md) | Learn how to create an app package and manifest to manually. |\n| [Deploy and debug your converted UWP app](desktop-to-uwp-deploy-and-debug.md) | Contains info to help you be successful deploying and debugging your app after converting it. Also, if you're curious about some of the internals of the Desktop Conversion extensions, this topic is for you. |\n| [Desktop app bridge to UWP code samples](https://github.com/Microsoft/DesktopBridgeToUWP-Samples) | Code samples on GitHub demonstrating features of converted apps. |\n"}