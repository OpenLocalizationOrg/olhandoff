{"nodes":[{"content":"Run the Desktop Converter App to convert a Windows desktop application (like Win32, WPF, and Windows Forms) to a Universal Windows Platform (UWP) app.","pos":[33,183]},{"content":"Desktop App Converter Preview (Project Centennial)","pos":[228,278]},{"content":"Desktop App Converter Preview (Project Centennial)","pos":[286,336]},{"content":"Some information relates to pre-released product which may be substantially modified before it's commercially released.","pos":[340,459]},{"content":"Microsoft makes no warranties, express or implied, with respect to the information provided here.","pos":[460,557]},{"content":"Get the Desktop App Converter.","pos":[562,592]},{"content":"Desktop App Converter is a pre-release tool that enables you to bring your existing desktop apps written for .NET 4.6.1 or Win32 to the Universal Windows Platform (UWP).","pos":[642,811]},{"content":"You can run your desktop installers through the converter in an unattended (silent) mode and obtain an AppX package that you can install by using the Add-AppxPackage PowerShell cmdlet on your development machine.","pos":[812,1024]},{"content":"The converter runs the desktop installer in an isolated Windows environment using a clean base image provided as part of the converter download.","pos":[1026,1170]},{"content":"It captures any registry and file system I/O made by the desktop installer and packages it as part of the output.","pos":[1171,1284]},{"content":"The converter outputs an AppX with package identity and the ability to call a vast range of WinRT APIs.","pos":[1285,1388]},{"content":"What's new","pos":[1393,1403]},{"content":"This section outlines changes between versions of the Desktop App Converter.","pos":[1405,1481]},{"content":"6/8/2016","pos":[1488,1496]},{"content":"Added support for generating x86 appx packages on AMD64 host machines running the converter.","pos":[1500,1592]},{"content":"Reduced disk space usage by removing any previously expanded base images.","pos":[1595,1668]},{"content":"Added support for cleaning up temporary files and any unnecessary base images.","pos":[1671,1749]},{"content":"Improved support for detecting file type and protocol associations.","pos":[1752,1819]},{"content":"Improved logic to detect the AppExecutable property for a large set of apps.","pos":[1822,1898]},{"content":"Added support for providing additional –InstallerArguments for MSI based installers.","pos":[1901,1985]},{"content":"Bug fixes for any PathTooLongException errors during the conversion process.","pos":[1988,2064]},{"content":"5/12/2016","pos":[2070,2079]},{"content":"Restored support for Pro edition of Windows.","pos":[2083,2127]},{"content":"Converter <ph id=\"ph1\">```-Setup```</ph> flag now enables Windows Containers feature and handles base image expansion.","pos":[2131,2231]},{"content":"Run the following from an elevated PowerShell prompt to do one time setup:","pos":[2232,2306]},{"content":"Added auto-detection of app install path and moving application root outside of VFS to reduce any unnecessary file system redirections at runtime.","pos":[2396,2542]},{"content":"Added auto-detection of the expanded base image as part of the conversion process.","pos":[2545,2627]},{"content":"Added auto-detection for file type associations and protocols.","pos":[2630,2692]},{"content":"Improved logic to detect Start Menu shortcut.","pos":[2695,2740]},{"content":"Improved file system filtering to retain app installed MUI files.","pos":[2743,2808]},{"content":"Updated the minimum supported desktop version (10.0.14342.0) for Project Centennial in the manifest.","pos":[2811,2911]},{"content":"System requirements","pos":[2916,2935]},{"content":"Supported operating system","pos":[2941,2967]},{"content":"Windows 10 Anniversary Update Enterprise edition preview (Build 10.0.14342.0 and later)","pos":[2970,3057]},{"content":"Required hardware configuration","pos":[3063,3094]},{"content":"Your computer must have the following minimum capabilities:","pos":[3096,3155]},{"content":"64 bit (x64) processor","pos":[3158,3180]},{"content":"Hardware-assisted virtualization","pos":[3183,3215]},{"content":"Second Level Address Translation (SLAT)","pos":[3218,3257]},{"content":"Recommended resources","pos":[3263,3284]},{"content":"Windows Software Development Kit (SDK) for Windows 10","pos":[3288,3341]},{"content":"Set up the Desktop App Converter","pos":[3419,3451]},{"content":"Desktop App Converter relies on Windows 10 features that are flighted as part of the Windows Insider Preview builds.","pos":[3455,3571]},{"content":"Make sure that you're on the latest build to utilize the converter.","pos":[3572,3639]},{"content":"Ensure that you have the latest Windows 10 Insider Preview OS – Enterprise or Pro edition (http://insider.windows.com).","pos":[3644,3763]},{"content":"Download the DesktopAppConverter.zip and the base image .wim file that matches your Insider Preview build (http://aka.ms/converter).","pos":[3768,3900]},{"content":"Extract the DesktopAppConverter.zip to a local folder.","pos":[3905,3959]},{"content":"From an admin PowerShell window:","pos":[3963,3995]},{"content":"Run the following command from an admin PowerShell window to setup the converter:","pos":[4047,4128]},{"content":"If running the previous command prompts you to reboot, restart your machine and run the command again.","pos":[4226,4328]},{"content":"Run the Desktop App Converter","pos":[4333,4362]},{"content":"Desktop App Converter has two entry points: PowerShell and Command Shell.","pos":[4363,4436]},{"content":"You can use either of these entry points to start the conversion process.","pos":[4437,4510]},{"content":"Usage","pos":[4516,4521]},{"content":"Example","pos":[5010,5017]},{"pos":[5018,5141],"content":"The following example shows how to convert a desktop app named <bpt id=\"p1\">*</bpt>MyApp<ept id=\"p1\">*</ept> by <bpt id=\"p2\">*</bpt><ph id=\"ph1\">&amp;lt;</ph>publisher_name<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p2\">*</ept> to a UWP package (AppX)."},{"content":"From an admin PowerShell window, run the following command:","pos":[5145,5204]},{"content":"Deploy your converted AppX","pos":[5433,5459]},{"content":"Use the <bpt id=\"p1\">[</bpt>Add-AppxPackage<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/hh856048.aspx)</ept> cmdlet in PowerShell to deploy a signed app package (.appx) to a user account.","pos":[5460,5623]},{"content":"To sign your .appx package, refer to the following section, \"Signing your .Appx Package\".","pos":[5624,5713]},{"content":"Also, you can include the <bpt id=\"p1\">*</bpt>Register<ept id=\"p1\">*</ept> parameter of the cmdlet to install from a folder of unpackaged files during the development process.","pos":[5714,5851]},{"content":"For more info, see <bpt id=\"p1\">[</bpt>Deploy and debug your converted UWP app<ept id=\"p1\">](desktop-to-uwp-deploy-and-debug.md)</ept>.","pos":[5852,5949]},{"content":"Sign your .Appx Package","pos":[5954,5977]},{"content":"The Add-AppxPackage cmdlet requires that the application package (.appx) being deployed must be signed.","pos":[5979,6082]},{"content":"Use SignTool.exe, which ships in the Microsoft Windows 10 SDK, to sign the .appx package.","pos":[6083,6172]},{"content":"Example","pos":[6178,6185]},{"pos":[6425,6515],"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept> When you run MakeCert.exe and you're asked to enter a password, select <bpt id=\"p2\">**</bpt>None<ept id=\"p2\">**</ept>."},{"content":"For more info on certificates and signing, see:","pos":[6517,6564]},{"content":"How to: Create Temporary Certificates for Use During Development","pos":[6569,6633]},{"content":"SignTool","pos":[6688,6696]},{"content":"SignTool.exe (Sign Tool)","pos":[6767,6791]},{"content":"Caveats","pos":[6848,6855]},{"content":"The Windows 10 build on the host machine must match the base image that you obtained as part of the Desktop App Converter download.","pos":[6859,6990]},{"content":"Ensure that the desktop installer is in an independent directory, because the converter copies all of the directory's content to the isolated Windows environment.","pos":[6996,7158]},{"content":"Currently, the Desktop App Converter supports running the conversion process on a 64-bit operating system only.","pos":[7164,7275]},{"content":"You can deploy the converted .appx packages to a 64-bit (x64) OS only.","pos":[7276,7346]},{"content":"Desktop App Converter requires the desktop installer to run under unattended mode.","pos":[7352,7434]},{"content":"Ensure that you pass the silent flag for your installer to the converter by using the <bpt id=\"p1\">*</bpt>-InstallerArguments<ept id=\"p1\">*</ept> parameter.","pos":[7435,7553]},{"content":"Publishing public SxS Fusion assemblies won't work.","pos":[7557,7608]},{"content":"During install, an application can publish public side-by-side Fusion assemblies, accessible to any other process.","pos":[7609,7723]},{"content":"During process activation context creation, these assemblies are retrieved by a system process named CSRSS.exe.","pos":[7724,7835]},{"content":"When this is done for a Centennial process, activation context creation and module loading of these assemblies will fail.","pos":[7836,7957]},{"content":"Inbox assemblies, like ComCtl, are shipped with the OS, so taking a dependency on them from Centennial processes is safe.","pos":[7958,8079]},{"content":"The SxS Fusion assemblies are registered in the following locations:","pos":[8080,8148]},{"pos":[8153,8162],"content":"Registry:"},{"content":"File System: %windir%<ph id=\"ph1\">\\\\</ph>SideBySide","pos":[8249,8282]},{"content":"Known issues","pos":[8287,8299]},{"content":"If you receive a Windows Insider flight on a developer machine that previously had the Desktop App Converter Preview installed, you may receive the error <ph id=\"ph1\">`New-ContainerNetwork: The object already exists`</ph> when you setup the new base image.","pos":[8303,8541]},{"content":"As a workaround, run the command <ph id=\"ph1\">`Netsh int ipv4 reset`</ph> from an elevated command prompt, then reboot your machine.","pos":[8542,8656]},{"content":"A .NET app compiled with \"AnyCPU\" build option will fail to install if the main executable or any of the dependencies were placed under \"Program Files\" or \"Windows\\System32\".","pos":[8660,8834]},{"content":"As a workaround, please use your architecture specific desktop installer (32 bit or 64 bit) to successfully generate an AppX package.","pos":[8835,8968]},{"content":"Telemetry from Desktop App Converter","pos":[8973,9009]},{"content":"Desktop App Converter may collect information about you and your use of the software and send this info to Microsoft.","pos":[9012,9129]},{"content":"You can learn more about Microsoft's data collection and use in the product documentation and in the <bpt id=\"p1\">[</bpt>Microsoft Privacy Statement<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=521839)</ept>.","pos":[9130,9308]},{"content":"You agree to comply with all applicable provisions of the Microsoft Privacy Statement.","pos":[9309,9395]},{"content":"By default, telemetry will be enabled for the Desktop App Converter.","pos":[9397,9465]},{"content":"Add the following registry key to configure telemetry to a desired setting:","pos":[9466,9541]},{"pos":[9615,9682],"content":"Add or edit the <bpt id=\"p1\">*</bpt>DisableTelemetry<ept id=\"p1\">*</ept> value by using a DWORD set to 1."},{"content":"To enable telemetry, remove the key or set the value to 0.","pos":[9685,9743]},{"content":"Desktop App Converter usage","pos":[9748,9775]},{"content":"Here's a list of parameters to the Desktop App Converter.","pos":[9776,9833]},{"content":"You can also view this list in the Windows Powershell window by running the following command:","pos":[9834,9928]},{"content":"Setup Parameters","pos":[9992,10008]},{"content":"Parameter","pos":[10012,10021]},{"content":"Description","pos":[10022,10033]},{"content":"Runs DesktopAppConverter in setup mode.","pos":[10095,10134]},{"content":"Setup mode supports expanding a provided base image.","pos":[10135,10187]},{"content":"Full path to an unexpanded base image.","pos":[10218,10256]},{"content":"This parameter is required if -Setup is specified.","pos":[10257,10307]},{"pos":[10334,10344],"content":"[optional]"},{"content":"Specifies a log file.","pos":[10347,10368]},{"content":"If omitted, a log file temporary location will be created.","pos":[10369,10427]},{"pos":[10462,10472],"content":"[optional]"},{"content":"Prefix value to be used for the Nat instance.","pos":[10475,10520]},{"content":"Typically, you would want to change this only if your host machine is attached to the same subnet range as the converter's NetNat.","pos":[10521,10651]},{"content":"You can query the current converter NetNat config by using the <bpt id=\"p1\">**</bpt>Get-NetNat<ept id=\"p1\">**</ept> cmdlet.","pos":[10652,10737]},{"content":"Don't prompt for reboot when running setup (reboot is required to enable the container feature).","pos":[10780,10876]},{"content":"Conversion Parameters","pos":[10884,10905]},{"content":"Parameter","pos":[10909,10918]},{"content":"Description","pos":[10919,10930]},{"content":"The path to the installer for your application - must be able to run unattended/silently","pos":[10985,11073]},{"pos":[11111,11121],"content":"[optional]"},{"content":"A comma-separated list or string of arguments to force your installer to run unattended/silently.","pos":[11124,11221]},{"content":"This parameter is optional if your installer is an msi.","pos":[11222,11277]},{"content":"To get a log from your installer, supply the logging argument for the installer here and use the path <ph id=\"ph1\">```&lt;log_folder&gt;```</ph>, which is a token that the converter replaces with the appropriate path.","pos":[11278,11471]},{"content":"NOTE: The unattended/silent flags and log arguments will vary between installer technologies.","pos":[11482,11575]},{"content":"An example usage for this parameter: <ph id=\"ph1\">```-InstallerArguments \"/silent /log &lt;log_folder&gt;\\install.log\"```</ph> Another example that doesn't produce a log file may look like: <ph id=\"ph2\">```-InstallerArguments \"/quiet\", \"/norestart\"```</ph> Again, you must literally direct any logs to the token path <ph id=\"ph3\">```&lt;log_folder&gt;```</ph> if you want the converter to capture it and put it in the final log folder.","pos":[11586,11955]},{"pos":[11997,12007],"content":"[optional]"},{"content":"A comma-separated list of exit codes that indicate your installer ran successfully (for example: 0, 1234, 5678).","pos":[12010,12122]},{"content":"By default this is 0 for non-msi, and 0, 1641, 3010 for msi.","pos":[12124,12184]},{"content":"The desired destination for the converter's appx output - DesktopAppConverter can create this location if it doesn't already exist.","pos":[12217,12348]},{"content":"Appx Identity Parameters","pos":[12355,12379]},{"content":"Parameter","pos":[12383,12392]},{"content":"Description","pos":[12393,12404]},{"content":"The name of your Universal Windows App package","pos":[12461,12507]},{"content":"The publisher of your Universal Windows App package","pos":[12537,12588]},{"content":"The version number for your Universal Windows App package","pos":[12617,12674]},{"content":"Optional Appx Manifest Parameters","pos":[12680,12713]},{"content":"Parameter","pos":[12717,12726]},{"content":"Description","pos":[12727,12738]},{"pos":[12795,12805],"content":"[optional]"},{"content":"The full path to your application's main executable if it were to be installed (it doesn't have to be), for example, \"C:\\Program Files (x86)\\MyApp\\MyApp.exe\".","pos":[12808,12966]},{"pos":[12998,13008],"content":"[optional]"},{"content":"A comma-separated list of file types which the application will be associated with (eg.","pos":[13011,13098]},{"content":"\".txt, .doc\", without the quotes).","pos":[13099,13133]},{"pos":[13158,13168],"content":"[optional]"},{"content":"Specifies a value to set Application Id to in the appx manifest.","pos":[13171,13235]},{"content":"If it is not specified, it will be set to the value passed in for <bpt id=\"p1\">*</bpt>PackageName<ept id=\"p1\">*</ept>.","pos":[13236,13316]},{"pos":[13350,13360],"content":"[optional]"},{"content":"Specifies a value to set Application Display Name to in the appx manifest.","pos":[13363,13437]},{"content":"If it is not specified, it will be set to the value passed in for <bpt id=\"p1\">*</bpt>PackageName<ept id=\"p1\">*</ept>.","pos":[13438,13518]},{"pos":[13553,13563],"content":"[optional]"},{"content":"Specifies a value to set Application Description to in the appx manifest.","pos":[13566,13639]},{"content":"If it is not specified, it will be set to the value passed in for <bpt id=\"p1\">*</bpt>PackageName<ept id=\"p1\">*</ept>.","pos":[13640,13720]},{"pos":[13758,13768],"content":"[optional]"},{"content":"Specifies a value to set Package Display Name to in the appx manifest.","pos":[13771,13841]},{"content":"If it is not specified, it will be set to the value passed in for <bpt id=\"p1\">*</bpt>PackageName<ept id=\"p1\">*</ept>.","pos":[13842,13922]},{"pos":[13970,13980],"content":"[optional]"},{"content":"Specifies a value to set Package Publisher Display Name to in the appx manifest.","pos":[13983,14063]},{"content":"If it is not specified, it will be set to the value passed in for <bpt id=\"p1\">*</bpt>Publisher<ept id=\"p1\">*</ept>.","pos":[14064,14142]},{"content":"Other Conversion Parameters","pos":[14150,14177]},{"content":"Parameter","pos":[14181,14190]},{"content":"Description","pos":[14191,14202]},{"pos":[14263,14273],"content":"[optional]"},{"content":"Full path to an already expanded base image.","pos":[14276,14320]},{"pos":[14359,14369],"content":"[optional]"},{"content":"A switch that, when present, tells this script to call MakeAppx on the output.","pos":[14372,14450]},{"pos":[14478,14488],"content":"[optional]"},{"content":"Specifies a log file.","pos":[14491,14512]},{"content":"If omitted, a log file temporary location will be created.","pos":[14513,14571]},{"content":"This cmdlet supports the common parameters: <bpt id=\"p1\">*</bpt>Verbose<ept id=\"p1\">*</ept>, <bpt id=\"p2\">*</bpt>Debug<ept id=\"p2\">*</ept>, <bpt id=\"p3\">*</bpt>ErrorAction<ept id=\"p3\">*</ept>, <bpt id=\"p4\">*</bpt>ErrorVariable<ept id=\"p4\">*</ept>, <bpt id=\"p5\">*</bpt>WarningAction<ept id=\"p5\">*</ept>, <bpt id=\"p6\">*</bpt>WarningVariable<ept id=\"p6\">*</ept>, <bpt id=\"p7\">*</bpt>OutBuffer<ept id=\"p7\">*</ept>, <bpt id=\"p8\">*</bpt>PipelineVariable<ept id=\"p8\">*</ept>, and <bpt id=\"p9\">*</bpt>OutVariable<ept id=\"p9\">*</ept>.","pos":[14603,14786]},{"content":"For more info, see <bpt id=\"p1\">[</bpt>about_CommonParameters<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkID=113216)</ept>.","pos":[14787,14878]},{"content":"Cleanup Parameters","pos":[14886,14904]},{"content":"Parameter","pos":[14906,14915]},{"content":"Description","pos":[14916,14927]},{"content":"Runs cleanup for the DesktopAppConverter artifacts.","pos":[14981,15032]},{"content":"There are 3 valid options for the Cleanup mode.","pos":[15033,15080]},{"content":"Deletes all expanded base images, removes any temporary converter files, removes the container network, and disables the optional Windows feature, Containers.","pos":[15104,15262]},{"content":"Removes all the temporary converter files.","pos":[15296,15338]},{"content":"Deletes all the expanded base images installed on your host machine.","pos":[15373,15441]},{"content":"x86 Package Parameters","pos":[15449,15471]},{"content":"The Desktop App Converter Preview now supports creation of x86 app packages that you can install and run on both x86 and amd64 machines.","pos":[15472,15608]},{"content":"Note the Desktop App Converter still needs to run on an AMD64 machine to perform a successful conversion.","pos":[15609,15714]},{"content":"Parameter","pos":[15717,15726]},{"content":"Description","pos":[15727,15738]},{"content":"Generates a 32-bit package that can install and run on both a 32-bit and 64-bit host OS.","pos":[15810,15898]},{"content":"By default, converter attempts to detect package architecture from app’s main executable or defaults to 64-bit if no exe is found.","pos":[15899,16029]},{"content":"See also","pos":[16036,16044]},{"content":"Get the Desktop App Converter","pos":[16048,16077]},{"content":"Bring your desktop app to the Universal Windows Platform","pos":[16129,16185]},{"content":"Bringing Desktop Apps to the UWP Using Desktop App Converter","pos":[16253,16313]},{"content":"Project Centennial: Bringing Existing Desktop Applications to the Universal Windows Platform","pos":[16368,16460]},{"content":"UserVoice for Desktop Bridge (Project Centennial)","pos":[16517,16566]},{"content":"Desktop app bridge to UWP code samples on GitHub","pos":[16608,16656]}],"content":"---\nauthor: awkoren\nDescription: Run the Desktop Converter App to convert a Windows desktop application (like Win32, WPF, and Windows Forms) to a Universal Windows Platform (UWP) app.\nSearch.Product: eADQiWindows 10XVcnh\ntitle: Desktop App Converter Preview (Project Centennial)\n---\n\n# Desktop App Converter Preview (Project Centennial)\n\n\\[Some information relates to pre-released product which may be substantially modified before it's commercially released. Microsoft makes no warranties, express or implied, with respect to the information provided here.\\]\n\n[Get the Desktop App Converter.](http://go.microsoft.com/fwlink/?LinkId=785437)\n\nDesktop App Converter is a pre-release tool that enables you to bring your existing desktop apps written for .NET 4.6.1 or Win32 to the Universal Windows Platform (UWP). You can run your desktop installers through the converter in an unattended (silent) mode and obtain an AppX package that you can install by using the Add-AppxPackage PowerShell cmdlet on your development machine.\n\nThe converter runs the desktop installer in an isolated Windows environment using a clean base image provided as part of the converter download. It captures any registry and file system I/O made by the desktop installer and packages it as part of the output. The converter outputs an AppX with package identity and the ability to call a vast range of WinRT APIs.\n\n## What's new\n\nThis section outlines changes between versions of the Desktop App Converter. \n\n### 6/8/2016\n\n* Added support for generating x86 appx packages on AMD64 host machines running the converter.\n* Reduced disk space usage by removing any previously expanded base images.\n* Added support for cleaning up temporary files and any unnecessary base images.\n* Improved support for detecting file type and protocol associations.\n* Improved logic to detect the AppExecutable property for a large set of apps.\n* Added support for providing additional –InstallerArguments for MSI based installers.\n* Bug fixes for any PathTooLongException errors during the conversion process.\n\n### 5/12/2016\n\n- Restored support for Pro edition of Windows. \n- Converter ```-Setup``` flag now enables Windows Containers feature and handles base image expansion. Run the following from an elevated PowerShell prompt to do one time setup: ```PS C:\\> .\\DesktopAppConverter.ps1 -Setup -BaseImage BaseImage-12345.wim -Verbose```\n- Added auto-detection of app install path and moving application root outside of VFS to reduce any unnecessary file system redirections at runtime.\n- Added auto-detection of the expanded base image as part of the conversion process.\n- Added auto-detection for file type associations and protocols.\n- Improved logic to detect Start Menu shortcut.\n- Improved file system filtering to retain app installed MUI files.\n- Updated the minimum supported desktop version (10.0.14342.0) for Project Centennial in the manifest.\n\n## System requirements\n\n### Supported operating system\n+ Windows 10 Anniversary Update Enterprise edition preview (Build 10.0.14342.0 and later)\n\n### Required hardware configuration\n\nYour computer must have the following minimum capabilities:\n+ 64 bit (x64) processor\n+ Hardware-assisted virtualization\n+ Second Level Address Translation (SLAT)\n\n### Recommended resources\n+ [Windows Software Development Kit (SDK) for Windows 10](https://developer.microsoft.com/en-us/windows/downloads/windows-10-sdk)\n\n## Set up the Desktop App Converter   \nDesktop App Converter relies on Windows 10 features that are flighted as part of the Windows Insider Preview builds. Make sure that you're on the latest build to utilize the converter.\n\n1. Ensure that you have the latest Windows 10 Insider Preview OS – Enterprise or Pro edition (http://insider.windows.com). \n2. Download the DesktopAppConverter.zip and the base image .wim file that matches your Insider Preview build (http://aka.ms/converter). \n3. Extract the DesktopAppConverter.zip to a local folder.\n4. From an admin PowerShell window:  \n```CMD\nPS C:\\> Set-ExecutionPolicy bypass\n```\n5. Run the following command from an admin PowerShell window to setup the converter:\n```CMD\nPS C:\\> .\\DesktopAppConverter.ps1 -Setup -BaseImage .\\BaseImage-1XXXX.wim -Verbose\n```\n6. If running the previous command prompts you to reboot, restart your machine and run the command again.\n\n## Run the Desktop App Converter\nDesktop App Converter has two entry points: PowerShell and Command Shell. You can use either of these entry points to start the conversion process.\n\n### Usage\n```CMD\nDesktopAppConverter.ps1\n-Installer <String> [-InstallerArguments <String>] [-InstallerValidExitCodes <Int32>]\n-Destination <String>\n-PackageName <String>\n-Publisher <String>\n-Version <Version>\n[-ExpandedBaseImage <String>]\n[-AppExecutable <String>]\n[-AppFileTypes <String>]\n[-AppId <String>]\n[-AppDisplayName <String>]\n[-AppDescription <String>]\n[-PackageDisplayName <String>]\n[-PackagePublisherDisplayName <String>]\n[-MakeAppx]\n[-LogFile <String>]\n[<CommonParameters>]  \n```\n\n### Example\nThe following example shows how to convert a desktop app named *MyApp* by *&lt;publisher_name&gt;* to a UWP package (AppX).\n\n+ From an admin PowerShell window, run the following command:\n```CMD\nPS C:\\>.\\DesktopAppConverter.ps1 -Installer C:\\Installer\\MyApp.exe \n-InstallerArguments \"/S\" -Destination C:\\Output\\MyApp -PackageName \"MyApp\" \n-Publisher \"CN=<publisher_name>\" -Version 0.0.0.1 -MakeAppx -Verbose\n```\n\n## Deploy your converted AppX\nUse the [Add-AppxPackage](https://technet.microsoft.com/en-us/library/hh856048.aspx) cmdlet in PowerShell to deploy a signed app package (.appx) to a user account. To sign your .appx package, refer to the following section, \"Signing your .Appx Package\". Also, you can include the *Register* parameter of the cmdlet to install from a folder of unpackaged files during the development process. For more info, see [Deploy and debug your converted UWP app](desktop-to-uwp-deploy-and-debug.md).\n\n## Sign your .Appx Package\n\nThe Add-AppxPackage cmdlet requires that the application package (.appx) being deployed must be signed. Use SignTool.exe, which ships in the Microsoft Windows 10 SDK, to sign the .appx package.\n\n### Example\n```CMD\nC:\\> MakeCert.exe -r -h 0 -n \"CN=<publisher_name>\" -eku 1.3.6.1.5.5.7.3.3 -pe -sv <my.pvk> <my.cer>\nC:\\> pvk2pfx.exe -pvk <my.pvk> -spc <my.cer> -pfx <my.pfx>\nC:\\> signtool.exe sign -f <my.pfx> -fd SHA256 -v .\\<outputAppX>.appx\n```\n**Note:** When you run MakeCert.exe and you're asked to enter a password, select **None**.\n\nFor more info on certificates and signing, see:\n\n+ [How to: Create Temporary Certificates for Use During Development](https://msdn.microsoft.com/library/ms733813.aspx)\n+ [SignTool](https://msdn.microsoft.com/library/windows/desktop/aa387764.aspx)\n+ [SignTool.exe (Sign Tool)](https://msdn.microsoft.com/library/8s9b9yaz.aspx)\n\n### Caveats\n1. The Windows 10 build on the host machine must match the base image that you obtained as part of the Desktop App Converter download.  \n2. Ensure that the desktop installer is in an independent directory, because the converter copies all of the directory's content to the isolated Windows environment.  \n3. Currently, the Desktop App Converter supports running the conversion process on a 64-bit operating system only. You can deploy the converted .appx packages to a 64-bit (x64) OS only.  \n4. Desktop App Converter requires the desktop installer to run under unattended mode. Ensure that you pass the silent flag for your installer to the converter by using the *-InstallerArguments* parameter.\n5. Publishing public SxS Fusion assemblies won't work. During install, an application can publish public side-by-side Fusion assemblies, accessible to any other process. During process activation context creation, these assemblies are retrieved by a system process named CSRSS.exe. When this is done for a Centennial process, activation context creation and module loading of these assemblies will fail. Inbox assemblies, like ComCtl, are shipped with the OS, so taking a dependency on them from Centennial processes is safe. The SxS Fusion assemblies are registered in the following locations:\n  + Registry: `HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\SideBySide\\Winners`\n  + File System: %windir%\\\\SideBySide\n\n## Known issues\n\n+ If you receive a Windows Insider flight on a developer machine that previously had the Desktop App Converter Preview installed, you may receive the error `New-ContainerNetwork: The object already exists` when you setup the new base image. As a workaround, run the command `Netsh int ipv4 reset` from an elevated command prompt, then reboot your machine. \n+ A .NET app compiled with \"AnyCPU\" build option will fail to install if the main executable or any of the dependencies were placed under \"Program Files\" or \"Windows\\System32\". As a workaround, please use your architecture specific desktop installer (32 bit or 64 bit) to successfully generate an AppX package.\n\n## Telemetry from Desktop App Converter  \nDesktop App Converter may collect information about you and your use of the software and send this info to Microsoft. You can learn more about Microsoft's data collection and use in the product documentation and in the [Microsoft Privacy Statement](http://go.microsoft.com/fwlink/?LinkId=521839). You agree to comply with all applicable provisions of the Microsoft Privacy Statement.\n\nBy default, telemetry will be enabled for the Desktop App Converter. Add the following registry key to configure telemetry to a desired setting:  \n```CMD\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\DesktopAppConverter\n```\n+ Add or edit the *DisableTelemetry* value by using a DWORD set to 1.\n+ To enable telemetry, remove the key or set the value to 0.\n\n## Desktop App Converter usage\nHere's a list of parameters to the Desktop App Converter. You can also view this list in the Windows Powershell window by running the following command:  \n```CMD\nget-help .\\DesktopAppConverter.ps1 -detailed\n```\n\n### Setup Parameters  \n|Parameter|Description|\n|---------|-----------|\n|```-Setup [<SwitchParameter>]``` | Runs DesktopAppConverter in setup mode. Setup mode supports expanding a provided base image.|\n|```-BaseImage <String>``` | Full path to an unexpanded base image. This parameter is required if -Setup is specified.|\n|```-LogFile <String>``` [optional] | Specifies a log file. If omitted, a log file temporary location will be created.|\n|```-NatSubnetPrefix <String>``` [optional] | Prefix value to be used for the Nat instance. Typically, you would want to change this only if your host machine is attached to the same subnet range as the converter's NetNat. You can query the current converter NetNat config by using the **Get-NetNat** cmdlet. |\n|```-NoRestart [<SwitchParameter>]``` | Don't prompt for reboot when running setup (reboot is required to enable the container feature). |\n\n### Conversion Parameters  \n|Parameter|Description|\n|---------|-----------|\n|```-Installer <String>``` | The path to the installer for your application - must be able to run unattended/silently|\n|```-InstallerArguments <String>``` [optional] | A comma-separated list or string of arguments to force your installer to run unattended/silently. This parameter is optional if your installer is an msi. To get a log from your installer, supply the logging argument for the installer here and use the path ```<log_folder>```, which is a token that the converter replaces with the appropriate path. <br><br>**NOTE: The unattended/silent flags and log arguments will vary between installer technologies.** <br><br>An example usage for this parameter: ```-InstallerArguments \"/silent /log <log_folder>\\install.log\"``` Another example that doesn't produce a log file may look like: ```-InstallerArguments \"/quiet\", \"/norestart\"``` Again, you must literally direct any logs to the token path ```<log_folder>``` if you want the converter to capture it and put it in the final log folder.|\n|```-InstallerValidExitCodes <Int32>``` [optional] | A comma-separated list of exit codes that indicate your installer ran successfully (for example: 0, 1234, 5678).  By default this is 0 for non-msi, and 0, 1641, 3010 for msi.|\n|```-Destination <String>``` | The desired destination for the converter's appx output - DesktopAppConverter can create this location if it doesn't already exist.|\n\n### Appx Identity Parameters  \n|Parameter|Description|\n|---------|-----------|\n|```-PackageName <String>``` | The name of your Universal Windows App package\n|```-Publisher <String>``` | The publisher of your Universal Windows App package\n|```-Version <Version>``` | The version number for your Universal Windows App package\n\n### Optional Appx Manifest Parameters  \n|Parameter|Description|\n|---------|-----------|\n|```-AppExecutable <String>``` [optional] | The full path to your application's main executable if it were to be installed (it doesn't have to be), for example, \"C:\\Program Files (x86)\\MyApp\\MyApp.exe\".|\n|```-AppFileTypes <String>``` [optional] | A comma-separated list of file types which the application will be associated with (eg. \".txt, .doc\", without the quotes).|\n|```-AppId <String>``` [optional] | Specifies a value to set Application Id to in the appx manifest. If it is not specified, it will be set to the value passed in for *PackageName*.|\n|```-AppDisplayName <String>``` [optional] | Specifies a value to set Application Display Name to in the appx manifest. If it is not specified, it will be set to the value passed in for *PackageName*. |\n|```-AppDescription <String>``` [optional] | Specifies a value to set Application Description to in the appx manifest. If it is not specified, it will be set to the value passed in for *PackageName*.|\n|```-PackageDisplayName <String>``` [optional] | Specifies a value to set Package Display Name to in the appx manifest. If it is not specified, it will be set to the value passed in for *PackageName*. |\n|```-PackagePublisherDisplayName <String>``` [optional] | Specifies a value to set Package Publisher Display Name to in the appx manifest. If it is not specified, it will be set to the value passed in for *Publisher*. |\n\n### Other Conversion Parameters  \n|Parameter|Description|\n|---------|-----------|\n|```-ExpandedBaseImage <String>``` [optional] | Full path to an already expanded base image.|\n|```-MakeAppx [<SwitchParameter>]``` [optional] | A switch that, when present, tells this script to call MakeAppx on the output. |\n|```-LogFile <String>``` [optional] | Specifies a log file. If omitted, a log file temporary location will be created. |\n|```<Common parameters>``` | This cmdlet supports the common parameters: *Verbose*, *Debug*, *ErrorAction*, *ErrorVariable*, *WarningAction*, *WarningVariable*, *OutBuffer*, *PipelineVariable*, and *OutVariable*. For more info, see [about_CommonParameters](http://go.microsoft.com/fwlink/?LinkID=113216). |\n\n### Cleanup Parameters\n|Parameter|Description|\n|---------|-----------|\n|```Cleanup [<Option>]``` | Runs cleanup for the DesktopAppConverter artifacts. There are 3 valid options for the Cleanup mode. |\n|```Cleanup All``` | Deletes all expanded base images, removes any temporary converter files, removes the container network, and disables the optional Windows feature, Containers. |\n|```Cleanup WorkDirectory``` | Removes all the temporary converter files. |\n|```Cleanup ExpandedImages``` | Deletes all the expanded base images installed on your host machine. |\n\n### x86 Package Parameters\nThe Desktop App Converter Preview now supports creation of x86 app packages that you can install and run on both x86 and amd64 machines. Note the Desktop App Converter still needs to run on an AMD64 machine to perform a successful conversion.\n\n|Parameter|Description|\n|---------|-----------|\n|```-CreateX86Package[<SwitchParameter>]``` | Generates a 32-bit package that can install and run on both a 32-bit and 64-bit host OS. By default, converter attempts to detect package architecture from app’s main executable or defaults to 64-bit if no exe is found. |\n\n## See also\n+ [Get the Desktop App Converter](http://go.microsoft.com/fwlink/?LinkId=785437)\n+ [Bring your desktop app to the Universal Windows Platform](https://developer.microsoft.com/en-us/windows/bridges/desktop)\n+ [Bringing Desktop Apps to the UWP Using Desktop App Converter](https://channel9.msdn.com/events/Build/2016/P504)\n+ [Project Centennial: Bringing Existing Desktop Applications to the Universal Windows Platform](https://channel9.msdn.com/events/Build/2016/B829)  \n+ [UserVoice for Desktop Bridge (Project Centennial)](http://aka.ms/UserVoiceDesktopToUwp)\n+ [Desktop app bridge to UWP code samples on GitHub](https://github.com/Microsoft/DesktopBridgeToUWP-Samples)\n"}