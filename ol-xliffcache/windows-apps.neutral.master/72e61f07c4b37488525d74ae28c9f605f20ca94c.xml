{"nodes":[{"content":"Auto-launching with AutoPlay","pos":[29,57]},{"content":"You can use AutoPlay to provide your app as an option when a user connects a device to their PC.","pos":[71,167]},{"content":"This includes non-volume devices such as a camera or media player, or volume devices such as a USB thumb drive, SD card, or DVD.","pos":[168,296]},{"pos":[418,446],"content":"Auto-launching with AutoPlay"},{"content":"Updated for UWP apps on Windows 10.","pos":[452,487]},{"content":"For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept>","pos":[488,580]},{"content":"You can use <bpt id=\"p1\">**</bpt>AutoPlay<ept id=\"p1\">**</ept> to provide your app as an option when a user connects a device to their PC.","pos":[586,686]},{"content":"This includes non-volume devices such as a camera or media player, or volume devices such as a USB thumb drive, SD card, or DVD.","pos":[687,815]},{"content":"You can also use <bpt id=\"p1\">**</bpt>AutoPlay<ept id=\"p1\">**</ept> to offer your app as an option when users share files between two PCs by using proximity (tapping).","pos":[816,945]},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  If you are a device manufacturer and you want to associate your <bpt id=\"p2\">[</bpt>Windows Store device app<ept id=\"p2\">](http://go.microsoft.com/fwlink/p/?LinkID=301381)</ept> as an <bpt id=\"p3\">**</bpt>AutoPlay<ept id=\"p3\">**</ept> handler for your device, you can identify that app in the device metadata.","pos":[949,1192]},{"content":"For more info, see <bpt id=\"p1\">[</bpt>AutoPlay for Windows Store device apps<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=306684)</ept>.","pos":[1193,1302]},{"content":"Register for AutoPlay content","pos":[1307,1336]},{"content":"You can register apps as options for <bpt id=\"p1\">**</bpt>AutoPlay<ept id=\"p1\">**</ept> content events.","pos":[1338,1403]},{"content":"<bpt id=\"p1\">**</bpt>AutoPlay<ept id=\"p1\">**</ept> content events are raised when a volume device such as a camera memory card, thumb drive, or DVD is inserted into the PC.","pos":[1404,1538]},{"content":"Here we show how to identify your app as an <bpt id=\"p1\">**</bpt>AutoPlay<ept id=\"p1\">**</ept> option when a volume device from a camera is inserted.","pos":[1539,1650]},{"content":"In this tutorial, you created an app that displays image files or copies them to Pictures.","pos":[1652,1742]},{"content":"You registered the app for the AutoPlay <bpt id=\"p1\">**</bpt>ShowPicturesOnArrival<ept id=\"p1\">**</ept> content event.","pos":[1743,1823]},{"content":"AutoPlay also raises content events for content shared between PCs using proximity (tapping).","pos":[1825,1918]},{"content":"You can use the steps and code in this section to handle files that are shared between PCs that use proximity.","pos":[1919,2029]},{"content":"The following table lists the AutoPlay content events that are available for sharing content by using proximity.","pos":[2030,2142]},{"content":"Action","pos":[2146,2152]},{"content":"AutoPlay content event","pos":[2163,2185]},{"content":"Sharing music","pos":[2236,2249]},{"content":"PlayMusicFilesOnArrival","pos":[2253,2276]},{"content":"Sharing videos","pos":[2281,2295]},{"content":"PlayVideoFilesOnArrival","pos":[2298,2321]},{"pos":[2327,2509],"content":"When files are shared by using proximity, the <bpt id=\"p1\">**</bpt>Files<ept id=\"p1\">**</ept> property of the <bpt id=\"p2\">**</bpt>FileActivatedEventArgs<ept id=\"p2\">**</ept> object contains a reference to a root folder that contains all of the shared files."},{"content":"Step 1: Create a new project and add AutoPlay declarations","pos":[2515,2573]},{"content":"Open Microsoft Visual Studio and select <bpt id=\"p1\">**</bpt>New Project<ept id=\"p1\">**</ept> from the <bpt id=\"p2\">**</bpt>File<ept id=\"p2\">**</ept> menu.","pos":[2579,2658]},{"content":"In the <bpt id=\"p1\">**</bpt>Visual C#<ept id=\"p1\">**</ept> section, under <bpt id=\"p2\">**</bpt>Windows<ept id=\"p2\">**</ept>, select <bpt id=\"p3\">**</bpt>Blank App (Universal Windows)<ept id=\"p3\">**</ept>.","pos":[2659,2749]},{"content":"Name the app <bpt id=\"p1\">**</bpt>AutoPlayDisplayOrCopyImages<ept id=\"p1\">**</ept> and click <bpt id=\"p2\">**</bpt>OK.<ept id=\"p2\">**</ept>","pos":[2750,2812]},{"content":"Open the Package.appxmanifest file and select the <bpt id=\"p1\">**</bpt>Capabilities<ept id=\"p1\">**</ept> tab.","pos":[2817,2888]},{"content":"Select the <bpt id=\"p1\">**</bpt>Removable Storage<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Pictures Library<ept id=\"p2\">**</ept> capabilities.","pos":[2889,2960]},{"content":"This gives the app access to removable storage devices for camera memory, and access to local pictures.","pos":[2961,3064]},{"content":"In the manifest file, select the <bpt id=\"p1\">**</bpt>Declarations<ept id=\"p1\">**</ept> tab.","pos":[3069,3123]},{"content":"In the <bpt id=\"p1\">**</bpt>Available Declarations<ept id=\"p1\">**</ept> drop-down list, select <bpt id=\"p2\">**</bpt>AutoPlay Content<ept id=\"p2\">**</ept> and click <bpt id=\"p3\">**</bpt>Add<ept id=\"p3\">**</ept>.","pos":[3124,3220]},{"content":"Select the new <bpt id=\"p1\">**</bpt>AutoPlay Content<ept id=\"p1\">**</ept> item that was added to the <bpt id=\"p2\">**</bpt>Supported Declarations<ept id=\"p2\">**</ept> list.","pos":[3221,3316]},{"content":"An <bpt id=\"p1\">**</bpt>AutoPlay Content<ept id=\"p1\">**</ept> declaration identifies your app as an option when AutoPlay raises a content event.","pos":[3321,3427]},{"content":"The event is based on the content of a volume device such as a DVD or a thumb drive.","pos":[3428,3512]},{"content":"AutoPlay examines the content of the volume device and determines which content event to raise.","pos":[3513,3608]},{"content":"If the root of the volume contains a DCIM, AVCHD, or PRIVATE<ph id=\"ph1\">\\\\</ph>ACHD folder, or if a user has enabled <bpt id=\"p1\">**</bpt>Choose what to do with each type of media<ept id=\"p1\">**</ept> in the AutoPlay Control Panel and pictures are found in the root of the volume, then AutoPlay raises the <bpt id=\"p2\">**</bpt>ShowPicturesOnArrival<ept id=\"p2\">**</ept> event.","pos":[3609,3892]},{"content":"In the <bpt id=\"p1\">**</bpt>Launch Actions<ept id=\"p1\">**</ept> section, enter the values from Table 1 below for the first launch action.","pos":[3893,3992]},{"content":"In the <bpt id=\"p1\">**</bpt>Launch Actions<ept id=\"p1\">**</ept> section for the <bpt id=\"p2\">**</bpt>AutoPlay Content<ept id=\"p2\">**</ept> item, click <bpt id=\"p3\">**</bpt>Add New<ept id=\"p3\">**</ept> to add a second launch action.","pos":[3997,4114]},{"content":"Enter the values in Table 2 below for the second launch action.","pos":[4115,4178]},{"content":"In the <bpt id=\"p1\">**</bpt>Available Declarations<ept id=\"p1\">**</ept> drop-down list, select <bpt id=\"p2\">**</bpt>File Type Associations<ept id=\"p2\">**</ept> and click <bpt id=\"p3\">**</bpt>Add<ept id=\"p3\">**</ept>.","pos":[4183,4285]},{"content":"In the Properties of the new <bpt id=\"p1\">**</bpt>File Type Associations<ept id=\"p1\">**</ept> declaration, set the <bpt id=\"p2\">**</bpt>Display Name<ept id=\"p2\">**</ept> field to <bpt id=\"p3\">**</bpt>AutoPlay Copy or Show Images<ept id=\"p3\">**</ept> and the <bpt id=\"p4\">**</bpt>Name<ept id=\"p4\">**</ept> field to <bpt id=\"p5\">**</bpt>image<ph id=\"ph1\">\\_</ph>association1<ept id=\"p5\">**</ept>.","pos":[4286,4472]},{"content":"In the <bpt id=\"p1\">**</bpt>Supported File Types<ept id=\"p1\">**</ept> section, click <bpt id=\"p2\">**</bpt>Add New<ept id=\"p2\">**</ept>.","pos":[4473,4532]},{"content":"Set the <bpt id=\"p1\">**</bpt>File Type<ept id=\"p1\">**</ept> field to <bpt id=\"p2\">**</bpt>.jpg<ept id=\"p2\">**</ept>.","pos":[4533,4573]},{"content":"In the <bpt id=\"p1\">**</bpt>Supported File Types<ept id=\"p1\">**</ept> section, set the <bpt id=\"p2\">**</bpt>File Type<ept id=\"p2\">**</ept> field of the new file association to <bpt id=\"p3\">**</bpt>.png<ept id=\"p3\">**</ept>.","pos":[4574,4683]},{"content":"For content events, AutoPlay filters out any file types that are not explicitly associated with your app.","pos":[4684,4789]},{"content":"Save and close the manifest file.","pos":[4794,4827]},{"content":"Table 1","pos":[4832,4839]},{"content":"Setting","pos":[4845,4852]},{"content":"Value","pos":[4867,4872]},{"content":"Verb","pos":[4941,4945]},{"content":"show","pos":[4963,4967]},{"content":"Action Display Name","pos":[4989,5008]},{"content":"Show Pictures","pos":[5011,5024]},{"content":"Content Event","pos":[5037,5050]},{"content":"ShowPicturesOnArrival","pos":[5059,5080]},{"content":"The <bpt id=\"p1\">**</bpt>Action Display Name<ept id=\"p1\">**</ept> setting identifies the string that AutoPlay displays for your app.","pos":[5084,5178]},{"content":"The <bpt id=\"p1\">**</bpt>Verb<ept id=\"p1\">**</ept> setting identifies a value that is passed to your app for the selected option.","pos":[5179,5270]},{"content":"You can specify multiple launch actions for an AutoPlay event and use the <bpt id=\"p1\">**</bpt>Verb<ept id=\"p1\">**</ept> setting to determine which option a user has selected for your app.","pos":[5271,5421]},{"content":"You can tell which option the user selected by checking the <bpt id=\"p1\">**</bpt>verb<ept id=\"p1\">**</ept> property of the startup event arguments passed to your app.","pos":[5422,5550]},{"content":"You can use any value for the <bpt id=\"p1\">**</bpt>Verb<ept id=\"p1\">**</ept> setting except, <bpt id=\"p2\">**</bpt>open<ept id=\"p2\">**</ept>, which is reserved.","pos":[5551,5634]},{"content":"Table 2","pos":[5638,5645]},{"content":"Setting","pos":[5653,5660]},{"content":"Value","pos":[5675,5680]},{"content":"Verb","pos":[5759,5763]},{"content":"copy","pos":[5781,5785]},{"content":"Action Display Name","pos":[5812,5831]},{"content":"Copy Pictures Into Library","pos":[5834,5860]},{"content":"Content Event","pos":[5865,5878]},{"content":"ShowPicturesOnArrival","pos":[5887,5908]},{"content":"Step 2: Add XAML UI","pos":[5921,5940]},{"content":"Open the MainPage.xaml file and add the following XAML to the default <ph id=\"ph1\">&amp;lt;</ph>Grid<ph id=\"ph2\">&amp;gt;</ph> section.","pos":[5942,6033]},{"content":"Step 3: Add initialization code","pos":[6392,6423]},{"content":"The code in this step checks the verb value in the <bpt id=\"p1\">**</bpt>Verb<ept id=\"p1\">**</ept> property, which is one of the startup arguments passed to the app during the <bpt id=\"p2\">**</bpt>OnFileActivated<ept id=\"p2\">**</ept> event.","pos":[6425,6588]},{"content":"The code then calls a method related to the option that the user selected.","pos":[6589,6663]},{"content":"For the camera memory event, AutoPlay passes the root folder of the camera storage to the app.","pos":[6664,6758]},{"content":"You can retrieve this folder from the first element of the <bpt id=\"p1\">**</bpt>Files<ept id=\"p1\">**</ept> property.","pos":[6759,6837]},{"pos":[6839,6913],"content":"Open the App.xaml.cs file and add the following code to the <bpt id=\"p1\">**</bpt>App<ept id=\"p1\">**</ept> class."},{"pos":[7617,7705],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  The <ph id=\"ph1\">`DisplayImages`</ph> and <ph id=\"ph2\">`CopyImages`</ph> methods are added in the following steps."},{"content":"Step 4: Add code to display images","pos":[7711,7745]},{"pos":[7747,7825],"content":"In the MainPage.xaml.cs file add the following code to the <bpt id=\"p1\">**</bpt>MainPage<ept id=\"p1\">**</ept> class."},{"content":"Step 5: Add code to copy images","pos":[9665,9696]},{"pos":[9698,9776],"content":"In the MainPage.xaml.cs file add the following code to the <bpt id=\"p1\">**</bpt>MainPage<ept id=\"p1\">**</ept> class."},{"content":"Step 6: Build and run the app","pos":[11075,11104]},{"content":"Press F5 to build and deploy the app (in debug mode).","pos":[11110,11163]},{"pos":[11168,11807],"content":"To run your app, insert a camera memory card or another storage device from a camera into your PC. Then, select one of the content event options that you specified in your package.appxmanifest file from the AutoPlay list of options. This sample code only displays or copies pictures in the DCIM folder of a camera memory card. If your camera memory card stores pictures in an AVCHD or PRIVATE\\\\ACHD folder, you will need to update the code accordingly.\n**Note**  If you don't have a camera memory card, you can use a flash drive if it has a folder named **DCIM** in the root and if the DCIM folder has a subfolder that contains images.","leadings":["","    "],"nodes":[{"content":"To run your app, insert a camera memory card or another storage device from a camera into your PC.","pos":[0,98]},{"content":"Then, select one of the content event options that you specified in your package.appxmanifest file from the AutoPlay list of options.","pos":[99,232]},{"content":"This sample code only displays or copies pictures in the DCIM folder of a camera memory card.","pos":[233,326]},{"content":"If your camera memory card stores pictures in an AVCHD or PRIVATE<ph id=\"ph1\">\\\\</ph>ACHD folder, you will need to update the code accordingly.","pos":[327,452]},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  If you don't have a camera memory card, you can use a flash drive if it has a folder named <bpt id=\"p2\">**</bpt>DCIM<ept id=\"p2\">**</ept> in the root and if the DCIM folder has a subfolder that contains images.","pos":[453,635]}]},{"content":"Register for an AutoPlay device","pos":[11812,11843]},{"content":"You can register apps as options for <bpt id=\"p1\">**</bpt>AutoPlay<ept id=\"p1\">**</ept> device events.","pos":[11846,11910]},{"content":"<bpt id=\"p1\">**</bpt>AutoPlay<ept id=\"p1\">**</ept> device events are raised when a device is connected to a PC.","pos":[11911,11984]},{"content":"Here we show how to identify your app as an <bpt id=\"p1\">**</bpt>AutoPlay<ept id=\"p1\">**</ept> option when a camera is connected to a PC.","pos":[11986,12085]},{"content":"The app registers as a handler for the <bpt id=\"p1\">**</bpt>WPD<ph id=\"ph1\">\\\\</ph>ImageSourceAutoPlay<ept id=\"p1\">**</ept> event.","pos":[12086,12160]},{"content":"This is a common event that the Windows Portable Device (WPD) system raises when cameras and other imaging devices notify it that they are an ImageSource using MTP.","pos":[12161,12325]},{"content":"For more info, see <bpt id=\"p1\">[</bpt>Windows Portable Devices<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/hardware/ff597729)</ept>.","pos":[12326,12434]},{"content":"<bpt id=\"p1\">**</bpt>Important<ept id=\"p1\">**</ept>  The <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>Windows.Devices.Portable.StorageDevice<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/br225654)</ept> APIs are part of the <bpt id=\"p4\">[</bpt>desktop device family<ept id=\"p4\">](https://msdn.microsoft.com/library/windows/apps/dn894631)</ept>.","pos":[12436,12661]},{"content":"Apps can use these APIs only on Windows 10 devices in the desktop device family, such as PCs.","pos":[12662,12755]},{"content":"Step 1: Create a new project and add AutoPlay declarations","pos":[12764,12822]},{"content":"Open Visual Studio and select <bpt id=\"p1\">**</bpt>New Project<ept id=\"p1\">**</ept> from the <bpt id=\"p2\">**</bpt>File<ept id=\"p2\">**</ept> menu.","pos":[12828,12897]},{"content":"In the <bpt id=\"p1\">**</bpt>Visual C#<ept id=\"p1\">**</ept> section, under <bpt id=\"p2\">**</bpt>Windows<ept id=\"p2\">**</ept>, select <bpt id=\"p3\">**</bpt>Blank App (Universal Windows)<ept id=\"p3\">**</ept>.","pos":[12898,12988]},{"content":"Name the app <bpt id=\"p1\">**</bpt>AutoPlayDevice<ph id=\"ph1\">\\_</ph>Camera<ept id=\"p1\">**</ept> and click <bpt id=\"p2\">**</bpt>OK.<ept id=\"p2\">**</ept>","pos":[12989,13046]},{"content":"Open the Package.appxmanifest file and select the <bpt id=\"p1\">**</bpt>Capabilities<ept id=\"p1\">**</ept> tab.","pos":[13051,13122]},{"content":"Select the <bpt id=\"p1\">**</bpt>Removable Storage<ept id=\"p1\">**</ept> capability.","pos":[13123,13167]},{"content":"This gives the app access to the data on the camera as a removable storage volume device.","pos":[13168,13257]},{"content":"In the manifest file, select the <bpt id=\"p1\">**</bpt>Declarations<ept id=\"p1\">**</ept> tab.","pos":[13262,13316]},{"content":"In the <bpt id=\"p1\">**</bpt>Available Declarations<ept id=\"p1\">**</ept> drop-down list, select <bpt id=\"p2\">**</bpt>AutoPlay Device<ept id=\"p2\">**</ept> and click <bpt id=\"p3\">**</bpt>Add<ept id=\"p3\">**</ept>.","pos":[13317,13412]},{"content":"Select the new <bpt id=\"p1\">**</bpt>AutoPlay Device<ept id=\"p1\">**</ept> item that was added to the <bpt id=\"p2\">**</bpt>Supported Declarations<ept id=\"p2\">**</ept> list.","pos":[13413,13507]},{"content":"An <bpt id=\"p1\">**</bpt>AutoPlay Device<ept id=\"p1\">**</ept> declaration identifies your app as an option when AutoPlay raises a device event for known events.","pos":[13512,13633]},{"content":"In the <bpt id=\"p1\">**</bpt>Launch Actions<ept id=\"p1\">**</ept> section, enter the values in the table below for the first launch action.","pos":[13634,13733]},{"content":"In the <bpt id=\"p1\">**</bpt>Available Declarations<ept id=\"p1\">**</ept> drop-down list, select <bpt id=\"p2\">**</bpt>File Type Associations<ept id=\"p2\">**</ept> and click <bpt id=\"p3\">**</bpt>Add<ept id=\"p3\">**</ept>.","pos":[13738,13840]},{"content":"In the Properties of the new <bpt id=\"p1\">**</bpt>File Type Associations<ept id=\"p1\">**</ept> declaration, set the <bpt id=\"p2\">**</bpt>Display Name<ept id=\"p2\">**</ept> field to <bpt id=\"p3\">**</bpt>Show Images from Camera<ept id=\"p3\">**</ept> and the <bpt id=\"p4\">**</bpt>Name<ept id=\"p4\">**</ept> field to <bpt id=\"p5\">**</bpt>camera<ph id=\"ph1\">\\_</ph>association1<ept id=\"p5\">**</ept>.","pos":[13841,14023]},{"content":"In the <bpt id=\"p1\">**</bpt>Supported File Types<ept id=\"p1\">**</ept> section, click <bpt id=\"p2\">**</bpt>Add New<ept id=\"p2\">**</ept> (if needed).","pos":[14024,14095]},{"content":"Set the <bpt id=\"p1\">**</bpt>File Type<ept id=\"p1\">**</ept> field to <bpt id=\"p2\">**</bpt>.jpg<ept id=\"p2\">**</ept>.","pos":[14096,14136]},{"content":"In the <bpt id=\"p1\">**</bpt>Supported File Types<ept id=\"p1\">**</ept> section, click <bpt id=\"p2\">**</bpt>Add New<ept id=\"p2\">**</ept> again.","pos":[14137,14202]},{"content":"Set the <bpt id=\"p1\">**</bpt>File Type<ept id=\"p1\">**</ept> field of the new file association to <bpt id=\"p2\">**</bpt>.png<ept id=\"p2\">**</ept>.","pos":[14203,14271]},{"content":"For content events, AutoPlay filters out any file types that are not explicitly associated with your app.","pos":[14272,14377]},{"content":"Save and close the manifest file.","pos":[14382,14415]},{"content":"Setting","pos":[14419,14426]},{"content":"Value","pos":[14441,14446]},{"content":"Verb","pos":[14505,14509]},{"content":"show","pos":[14527,14531]},{"content":"Action Display Name","pos":[14548,14567]},{"content":"Show Pictures","pos":[14570,14583]},{"content":"Content Event","pos":[14591,14604]},{"content":"WPD<ph id=\"ph1\">\\\\</ph>ImageSource","pos":[14613,14629]},{"content":"The <bpt id=\"p1\">**</bpt>Action Display Name<ept id=\"p1\">**</ept> setting identifies the string that AutoPlay displays for your app.","pos":[14633,14727]},{"content":"The <bpt id=\"p1\">**</bpt>Verb<ept id=\"p1\">**</ept> setting identifies a value that is passed to your app for the selected option.","pos":[14728,14819]},{"content":"You can specify multiple launch actions for an AutoPlay event and use the <bpt id=\"p1\">**</bpt>Verb<ept id=\"p1\">**</ept> setting to determine which option a user has selected for your app.","pos":[14820,14970]},{"content":"You can tell which option the user selected by checking the <bpt id=\"p1\">**</bpt>verb<ept id=\"p1\">**</ept> property of the startup event arguments passed to your app.","pos":[14971,15099]},{"content":"You can use any value for the <bpt id=\"p1\">**</bpt>Verb<ept id=\"p1\">**</ept> setting except, <bpt id=\"p2\">**</bpt>open<ept id=\"p2\">**</ept>, which is reserved.","pos":[15100,15183]},{"content":"For an example of using multiple verbs in a single app, see <bpt id=\"p1\">[</bpt>Register for AutoPlay content<ept id=\"p1\">](#autoplaycontent)</ept>.","pos":[15184,15294]},{"content":"Step 2: Add assembly reference for the desktop extensions","pos":[15300,15357]},{"content":"The APIs required to access storage on a Windows Portable Device, <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Windows.Devices.Portable.StorageDevice<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br225654)</ept>, are part of the desktop <bpt id=\"p3\">[</bpt>desktop device family<ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn894631)</ept>.","pos":[15359,15635]},{"content":"This means a special assembly is required to use the APIs and those calls will only work on a device in the desktop device family (such as a PC).","pos":[15636,15781]},{"pos":[15787,15873],"content":"In <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept>, right click on <bpt id=\"p2\">**</bpt>References<ept id=\"p2\">**</ept> and then <bpt id=\"p3\">**</bpt>Add Reference...<ept id=\"p3\">**</ept>."},{"pos":[15878,15932],"content":"Expand <bpt id=\"p1\">**</bpt>Universal Windows<ept id=\"p1\">**</ept> and click <bpt id=\"p2\">**</bpt>Extensions<ept id=\"p2\">**</ept>."},{"pos":[15937,16009],"content":"Then select <bpt id=\"p1\">**</bpt>Windows Desktop Extensions for the UWP<ept id=\"p1\">**</ept> and click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>."},{"content":"Step 3: Add XAML UI","pos":[16015,16034]},{"content":"Open the MainPage.xaml file and add the following XAML to the default <ph id=\"ph1\">&amp;lt;</ph>Grid<ph id=\"ph2\">&amp;gt;</ph> section.","pos":[16036,16127]},{"content":"Step 4: Add activation code","pos":[17184,17211]},{"content":"The code in this step references the camera as a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>StorageDevice<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br225654)</ept> by passing the device information Id of the camera to the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>FromId<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br225655)</ept> method.","pos":[17213,17476]},{"content":"The device information Id of the camera is obtained by first casting the event arguments as <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>DeviceActivatedEventArgs<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br224710)</ept>, and then getting the value from the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>DeviceInformationId<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br224711)</ept> property.","pos":[17477,17788]},{"pos":[17790,17864],"content":"Open the App.xaml.cs file and add the following code to the <bpt id=\"p1\">**</bpt>App<ept id=\"p1\">**</ept> class."},{"pos":[19233,19298],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  The <ph id=\"ph1\">`ShowImages`</ph> method is added in the following step."},{"content":"Step 5: Add code to display device information","pos":[19304,19350]},{"content":"You can obtain information about the camera from the properties of the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>StorageDevice<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br225654)</ept> class.","pos":[19352,19507]},{"content":"The code in this step displays the device name and other info to the user when the app runs.","pos":[19508,19600]},{"content":"The code then calls the GetImageList and GetThumbnail methods, which you will add in the next step, to display thumbnails of the images stored on the camera","pos":[19601,19757]},{"pos":[19759,19838],"content":"In the MainPage.xaml.cs file, add the following code to the <bpt id=\"p1\">**</bpt>MainPage<ept id=\"p1\">**</ept> class."},{"pos":[20513,20601],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  The <ph id=\"ph1\">`GetImageList`</ph> and <ph id=\"ph2\">`GetThumbnail`</ph> methods are added in the following step."},{"content":"Step 6: Add code to display images","pos":[20610,20644]},{"content":"The code in this step displays thumbnails of the images stored on the camera.","pos":[20646,20723]},{"content":"The code makes asynchronous calls to the camera to get the thumbnail image.","pos":[20724,20799]},{"content":"However, the next asynchronous call doesn't occur until the previous asynchronous call completes.","pos":[20800,20897]},{"content":"This ensures that only one request is made to the camera at a time.","pos":[20898,20965]},{"pos":[20967,21046],"content":"In the MainPage.xaml.cs file, add the following code to the <bpt id=\"p1\">**</bpt>MainPage<ept id=\"p1\">**</ept> class."},{"content":"Step 7: Build and run the app","pos":[22264,22293]},{"content":"Press F5 to build and deploy the app (in debug mode).","pos":[22299,22352]},{"pos":[22357,22554],"content":"To run your app, connect a camera to your machine. Then select the app from the AutoPlay list of options.\n**Note**  Not all cameras advertise for the **WPD\\\\ImageSource** AutoPlay device event.","leadings":["","    "],"nodes":[{"content":"To run your app, connect a camera to your machine.","pos":[0,50]},{"content":"Then select the app from the AutoPlay list of options.","pos":[51,105]},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  Not all cameras advertise for the <bpt id=\"p2\">**</bpt>WPD<ph id=\"ph1\">\\\\</ph>ImageSource<ept id=\"p2\">**</ept> AutoPlay device event.","pos":[106,193]}]},{"content":"Configure removable storage","pos":[22566,22593]},{"content":"You can identify a volume device such as a memory card or thumb drive as an <bpt id=\"p1\">**</bpt>AutoPlay<ept id=\"p1\">**</ept> device when the volume device is connected to a PC.","pos":[22596,22736]},{"content":"This is especially useful when you want to associate a specific app for <bpt id=\"p1\">**</bpt>AutoPlay<ept id=\"p1\">**</ept> to present to the user for your volume device.","pos":[22737,22868]},{"pos":[22870,22944],"content":"Here we show how to identify your volume device as an <bpt id=\"p1\">**</bpt>AutoPlay<ept id=\"p1\">**</ept> device."},{"content":"To identify your volume device as an <bpt id=\"p1\">**</bpt>AutoPlay<ept id=\"p1\">**</ept> device, add an autorun.inf file to the root drive of your device.","pos":[22946,23061]},{"content":"In the autorun.inf file, add a <bpt id=\"p1\">**</bpt>CustomEvent<ept id=\"p1\">**</ept> key to the <bpt id=\"p2\">**</bpt>AutoRun<ept id=\"p2\">**</ept> section.","pos":[23062,23140]},{"content":"When your volume device connects to a PC, <bpt id=\"p1\">**</bpt>AutoPlay<ept id=\"p1\">**</ept> will find the autorun.inf file and treat your volume as a device.","pos":[23141,23261]},{"content":"<bpt id=\"p1\">**</bpt>AutoPlay<ept id=\"p1\">**</ept> will create an <bpt id=\"p2\">**</bpt>AutoPlay<ept id=\"p2\">**</ept> event by using the name that you supplied for the <bpt id=\"p3\">**</bpt>CustomEvent<ept id=\"p3\">**</ept> key.","pos":[23262,23373]},{"content":"You can then create an app and register the app as a handler for that <bpt id=\"p1\">**</bpt>AutoPlay<ept id=\"p1\">**</ept> event.","pos":[23374,23463]},{"content":"When the device is connected to the PC, <bpt id=\"p1\">**</bpt>AutoPlay<ept id=\"p1\">**</ept> will show your app as a handler for your volume device.","pos":[23464,23572]},{"content":"For more info on autorun.inf files, see <bpt id=\"p1\">[</bpt>autorun.inf entries<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/desktop/cc144200)</ept>.","pos":[23573,23696]},{"content":"Step 1: Create an autorun.inf file","pos":[23702,23736]},{"content":"In the root drive of your volume device, add a file named autorun.inf.","pos":[23738,23808]},{"content":"Open the autorun.inf file and add the following text.","pos":[23809,23862]},{"content":"Step 2: Create a new project and add AutoPlay declarations","pos":[23936,23994]},{"content":"Open Visual Studio and select <bpt id=\"p1\">**</bpt>New Project<ept id=\"p1\">**</ept> from the <bpt id=\"p2\">**</bpt>File<ept id=\"p2\">**</ept> menu.","pos":[24000,24069]},{"content":"In the <bpt id=\"p1\">**</bpt>Visual C#<ept id=\"p1\">**</ept> section, under <bpt id=\"p2\">**</bpt>Windows<ept id=\"p2\">**</ept>, select <bpt id=\"p3\">**</bpt>Blank App (Universal Windows)<ept id=\"p3\">**</ept>.","pos":[24070,24160]},{"content":"Name the application <bpt id=\"p1\">**</bpt>AutoPlayCustomEvent<ept id=\"p1\">**</ept> and click <bpt id=\"p2\">**</bpt>OK.<ept id=\"p2\">**</ept>","pos":[24161,24223]},{"content":"Open the Package.appxmanifest file and select the <bpt id=\"p1\">**</bpt>Capabilities<ept id=\"p1\">**</ept> tab.","pos":[24228,24299]},{"content":"Select the <bpt id=\"p1\">**</bpt>Removable Storage<ept id=\"p1\">**</ept> capability.","pos":[24300,24344]},{"content":"This gives the app access to the files and folders on removable storage devices.","pos":[24345,24425]},{"content":"In the manifest file, select the <bpt id=\"p1\">**</bpt>Declarations<ept id=\"p1\">**</ept> tab.","pos":[24430,24484]},{"content":"In the <bpt id=\"p1\">**</bpt>Available Declarations<ept id=\"p1\">**</ept> drop-down list, select <bpt id=\"p2\">**</bpt>AutoPlay Content<ept id=\"p2\">**</ept> and click <bpt id=\"p3\">**</bpt>Add<ept id=\"p3\">**</ept>.","pos":[24485,24581]},{"content":"Select the new <bpt id=\"p1\">**</bpt>AutoPlay Content<ept id=\"p1\">**</ept> item that was added to the <bpt id=\"p2\">**</bpt>Supported Declarations<ept id=\"p2\">**</ept> list.","pos":[24582,24677]},{"pos":[24683,24801],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  Alternatively, you can also choose to add an <bpt id=\"p2\">**</bpt>AutoPlay Device<ept id=\"p2\">**</ept> declaration for your custom AutoPlay event."},{"pos":[24811,24958],"content":"In the <bpt id=\"p1\">**</bpt>Launch Actions<ept id=\"p1\">**</ept> section for your <bpt id=\"p2\">**</bpt>AutoPlay Content<ept id=\"p2\">**</ept> event declaration, enter the values in the table below for the first launch action."},{"content":"In the <bpt id=\"p1\">**</bpt>Available Declarations<ept id=\"p1\">**</ept> drop-down list, select <bpt id=\"p2\">**</bpt>File Type Associations<ept id=\"p2\">**</ept> and click <bpt id=\"p3\">**</bpt>Add<ept id=\"p3\">**</ept>.","pos":[24963,25065]},{"content":"In the Properties of the new <bpt id=\"p1\">**</bpt>File Type Associations<ept id=\"p1\">**</ept> declaration, set the <bpt id=\"p2\">**</bpt>Display Name<ept id=\"p2\">**</ept> field to <bpt id=\"p3\">**</bpt>Show .ms Files<ept id=\"p3\">**</ept> and the <bpt id=\"p4\">**</bpt>Name<ept id=\"p4\">**</ept> field to <bpt id=\"p5\">**</bpt>ms<ph id=\"ph1\">\\_</ph>association<ept id=\"p5\">**</ept>.","pos":[25066,25234]},{"content":"In the <bpt id=\"p1\">**</bpt>Supported File Types<ept id=\"p1\">**</ept> section, click <bpt id=\"p2\">**</bpt>Add New<ept id=\"p2\">**</ept>.","pos":[25235,25294]},{"content":"Set the <bpt id=\"p1\">**</bpt>File Type<ept id=\"p1\">**</ept> field to <bpt id=\"p2\">**</bpt>.ms<ept id=\"p2\">**</ept>.","pos":[25295,25334]},{"content":"For content events, AutoPlay filters out any file types that aren't explicitly associated with your app.","pos":[25335,25439]},{"content":"Save and close the manifest file.","pos":[25444,25477]},{"content":"Setting","pos":[25481,25488]},{"content":"Value","pos":[25503,25508]},{"content":"Verb","pos":[25593,25597]},{"content":"show","pos":[25615,25619]},{"content":"Action Display Name","pos":[25649,25668]},{"content":"Show Files","pos":[25671,25681]},{"content":"Content Event","pos":[25705,25718]},{"content":"AutoPlayCustomEventQuickstart","pos":[25727,25756]},{"content":"The <bpt id=\"p1\">**</bpt>Content Event<ept id=\"p1\">**</ept> value is the text that you supplied for the <bpt id=\"p2\">**</bpt>CustomEvent<ept id=\"p2\">**</ept> key in your autorun.inf file.","pos":[25760,25871]},{"content":"The <bpt id=\"p1\">**</bpt>Action Display Name<ept id=\"p1\">**</ept> setting identifies the string that AutoPlay displays for your app.","pos":[25872,25966]},{"content":"The <bpt id=\"p1\">**</bpt>Verb<ept id=\"p1\">**</ept> setting identifies a value that is passed to your app for the selected option.","pos":[25967,26058]},{"content":"You can specify multiple launch actions for an AutoPlay event and use the <bpt id=\"p1\">**</bpt>Verb<ept id=\"p1\">**</ept> setting to determine which option a user has selected for your app.","pos":[26059,26209]},{"content":"You can tell which option the user selected by checking the <bpt id=\"p1\">**</bpt>verb<ept id=\"p1\">**</ept> property of the startup event arguments passed to your app.","pos":[26210,26338]},{"content":"You can use any value for the <bpt id=\"p1\">**</bpt>Verb<ept id=\"p1\">**</ept> setting except, <bpt id=\"p2\">**</bpt>open<ept id=\"p2\">**</ept>, which is reserved.","pos":[26339,26422]},{"content":"Step 3: Add XAML UI","pos":[26428,26447]},{"content":"Open the MainPage.xaml file and add the following XAML to the default <ph id=\"ph1\">&amp;lt;</ph>Grid<ph id=\"ph2\">&amp;gt;</ph> section.","pos":[26449,26540]},{"content":"Step 4: Add activation code","pos":[26760,26787]},{"content":"The code in this step calls a method to display the folders in the root drive of your volume device.","pos":[26789,26889]},{"content":"For the AutoPlay content events, AutoPlay passes the root folder of the storage device in the startup arguments passed to the application during the <bpt id=\"p1\">**</bpt>OnFileActivated<ept id=\"p1\">**</ept> event.","pos":[26890,27065]},{"content":"You can retrieve this folder from the first element of the <bpt id=\"p1\">**</bpt>Files<ept id=\"p1\">**</ept> property.","pos":[27066,27144]},{"pos":[27146,27220],"content":"Open the App.xaml.cs file and add the following code to the <bpt id=\"p1\">**</bpt>App<ept id=\"p1\">**</ept> class."},{"pos":[27574,27641],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  The <ph id=\"ph1\">`DisplayFiles`</ph> method is added in the following step."},{"content":"Step 5: Add code to display folders","pos":[27650,27685]},{"pos":[27687,27765],"content":"In the MainPage.xaml.cs file add the following code to the <bpt id=\"p1\">**</bpt>MainPage<ept id=\"p1\">**</ept> class."},{"content":"Step 6: Build and run the qpp","pos":[28394,28423]},{"content":"Press F5 to build and deploy the app (in debug mode).","pos":[28429,28482]},{"content":"To run your app, insert a memory card or another storage device into your PC.","pos":[28487,28564]},{"content":"Then select your app from the list of AutoPlay handler options.","pos":[28565,28628]},{"content":"AutoPlay event reference","pos":[28633,28657]},{"content":"The <bpt id=\"p1\">**</bpt>AutoPlay<ept id=\"p1\">**</ept> system allows apps to register for a variety of device and volume (disk) arrival events.","pos":[28660,28765]},{"content":"To register for <bpt id=\"p1\">**</bpt>AutoPlay<ept id=\"p1\">**</ept> content events, you must enable the <bpt id=\"p2\">**</bpt>Removable Storage<ept id=\"p2\">**</ept> capability in your package manifest.","pos":[28766,28889]},{"content":"This table shows the events that you can register for and when they are raised.","pos":[28890,28969]},{"content":"Scenario","pos":[28973,28981]},{"content":"Event","pos":[29042,29047]},{"content":"Description","pos":[29052,29063]},{"content":"Using photos on a Camera","pos":[29167,29191]},{"content":"WPD\\ImageSource","pos":[29238,29253]},{"content":"Raised for cameras that are identified as Windows Portable Devices and offer the ImageSource capability.","pos":[29273,29377]},{"content":"Using music on an audio player","pos":[29639,29669]},{"content":"WPD\\AudioSource","pos":[29710,29725]},{"content":"Raised for media players that are identified as Windows Portable Devices and offer the AudioSource capability.","pos":[29745,29855]},{"content":"Using videos on a video camera","pos":[30111,30141]},{"content":"WPD\\VideoSource","pos":[30182,30197]},{"content":"Raised for video cameras that are identified as Windows Portable Devices and offer the VideoSource capability.","pos":[30217,30327]},{"content":"Access a connected flash drive or external hard drive","pos":[30583,30636]},{"content":"StorageOnArrival","pos":[30654,30670]},{"content":"Raised when a drive or volume is connected to the PC.","pos":[30689,30742]},{"content":"If the drive or volume contains a DCIM, AVCHD, or PRIVATE\\ACHD folder in the root of the disk, the <bpt id=\"p1\">**</bpt>ShowPicturesOnArrival<ept id=\"p1\">**</ept> event is raised instead.","pos":[30745,30894]},{"content":"Using photos from mass storage (legacy)","pos":[31055,31094]},{"content":"ShowPicturesOnArrival","pos":[31126,31147]},{"content":"Raised when a drive or volume contains a DCIM, AVCHD, or PRIVATE\\ACHD folder in the root of the disk.","pos":[31161,31262]},{"content":"IIf a user  has enabled <bpt id=\"p1\">**</bpt>Choose what to do with each type of media<ept id=\"p1\">**</ept> in the AutoPlay Control Panel, AutoPlay will examine a volume connected to the PC to determine the type of content on the disk.","pos":[31263,31460]},{"content":"When pictures are found, <bpt id=\"p1\">**</bpt>ShowPicturesOnArrival<ept id=\"p1\">**</ept> is raised.","pos":[31461,31522]},{"content":"Receiving photos with Proximity Sharing (tap and send)","pos":[31527,31581]},{"content":"ShowPicturesOnArrival","pos":[31598,31619]},{"content":"When users send content with using proximity (tap and send), AutoPlay will examine the shared files to determine the type of content.","pos":[31633,31766]},{"content":"If pictures are found, <bpt id=\"p1\">**</bpt>ShowPicturesOnArrival<ept id=\"p1\">**</ept> is raised.","pos":[31767,31826]},{"content":"Using music from mass storage (legacy)","pos":[31999,32037]},{"content":"PlayMusicFilesOnArrival","pos":[32070,32093]},{"content":"If a user has enabled <bpt id=\"p1\">**</bpt>Choose what to do with each type of media<ept id=\"p1\">**</ept> in the AutoPlay Control Panel, AutoPlay will examine a volume connected to the PC to determine the type of content on the disk.","pos":[32105,32300]},{"content":"When music files are found, <bpt id=\"p1\">**</bpt>PlayMusicFilesOnArrival<ept id=\"p1\">**</ept> is raised.","pos":[32302,32368]},{"content":"Receiving music with Proximity Sharing (tap and send)","pos":[32471,32524]},{"content":"PlayMusicFilesOnArrival","pos":[32542,32565]},{"content":"When users send content with using proximity (tap and send), AutoPlay will examine the shared files to determine the type of content.","pos":[32577,32710]},{"content":"If music files are found, <bpt id=\"p1\">**</bpt>PlayMusicFilesOnArrival<ept id=\"p1\">**</ept> is raised.","pos":[32711,32775]},{"content":"Using videos from mass storage (legacy)","pos":[32943,32982]},{"content":"PlayVideoFilesOnArrival","pos":[33014,33037]},{"content":"If a user has enabled <bpt id=\"p1\">**</bpt>Choose what to do with each type of media<ept id=\"p1\">**</ept> in the AutoPlay Control Panel,, AutoPlay will examine a volume connected to the PC to determine the type of content on the disk.","pos":[33049,33245]},{"content":"When video files are found, <bpt id=\"p1\">**</bpt>PlayVideoFilesOnArrival<ept id=\"p1\">**</ept> is raised.","pos":[33246,33312]},{"content":"Receiving videos with Proximity Sharing (tap and send)","pos":[33415,33469]},{"content":"PlayVideoFilesOnArrival","pos":[33486,33509]},{"content":"When users send content with using proximity (tap and send), AutoPlay will examine the shared files to determine the type of content.","pos":[33521,33654]},{"content":"If video files are found, <bpt id=\"p1\">**</bpt>PlayVideoFilesOnArrival<ept id=\"p1\">**</ept> is raised.","pos":[33655,33719]},{"content":"Handling mixed sets of files from a connected device","pos":[33887,33939]},{"content":"MixedContentOnArrival","pos":[33958,33979]},{"content":"If a user has enabled <bpt id=\"p1\">**</bpt>Choose what to do with each type of media<ept id=\"p1\">**</ept> in the AutoPlay Control Panel, AutoPlay will examine a volume connected to the PC to determine the type of content on the disk.","pos":[33993,34188]},{"content":"If no specific content type is found (for example, pictures), <bpt id=\"p1\">**</bpt>MixedContentOnArrival<ept id=\"p1\">**</ept> is raised.","pos":[34189,34287]},{"content":"Handling mixed sets of files with Proximity Sharing (tap and send)","pos":[34359,34425]},{"content":"MixedContentOnArrival","pos":[34430,34451]},{"content":"When users send content with using proximity (tap and send), AutoPlay will examine the shared files to determine the type of content.","pos":[34465,34598]},{"content":"If no specific content type is found (for example, pictures), <bpt id=\"p1\">**</bpt>MixedContentOnArrival<ept id=\"p1\">**</ept> is raised.","pos":[34599,34697]},{"content":"Handle video from optical media","pos":[34831,34862]},{"content":"PlayDVDMovieOnArrival","pos":[34902,34923]},{"content":"PlayBluRayOnArrival","pos":[35846,35865]},{"content":"PlayVideoCDMovieOnArrival","pos":[36790,36815]},{"content":"PlaySuperVideoCDMovieOnArrival","pos":[37734,37764]},{"content":"Handle music from optical media","pos":[38135,38166]},{"content":"PlayCDAudioOnArrival","pos":[38206,38226]},{"content":"PlayDVDAudioOnArrival","pos":[39150,39171]},{"content":"Play enhanced disks","pos":[39551,39570]},{"content":"PlayEnhancedCDOnArrival","pos":[39622,39645]},{"content":"PlayEnhancedDVDOnArrival","pos":[40566,40590]},{"content":"Handle writeable optical disks","pos":[40967,40997]},{"content":"HandleCDBurningOnArrival","pos":[41038,41062]},{"content":"HandleDVDBurningOnArrival","pos":[41982,42007]},{"content":"HandleBDBurningOnArrival","pos":[42926,42950]},{"content":"Handle any other device or volume connection","pos":[43327,43371]},{"content":"UnknownContentOnArrival","pos":[43398,43421]},{"content":"Raised for all events in case content is found that does not match any of the AutoPlay content events.","pos":[43433,43535]},{"content":"Use of this event is not recommended.","pos":[43536,43573]},{"content":"You should only register your application for the specific AutoPlay events that it can handle.","pos":[43574,43668]},{"content":"You can specify that AutoPlay raise a custom AutoPlay Content event using the <bpt id=\"p1\">**</bpt>CustomEvent<ept id=\"p1\">**</ept> entry in the autorun.inf file for a volume.","pos":[43798,43935]},{"content":"For more info, see <bpt id=\"p1\">[</bpt>Autorun.inf entries<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/desktop/cc144200)</ept>.","pos":[43936,44038]},{"content":"You can register your app as an AutoPlay Content or AutoPlay Device event handler by adding an extension to the package.appxmanifest file for your app.","pos":[44040,44191]},{"content":"If you are using Visual Studio, you can add an <bpt id=\"p1\">**</bpt>AutoPlay Content<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>AutoPlay Device<ept id=\"p2\">**</ept> declaration in the <bpt id=\"p3\">**</bpt>Declarations<ept id=\"p3\">**</ept> tab.","pos":[44192,44323]},{"content":"If you are editing the package.appxmanifest file for your app directly, add an <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Extension<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br211400)</ept> element to your package manifest that specifies either <bpt id=\"p3\">**</bpt>windows.autoPlayContent<ept id=\"p3\">**</ept> or <bpt id=\"p4\">**</bpt>windows.autoPlayDevice<ept id=\"p4\">**</ept> as the <bpt id=\"p5\">**</bpt>Category<ept id=\"p5\">**</ept>.","pos":[44324,44610]},{"content":"For example, the following entry in the package manifest adds an <bpt id=\"p1\">**</bpt>AutoPlay Content<ept id=\"p1\">**</ept> extension to register the app as a handler for the <bpt id=\"p2\">**</bpt>ShowPicturesOnArrival<ept id=\"p2\">**</ept> event.","pos":[44611,44780]}],"content":"---\nauthor: TylerMSFT\ntitle: Auto-launching with AutoPlay\ndescription: You can use AutoPlay to provide your app as an option when a user connects a device to their PC. This includes non-volume devices such as a camera or media player, or volume devices such as a USB thumb drive, SD card, or DVD.\nms.assetid: AD4439EA-00B0-4543-887F-2C1D47408EA7\n---\n\n# <span id=\"dev_launch_resume.auto-launching_with_autoplay\"></span>Auto-launching with AutoPlay\n\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\n\nYou can use **AutoPlay** to provide your app as an option when a user connects a device to their PC. This includes non-volume devices such as a camera or media player, or volume devices such as a USB thumb drive, SD card, or DVD. You can also use **AutoPlay** to offer your app as an option when users share files between two PCs by using proximity (tapping).\n\n> **Note**  If you are a device manufacturer and you want to associate your [Windows Store device app](http://go.microsoft.com/fwlink/p/?LinkID=301381) as an **AutoPlay** handler for your device, you can identify that app in the device metadata. For more info, see [AutoPlay for Windows Store device apps](http://go.microsoft.com/fwlink/p/?LinkId=306684).\n\n## Register for AutoPlay content\n\nYou can register apps as options for **AutoPlay** content events. **AutoPlay** content events are raised when a volume device such as a camera memory card, thumb drive, or DVD is inserted into the PC. Here we show how to identify your app as an **AutoPlay** option when a volume device from a camera is inserted.\n\nIn this tutorial, you created an app that displays image files or copies them to Pictures. You registered the app for the AutoPlay **ShowPicturesOnArrival** content event.\n\nAutoPlay also raises content events for content shared between PCs using proximity (tapping). You can use the steps and code in this section to handle files that are shared between PCs that use proximity. The following table lists the AutoPlay content events that are available for sharing content by using proximity.\n\n| Action         | AutoPlay content event  |\n|----------------|-------------------------|\n| Sharing music  | PlayMusicFilesOnArrival |\n| Sharing videos | PlayVideoFilesOnArrival |\n\n \nWhen files are shared by using proximity, the **Files** property of the **FileActivatedEventArgs** object contains a reference to a root folder that contains all of the shared files.\n\n### Step 1: Create a new project and add AutoPlay declarations\n\n1.  Open Microsoft Visual Studio and select **New Project** from the **File** menu. In the **Visual C#** section, under **Windows**, select **Blank App (Universal Windows)**. Name the app **AutoPlayDisplayOrCopyImages** and click **OK.**\n2.  Open the Package.appxmanifest file and select the **Capabilities** tab. Select the **Removable Storage** and **Pictures Library** capabilities. This gives the app access to removable storage devices for camera memory, and access to local pictures.\n3.  In the manifest file, select the **Declarations** tab. In the **Available Declarations** drop-down list, select **AutoPlay Content** and click **Add**. Select the new **AutoPlay Content** item that was added to the **Supported Declarations** list.\n4.  An **AutoPlay Content** declaration identifies your app as an option when AutoPlay raises a content event. The event is based on the content of a volume device such as a DVD or a thumb drive. AutoPlay examines the content of the volume device and determines which content event to raise. If the root of the volume contains a DCIM, AVCHD, or PRIVATE\\\\ACHD folder, or if a user has enabled **Choose what to do with each type of media** in the AutoPlay Control Panel and pictures are found in the root of the volume, then AutoPlay raises the **ShowPicturesOnArrival** event. In the **Launch Actions** section, enter the values from Table 1 below for the first launch action.\n5.  In the **Launch Actions** section for the **AutoPlay Content** item, click **Add New** to add a second launch action. Enter the values in Table 2 below for the second launch action.\n6.  In the **Available Declarations** drop-down list, select **File Type Associations** and click **Add**. In the Properties of the new **File Type Associations** declaration, set the **Display Name** field to **AutoPlay Copy or Show Images** and the **Name** field to **image\\_association1**. In the **Supported File Types** section, click **Add New**. Set the **File Type** field to **.jpg**. In the **Supported File Types** section, set the **File Type** field of the new file association to **.png**. For content events, AutoPlay filters out any file types that are not explicitly associated with your app.\n7.  Save and close the manifest file.\n\n\n**Table 1**\n\n| Setting             | Value                 |\n|---------------------|-----------------------|\n| Verb                | show                  |\n| Action Display Name | Show Pictures         |\n| Content Event       | ShowPicturesOnArrival |\n\nThe **Action Display Name** setting identifies the string that AutoPlay displays for your app. The **Verb** setting identifies a value that is passed to your app for the selected option. You can specify multiple launch actions for an AutoPlay event and use the **Verb** setting to determine which option a user has selected for your app. You can tell which option the user selected by checking the **verb** property of the startup event arguments passed to your app. You can use any value for the **Verb** setting except, **open**, which is reserved.\n\n**Table 2**  \n\n| Setting             | Value                      |\n|---------------------|----------------------------|\n| Verb                | copy                       |\n| Action Display Name | Copy Pictures Into Library |\n| Content Event       | ShowPicturesOnArrival      |\n\n### Step 2: Add XAML UI\n\nOpen the MainPage.xaml file and add the following XAML to the default &lt;Grid&gt; section.\n\n```xml\n<TextBlock FontSize=\"18\">File List</TextBlock>\n<TextBlock x:Name=\"FilesBlock\" HorizontalAlignment=\"Left\" TextWrapping=\"Wrap\"\n           VerticalAlignment=\"Top\" Margin=\"0,20,0,0\" Height=\"280\" Width=\"240\" />\n<Canvas x:Name=\"FilesCanvas\" HorizontalAlignment=\"Left\" VerticalAlignment=\"Top\"\n        Margin=\"260,20,0,0\" Height=\"280\" Width=\"100\"/>\n```\n\n### Step 3: Add initialization code\n\nThe code in this step checks the verb value in the **Verb** property, which is one of the startup arguments passed to the app during the **OnFileActivated** event. The code then calls a method related to the option that the user selected. For the camera memory event, AutoPlay passes the root folder of the camera storage to the app. You can retrieve this folder from the first element of the **Files** property.\n\nOpen the App.xaml.cs file and add the following code to the **App** class.\n\n```cs\nprotected override void OnFileActivated(FileActivatedEventArgs args)\n{\n    if (args.Verb == \"show\")\n    {\n        Frame rootFrame = (Frame)Window.Current.Content;\n        MainPage page = (MainPage)rootFrame.Content;\n\n        // Call DisplayImages with root folder from camera storage.\n        page.DisplayImages((Windows.Storage.StorageFolder)args.Files[0]);\n    }\n\n    if (args.Verb == \"copy\")\n    {\n        Frame rootFrame = (Frame)Window.Current.Content;\n        MainPage page = (MainPage)rootFrame.Content;\n\n        // Call CopyImages with root folder from camera storage.\n        page.CopyImages((Windows.Storage.StorageFolder)args.Files[0]);\n    }\n\n    base.OnFileActivated(args);\n}\n```\n\n> **Note**  The `DisplayImages` and `CopyImages` methods are added in the following steps.\n\n### Step 4: Add code to display images\n\nIn the MainPage.xaml.cs file add the following code to the **MainPage** class.\n\n```cs\nasync internal void DisplayImages(Windows.Storage.StorageFolder rootFolder)\n{\n    // Display images from first folder in root\\DCIM.\n    var dcimFolder = await rootFolder.GetFolderAsync(\"DCIM\");\n    var folderList = await dcimFolder.GetFoldersAsync();\n    var cameraFolder = folderList[0];\n    var fileList = await cameraFolder.GetFilesAsync();\n    for (int i = 0; i < fileList.Count; i++)\n    {\n        var file = (Windows.Storage.StorageFile)fileList[i];\n        WriteMessageText(file.Name + \"\\n\");\n        DisplayImage(file, i);\n    }\n}\n\nasync private void DisplayImage(Windows.Storage.IStorageItem file, int index)\n{\n    try\n    {\n        var sFile = (Windows.Storage.StorageFile)file;\n        Windows.Storage.Streams.IRandomAccessStream imageStream =\n            await sFile.OpenAsync(Windows.Storage.FileAccessMode.Read);\n        Windows.UI.Xaml.Media.Imaging.BitmapImage imageBitmap =\n            new Windows.UI.Xaml.Media.Imaging.BitmapImage();\n        imageBitmap.SetSource(imageStream);\n        var element = new Image();\n        element.Source = imageBitmap;\n        element.Height = 100;\n        Thickness margin = new Thickness();\n        margin.Top = index * 100;\n        element.Margin = margin;\n        FilesCanvas.Children.Add(element);\n    }\n    catch (Exception e)\n    {\n       WriteMessageText(e.Message + \"\\n\");\n    }\n}\n\n// Write a message to MessageBlock on the UI thread.\nprivate Windows.UI.Core.CoreDispatcher messageDispatcher = Window.Current.CoreWindow.Dispatcher;\n\nprivate async void WriteMessageText(string message, bool overwrite = false)\n{\n    await messageDispatcher.RunAsync(Windows.UI.Core.CoreDispatcherPriority.Normal,\n        () =>\n        {\n            if (overwrite)\n                FilesBlock.Text = message;\n            else\n                FilesBlock.Text += message;\n        });\n}\n```\n\n### Step 5: Add code to copy images\n\nIn the MainPage.xaml.cs file add the following code to the **MainPage** class.\n\n```cs\nasync internal void CopyImages(Windows.Storage.StorageFolder rootFolder)\n{\n    // Copy images from first folder in root\\DCIM.\n    var dcimFolder = await rootFolder.GetFolderAsync(\"DCIM\");\n    var folderList = await dcimFolder.GetFoldersAsync();\n    var cameraFolder = folderList[0];\n    var fileList = await cameraFolder.GetFilesAsync();\n\n    try\n    {\n        var folderName = \"Images \" + DateTime.Now.ToString(\"yyyy-MM-dd HHmmss\");\n        Windows.Storage.StorageFolder imageFolder = await\n            Windows.Storage.KnownFolders.PicturesLibrary.CreateFolderAsync(folderName);\n\n        foreach (Windows.Storage.IStorageItem file in fileList)\n        {\n            CopyImage(file, imageFolder);\n        }\n    }\n    catch (Exception e)\n    {\n        WriteMessageText(\"Failed to copy images.\\n\" + e.Message + \"\\n\");\n    }\n}\n\nasync internal void CopyImage(Windows.Storage.IStorageItem file,\n                              Windows.Storage.StorageFolder imageFolder)\n{\n    try\n    {\n        Windows.Storage.StorageFile sFile = (Windows.Storage.StorageFile)file;\n        await sFile.CopyAsync(imageFolder, sFile.Name);\n        WriteMessageText(sFile.Name + \" copied.\\n\");\n    }\n    catch (Exception e)\n    {\n        WriteMessageText(\"Failed to copy file.\\n\" + e.Message + \"\\n\");\n    }\n}\n```\n\n### Step 6: Build and run the app\n\n1.  Press F5 to build and deploy the app (in debug mode).\n2.  To run your app, insert a camera memory card or another storage device from a camera into your PC. Then, select one of the content event options that you specified in your package.appxmanifest file from the AutoPlay list of options. This sample code only displays or copies pictures in the DCIM folder of a camera memory card. If your camera memory card stores pictures in an AVCHD or PRIVATE\\\\ACHD folder, you will need to update the code accordingly.\n    **Note**  If you don't have a camera memory card, you can use a flash drive if it has a folder named **DCIM** in the root and if the DCIM folder has a subfolder that contains images.\n\n## Register for an AutoPlay device\n\n\nYou can register apps as options for **AutoPlay** device events. **AutoPlay** device events are raised when a device is connected to a PC.\n\nHere we show how to identify your app as an **AutoPlay** option when a camera is connected to a PC. The app registers as a handler for the **WPD\\\\ImageSourceAutoPlay** event. This is a common event that the Windows Portable Device (WPD) system raises when cameras and other imaging devices notify it that they are an ImageSource using MTP. For more info, see [Windows Portable Devices](https://msdn.microsoft.com/library/windows/hardware/ff597729).\n\n**Important**  The [**Windows.Devices.Portable.StorageDevice**](https://msdn.microsoft.com/library/windows/apps/br225654) APIs are part of the [desktop device family](https://msdn.microsoft.com/library/windows/apps/dn894631). Apps can use these APIs only on Windows 10 devices in the desktop device family, such as PCs.\n\n \n\n### Step 1: Create a new project and add AutoPlay declarations\n\n1.  Open Visual Studio and select **New Project** from the **File** menu. In the **Visual C#** section, under **Windows**, select **Blank App (Universal Windows)**. Name the app **AutoPlayDevice\\_Camera** and click **OK.**\n2.  Open the Package.appxmanifest file and select the **Capabilities** tab. Select the **Removable Storage** capability. This gives the app access to the data on the camera as a removable storage volume device.\n3.  In the manifest file, select the **Declarations** tab. In the **Available Declarations** drop-down list, select **AutoPlay Device** and click **Add**. Select the new **AutoPlay Device** item that was added to the **Supported Declarations** list.\n4.  An **AutoPlay Device** declaration identifies your app as an option when AutoPlay raises a device event for known events. In the **Launch Actions** section, enter the values in the table below for the first launch action.\n5.  In the **Available Declarations** drop-down list, select **File Type Associations** and click **Add**. In the Properties of the new **File Type Associations** declaration, set the **Display Name** field to **Show Images from Camera** and the **Name** field to **camera\\_association1**. In the **Supported File Types** section, click **Add New** (if needed). Set the **File Type** field to **.jpg**. In the **Supported File Types** section, click **Add New** again. Set the **File Type** field of the new file association to **.png**. For content events, AutoPlay filters out any file types that are not explicitly associated with your app.\n6.  Save and close the manifest file.\n\n| Setting             | Value            |\n|---------------------|------------------|\n| Verb                | show             |\n| Action Display Name | Show Pictures    |\n| Content Event       | WPD\\\\ImageSource |\n\nThe **Action Display Name** setting identifies the string that AutoPlay displays for your app. The **Verb** setting identifies a value that is passed to your app for the selected option. You can specify multiple launch actions for an AutoPlay event and use the **Verb** setting to determine which option a user has selected for your app. You can tell which option the user selected by checking the **verb** property of the startup event arguments passed to your app. You can use any value for the **Verb** setting except, **open**, which is reserved. For an example of using multiple verbs in a single app, see [Register for AutoPlay content](#autoplaycontent).\n\n### Step 2: Add assembly reference for the desktop extensions\n\nThe APIs required to access storage on a Windows Portable Device, [**Windows.Devices.Portable.StorageDevice**](https://msdn.microsoft.com/library/windows/apps/br225654), are part of the desktop [desktop device family](https://msdn.microsoft.com/library/windows/apps/dn894631). This means a special assembly is required to use the APIs and those calls will only work on a device in the desktop device family (such as a PC).\n\n1.  In **Solution Explorer**, right click on **References** and then **Add Reference...**.\n2.  Expand **Universal Windows** and click **Extensions**.\n3.  Then select **Windows Desktop Extensions for the UWP** and click **OK**.\n\n### Step 3: Add XAML UI\n\nOpen the MainPage.xaml file and add the following XAML to the default &lt;Grid&gt; section.\n\n```xml\n<StackPanel Orientation=\"Vertical\" Margin=\"10,0,-10,0\">\n    <TextBlock FontSize=\"24\">Device Information</TextBlock>\n    <StackPanel Orientation=\"Horizontal\">\n        <TextBlock x:Name=\"DeviceInfoTextBlock\" FontSize=\"18\" Height=\"400\" Width=\"400\" VerticalAlignment=\"Top\" />\n        <ListView x:Name=\"ImagesList\" HorizontalAlignment=\"Left\" Height=\"400\" VerticalAlignment=\"Top\" Width=\"400\">\n            <ListView.ItemTemplate>\n                <DataTemplate>\n                    <StackPanel Orientation=\"Vertical\">\n                        <Image Source=\"{Binding Path=Source}\" />\n                        <TextBlock Text=\"{Binding Path=Name}\" />\n                    </StackPanel>\n                </DataTemplate>\n            </ListView.ItemTemplate>\n            <ListView.ItemsPanel>\n                <ItemsPanelTemplate>\n                    <WrapGrid Orientation=\"Horizontal\" ItemHeight=\"100\" ItemWidth=\"120\"></WrapGrid>\n                </ItemsPanelTemplate>\n            </ListView.ItemsPanel>\n        </ListView>\n    </StackPanel>\n</StackPanel>\n```\n\n### Step 4: Add activation code\n\nThe code in this step references the camera as a [**StorageDevice**](https://msdn.microsoft.com/library/windows/apps/br225654) by passing the device information Id of the camera to the [**FromId**](https://msdn.microsoft.com/library/windows/apps/br225655) method. The device information Id of the camera is obtained by first casting the event arguments as [**DeviceActivatedEventArgs**](https://msdn.microsoft.com/library/windows/apps/br224710), and then getting the value from the [**DeviceInformationId**](https://msdn.microsoft.com/library/windows/apps/br224711) property.\n\nOpen the App.xaml.cs file and add the following code to the **App** class.\n\n```cs\nprotected override void OnActivated(IActivatedEventArgs args)\n{\n   if (args.Kind == ActivationKind.Device)\n   {\n      Frame rootFrame = null;\n      // Ensure that the current page exists and is activated\n      if (Window.Current.Content == null)\n      {\n         rootFrame = new Frame();\n         rootFrame.Navigate(typeof(MainPage));\n         Window.Current.Content = rootFrame;\n      }\n      else\n      {\n         rootFrame = Window.Current.Content as Frame;\n      }\n      Window.Current.Activate();\n\n      // Make sure the necessary APIs are present on the device\n      bool storageDeviceAPIPresent =\n      Windows.Foundation.Metadata.ApiInformation.IsTypePresent(\"Windows.Devices.Portable.StorageDevice\");\n\n      if (storageDeviceAPIPresent)\n      {\n         // Reference the current page as type MainPage\n         var mPage = rootFrame.Content as MainPage;\n\n         // Cast the activated event args as DeviceActivatedEventArgs and show images\n         var deviceArgs = args as DeviceActivatedEventArgs;\n         if (deviceArgs != null)\n         {\n            mPage.ShowImages(Windows.Devices.Portable.StorageDevice.FromId(deviceArgs.DeviceInformationId));\n         }\n      }\n      else\n      {\n         // Handle case where APIs are not present (when the device is not part of the desktop device family)\n      }\n\n   }\n\n   base.OnActivated(args);\n}\n```\n\n> **Note**  The `ShowImages` method is added in the following step.\n\n### Step 5: Add code to display device information\n\nYou can obtain information about the camera from the properties of the [**StorageDevice**](https://msdn.microsoft.com/library/windows/apps/br225654) class. The code in this step displays the device name and other info to the user when the app runs. The code then calls the GetImageList and GetThumbnail methods, which you will add in the next step, to display thumbnails of the images stored on the camera\n\nIn the MainPage.xaml.cs file, add the following code to the **MainPage** class.\n\n```cs\nprivate Windows.Storage.StorageFolder rootFolder;\n\ninternal async void ShowImages(Windows.Storage.StorageFolder folder)\n{\n    DeviceInfoTextBlock.Text = \"Display Name = \" + folder.DisplayName + \"\\n\";\n    DeviceInfoTextBlock.Text += \"Display Type =  \" + folder.DisplayType + \"\\n\";\n    DeviceInfoTextBlock.Text += \"FolderRelativeId = \" + folder.FolderRelativeId + \"\\n\";\n\n    // Reference first folder of the device as the root\n    rootFolder = (await folder.GetFoldersAsync())[0];\n    var imageList = await GetImageList(rootFolder);\n\n    foreach (Windows.Storage.StorageFile img in imageList)\n    {\n        ImagesList.Items.Add(await GetThumbnail(img));\n    }\n}\n```\n\n> **Note**  The `GetImageList` and `GetThumbnail` methods are added in the following step.\n\n \n\n### Step 6: Add code to display images\n\nThe code in this step displays thumbnails of the images stored on the camera. The code makes asynchronous calls to the camera to get the thumbnail image. However, the next asynchronous call doesn't occur until the previous asynchronous call completes. This ensures that only one request is made to the camera at a time.\n\nIn the MainPage.xaml.cs file, add the following code to the **MainPage** class.\n\n```cs\nasync private System.Threading.Tasks.Task<List<Windows.Storage.StorageFile>> GetImageList(Windows.Storage.StorageFolder folder)\n{\n    var result = await folder.GetFilesAsync();\n    var subFolders = await folder.GetFoldersAsync();\n    foreach (Windows.Storage.StorageFolder f in subFolders)\n        result = result.Union(await GetImageList(f)).ToList();\n\n    return (from f in result orderby f.Name select f).ToList();\n}\n\nasync private System.Threading.Tasks.Task<Image> GetThumbnail(Windows.Storage.StorageFile img)\n{\n    // Get the thumbnail to display\n    var thumbnail = await img.GetThumbnailAsync(Windows.Storage.FileProperties.ThumbnailMode.SingleItem,\n                                                100,\n                                                Windows.Storage.FileProperties.ThumbnailOptions.UseCurrentScale);\n\n    // Create a XAML Image object bind to on the display page\n    var result = new Image();\n    result.Height = thumbnail.OriginalHeight;\n    result.Width = thumbnail.OriginalWidth;\n    result.Name = img.Name;\n    var imageBitmap = new Windows.UI.Xaml.Media.Imaging.BitmapImage();\n    imageBitmap.SetSource(thumbnail);\n    result.Source = imageBitmap;\n\n    return result;\n}\n```\n\n### Step 7: Build and run the app\n\n1.  Press F5 to build and deploy the app (in debug mode).\n2.  To run your app, connect a camera to your machine. Then select the app from the AutoPlay list of options.\n    **Note**  Not all cameras advertise for the **WPD\\\\ImageSource** AutoPlay device event.\n\n     \n\n## Configure removable storage\n\n\nYou can identify a volume device such as a memory card or thumb drive as an **AutoPlay** device when the volume device is connected to a PC. This is especially useful when you want to associate a specific app for **AutoPlay** to present to the user for your volume device.\n\nHere we show how to identify your volume device as an **AutoPlay** device.\n\nTo identify your volume device as an **AutoPlay** device, add an autorun.inf file to the root drive of your device. In the autorun.inf file, add a **CustomEvent** key to the **AutoRun** section. When your volume device connects to a PC, **AutoPlay** will find the autorun.inf file and treat your volume as a device. **AutoPlay** will create an **AutoPlay** event by using the name that you supplied for the **CustomEvent** key. You can then create an app and register the app as a handler for that **AutoPlay** event. When the device is connected to the PC, **AutoPlay** will show your app as a handler for your volume device. For more info on autorun.inf files, see [autorun.inf entries](https://msdn.microsoft.com/library/windows/desktop/cc144200).\n\n### Step 1: Create an autorun.inf file\n\nIn the root drive of your volume device, add a file named autorun.inf. Open the autorun.inf file and add the following text.\n\n``` syntax\n[AutoRun]\nCustomEvent=AutoPlayCustomEventQuickstart\n```\n\n### Step 2: Create a new project and add AutoPlay declarations\n\n1.  Open Visual Studio and select **New Project** from the **File** menu. In the **Visual C#** section, under **Windows**, select **Blank App (Universal Windows)**. Name the application **AutoPlayCustomEvent** and click **OK.**\n2.  Open the Package.appxmanifest file and select the **Capabilities** tab. Select the **Removable Storage** capability. This gives the app access to the files and folders on removable storage devices.\n3.  In the manifest file, select the **Declarations** tab. In the **Available Declarations** drop-down list, select **AutoPlay Content** and click **Add**. Select the new **AutoPlay Content** item that was added to the **Supported Declarations** list.\n\n    **Note**  Alternatively, you can also choose to add an **AutoPlay Device** declaration for your custom AutoPlay event.\n    \n4.  In the **Launch Actions** section for your **AutoPlay Content** event declaration, enter the values in the table below for the first launch action.\n5.  In the **Available Declarations** drop-down list, select **File Type Associations** and click **Add**. In the Properties of the new **File Type Associations** declaration, set the **Display Name** field to **Show .ms Files** and the **Name** field to **ms\\_association**. In the **Supported File Types** section, click **Add New**. Set the **File Type** field to **.ms**. For content events, AutoPlay filters out any file types that aren't explicitly associated with your app.\n6.  Save and close the manifest file.\n\n| Setting             | Value                         |\n|---------------------|-------------------------------|\n| Verb                | show                          |\n| Action Display Name | Show Files                    |\n| Content Event       | AutoPlayCustomEventQuickstart |\n\nThe **Content Event** value is the text that you supplied for the **CustomEvent** key in your autorun.inf file. The **Action Display Name** setting identifies the string that AutoPlay displays for your app. The **Verb** setting identifies a value that is passed to your app for the selected option. You can specify multiple launch actions for an AutoPlay event and use the **Verb** setting to determine which option a user has selected for your app. You can tell which option the user selected by checking the **verb** property of the startup event arguments passed to your app. You can use any value for the **Verb** setting except, **open**, which is reserved.\n\n### Step 3: Add XAML UI\n\nOpen the MainPage.xaml file and add the following XAML to the default &lt;Grid&gt; section.\n\n```xml\n<StackPanel Orientation=\"Vertical\">\n    <TextBlock FontSize=\"28\" Margin=\"10,0,800,0\">Files</TextBlock>\n    <TextBlock x:Name=\"FilesBlock\" FontSize=\"22\" Height=\"600\" Margin=\"10,0,800,0\" />\n</StackPanel>\n```\n\n### Step 4: Add activation code\n\nThe code in this step calls a method to display the folders in the root drive of your volume device. For the AutoPlay content events, AutoPlay passes the root folder of the storage device in the startup arguments passed to the application during the **OnFileActivated** event. You can retrieve this folder from the first element of the **Files** property.\n\nOpen the App.xaml.cs file and add the following code to the **App** class.\n\n```cs\nprotected override void OnFileActivated(FileActivatedEventArgs args)\n{\n    var rootFrame = Window.Current.Content as Frame;\n    var page = rootFrame.Content as MainPage;\n\n    // Call ShowFolders with root folder from device storage.\n    page.DisplayFiles(args.Files[0] as Windows.Storage.StorageFolder);\n\n    base.OnFileActivated(args);\n}\n```\n\n> **Note**  The `DisplayFiles` method is added in the following step.\n\n \n\n### Step 5: Add code to display folders\n\nIn the MainPage.xaml.cs file add the following code to the **MainPage** class.\n\n```cs\ninternal async void DisplayFiles(Windows.Storage.StorageFolder folder)\n{\n    foreach (Windows.Storage.StorageFile f in await ReadFiles(folder, \".ms\"))\n    {\n        FilesBlock.Text += \"  \" + f.Name + \"\\n\";\n    }\n}\n\ninternal async System.Threading.Tasks.Task<IReadOnlyList<Windows.Storage.StorageFile>>\n    ReadFiles(Windows.Storage.StorageFolder folder, string fileExtension)\n{\n    var options = new Windows.Storage.Search.QueryOptions();\n    options.FileTypeFilter.Add(fileExtension);\n    var query = folder.CreateFileQueryWithOptions(options);\n    var files = await query.GetFilesAsync();\n\n    return files;\n}\n```\n\n### Step 6: Build and run the qpp\n\n1.  Press F5 to build and deploy the app (in debug mode).\n2.  To run your app, insert a memory card or another storage device into your PC. Then select your app from the list of AutoPlay handler options.\n\n## AutoPlay event reference\n\n\nThe **AutoPlay** system allows apps to register for a variety of device and volume (disk) arrival events. To register for **AutoPlay** content events, you must enable the **Removable Storage** capability in your package manifest. This table shows the events that you can register for and when they are raised.\n\n| Scenario                                                           | Event   | Description   |\n|--------------------------------------------------------------------|---------|---------------|\n| Using photos on a Camera                                           | **WPD\\ImageSource**                | Raised for cameras that are identified as Windows Portable Devices and offer the ImageSource capability.                                                                                                                                                                                                                                                                  |\n| Using music on an audio player                                     | **WPD\\AudioSource**                | Raised for media players that are identified as Windows Portable Devices and offer the AudioSource capability.                                                                                                                                                                                                                                                            |\n| Using videos on a video camera                                     | **WPD\\VideoSource**                | Raised for video cameras that are identified as Windows Portable Devices and offer the VideoSource capability.                                                                                                                                                                                                                                                            |\n| Access a connected flash drive or external hard drive              | **StorageOnArrival**               | Raised when a drive or volume is connected to the PC.   If the drive or volume contains a DCIM, AVCHD, or PRIVATE\\ACHD folder in the root of the disk, the **ShowPicturesOnArrival** event is raised instead.                                                                                                                                                             |\n| Using photos from mass storage (legacy)                            | **ShowPicturesOnArrival**          | Raised when a drive or volume contains a DCIM, AVCHD, or PRIVATE\\ACHD folder in the root of the disk. IIf a user  has enabled **Choose what to do with each type of media** in the AutoPlay Control Panel, AutoPlay will examine a volume connected to the PC to determine the type of content on the disk. When pictures are found, **ShowPicturesOnArrival** is raised. |\n| Receiving photos with Proximity Sharing (tap and send)             | **ShowPicturesOnArrival**          | When users send content with using proximity (tap and send), AutoPlay will examine the shared files to determine the type of content. If pictures are found, **ShowPicturesOnArrival** is raised.                                                                                                                                                                         |\n| Using music from mass storage (legacy)                             | **PlayMusicFilesOnArrival**        | If a user has enabled **Choose what to do with each type of media** in the AutoPlay Control Panel, AutoPlay will examine a volume connected to the PC to determine the type of content on the disk.  When music files are found, **PlayMusicFilesOnArrival** is raised.                                                                                                   |\n| Receiving music with Proximity Sharing (tap and send)              | **PlayMusicFilesOnArrival**        | When users send content with using proximity (tap and send), AutoPlay will examine the shared files to determine the type of content. If music files are found, **PlayMusicFilesOnArrival** is raised.                                                                                                                                                                    |\n| Using videos from mass storage (legacy)                            | **PlayVideoFilesOnArrival**        | If a user has enabled **Choose what to do with each type of media** in the AutoPlay Control Panel,, AutoPlay will examine a volume connected to the PC to determine the type of content on the disk. When video files are found, **PlayVideoFilesOnArrival** is raised.                                                                                                   |\n| Receiving videos with Proximity Sharing (tap and send)             | **PlayVideoFilesOnArrival**        | When users send content with using proximity (tap and send), AutoPlay will examine the shared files to determine the type of content. If video files are found, **PlayVideoFilesOnArrival** is raised.                                                                                                                                                                    |\n| Handling mixed sets of files from a connected device               | **MixedContentOnArrival**          | If a user has enabled **Choose what to do with each type of media** in the AutoPlay Control Panel, AutoPlay will examine a volume connected to the PC to determine the type of content on the disk. If no specific content type is found (for example, pictures), **MixedContentOnArrival** is raised.                                                                    |\n| Handling mixed sets of files with Proximity Sharing (tap and send) | **MixedContentOnArrival**          | When users send content with using proximity (tap and send), AutoPlay will examine the shared files to determine the type of content. If no specific content type is found (for example, pictures), **MixedContentOnArrival** is raised.                                                                                                                                  |\n| Handle video from optical media                                    | **PlayDVDMovieOnArrival**          |                                                                                                                                                                                                                                                                                                                                                                           |\n|                                                                    |                                    |                                                                                                                                                                                                                                                                                                                                                                           |\n|                                                                    | **PlayBluRayOnArrival**            |                                                                                                                                                                                                                                                                                                                                                                           |\n|                                                                    |                                    |                                                                                                                                                                                                                                                                                                                                                                           |\n|                                                                    | **PlayVideoCDMovieOnArrival**      |                                                                                                                                                                                                                                                                                                                                                                           |\n|                                                                    |                                    |                                                                                                                                                                                                                                                                                                                                                                           |\n|                                                                    | **PlaySuperVideoCDMovieOnArrival** |                                                                                                                                                                                                                                                                                                                                                                           |\n| Handle music from optical media                                    | **PlayCDAudioOnArrival**           |                                                                                                                                                                                                                                                                                                                                                                           |\n|                                                                    |                                    |                                                                                                                                                                                                                                                                                                                                                                           |\n|                                                                    | **PlayDVDAudioOnArrival**          |                                                                                                                                                                                                                                                                                                                                                                           |\n| Play enhanced disks                                                | **PlayEnhancedCDOnArrival**        |                                                                                                                                                                                                                                                                                                                                                                           |\n|                                                                    |                                    |                                                                                                                                                                                                                                                                                                                                                                           |\n|                                                                    | **PlayEnhancedDVDOnArrival**       |                                                                                                                                                                                                                                                                                                                                                                           |\n| Handle writeable optical disks                                     | **HandleCDBurningOnArrival**       |                                                                                                                                                                                                                                                                                                                                                                           |\n|                                                                    |                                    |                                                                                                                                                                                                                                                                                                                                                                           |\n|                                                                    | **HandleDVDBurningOnArrival**      |                                                                                                                                                                                                                                                                                                                                                                           |\n|                                                                    |                                    |                                                                                                                                                                                                                                                                                                                                                                           |\n|                                                                    | **HandleBDBurningOnArrival**       |                                                                                                                                                                                                                                                                                                                                                                           |\n| Handle any other device or volume connection                       | **UnknownContentOnArrival**        | Raised for all events in case content is found that does not match any of the AutoPlay content events. Use of this event is not recommended. You should only register your application for the specific AutoPlay events that it can handle.                                                                                                                               |\n\nYou can specify that AutoPlay raise a custom AutoPlay Content event using the **CustomEvent** entry in the autorun.inf file for a volume. For more info, see [Autorun.inf entries](https://msdn.microsoft.com/library/windows/desktop/cc144200).\n\nYou can register your app as an AutoPlay Content or AutoPlay Device event handler by adding an extension to the package.appxmanifest file for your app. If you are using Visual Studio, you can add an **AutoPlay Content** or **AutoPlay Device** declaration in the **Declarations** tab. If you are editing the package.appxmanifest file for your app directly, add an [**Extension**](https://msdn.microsoft.com/library/windows/apps/br211400) element to your package manifest that specifies either **windows.autoPlayContent** or **windows.autoPlayDevice** as the **Category**. For example, the following entry in the package manifest adds an **AutoPlay Content** extension to register the app as a handler for the **ShowPicturesOnArrival** event.\n\n```xml\n  <Applications>\n    <Application Id=\"AutoPlayHandlerSample.App\">\n      <Extensions>\n        <Extension Category=\"windows.autoPlayContent\">\n          <AutoPlayContent>\n            <LaunchAction Verb=\"show\" ActionDisplayName=\"Show Pictures\"\n                          ContentEvent=\"ShowPicturesOnArrival\" />\n          </AutoPlayContent>\n        </Extension>\n      </Extensions>\n    </Application>\n  </Applications>\n```\n\n \n\n \n"}