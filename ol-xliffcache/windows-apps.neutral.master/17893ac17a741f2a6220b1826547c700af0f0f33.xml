{"nodes":[{"content":"Determining availability of Microsoft OneDrive files","pos":[78,130]},{"content":"Determine if a Microsoft OneDrive file is available using the StorageFile.IsAvailable property.","pos":[144,239]},{"content":"Determining availability of Microsoft OneDrive files","pos":[246,298]},{"content":"Updated for UWP apps on Windows 10.","pos":[303,338]},{"content":"For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept>","pos":[339,431]},{"content":"Important APIs","pos":[440,454]},{"content":"FileIO class","pos":[466,478]},{"content":"StorageFile class","pos":[547,564]},{"content":"StorageFile.IsAvailable property","pos":[633,665]},{"pos":[770,971],"content":"Determine if a Microsoft OneDrive file is available using the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>StorageFile.IsAvailable<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/windows/apps/windows.storage.storagefile.isavailable.aspx)</ept> property."},{"content":"Prerequisites","pos":[976,989]},{"content":"Understand async programming for Universal Windows Platform (UWP) apps","pos":[997,1067]},{"content":"You can learn how to write asynchronous apps in C# or Visual Basic, see <bpt id=\"p1\">[</bpt>Call asynchronous APIs in C# or Visual Basic<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/Mt187337)</ept>.","pos":[1075,1252]},{"content":"To learn how to write asynchronous apps in C++, see <bpt id=\"p1\">[</bpt>Asynchronous programming in C++<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/Mt187334)</ept>.","pos":[1253,1397]},{"content":"App capabilty declarations","pos":[1405,1431]},{"pos":[1439,1497],"content":"See <bpt id=\"p1\">[</bpt>File access permissions<ept id=\"p1\">](file-access-permissions.md)</ept>."},{"content":"Using the StorageFile.IsAvailable property","pos":[1502,1544]},{"content":"Users are able to mark OneDrive files as either available-offline (default) or online-only.","pos":[1546,1637]},{"content":"This capability enables users to move large files (such as pictures and videos) to their OneDrive, mark them as online-only, and save disk space (the only thing kept locally is a metadata file).","pos":[1638,1832]},{"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>StorageFile.IsAvailable<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/windows/apps/windows.storage.storagefile.isavailable.aspx)</ept>, is used to determine if a file is currently available.","pos":[1834,2019]},{"content":"The following table shows the value of the <bpt id=\"p1\">**</bpt>StorageFile.IsAvailable<ept id=\"p1\">**</ept> property in various scenarios.","pos":[2020,2121]},{"content":"Type of file","pos":[2125,2137]},{"content":"Online","pos":[2169,2175]},{"content":"Metered network","pos":[2178,2193]},{"content":"Offline","pos":[2203,2210]},{"content":"Local file","pos":[2305,2315]},{"content":"True","pos":[2349,2353]},{"content":"True","pos":[2358,2362]},{"content":"True","pos":[2383,2387]},{"content":"OneDrive file marked as available-offline","pos":[2395,2436]},{"content":"True","pos":[2439,2443]},{"content":"True","pos":[2448,2452]},{"content":"True","pos":[2473,2477]},{"content":"OneDrive file marked as online-only","pos":[2485,2520]},{"content":"True","pos":[2529,2533]},{"content":"Based on user settings","pos":[2538,2560]},{"content":"False","pos":[2563,2568]},{"content":"Network file","pos":[2575,2587]},{"content":"True","pos":[2619,2623]},{"content":"Based on user settings","pos":[2628,2650]},{"content":"False","pos":[2653,2658]},{"content":"The following steps illustrate how to determine if a file is currently available.","pos":[2667,2748]},{"content":"Declare a capability appropriate for the library you want to access.","pos":[2754,2822]},{"content":"Include the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Windows.Storage<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR227346)</ept> namespace.","pos":[2827,2929]},{"content":"This namespace includes the types for managing files, folders, and application settings.","pos":[2930,3018]},{"content":"It also includes the needed <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>StorageFile<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR227171)</ept> type.","pos":[3019,3128]},{"content":"Acquire a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>StorageFile<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR227171)</ept> object for the desired file(s).","pos":[3133,3250]},{"content":"If you are enumerating a library, this step is usually accomplished by calling the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>StorageFolder.CreateFileQuery<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR227252)</ept> method and then calling the resulting <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>StorageFileQueryResult<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/BR208046)</ept> object's <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>GetFilesAsync<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/en-us/library/windows/apps/br227276.aspx)</ept> method.","pos":[3251,3658]},{"content":"The <bpt id=\"p1\">**</bpt>GetFilesAsync<ept id=\"p1\">**</ept> method returns an <bpt id=\"p2\">[</bpt>IReadOnlyList<ept id=\"p2\">](http://go.microsoft.com/fwlink/p/?LinkId=324970)</ept> collection of <bpt id=\"p3\">**</bpt>StorageFile<ept id=\"p3\">**</ept> objects.","pos":[3659,3802]},{"pos":[3807,4156],"content":"Once you have the access to a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>StorageFile<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR227171)</ept> object representing the desired file(s), the value of the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>StorageFile.IsAvailable<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/en-us/library/windows/apps/windows.storage.storagefile.isavailable.aspx)</ept> property reflects whether or not the file is available."},{"content":"The following generic method illustrates how to enumerate any folder and return the collection of <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>StorageFile<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/BR227171)</ept> objects for that folder.","pos":[4158,4356]},{"content":"The calling method then iterates over the returned collection referencing the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>StorageFile.IsAvailable<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/windows/apps/windows.storage.storagefile.isavailable.aspx)</ept> property for each file.","pos":[4357,4588]}],"content":"---\nauthor: TylerMSFT\nms.assetid: 3604524F-112A-474F-B0CA-0726DC8DB885\ntitle: Determining availability of Microsoft OneDrive files\ndescription: Determine if a Microsoft OneDrive file is available using the StorageFile.IsAvailable property.\n---\n# Determining availability of Microsoft OneDrive files\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\n\n** Important APIs **\n\n-   [**FileIO class**](https://msdn.microsoft.com/library/windows/apps/Hh701440)\n-   [**StorageFile class**](https://msdn.microsoft.com/library/windows/apps/BR227171)\n-   [**StorageFile.IsAvailable property**](https://msdn.microsoft.com/en-us/library/windows/apps/windows.storage.storagefile.isavailable.aspx)\n\nDetermine if a Microsoft OneDrive file is available using the [**StorageFile.IsAvailable**](https://msdn.microsoft.com/en-us/library/windows/apps/windows.storage.storagefile.isavailable.aspx) property.\n\n## Prerequisites\n\n-   **Understand async programming for Universal Windows Platform (UWP) apps**\n\n    You can learn how to write asynchronous apps in C# or Visual Basic, see [Call asynchronous APIs in C# or Visual Basic](https://msdn.microsoft.com/library/windows/apps/Mt187337). To learn how to write asynchronous apps in C++, see [Asynchronous programming in C++](https://msdn.microsoft.com/library/windows/apps/Mt187334).\n\n-   **App capabilty declarations**\n\n    See [File access permissions](file-access-permissions.md).\n\n## Using the StorageFile.IsAvailable property\n\nUsers are able to mark OneDrive files as either available-offline (default) or online-only. This capability enables users to move large files (such as pictures and videos) to their OneDrive, mark them as online-only, and save disk space (the only thing kept locally is a metadata file).\n\n[**StorageFile.IsAvailable**](https://msdn.microsoft.com/en-us/library/windows/apps/windows.storage.storagefile.isavailable.aspx), is used to determine if a file is currently available. The following table shows the value of the **StorageFile.IsAvailable** property in various scenarios.\n\n| Type of file                              | Online | Metered network        | Offline |\n|-------------------------------------------|--------|------------------------|---------|\n| Local file                                | True   | True                   | True    |\n| OneDrive file marked as available-offline | True   | True                   | True    |\n| OneDrive file marked as online-only       | True   | Based on user settings | False   |\n| Network file                              | True   | Based on user settings | False   |\n\n \n\nThe following steps illustrate how to determine if a file is currently available.\n\n1.  Declare a capability appropriate for the library you want to access.\n2.  Include the [**Windows.Storage**](https://msdn.microsoft.com/library/windows/apps/BR227346) namespace. This namespace includes the types for managing files, folders, and application settings. It also includes the needed [**StorageFile**](https://msdn.microsoft.com/library/windows/apps/BR227171) type.\n3.  Acquire a [**StorageFile**](https://msdn.microsoft.com/library/windows/apps/BR227171) object for the desired file(s). If you are enumerating a library, this step is usually accomplished by calling the [**StorageFolder.CreateFileQuery**](https://msdn.microsoft.com/library/windows/apps/BR227252) method and then calling the resulting [**StorageFileQueryResult**](https://msdn.microsoft.com/library/windows/apps/BR208046) object's [**GetFilesAsync**](https://msdn.microsoft.com/en-us/library/windows/apps/br227276.aspx) method. The **GetFilesAsync** method returns an [IReadOnlyList](http://go.microsoft.com/fwlink/p/?LinkId=324970) collection of **StorageFile** objects.\n4.  Once you have the access to a [**StorageFile**](https://msdn.microsoft.com/library/windows/apps/BR227171) object representing the desired file(s), the value of the [**StorageFile.IsAvailable**](https://msdn.microsoft.com/en-us/library/windows/apps/windows.storage.storagefile.isavailable.aspx) property reflects whether or not the file is available.\n\nThe following generic method illustrates how to enumerate any folder and return the collection of [**StorageFile**](https://msdn.microsoft.com/library/windows/apps/BR227171) objects for that folder. The calling method then iterates over the returned collection referencing the [**StorageFile.IsAvailable**](https://msdn.microsoft.com/en-us/library/windows/apps/windows.storage.storagefile.isavailable.aspx) property for each file.\n\n```CSharp\n/// <summary>\n/// Generic function that retrieves all files from the specified folder.\n/// </summary>\n/// <param name=\"folder\">The folder to be searched.</param>\n/// <returns>An IReadOnlyList collection containing the file objects.</returns>\nasync Task<System.Collections.Generic.IReadOnlyList<StorageFile>> GetLibraryFilesAsync(StorageFolder folder)\n{\n    var query = folder.CreateFileQuery();\n    return await query.GetFilesAsync();\n}\n\n...\n\nprivate async void CheckAvailabilityOfFilesInPicturesLibrary()\n{\n    // Determine availability of all files within Pictures library.\n    var files = await GetLibraryFilesAsync(KnownFolders.PicturesLibrary);\n    for (int i = 0; i < files.Count; i++)\n    {\n        StorageFile file = files[i];\n\n        StringBuilder fileInfo = new StringBuilder();\n        fileInfo.AppendFormat(\"{0} (on {1}) is {2}\", \n                    file.Name, \n                    file.Provider.DisplayName, \n                    file.IsAvailable ? \"available\" : \"not available\");\n    }\n}\n```\n\n \n\n \n\n\n\n\n"}