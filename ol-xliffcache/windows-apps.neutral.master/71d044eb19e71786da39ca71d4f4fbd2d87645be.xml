{"nodes":[{"content":"Overlay tiled images on a map","pos":[29,58]},{"content":"Overlay third-party or custom tiled images on a map by using tile sources.","pos":[72,146]},{"content":"Use tile sources to overlay specialized information such as weather data, population data, or seismic data; or use tile sources to replace the default map entirely.","pos":[147,311]},{"content":"Overlay tiled images on a map","pos":[368,397]},{"content":"Updated for UWP apps on Windows 10.","pos":[403,438]},{"content":"For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept>","pos":[439,531]},{"content":"Overlay third-party or custom tiled images on a map by using tile sources.","pos":[537,611]},{"content":"Use tile sources to overlay specialized information such as weather data, population data, or seismic data; or use tile sources to replace the default map entirely.","pos":[612,776]},{"pos":[778,961],"content":"<bpt id=\"p1\">**</bpt>Tip<ept id=\"p1\">**</ept> To learn more about using maps in your app, download the following sample from the <bpt id=\"p2\">[</bpt>Windows-universal-samples repo<ept id=\"p2\">](http://go.microsoft.com/fwlink/p/?LinkId=619979)</ept> on GitHub."},{"content":"Universal Windows Platform (UWP) map sample","pos":[968,1011]},{"content":"Tiled image overview","pos":[1066,1086]},{"content":"Map services such as Nokia Maps and Bing Maps cut maps into square tiles for quick retrieval and display.","pos":[1089,1194]},{"content":"These tiles are 256 pixels by 256 pixels in size, and are pre-rendered at multiple levels of detail.","pos":[1195,1295]},{"content":"Many third-party services also provide map-based data that's cut into tiles.","pos":[1296,1372]},{"content":"Use tile sources to retrieve third-party tiles, or to create your own custom tiles, and overlay them on the map displayed in the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>MapControl<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn637004)</ept>.","pos":[1373,1577]},{"content":"Important","pos":[1581,1590]},{"content":"When you use tile sources, you don't have to write code to request or to position individual tiles.","pos":[1595,1694]},{"content":"The <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>MapControl<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn637004)</ept> requests tiles as it needs them.","pos":[1695,1806]},{"content":"Each request specifies the X and Y coordinates and the zoom level for the individual tile.","pos":[1807,1897]},{"content":"You simply specify the format of the Uri or filename to use to retrieve the tiles in the <bpt id=\"p1\">**</bpt>UriFormatString<ept id=\"p1\">**</ept> property.","pos":[1898,2016]},{"content":"That is, you insert replaceable parameters in the base Uri or filename to indicate where to pass the X and Y coordinates and the zoom level for each tile.","pos":[2017,2171]},{"pos":[2173,2465],"content":"Here's an example of the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>UriFormatString<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn636992)</ept> property for an <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>HttpMapTileDataSource<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn636986)</ept> that shows the replaceable parameters for the X and Y coordinates and the zoom level."},{"content":"(The X and Y coordinates represent the location of the individual tile within the map of the world at the specified level of detail.","pos":[2550,2682]},{"content":"The tile numbering system starts from {0, 0} in the upper left corner of the map.","pos":[2683,2764]},{"content":"For example, the tile at {1, 2} is in the second column of the third row of the grid of tiles.)","pos":[2765,2860]},{"pos":[2862,3001],"content":"For more info about the tile system used by mapping services, see <bpt id=\"p1\">[</bpt>Bing Maps Tile System<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=626692)</ept>."},{"content":"Overlay tiles from a tile source","pos":[3007,3039]},{"pos":[3041,3185],"content":"Overlay tiled images from a tile source on a map by using the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>MapTileDataSource<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn637141)</ept>."},{"pos":[3191,3345],"content":"Instantiate one of the three tile data source classes that inherit from <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>MapTileDataSource<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn637141)</ept>."},{"content":"HttpMapTileDataSource","pos":[3358,3379]},{"content":"LocalMapTileDataSource","pos":[3452,3474]},{"content":"CustomMapTileDataSource","pos":[3547,3570]},{"pos":[3637,3763],"content":"Configure the <bpt id=\"p1\">**</bpt>UriFormatString<ept id=\"p1\">**</ept> to use to request the tiles by inserting replaceable parameters in the base Uri or filename."},{"content":"The following example instantiates an <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>HttpMapTileDataSource<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn636986)</ept>.","pos":[3769,3893]},{"content":"This example specifies the value of the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>UriFormatString<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn636992)</ept> in the constructor of the <bpt id=\"p3\">**</bpt>HttpMapTileDataSource<ept id=\"p3\">**</ept>.","pos":[3894,4066]},{"content":"Instantiate and configure a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>MapTileSource<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn637144)</ept>.","pos":[4235,4341]},{"content":"Specify the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>MapTileDataSource<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn637141)</ept> that you configured in the previous step as the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>DataSource<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn637149)</ept> of the <bpt id=\"p5\">**</bpt>MapTileSource<ept id=\"p5\">**</ept>.","pos":[4342,4584]},{"pos":[4590,4805],"content":"The following example specifies the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>DataSource<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn637149)</ept> in the constructor of the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>MapTileSource<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn637144)</ept>."},{"pos":[4896,5066],"content":"You can restrict the conditions in which the tiles are displayed by using properties of the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>MapTileSource<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn637144)</ept>."},{"pos":[5076,5238],"content":"Display tiles only within a specific geographic area by providing a value for the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Bounds<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn637147)</ept> property."},{"pos":[5247,5411],"content":"Display tiles only at certain levels of detail by providing a value for the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ZoomLevelRange<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn637171)</ept> property."},{"pos":[5417,5925],"content":"Optionally, configure other properties of the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>MapTileSource<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn637144)</ept> that affect the loading or the display of the tiles, such as <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>Layer<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn637157)</ept>, <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>AllowOverstretch<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/dn637145)</ept>, <bpt id=\"p7\">[</bpt><bpt id=\"p8\">**</bpt>IsRetryEnabled<ept id=\"p8\">**</ept><ept id=\"p7\">](https://msdn.microsoft.com/library/windows/apps/dn637153)</ept>, and <bpt id=\"p9\">[</bpt><bpt id=\"p10\">**</bpt>IsTransparencyEnabled<ept id=\"p10\">**</ept><ept id=\"p9\">](https://msdn.microsoft.com/library/windows/apps/dn637155)</ept>."},{"pos":[5931,6193],"content":"Add the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>MapTileSource<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn637144)</ept> to the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>TileSources<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn637053)</ept> collection of the <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>MapControl<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/dn637004)</ept>."},{"content":"Overlay tiles from a web service","pos":[6267,6299]},{"pos":[6302,6451],"content":"Overlay tiled images retrieved from a web service by using the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>HttpMapTileDataSource<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn636986)</ept>."},{"pos":[6457,6558],"content":"Instantiate an <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>HttpMapTileDataSource<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn636986)</ept>."},{"content":"Specify the format of the Uri that the web service expects as the value of the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>UriFormatString<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn636992)</ept> property.","pos":[6563,6731]},{"content":"To create this value, insert replaceable parameters in the base Uri.","pos":[6732,6800]},{"content":"For example, in the following code sample, the value of the <bpt id=\"p1\">**</bpt>UriFormatString<ept id=\"p1\">**</ept> is:","pos":[6801,6884]},{"content":"The web service has to support a Uri that contains the replaceable parameters {x}, {y}, and {zoomlevel}.","pos":[6982,7086]},{"content":"Most web services (for example, Nokia, Bing, and Google) support Uris in this format.","pos":[7087,7172]},{"content":"If the web service requires additional arguments that aren't available with the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>UriFormatString<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn636992)</ept> property, then you have to create a custom Uri.","pos":[7173,7380]},{"content":"Create and return a custom Uri by handling the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>UriRequested<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn636993)</ept> event.","pos":[7381,7511]},{"content":"For more info, see the <bpt id=\"p1\">[</bpt>Provide a custom URI<ept id=\"p1\">](#customuri)</ept> section later in this topic.","pos":[7512,7598]},{"pos":[7604,7700],"content":"Then, follow the remaining steps described previously in the <bpt id=\"p1\">[</bpt>Tiled image overview<ept id=\"p1\">](#tileintro)</ept>."},{"content":"The following example overlays tiles from a fictitious web service on a map of North America.","pos":[7702,7795]},{"content":"The value of the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>UriFormatString<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn636992)</ept> is specified in the constructor of the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>HttpMapTileDataSource<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn636986)</ept>.","pos":[7796,8018]},{"content":"In this example, tiles are only displayed within the geographic boundaries specified by the optional <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Bounds<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn637147)</ept> property.","pos":[8019,8200]},{"content":"[!div class=\"tabbedCodeSnippets\"]","pos":[8204,8237]},{"content":"Overlay tiles from local storage","pos":[10202,10234]},{"content":"Overlay tiled images stored as files in local storage by using the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>LocalMapTileDataSource<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn636994)</ept>.","pos":[10237,10391]},{"content":"Typically, you package and distribute these files with your app.","pos":[10392,10456]},{"pos":[10462,10563],"content":"Instantiate a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>LocalMapTileDataSource<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn636994)</ept>."},{"content":"Specify the format of the file names as the value of the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>UriFormatString<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn636998)</ept> property.","pos":[10568,10714]},{"content":"To create this value, insert replaceable parameters in the base filename.","pos":[10715,10788]},{"content":"For example, in the following code sample, the value of the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>UriFormatString<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn636992)</ept> is:","pos":[10789,10932]},{"content":"If the format of the file names requires additional arguments that aren't available with the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>UriFormatString<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn636998)</ept> property, then you have to create a custom Uri.","pos":[10999,11219]},{"content":"Create and return a custom Uri by handling the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>UriRequested<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn637001)</ept> event.","pos":[11220,11350]},{"content":"For more info, see the <bpt id=\"p1\">[</bpt>Provide a custom URI<ept id=\"p1\">](#customuri)</ept> section later in this topic.","pos":[11351,11437]},{"pos":[11443,11539],"content":"Then, follow the remaining steps described previously in the <bpt id=\"p1\">[</bpt>Tiled image overview<ept id=\"p1\">](#tileintro)</ept>."},{"content":"You can use the following protocols and locations to load tiles from local storage:","pos":[11541,11624]},{"content":"Uri","pos":[11628,11631]},{"content":"More info","pos":[11634,11643]},{"content":"ms-appx:///","pos":[11815,11826]},{"content":"Points to the root of the app's installation folder.","pos":[11829,11881]},{"pos":[11889,12023],"content":"This is the location referenced by the <bpt id=\"p1\">[</bpt>Package.InstalledLocation<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br224681)</ept> property."},{"content":"ms-appdata:///local","pos":[12028,12047]},{"content":"Points to the root of the app's local storage.","pos":[12050,12096]},{"pos":[12104,12240],"content":"This is the location referenced by the <bpt id=\"p1\">[</bpt>ApplicationData.LocalFolder<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br241621)</ept> property."},{"content":"ms-appdata:///temp","pos":[12245,12263]},{"content":"Points to the app's temp folder.","pos":[12266,12298]},{"pos":[12306,12446],"content":"This is the location referenced by the <bpt id=\"p1\">[</bpt>ApplicationData.TemporaryFolder<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br241629)</ept> property."},{"content":"The following example loads tiles that are stored as files in the app's installation folder by using the <ph id=\"ph1\">`ms-appx:///`</ph> protocol.","pos":[12453,12581]},{"content":"The value for the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>UriFormatString<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn636998)</ept> is specified in the constructor of the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>LocalMapTileDataSource<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn636994)</ept>.","pos":[12582,12806]},{"content":"In this example, tiles are only displayed when the zoom level of the map is within the range specified by the optional <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ZoomLevelRange<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn637171)</ept> property.","pos":[12807,13014]},{"content":"Provide a custom URI","pos":[13725,13745]},{"content":"If the replaceable parameters available with the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>UriFormatString<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn636992)</ept> property of the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>HttpMapTileDataSource<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn636986)</ept> or the <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>UriFormatString<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/dn636998)</ept> property of the <bpt id=\"p7\">[</bpt><bpt id=\"p8\">**</bpt>LocalMapTileDataSource<ept id=\"p8\">**</ept><ept id=\"p7\">](https://msdn.microsoft.com/library/windows/apps/dn636994)</ept> aren't sufficient to retrieve your tiles, then you have to create a custom Uri.","pos":[13748,14248]},{"content":"Create and return a custom Uri by providing a custom handler for the <bpt id=\"p1\">**</bpt>UriRequested<ept id=\"p1\">**</ept> event.","pos":[14249,14341]},{"content":"The <bpt id=\"p1\">**</bpt>UriRequested<ept id=\"p1\">**</ept> event is raised for each individual tile.","pos":[14342,14404]},{"pos":[14410,14860],"content":"In your custom handler for the <bpt id=\"p1\">**</bpt>UriRequested<ept id=\"p1\">**</ept> event, combine the required custom arguments with the <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>X<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/dn610743)</ept>, <bpt id=\"p4\">[</bpt><bpt id=\"p5\">**</bpt>Y<ept id=\"p5\">**</ept><ept id=\"p4\">](https://msdn.microsoft.com/library/windows/apps/dn610744)</ept>, and <bpt id=\"p6\">[</bpt><bpt id=\"p7\">**</bpt>ZoomLevel<ept id=\"p7\">**</ept><ept id=\"p6\">](https://msdn.microsoft.com/library/windows/apps/dn610745)</ept> properties of the <bpt id=\"p8\">[</bpt><bpt id=\"p9\">**</bpt>MapTileUriRequestedEventArgs<ept id=\"p9\">**</ept><ept id=\"p8\">](https://msdn.microsoft.com/library/windows/apps/dn637177)</ept> to create the custom Uri."},{"pos":[14865,15268],"content":"Return the custom Uri in the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Uri<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn610748)</ept> property of the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>MapTileUriRequest<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn637173)</ept>, which is contained in the <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>Request<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/dn637179)</ept> property of the <bpt id=\"p7\">[</bpt><bpt id=\"p8\">**</bpt>MapTileUriRequestedEventArgs<ept id=\"p8\">**</ept><ept id=\"p7\">](https://msdn.microsoft.com/library/windows/apps/dn637177)</ept>."},{"content":"The following example shows how to provide a custom Uri by creating a custom handler for the <bpt id=\"p1\">**</bpt>UriRequested<ept id=\"p1\">**</ept> event.","pos":[15270,15386]},{"content":"It also shows how to implement the deferral pattern if you have to do something asynchronously to create the custom Uri.","pos":[15387,15507]},{"content":"Overlay tiles from a custom source","pos":[16953,16987]},{"content":"Overlay custom tiles by using the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>CustomMapTileDataSource<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn636983)</ept>.","pos":[16990,17112]},{"content":"Create tiles programmatically in memory on the fly, or write your own code to load existing tiles from another source.","pos":[17113,17231]},{"content":"To create or load custom tiles, provide a custom handler for the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>BitmapRequested<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn636984)</ept> event.","pos":[17233,17384]},{"content":"The <bpt id=\"p1\">**</bpt>BitmapRequested<ept id=\"p1\">**</ept> event is raised for each individual tile.","pos":[17385,17450]},{"pos":[17456,17983],"content":"In your custom handler for the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>BitmapRequested<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn636984)</ept> event, combine the required custom arguments with the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>X<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn637135)</ept>, <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>Y<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/dn637136)</ept>, and <bpt id=\"p7\">[</bpt><bpt id=\"p8\">**</bpt>ZoomLevel<ept id=\"p8\">**</ept><ept id=\"p7\">](https://msdn.microsoft.com/library/windows/apps/dn637137)</ept> properties of the <bpt id=\"p9\">[</bpt><bpt id=\"p10\">**</bpt>MapTileBitmapRequestedEventArgs<ept id=\"p10\">**</ept><ept id=\"p9\">](https://msdn.microsoft.com/library/windows/apps/dn637132)</ept> to create or retrieve a custom tile."},{"content":"Return the custom tile in the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>PixelData<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn637140)</ept> property of the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>MapTileBitmapRequest<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn637128)</ept>, which is contained in the <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>Request<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/dn637134)</ept> property of the <bpt id=\"p7\">[</bpt><bpt id=\"p8\">**</bpt>MapTileBitmapRequestedEventArgs<ept id=\"p8\">**</ept><ept id=\"p7\">](https://msdn.microsoft.com/library/windows/apps/dn637132)</ept>.","pos":[17988,18404]},{"content":"The <bpt id=\"p1\">**</bpt>PixelData<ept id=\"p1\">**</ept> property is of type <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>IRandomAccessStreamReference<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/hh701664)</ept>.","pos":[18405,18536]},{"content":"The following example shows how to provide custom tiles by creating a custom handler for the <bpt id=\"p1\">**</bpt>BitmapRequested<ept id=\"p1\">**</ept> event.","pos":[18538,18657]},{"content":"This example creates identical red tiles that are partially opaque.","pos":[18658,18725]},{"content":"The example ignores the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>X<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn637135)</ept>, <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>Y<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn637136)</ept>, and <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>ZoomLevel<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/dn637137)</ept> properties of the <bpt id=\"p7\">[</bpt><bpt id=\"p8\">**</bpt>MapTileBitmapRequestedEventArgs<ept id=\"p8\">**</ept><ept id=\"p7\">](https://msdn.microsoft.com/library/windows/apps/dn637132)</ept>.","pos":[18726,19076]},{"content":"Although this is not a real world example, the example demonstrates how you can create in-memory custom tiles on the fly.","pos":[19077,19198]},{"content":"The example also shows how to implement the deferral pattern if you have to do something asynchronously to create the custom tiles.","pos":[19199,19330]},{"content":"Replace the default map","pos":[23098,23121]},{"content":"To replace the default map entirely with third-party or custom tiles:","pos":[23124,23193]},{"pos":[23199,23494],"content":"Specify <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>MapTileLayer<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn637143)</ept>.<bpt id=\"p3\">**</bpt>BackgroundReplacement<ept id=\"p3\">**</ept> as the value of the <bpt id=\"p4\">[</bpt><bpt id=\"p5\">**</bpt>Layer<ept id=\"p5\">**</ept><ept id=\"p4\">](https://msdn.microsoft.com/library/windows/apps/dn637157)</ept> property of the <bpt id=\"p6\">[</bpt><bpt id=\"p7\">**</bpt>MapTileSource<ept id=\"p7\">**</ept><ept id=\"p6\">](https://msdn.microsoft.com/library/windows/apps/dn637144)</ept>."},{"pos":[23499,23770],"content":"Specify <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>MapStyle<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn637127)</ept>.<bpt id=\"p3\">**</bpt>None<ept id=\"p3\">**</ept> as the value of the <bpt id=\"p4\">[</bpt><bpt id=\"p5\">**</bpt>Style<ept id=\"p5\">**</ept><ept id=\"p4\">](https://msdn.microsoft.com/library/windows/apps/dn637051)</ept> property of the <bpt id=\"p6\">[</bpt><bpt id=\"p7\">**</bpt>MapControl<ept id=\"p7\">**</ept><ept id=\"p6\">](https://msdn.microsoft.com/library/windows/apps/dn637004)</ept>."},{"content":"Related topics","pos":[23775,23789]},{"content":"Bing Maps Developer Center","pos":[23794,23820]},{"content":"UWP map sample","pos":[23858,23872]},{"content":"Design guidelines for maps","pos":[23926,23952]},{"content":"Build 2015 video: Leveraging Maps and Location Across Phone, Tablet, and PC in Your Windows Apps","pos":[24015,24111]},{"content":"UWP traffic app sample","pos":[24167,24189]}],"content":"---\nauthor: msatranjr\ntitle: Overlay tiled images on a map\ndescription: Overlay third-party or custom tiled images on a map by using tile sources. Use tile sources to overlay specialized information such as weather data, population data, or seismic data; or use tile sources to replace the default map entirely.\nms.assetid: 066BD6E2-C22B-4F5B-AA94-5D6C86A09BDF\n---\n\n# Overlay tiled images on a map\n\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\n\nOverlay third-party or custom tiled images on a map by using tile sources. Use tile sources to overlay specialized information such as weather data, population data, or seismic data; or use tile sources to replace the default map entirely.\n\n**Tip** To learn more about using maps in your app, download the following sample from the [Windows-universal-samples repo](http://go.microsoft.com/fwlink/p/?LinkId=619979) on GitHub.\n\n-   [Universal Windows Platform (UWP) map sample](http://go.microsoft.com/fwlink/p/?LinkId=619977)\n\n## Tiled image overview\n\n\nMap services such as Nokia Maps and Bing Maps cut maps into square tiles for quick retrieval and display. These tiles are 256 pixels by 256 pixels in size, and are pre-rendered at multiple levels of detail. Many third-party services also provide map-based data that's cut into tiles. Use tile sources to retrieve third-party tiles, or to create your own custom tiles, and overlay them on the map displayed in the [**MapControl**](https://msdn.microsoft.com/library/windows/apps/dn637004).\n\n**Important**  \nWhen you use tile sources, you don't have to write code to request or to position individual tiles. The [**MapControl**](https://msdn.microsoft.com/library/windows/apps/dn637004) requests tiles as it needs them. Each request specifies the X and Y coordinates and the zoom level for the individual tile. You simply specify the format of the Uri or filename to use to retrieve the tiles in the **UriFormatString** property. That is, you insert replaceable parameters in the base Uri or filename to indicate where to pass the X and Y coordinates and the zoom level for each tile.\n\nHere's an example of the [**UriFormatString**](https://msdn.microsoft.com/library/windows/apps/dn636992) property for an [**HttpMapTileDataSource**](https://msdn.microsoft.com/library/windows/apps/dn636986) that shows the replaceable parameters for the X and Y coordinates and the zoom level.\n\n``` syntax\n    http://www.<web service name>.com/z={zoomlevel}&x={x}&y={y}\n```\n\n \n\n(The X and Y coordinates represent the location of the individual tile within the map of the world at the specified level of detail. The tile numbering system starts from {0, 0} in the upper left corner of the map. For example, the tile at {1, 2} is in the second column of the third row of the grid of tiles.)\n\nFor more info about the tile system used by mapping services, see [Bing Maps Tile System](http://go.microsoft.com/fwlink/p/?LinkId=626692).\n\n### Overlay tiles from a tile source\n\nOverlay tiled images from a tile source on a map by using the [**MapTileDataSource**](https://msdn.microsoft.com/library/windows/apps/dn637141).\n\n1.  Instantiate one of the three tile data source classes that inherit from [**MapTileDataSource**](https://msdn.microsoft.com/library/windows/apps/dn637141).\n\n    -   [**HttpMapTileDataSource**](https://msdn.microsoft.com/library/windows/apps/dn636986)\n    -   [**LocalMapTileDataSource**](https://msdn.microsoft.com/library/windows/apps/dn636994)\n    -   [**CustomMapTileDataSource**](https://msdn.microsoft.com/library/windows/apps/dn636983)\n\n    Configure the **UriFormatString** to use to request the tiles by inserting replaceable parameters in the base Uri or filename.\n\n    The following example instantiates an [**HttpMapTileDataSource**](https://msdn.microsoft.com/library/windows/apps/dn636986). This example specifies the value of the [**UriFormatString**](https://msdn.microsoft.com/library/windows/apps/dn636992) in the constructor of the **HttpMapTileDataSource**.\n\n    ```cs\n        HttpMapTileDataSource dataSource = new HttpMapTileDataSource(\n          \"http://www.<web service name>.com/z={zoomlevel}&x={x}&y={y}\");\n    ```\n\n2.  Instantiate and configure a [**MapTileSource**](https://msdn.microsoft.com/library/windows/apps/dn637144). Specify the [**MapTileDataSource**](https://msdn.microsoft.com/library/windows/apps/dn637141) that you configured in the previous step as the [**DataSource**](https://msdn.microsoft.com/library/windows/apps/dn637149) of the **MapTileSource**.\n\n    The following example specifies the [**DataSource**](https://msdn.microsoft.com/library/windows/apps/dn637149) in the constructor of the [**MapTileSource**](https://msdn.microsoft.com/library/windows/apps/dn637144).\n\n    ```cs\n        MapTileSource tileSource = new MapTileSource(dataSource);\n    ```\n\n    You can restrict the conditions in which the tiles are displayed by using properties of the [**MapTileSource**](https://msdn.microsoft.com/library/windows/apps/dn637144).\n\n    -   Display tiles only within a specific geographic area by providing a value for the [**Bounds**](https://msdn.microsoft.com/library/windows/apps/dn637147) property.\n    -   Display tiles only at certain levels of detail by providing a value for the [**ZoomLevelRange**](https://msdn.microsoft.com/library/windows/apps/dn637171) property.\n\n    Optionally, configure other properties of the [**MapTileSource**](https://msdn.microsoft.com/library/windows/apps/dn637144) that affect the loading or the display of the tiles, such as [**Layer**](https://msdn.microsoft.com/library/windows/apps/dn637157), [**AllowOverstretch**](https://msdn.microsoft.com/library/windows/apps/dn637145), [**IsRetryEnabled**](https://msdn.microsoft.com/library/windows/apps/dn637153), and [**IsTransparencyEnabled**](https://msdn.microsoft.com/library/windows/apps/dn637155).\n\n3.  Add the [**MapTileSource**](https://msdn.microsoft.com/library/windows/apps/dn637144) to the [**TileSources**](https://msdn.microsoft.com/library/windows/apps/dn637053) collection of the [**MapControl**](https://msdn.microsoft.com/library/windows/apps/dn637004).\n\n    ```cs\n         MapControl1.TileSources.Add(tileSource);\n    ```\n\n## Overlay tiles from a web service\n\n\nOverlay tiled images retrieved from a web service by using the [**HttpMapTileDataSource**](https://msdn.microsoft.com/library/windows/apps/dn636986).\n\n1.  Instantiate an [**HttpMapTileDataSource**](https://msdn.microsoft.com/library/windows/apps/dn636986).\n2.  Specify the format of the Uri that the web service expects as the value of the [**UriFormatString**](https://msdn.microsoft.com/library/windows/apps/dn636992) property. To create this value, insert replaceable parameters in the base Uri. For example, in the following code sample, the value of the **UriFormatString** is:\n\n    ``` syntax\n        http://www.<web service name>.com/z={zoomlevel}&x={x}&y={y}\n    ```\n\n    The web service has to support a Uri that contains the replaceable parameters {x}, {y}, and {zoomlevel}. Most web services (for example, Nokia, Bing, and Google) support Uris in this format. If the web service requires additional arguments that aren't available with the [**UriFormatString**](https://msdn.microsoft.com/library/windows/apps/dn636992) property, then you have to create a custom Uri. Create and return a custom Uri by handling the [**UriRequested**](https://msdn.microsoft.com/library/windows/apps/dn636993) event. For more info, see the [Provide a custom URI](#customuri) section later in this topic.\n\n3.  Then, follow the remaining steps described previously in the [Tiled image overview](#tileintro).\n\nThe following example overlays tiles from a fictitious web service on a map of North America. The value of the [**UriFormatString**](https://msdn.microsoft.com/library/windows/apps/dn636992) is specified in the constructor of the [**HttpMapTileDataSource**](https://msdn.microsoft.com/library/windows/apps/dn636986). In this example, tiles are only displayed within the geographic boundaries specified by the optional [**Bounds**](https://msdn.microsoft.com/library/windows/apps/dn637147) property.\n\n> [!div class=\"tabbedCodeSnippets\"]\n```csharp\n        private void AddHttpMapTileSource()\n        {\n            // Create the bounding box in which the tiles are displayed.\n            // This example represents North America.\n            BasicGeoposition northWestCorner =\n                new BasicGeoposition() { Latitude = 48.38544, Longitude = -124.667360 };\n            BasicGeoposition southEastCorner =\n                new BasicGeoposition() { Latitude = 25.26954, Longitude = -80.30182 };\n            GeoboundingBox boundingBox = new GeoboundingBox(northWestCorner, southEastCorner);\n\n            // Create an HTTP data source.\n            // This example retrieves tiles from a fictitious web service.\n            HttpMapTileDataSource dataSource = new HttpMapTileDataSource(\n                \"http://www.<web service name>.com/z={zoomlevel}&x={x}&y={y}\");\n\n            // Optionally, add custom HTTP headers if the web service requires them.\n            dataSource.AdditionalRequestHeaders.Add(\"header name\", \"header value\");\n\n            // Create a tile source and add it to the Map control.\n            MapTileSource tileSource = new MapTileSource(dataSource);\n            tileSource.Bounds = boundingBox;\n            MapControl1.TileSources.Add(tileSource);\n        }\n```\n```cpp\nvoid MainPage::AddHttpMapTileSource()\n{\n       BasicGeoposition northWest = { 48.38544, -124.667360 };\n       BasicGeoposition southEast = { 25.26954, -80.30182 };\n       GeoboundingBox^ boundingBox = ref new GeoboundingBox(northWest, southEast);\n\n       auto dataSource = ref new Windows::UI::Xaml::Controls::Maps::HttpMapTileDataSource(\n             \"http://www.<web service name>.com/z={zoomlevel}&x={x}&y={y}\");\n\n       dataSource->AdditionalRequestHeaders->Insert(\"header name\", \"header value\");\n\n       auto tileSource = ref new Windows::UI::Xaml::Controls::Maps::MapTileSource(dataSource);\n       tileSource->Bounds = boundingBox;\n\n       this->MapControl1->TileSources->Append(tileSource);\n}\n```\n\n## Overlay tiles from local storage\n\n\nOverlay tiled images stored as files in local storage by using the [**LocalMapTileDataSource**](https://msdn.microsoft.com/library/windows/apps/dn636994). Typically, you package and distribute these files with your app.\n\n1.  Instantiate a [**LocalMapTileDataSource**](https://msdn.microsoft.com/library/windows/apps/dn636994).\n2.  Specify the format of the file names as the value of the [**UriFormatString**](https://msdn.microsoft.com/library/windows/apps/dn636998) property. To create this value, insert replaceable parameters in the base filename. For example, in the following code sample, the value of the [**UriFormatString**](https://msdn.microsoft.com/library/windows/apps/dn636992) is:\n\n    ``` syntax\n        Tile_{zoomlevel}_{x}_{y}.png\n    ```\n\n    If the format of the file names requires additional arguments that aren't available with the [**UriFormatString**](https://msdn.microsoft.com/library/windows/apps/dn636998) property, then you have to create a custom Uri. Create and return a custom Uri by handling the [**UriRequested**](https://msdn.microsoft.com/library/windows/apps/dn637001) event. For more info, see the [Provide a custom URI](#customuri) section later in this topic.\n\n3.  Then, follow the remaining steps described previously in the [Tiled image overview](#tileintro).\n\nYou can use the following protocols and locations to load tiles from local storage:\n\n| Uri | More info |\n|---------------------|----------------------------------------------------------------------------------------------------------------------------------------------|\n| ms-appx:/// | Points to the root of the app's installation folder. |\n|  | This is the location referenced by the [Package.InstalledLocation](https://msdn.microsoft.com/library/windows/apps/br224681) property. |\n| ms-appdata:///local | Points to the root of the app's local storage. |\n|  | This is the location referenced by the [ApplicationData.LocalFolder](https://msdn.microsoft.com/library/windows/apps/br241621) property. |\n| ms-appdata:///temp | Points to the app's temp folder. |\n|  | This is the location referenced by the [ApplicationData.TemporaryFolder](https://msdn.microsoft.com/library/windows/apps/br241629) property. |\n\n \n\nThe following example loads tiles that are stored as files in the app's installation folder by using the `ms-appx:///` protocol. The value for the [**UriFormatString**](https://msdn.microsoft.com/library/windows/apps/dn636998) is specified in the constructor of the [**LocalMapTileDataSource**](https://msdn.microsoft.com/library/windows/apps/dn636994). In this example, tiles are only displayed when the zoom level of the map is within the range specified by the optional [**ZoomLevelRange**](https://msdn.microsoft.com/library/windows/apps/dn637171) property.\n\n```csharp\n        void AddLocalMapTileSource()\n        {\n            // Specify the range of zoom levels\n            // at which the overlaid tiles are displayed.\n            MapZoomLevelRange range;\n            range.Min = 11;\n            range.Max = 20;\n\n            // Create a local data source.\n            LocalMapTileDataSource dataSource = new LocalMapTileDataSource(\n                \"ms-appx:///TileSourceAssets/Tile_{zoomlevel}_{x}_{y}.png\");\n\n            // Create a tile source and add it to the Map control.\n            MapTileSource tileSource = new MapTileSource(dataSource);\n            tileSource.ZoomLevelRange = range;\n            MapControl1.TileSources.Add(tileSource);\n        }\n```\n\n## Provide a custom URI\n\n\nIf the replaceable parameters available with the [**UriFormatString**](https://msdn.microsoft.com/library/windows/apps/dn636992) property of the [**HttpMapTileDataSource**](https://msdn.microsoft.com/library/windows/apps/dn636986) or the [**UriFormatString**](https://msdn.microsoft.com/library/windows/apps/dn636998) property of the [**LocalMapTileDataSource**](https://msdn.microsoft.com/library/windows/apps/dn636994) aren't sufficient to retrieve your tiles, then you have to create a custom Uri. Create and return a custom Uri by providing a custom handler for the **UriRequested** event. The **UriRequested** event is raised for each individual tile.\n\n1.  In your custom handler for the **UriRequested** event, combine the required custom arguments with the [**X**](https://msdn.microsoft.com/library/windows/apps/dn610743), [**Y**](https://msdn.microsoft.com/library/windows/apps/dn610744), and [**ZoomLevel**](https://msdn.microsoft.com/library/windows/apps/dn610745) properties of the [**MapTileUriRequestedEventArgs**](https://msdn.microsoft.com/library/windows/apps/dn637177) to create the custom Uri.\n2.  Return the custom Uri in the [**Uri**](https://msdn.microsoft.com/library/windows/apps/dn610748) property of the [**MapTileUriRequest**](https://msdn.microsoft.com/library/windows/apps/dn637173), which is contained in the [**Request**](https://msdn.microsoft.com/library/windows/apps/dn637179) property of the [**MapTileUriRequestedEventArgs**](https://msdn.microsoft.com/library/windows/apps/dn637177).\n\nThe following example shows how to provide a custom Uri by creating a custom handler for the **UriRequested** event. It also shows how to implement the deferral pattern if you have to do something asynchronously to create the custom Uri.\n\n```csharp\nusing Windows.UI.Xaml.Controls.Maps;\nusing System.Threading.Tasks;\n...\n            var httpTileDataSource = new HttpMapTileDataSource();\n            // Attach a handler for the UriRequested event.\n            httpTileDataSource.UriRequested += HandleUriRequestAsync;\n            MapTileSource httpTileSource = new MapTileSource(httpTileDataSource);\n            MapControl1.TileSources.Add(httpTileSource);\n...\n        // Handle the UriRequested event.\n        private async void HandleUriRequestAsync(HttpMapTileDataSource sender,\n            MapTileUriRequestedEventArgs args)\n        {\n            // Get a deferral to do something asynchronously.\n            // Omit this line if you don't have to do something asynchronously.\n            var deferral = args.Request.GetDeferral();\n\n            // Get the custom Uri.\n            var uri = await GetCustomUriAsync(args.X, args.Y, args.ZoomLevel);\n\n            // Specify the Uri in the Uri property of the MapTileUriRequest.\n            args.Request.Uri = uri;\n\n            // Notify the app that the custom Uri is ready.\n            // Omit this line also if you don't have to do something asynchronously.\n            deferral.Complete();\n        }\n\n        // Create the custom Uri.\n        private async Task<Uri> GetCustomUriAsync(int x, int y, int zoomLevel)\n        {\n            // Do something asynchronously to create and return the custom Uri.        }\n        }\n```\n\n## Overlay tiles from a custom source\n\n\nOverlay custom tiles by using the [**CustomMapTileDataSource**](https://msdn.microsoft.com/library/windows/apps/dn636983). Create tiles programmatically in memory on the fly, or write your own code to load existing tiles from another source.\n\nTo create or load custom tiles, provide a custom handler for the [**BitmapRequested**](https://msdn.microsoft.com/library/windows/apps/dn636984) event. The **BitmapRequested** event is raised for each individual tile.\n\n1.  In your custom handler for the [**BitmapRequested**](https://msdn.microsoft.com/library/windows/apps/dn636984) event, combine the required custom arguments with the [**X**](https://msdn.microsoft.com/library/windows/apps/dn637135), [**Y**](https://msdn.microsoft.com/library/windows/apps/dn637136), and [**ZoomLevel**](https://msdn.microsoft.com/library/windows/apps/dn637137) properties of the [**MapTileBitmapRequestedEventArgs**](https://msdn.microsoft.com/library/windows/apps/dn637132) to create or retrieve a custom tile.\n2.  Return the custom tile in the [**PixelData**](https://msdn.microsoft.com/library/windows/apps/dn637140) property of the [**MapTileBitmapRequest**](https://msdn.microsoft.com/library/windows/apps/dn637128), which is contained in the [**Request**](https://msdn.microsoft.com/library/windows/apps/dn637134) property of the [**MapTileBitmapRequestedEventArgs**](https://msdn.microsoft.com/library/windows/apps/dn637132). The **PixelData** property is of type [**IRandomAccessStreamReference**](https://msdn.microsoft.com/library/windows/apps/hh701664).\n\nThe following example shows how to provide custom tiles by creating a custom handler for the **BitmapRequested** event. This example creates identical red tiles that are partially opaque. The example ignores the [**X**](https://msdn.microsoft.com/library/windows/apps/dn637135), [**Y**](https://msdn.microsoft.com/library/windows/apps/dn637136), and [**ZoomLevel**](https://msdn.microsoft.com/library/windows/apps/dn637137) properties of the [**MapTileBitmapRequestedEventArgs**](https://msdn.microsoft.com/library/windows/apps/dn637132). Although this is not a real world example, the example demonstrates how you can create in-memory custom tiles on the fly. The example also shows how to implement the deferral pattern if you have to do something asynchronously to create the custom tiles.\n\n```csharp\nusing Windows.UI.Xaml.Controls.Maps;\nusing Windows.Storage.Streams;\nusing System.Threading.Tasks;\n...\n        CustomMapTileDataSource customDataSource = new CustomMapTileDataSource();\n        // Attach a handler for the BitmapRequested event.\n        customDataSource.BitmapRequested += customDataSource_BitmapRequestedAsync;\n        customTileSource = new MapTileSource(customDataSource);\n        MapControl1.TileSources.Add(customTileSource);\n...\n        // Handle the BitmapRequested event.\n        private async void customDataSource_BitmapRequestedAsync(\n            CustomMapTileDataSource sender,\n            MapTileBitmapRequestedEventArgs args)\n        {\n            var deferral = args.Request.GetDeferral();\n            args.Request.PixelData = await CreateBitmapAsStreamAsync();\n            deferral.Complete();\n        }\n\n        // Create the custom tiles.\n        // This example creates red tiles that are partially opaque.\n        private async Task<RandomAccessStreamReference> CreateBitmapAsStreamAsync()\n        {\n            int pixelHeight = 256;\n            int pixelWidth = 256;\n            int bpp = 4;\n\n            byte[] bytes = new byte[pixelHeight * pixelWidth * bpp];\n\n            for (int y = 0; y < pixelHeight; y++)\n            {\n                for (int x = 0; x < pixelWidth; x++)\n                {\n                    int pixelIndex = y * pixelWidth + x;\n                    int byteIndex = pixelIndex * bpp;\n\n                    // Set the current pixel bytes.\n                    bytes[byteIndex] = 0xff;        // Red\n                    bytes[byteIndex + 1] = 0x00;    // Green\n                    bytes[byteIndex + 2] = 0x00;    // Blue\n                    bytes[byteIndex + 3] = 0x80;    // Alpha (0xff = fully opaque)\n                }\n            }\n\n            // Create RandomAccessStream from byte array.\n            InMemoryRandomAccessStream randomAccessStream =\n                new InMemoryRandomAccessStream();\n            IOutputStream outputStream = randomAccessStream.GetOutputStreamAt(0);\n            DataWriter writer = new DataWriter(outputStream);\n            writer.WriteBytes(bytes);\n            await writer.StoreAsync();\n            await writer.FlushAsync();\n            return RandomAccessStreamReference.CreateFromStream(randomAccessStream);\n        }\n```\n\n```cpp\nInMemoryRandomAccessStream^ TileSources::CustomRandomAccessSteram::get()\n{\n       int pixelHeight = 256;\n       int pixelWidth = 256;\n       int bpp = 4;\n \n       Array<byte>^ bytes = ref new Array<byte>(pixelHeight * pixelWidth * bpp);\n       \n       for (int y = 0; y < pixelHeight; y++)\n       {\n              for (int x = 0; x < pixelWidth; x++)\n              {\n                     int pixelIndex = y * pixelWidth + x;\n                     int byteIndex = pixelIndex * bpp;\n \n                     // Set the current pixel bytes.\n                     bytes[byteIndex] = (byte)(std::rand() % 256);        // Red\n                     bytes[byteIndex + 1] = (byte)(std::rand() % 256);    // Green\n                     bytes[byteIndex + 2] = (byte)(std::rand() % 256);    // Blue\n                     bytes[byteIndex + 3] = (byte)((std::rand() % 56) + 200);    // Alpha (0xff = fully opaque)\n              }\n       }\n \n       // Create RandomAccessStream from byte array.\n       InMemoryRandomAccessStream^ randomAccessStream = ref new InMemoryRandomAccessStream();\n       IOutputStream^ outputStream = randomAccessStream->GetOutputStreamAt(0);\n       DataWriter^ writer = ref new DataWriter(outputStream);\n       writer->WriteBytes(bytes);\n \n       create_task(writer->StoreAsync()).then([writer](unsigned int)\n       {\n              create_task(writer->FlushAsync());\n       });\n \n       return randomAccessStream;\n}\n```\n\n## Replace the default map\n\n\nTo replace the default map entirely with third-party or custom tiles:\n\n-   Specify [**MapTileLayer**](https://msdn.microsoft.com/library/windows/apps/dn637143).**BackgroundReplacement** as the value of the [**Layer**](https://msdn.microsoft.com/library/windows/apps/dn637157) property of the [**MapTileSource**](https://msdn.microsoft.com/library/windows/apps/dn637144).\n-   Specify [**MapStyle**](https://msdn.microsoft.com/library/windows/apps/dn637127).**None** as the value of the [**Style**](https://msdn.microsoft.com/library/windows/apps/dn637051) property of the [**MapControl**](https://msdn.microsoft.com/library/windows/apps/dn637004).\n\n## Related topics\n\n* [Bing Maps Developer Center](https://www.bingmapsportal.com/)\n* [UWP map sample](http://go.microsoft.com/fwlink/p/?LinkId=619977)\n* [Design guidelines for maps](https://msdn.microsoft.com/library/windows/apps/dn596102)\n* [Build 2015 video: Leveraging Maps and Location Across Phone, Tablet, and PC in Your Windows Apps](https://channel9.msdn.com/Events/Build/2015/2-757)\n* [UWP traffic app sample](http://go.microsoft.com/fwlink/p/?LinkId=619982)\n\n"}