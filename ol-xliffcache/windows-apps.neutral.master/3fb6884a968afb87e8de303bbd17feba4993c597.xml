{"nodes":[{"content":"Guidelines for background tasks","pos":[29,60]},{"content":"Ensure your app meets the requirements for running background tasks.","pos":[74,142]},{"content":"Guidelines for background tasks","pos":[199,230]},{"content":"Updated for UWP apps on Windows 10.","pos":[236,271]},{"content":"For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept>","pos":[272,364]},{"content":"Ensure your app meets the requirements for running background tasks.","pos":[370,438]},{"content":"Background task guidance","pos":[443,467]},{"content":"Consider the following guidance when developing your background task, and before publishing your app.","pos":[470,571]},{"content":"<bpt id=\"p1\">**</bpt>CPU quotas:  <ept id=\"p1\">**</ept>Background tasks are limited by the amount of wall-clock usage time they get based on trigger type.","pos":[573,689]},{"content":"Most triggers are limited to 30 seconds of wall-clock usage, while some have the ability to run up to 10 minutes in order to complete intensive tasks.","pos":[690,840]},{"content":"Background tasks should be lightweight to save battery life and provide a better user experience for foreground apps.","pos":[841,958]},{"content":"See <bpt id=\"p1\">[</bpt>Support your app with background tasks<ept id=\"p1\">](support-your-app-with-background-tasks.md)</ept> for the resource constraints applied to background tasks.","pos":[959,1104]},{"content":"<bpt id=\"p1\">**</bpt>Manage background tasks:  <ept id=\"p1\">**</ept>Your app should get a list of registered background tasks, register for progress and completion handlers, and handle those events appropriately.","pos":[1106,1280]},{"content":"Your background task classes should report progress, cancellation, and completion.","pos":[1281,1363]},{"content":"For more info see <bpt id=\"p1\">[</bpt>Handle a cancelled background task<ept id=\"p1\">](handle-a-cancelled-background-task.md)</ept>, and <bpt id=\"p2\">[</bpt>Monitor background task progress and completion<ept id=\"p2\">](monitor-background-task-progress-and-completion.md)</ept>.","pos":[1364,1565]},{"content":"<bpt id=\"p1\">**</bpt>Use <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>BackgroundTaskDeferral<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/hh700499)</ept>:  <ept id=\"p1\">**</ept>If your background task class runs asynchronous code, make sure to use deferrals.","pos":[1567,1745]},{"content":"Otherwise your background task may be terminated prematurely when the <bpt id=\"p1\">[</bpt>Run<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/windows.applicationmodel.background.ibackgroundtask.run.aspx)</ept> method completes.","pos":[1746,1949]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Create and register a background task<ept id=\"p1\">](create-and-register-a-background-task.md)</ept>.","pos":[1950,2058]},{"content":"Alternatively, request one deferral, and use <bpt id=\"p1\">**</bpt>async/await<ept id=\"p1\">**</ept> to complete asynchronous method calls.","pos":[2060,2159]},{"content":"Close the deferral after the <bpt id=\"p1\">**</bpt>await<ept id=\"p1\">**</ept> method calls.","pos":[2160,2212]},{"content":"<bpt id=\"p1\">**</bpt>Update the app manifest:  <ept id=\"p1\">**</ept>Declare each background task in the application manifest, along with the type of triggers it is used with.","pos":[2214,2350]},{"content":"Otherwise your app will not be able to register the background task at runtime.","pos":[2351,2430]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Declare background tasks in the application manifest<ept id=\"p1\">](declare-background-tasks-in-the-application-manifest.md)</ept>.","pos":[2431,2569]},{"pos":[2571,2877],"content":"<bpt id=\"p1\">**</bpt>Prepare for app updates:  <ept id=\"p1\">**</ept>If your app will be updated, create and register a <bpt id=\"p2\">**</bpt>ServicingComplete<ept id=\"p2\">**</ept> background task (see <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>SystemTriggerType<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br224839)</ept>) to help perform app updates that may be necessary outside the context of running in the foreground."},{"content":"Request to execute background tasks:","pos":[2881,2917]},{"pos":[2925,3050],"content":"<bpt id=\"p1\">**</bpt>Important<ept id=\"p1\">**</ept>  Starting in Windows 10, apps are no longer required to be on the lock screen in order to run background tasks."},{"content":"Universal Windows Platform (UWP) apps can run all supported task types without being pinned to the lock screen.","pos":[3052,3163]},{"content":"However, apps must call <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>RequestAccessAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh700485)</ept> before registering any type of background task.","pos":[3164,3318]},{"content":"This method will return <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>BackgroundAccessStatus.Denied<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh700439)</ept> if the user has explicitly denied background task permissions for your app in the device's settings.","pos":[3319,3537]},{"content":"Background task checklist","pos":[3541,3566]},{"content":"The following checklist applies to all background tasks.","pos":[3569,3625]},{"content":"Create your background task in a Windows Runtime Component.","pos":[3631,3690]},{"content":"Associate your background task with the correct trigger.","pos":[3695,3751]},{"content":"Add conditions to help ensure your background task runs successfully.","pos":[3756,3825]},{"content":"Handle background task progress, completion, and cancellation.","pos":[3830,3892]},{"content":"Do not display UI other than toasts, tiles, and badge updates from the background task.","pos":[3897,3984]},{"content":"In the <bpt id=\"p1\">[</bpt>Run<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/windows.applicationmodel.background.ibackgroundtask.run.aspx)</ept> method, request deferrals for each asynchronous method call, and close them when the method is done.","pos":[3989,4212]},{"content":"Or, use one deferral with <bpt id=\"p1\">**</bpt>async/await<ept id=\"p1\">**</ept>.","pos":[4213,4255]},{"content":"Use persistent storage to share data between the background task and the app.","pos":[4260,4337]},{"content":"Declare each background task in the application manifest, along with the type of triggers it is used with.","pos":[4342,4448]},{"content":"Make sure the entry point and trigger types are correct.","pos":[4449,4505]},{"content":"Write background tasks that are short-lived.","pos":[4510,4554]},{"content":"Background tasks are limited to 30 seconds of wall-clock usage.","pos":[4555,4618]},{"content":"Do not rely on user interaction in background tasks.","pos":[4623,4675]},{"content":"Re-register your background tasks during app launch.","pos":[4680,4732]},{"content":"This ensures that they are registered the first time the app is launched.","pos":[4733,4806]},{"content":"It also provides a way to detect whether the user has disabled your app's background execution capabilities (in the event registration fails).","pos":[4807,4949]},{"pos":[4954,5188],"content":"Do not specify an Executable element in the manifest unless you are using a trigger that should be run in the same context as the app (such as the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ControlChannelTrigger<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh701032)</ept>)."},{"content":"Check for background task registration errors.","pos":[5193,5239]},{"content":"If appropriate, attempt to register the background task again with different parameter values.","pos":[5240,5334]},{"content":"For all device families except desktop, if the device becomes low on memory, background tasks may be terminated.","pos":[5339,5451]},{"content":"If an out of memory exception is not surfaced, or the app does not handle it, then the background task will be terminated without warning and without raising the OnCanceled event.","pos":[5452,5631]},{"content":"This helps to ensure the user experience of the app in the foreground.","pos":[5632,5702]},{"content":"Your background task should be designed to handle this scenario.","pos":[5703,5767]},{"content":"Windows: Background task checklist for lock screen-capable apps","pos":[5772,5835]},{"content":"Follow this guidance when developing background tasks for apps that are capable of being on the lock screen.","pos":[5838,5946]},{"content":"Follow the guidance in <bpt id=\"p1\">[</bpt>Guidelines and checklist for lock screen tiles<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh465403)</ept>.","pos":[5947,6077]},{"content":"Make sure your app needs to be on the lock screen before developing it as lock screen-capable.","pos":[6083,6177]},{"content":"For more info see <bpt id=\"p1\">[</bpt>Lock screen overview<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh779720)</ept>.","pos":[6178,6277]},{"content":"Make sure your app will still work without being on the lock screen.","pos":[6283,6351]},{"content":"Include a background task registered with <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>PushNotificationTrigger<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh700543)</ept>, <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>ControlChannelTrigger<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/hh701032)</ept>, or <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>TimeTrigger<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/br224843)</ept> and declare it in the app manifest.","pos":[6357,6689]},{"content":"Make sure the entry point and trigger types are correct.","pos":[6690,6746]},{"content":"This is required for certification, and enables the user to place the app on the lock screen.","pos":[6747,6840]},{"content":"Note","pos":[6844,6848]},{"content":"This article is for Windows 10 developers writing Universal Windows Platform (UWP) apps.","pos":[6853,6941]},{"content":"If you’re developing for Windows 8.x or Windows Phone 8.x, see the <bpt id=\"p1\">[</bpt>archived documentation<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept>.","pos":[6942,7083]},{"content":"Related topics","pos":[7091,7105]},{"content":"Create and register a background task","pos":[7110,7147]},{"content":"Declare background tasks in the application manifest","pos":[7194,7246]},{"content":"Handle a cancelled background task","pos":[7308,7342]},{"content":"Monitor background task progress and completion","pos":[7386,7433]},{"content":"Register a background task","pos":[7490,7516]},{"content":"Respond to system events with background tasks","pos":[7552,7598]},{"content":"Set conditions for running a background task","pos":[7654,7698]},{"content":"Update a live tile from a background task","pos":[7752,7793]},{"content":"Use a maintenance trigger","pos":[7844,7869]},{"content":"Run a background task on a timer","pos":[7904,7936]},{"content":"Debug a background task","pos":[7979,8002]},{"content":"How to trigger suspend, resume, and background events in Windows Store apps (when debugging)","pos":[8035,8127]}],"content":"---\nauthor: TylerMSFT\ntitle: Guidelines for background tasks\ndescription: Ensure your app meets the requirements for running background tasks.\nms.assetid: 18FF1104-1F73-47E1-9C7B-E2AA036C18ED\n---\n\n# Guidelines for background tasks\n\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\n\nEnsure your app meets the requirements for running background tasks.\n\n## Background task guidance\n\n\nConsider the following guidance when developing your background task, and before publishing your app.\n\n**CPU quotas:  **Background tasks are limited by the amount of wall-clock usage time they get based on trigger type. Most triggers are limited to 30 seconds of wall-clock usage, while some have the ability to run up to 10 minutes in order to complete intensive tasks. Background tasks should be lightweight to save battery life and provide a better user experience for foreground apps. See [Support your app with background tasks](support-your-app-with-background-tasks.md) for the resource constraints applied to background tasks.\n\n**Manage background tasks:  **Your app should get a list of registered background tasks, register for progress and completion handlers, and handle those events appropriately. Your background task classes should report progress, cancellation, and completion. For more info see [Handle a cancelled background task](handle-a-cancelled-background-task.md), and [Monitor background task progress and completion](monitor-background-task-progress-and-completion.md).\n\n**Use [**BackgroundTaskDeferral**](https://msdn.microsoft.com/library/windows/apps/hh700499):  **If your background task class runs asynchronous code, make sure to use deferrals. Otherwise your background task may be terminated prematurely when the [Run](https://msdn.microsoft.com/library/windows/apps/windows.applicationmodel.background.ibackgroundtask.run.aspx) method completes. For more information, see [Create and register a background task](create-and-register-a-background-task.md).\n\nAlternatively, request one deferral, and use **async/await** to complete asynchronous method calls. Close the deferral after the **await** method calls.\n\n**Update the app manifest:  **Declare each background task in the application manifest, along with the type of triggers it is used with. Otherwise your app will not be able to register the background task at runtime. For more information, see [Declare background tasks in the application manifest](declare-background-tasks-in-the-application-manifest.md).\n\n**Prepare for app updates:  **If your app will be updated, create and register a **ServicingComplete** background task (see [**SystemTriggerType**](https://msdn.microsoft.com/library/windows/apps/br224839)) to help perform app updates that may be necessary outside the context of running in the foreground.\n\n**Request to execute background tasks:  **\n\n> **Important**  Starting in Windows 10, apps are no longer required to be on the lock screen in order to run background tasks.\n\nUniversal Windows Platform (UWP) apps can run all supported task types without being pinned to the lock screen. However, apps must call [**RequestAccessAsync**](https://msdn.microsoft.com/library/windows/apps/hh700485) before registering any type of background task. This method will return [**BackgroundAccessStatus.Denied**](https://msdn.microsoft.com/library/windows/apps/hh700439) if the user has explicitly denied background task permissions for your app in the device's settings.\n## Background task checklist\n\n\nThe following checklist applies to all background tasks.\n\n-   Create your background task in a Windows Runtime Component.\n-   Associate your background task with the correct trigger.\n-   Add conditions to help ensure your background task runs successfully.\n-   Handle background task progress, completion, and cancellation.\n-   Do not display UI other than toasts, tiles, and badge updates from the background task.\n-   In the [Run](https://msdn.microsoft.com/library/windows/apps/windows.applicationmodel.background.ibackgroundtask.run.aspx) method, request deferrals for each asynchronous method call, and close them when the method is done. Or, use one deferral with **async/await**.\n-   Use persistent storage to share data between the background task and the app.\n-   Declare each background task in the application manifest, along with the type of triggers it is used with. Make sure the entry point and trigger types are correct.\n-   Write background tasks that are short-lived. Background tasks are limited to 30 seconds of wall-clock usage.\n-   Do not rely on user interaction in background tasks.\n-   Re-register your background tasks during app launch. This ensures that they are registered the first time the app is launched. It also provides a way to detect whether the user has disabled your app's background execution capabilities (in the event registration fails).\n-   Do not specify an Executable element in the manifest unless you are using a trigger that should be run in the same context as the app (such as the [**ControlChannelTrigger**](https://msdn.microsoft.com/library/windows/apps/hh701032)).\n-   Check for background task registration errors. If appropriate, attempt to register the background task again with different parameter values.\n-   For all device families except desktop, if the device becomes low on memory, background tasks may be terminated. If an out of memory exception is not surfaced, or the app does not handle it, then the background task will be terminated without warning and without raising the OnCanceled event. This helps to ensure the user experience of the app in the foreground. Your background task should be designed to handle this scenario.\n\n## Windows: Background task checklist for lock screen-capable apps\n\n\nFollow this guidance when developing background tasks for apps that are capable of being on the lock screen. Follow the guidance in [Guidelines and checklist for lock screen tiles](https://msdn.microsoft.com/library/windows/apps/hh465403).\n\n-   Make sure your app needs to be on the lock screen before developing it as lock screen-capable. For more info see [Lock screen overview](https://msdn.microsoft.com/library/windows/apps/hh779720).\n\n-   Make sure your app will still work without being on the lock screen.\n\n-   Include a background task registered with [**PushNotificationTrigger**](https://msdn.microsoft.com/library/windows/apps/hh700543), [**ControlChannelTrigger**](https://msdn.microsoft.com/library/windows/apps/hh701032), or [**TimeTrigger**](https://msdn.microsoft.com/library/windows/apps/br224843) and declare it in the app manifest. Make sure the entry point and trigger types are correct. This is required for certification, and enables the user to place the app on the lock screen.\n\n**Note**  \nThis article is for Windows 10 developers writing Universal Windows Platform (UWP) apps. If you’re developing for Windows 8.x or Windows Phone 8.x, see the [archived documentation](http://go.microsoft.com/fwlink/p/?linkid=619132).\n\n \n\n## Related topics\n\n* [Create and register a background task](create-and-register-a-background-task.md)\n* [Declare background tasks in the application manifest](declare-background-tasks-in-the-application-manifest.md)\n* [Handle a cancelled background task](handle-a-cancelled-background-task.md)\n* [Monitor background task progress and completion](monitor-background-task-progress-and-completion.md)\n* [Register a background task](register-a-background-task.md)\n* [Respond to system events with background tasks](respond-to-system-events-with-background-tasks.md)\n* [Set conditions for running a background task](set-conditions-for-running-a-background-task.md)\n* [Update a live tile from a background task](update-a-live-tile-from-a-background-task.md)\n* [Use a maintenance trigger](use-a-maintenance-trigger.md)\n* [Run a background task on a timer](run-a-background-task-on-a-timer-.md)\n* [Debug a background task](debug-a-background-task.md)\n* [How to trigger suspend, resume, and background events in Windows Store apps (when debugging)](http://go.microsoft.com/fwlink/p/?linkid=254345)\n\n \n\n \n"}