{"nodes":[{"content":"Provide deep links from the background app service in Cortana to launch the app to the foreground in a specific state or context.","pos":[47,176]},{"content":"Deep link from Cortana to a background app","pos":[184,226]},{"content":"Deep link from Cortana to a background app","pos":[341,383]},{"content":"Important APIs","pos":[388,402]},{"content":"Windows.ApplicationModel.VoiceCommands","pos":[413,451]},{"content":"Voice Command Definition (VCD) elements and attributes v1.2","pos":[520,579]},{"pos":[642,767],"content":"Provide deep links from a background app in <bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> that launch the app to the foreground in a specific state or context."},{"content":"Note","pos":[773,777]},{"content":"Both <bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> and the background app service are terminated when the foreground app is launched.","pos":[782,881]},{"pos":[883,1052],"content":"A deep link is displayed by default on the <bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> completion screen as shown here (\"Go to AdventureWorks\"), but you can display deep links on various other screens."},{"content":"cortana background app completion screen","pos":[1057,1097]},{"content":"Prerequisites:","pos":[1159,1173]},{"content":"This topic builds on <bpt id=\"p1\">[</bpt>Interact with a background app in Cortana<ept id=\"p1\">](interact-with-a-background-app-in-cortana.md)</ept>.","pos":[1179,1290]},{"content":"We continue using a trip planning and management app named <bpt id=\"p1\">**</bpt>Adventure Works<ept id=\"p1\">**</ept> to demonstrate various <bpt id=\"p2\">**</bpt>Cortana<ept id=\"p2\">**</ept> features.","pos":[1291,1414]},{"content":"If you're new to developing Universal Windows Platform (UWP) apps, have a look through these topics to get familiar with the technologies discussed here.","pos":[1416,1569]},{"content":"Create your first app","pos":[1576,1597]},{"pos":[1661,1778],"content":"Learn about events with <bpt id=\"p1\">[</bpt>Events and routed events overview<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/mt185584)</ept>"},{"content":"User experience guidelines:","pos":[1782,1809]},{"pos":[1815,2123],"content":"See <bpt id=\"p1\">[</bpt>Cortana design guidelines<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn974233)</ept> for info about how to integrate your app with <bpt id=\"p2\">**</bpt>Cortana<ept id=\"p2\">**</ept> and <bpt id=\"p3\">[</bpt>Speech design guidelines<ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn596121)</ept> for helpful tips on designing a useful and engaging speech-enabled app."},{"pos":[2209,2217],"content":"Overview"},{"pos":[2220,2269],"content":"Users can access your app through <bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> by:"},{"pos":[2275,2438],"content":"Activating it as a foreground app (see <bpt id=\"p1\">[</bpt>Activate a foreground app with voice commands through Cortana<ept id=\"p1\">](launch-a-foreground-app-with-voice-commands-in-cortana.md)</ept>)."},{"pos":[2443,2632],"content":"Exposing specific functionality as a background app service (see <bpt id=\"p1\">[</bpt>Activate a background app with voice commands through Cortana<ept id=\"p1\">](launch-a-background-app-with-voice-commands-in-cortana.md)</ept>)."},{"content":"Deep linking to specific pages, content, and state or context.","pos":[2637,2699]},{"content":"We discuss deep linking here.","pos":[2701,2730]},{"content":"Deep linking is useful when Cortana and your app service act as a gateway to your full-featured app (instead of requiring the user to launch the app through the Start menu), or for providing access to richer detail and functionality within your app that is not possible through Cortana.","pos":[2732,3018]},{"content":"Deep linking is another way to increase usability and promote your app.","pos":[3019,3090]},{"content":"There are three ways to provide deep links:","pos":[3092,3135]},{"pos":[3141,3199],"content":"A \"Go to <ph id=\"ph1\">&amp;lt;</ph>app<ph id=\"ph2\">&amp;gt;</ph>\" link on various <bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> screens."},{"pos":[3204,3269],"content":"A link embedded in a content tile on various <bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> screens."},{"content":"Programmatically launching the foreground app from the background app service.","pos":[3274,3352]},{"pos":[3477,3506],"content":"\"Go to <ph id=\"ph1\">&amp;lt;</ph>app<ph id=\"ph2\">&amp;gt;</ph>\" deep link"},{"pos":[3509,3601],"content":"<bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> displays a \"Go to <ph id=\"ph1\">&amp;lt;</ph>app<ph id=\"ph2\">&amp;gt;</ph>\" deep link below the content card on most screens."},{"content":"cortana background app completion screen","pos":[3605,3645]},{"content":"You can provide a launch argument for this link that opens your app in similar context as the app service.","pos":[3686,3792]},{"content":"If you don't provide a launch argument, the app is launched to the main screen.","pos":[3793,3872]},{"pos":[3874,4145],"content":"In this example from AdventureWorksVoiceCommandService.cs of the <bpt id=\"p1\">**</bpt>AdventureWorks<ept id=\"p1\">**</ept> sample, we pass the specified destination (<ph id=\"ph1\">`destination`</ph>) string to the SendCompletionMessageForDestination method, which retrieves all matching trips and provides a deep link to the app."},{"content":"First, we create a  <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>VoiceCommandUserMessage<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/windows.applicationmodel.voicecommands.voicecommandusermessage.aspx)</ept> (<ph id=\"ph1\">```userMessage```</ph>) that is spoken by <bpt id=\"p3\">**</bpt>Cortana<ept id=\"p3\">**</ept> and shown on the <bpt id=\"p4\">**</bpt>Cortana<ept id=\"p4\">**</ept> canvas.","pos":[4147,4400]},{"content":"A <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>VoiceCommandContentTile<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/windows.applicationmodel.voicecommands.voicecommandcontenttile.aspx)</ept> list object is then created for displaying the collection of result cards on the canvas.","pos":[4401,4638]},{"content":"These two objects are then passed to the <bpt id=\"p1\">[</bpt>CreateResponse<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/windows.applicationmodel.voicecommands.voicecommandresponse.createresponse.aspx)</ept> method of the <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>VoiceCommandResponse<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/dn974182)</ept> object (<ph id=\"ph1\">`response`</ph>).","pos":[4641,4947]},{"content":"We then set the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>AppLaunchArgument<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn974183)</ept> property value of the response object to the value of <ph id=\"ph1\">`destination`</ph> passsed to this function.","pos":[4948,5139]},{"content":"When a user taps a content tile on the Cortana canvas, the parameter values are passed to the app through the response object.","pos":[5140,5266]},{"pos":[5268,5480],"content":"Finally, we call the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ReportSuccessAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn706580)</ept> method of the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>VoiceCommandServiceConnection<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn974204)</ept>."},{"pos":[6411,6433],"content":"Content tile deep link"},{"pos":[6436,6507],"content":"You can add deep links to content cards on various <bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> screens."},{"content":"cortana background app hand-off screen","pos":[6511,6549]},{"content":"Like the \"Go to <ph id=\"ph1\">&amp;lt;</ph>app<ph id=\"ph2\">&amp;gt;</ph>\" links, you can provide a launch argument to open your app with similar context as the app service.","pos":[6603,6730]},{"content":"If you don't provide a launch argument, the content tile does not link to your app.","pos":[6731,6814]},{"pos":[6816,7082],"content":"In this example from AdventureWorksVoiceCommandService.cs of the <bpt id=\"p1\">**</bpt>AdventureWorks<ept id=\"p1\">**</ept> sample, we pass the specified destination to the SendCompletionMessageForDestination method, which retrieves all matching trips and provides content cards with deep links to the app."},{"content":"First, we create a  <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>VoiceCommandUserMessage<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/windows.applicationmodel.voicecommands.voicecommandusermessage.aspx)</ept> (<ph id=\"ph1\">```userMessage```</ph>) that is spoken by <bpt id=\"p3\">**</bpt>Cortana<ept id=\"p3\">**</ept> and shown on the <bpt id=\"p4\">**</bpt>Cortana<ept id=\"p4\">**</ept> canvas.","pos":[7084,7337]},{"content":"A <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>VoiceCommandContentTile<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/windows.applicationmodel.voicecommands.voicecommandcontenttile.aspx)</ept> list object is then created for displaying the collection of result cards on the canvas.","pos":[7338,7575]},{"content":"These two objects are then passed to the <bpt id=\"p1\">[</bpt>CreateResponse<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/windows.applicationmodel.voicecommands.voicecommandresponse.createresponse.aspx)</ept> method of the <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>VoiceCommandResponse<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/dn974182)</ept> object (<ph id=\"ph1\">```response```</ph>).","pos":[7578,7888]},{"content":"We then set the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>AppLaunchArgument<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn974183)</ept> property value to the value of the destination in the voice command.","pos":[7889,8055]},{"content":"Finally, we call the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ReportSuccessAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn706580)</ept> method of the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>VoiceCommandServiceConnection<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn974204)</ept>.","pos":[8057,8269]},{"content":"Here, we add two content tiles with different <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>AppLaunchArgument<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn974183)</ept> parameter values to a <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>VoiceCommandContentTile<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn974168)</ept> list used in the <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>ReportSuccessAsync<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/dn706580)</ept> call of the <bpt id=\"p7\">[</bpt><bpt id=\"p8\">**</bpt>VoiceCommandServiceConnection<ept id=\"p8\">**</ept><ept id=\"p7\">](https://msdn.microsoft.com/library/windows/apps/dn974204)</ept> object.","pos":[8270,8721]},{"pos":[12154,12176],"content":"Programmatic deep link"},{"content":"You can also programmatically launch your app with a launch argument to open your app with similar context as the app service.","pos":[12179,12305]},{"content":"If you don't provide a launch argument, the app is launched to the main screen.","pos":[12306,12385]},{"pos":[12387,12831],"content":"Here, we add an <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>AppLaunchArgument<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn974183)</ept> parameter with a value of \"Las Vegas\" to a <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>VoiceCommandResponse<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn974182)</ept> object used in the <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>RequestAppLaunchAsync<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/dn706581)</ept> call of the <bpt id=\"p7\">[</bpt><bpt id=\"p8\">**</bpt>VoiceCommandServiceConnection<ept id=\"p8\">**</ept><ept id=\"p7\">](https://msdn.microsoft.com/library/windows/apps/dn974204)</ept> object."},{"pos":[13292,13304],"content":"App manifest"},{"pos":[13307,13461],"content":"To enable deep linking to your app, you must declare the <ph id=\"ph1\">`windows.personalAssistantLaunch`</ph> extension in the Package.appxmanifest file of your app project."},{"pos":[13463,13560],"content":"Here, we declare the <ph id=\"ph1\">`windows.personalAssistantLaunch`</ph> extension for the <bpt id=\"p1\">**</bpt>Adventure Works<ept id=\"p1\">**</ept> app."},{"pos":[13986,14003],"content":"Protocol contract"},{"content":"Your app is launched to the foreground through Uniform Resource Identifier (URI) activation using a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Protocol<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br224693)</ept> contract.","pos":[14006,14188]},{"content":"Your app must override your app's <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>OnActivated<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br242330)</ept> event and check for an <bpt id=\"p3\">**</bpt>ActivationKind<ept id=\"p3\">**</ept> of <bpt id=\"p4\">**</bpt>Protocol<ept id=\"p4\">**</ept>.","pos":[14189,14357]},{"content":"For more info, see <bpt id=\"p1\">[</bpt>Handle URI activation<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/mt228339)</ept>.","pos":[14358,14459]},{"content":"Here, we decode the URI provided by the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ProtocolActivatedEventArgs<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br224742)</ept> to access the launch argument.","pos":[14461,14622]},{"content":"For this example, the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Uri<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br224746)</ept> is set to \"windows.personalassistantlaunch:?LaunchContext=Las Vegas\".","pos":[14623,14782]},{"pos":[15466,15482],"content":"Related articles"},{"content":"Developers","pos":[15487,15497]},{"content":"Cortana interactions","pos":[15503,15523]},{"content":"VCD elements and attributes v1.2","pos":[15555,15587]},{"content":"Designers","pos":[15652,15661]},{"content":"Cortana design guidelines","pos":[15667,15692]},{"content":"Speech design guidelines","pos":[15755,15779]},{"content":"Samples","pos":[15842,15849]},{"content":"Cortana voice command sample","pos":[15855,15883]}],"content":"---\nauthor: Karl-Bridge-Microsoft\nDescription: Provide deep links from the background app service in Cortana to launch the app to the foreground in a specific state or context.\ntitle: Deep link from Cortana to a background app\nms.assetid: BE811A87-8821-476A-90E4-2E20D37E4043\nlabel: Deep link to a background app\ntemplate: detail.hbs\n---\n\n# Deep link from Cortana to a background app\n\n\n**Important APIs**\n\n-   [**Windows.ApplicationModel.VoiceCommands**](https://msdn.microsoft.com/library/windows/apps/dn706594)\n-   [**Voice Command Definition (VCD) elements and attributes v1.2**](https://msdn.microsoft.com/library/windows/apps/dn706593)\n\nProvide deep links from a background app in **Cortana** that launch the app to the foreground in a specific state or context.\n\n> **Note**  \nBoth **Cortana** and the background app service are terminated when the foreground app is launched.\n\nA deep link is displayed by default on the **Cortana** completion screen as shown here (\"Go to AdventureWorks\"), but you can display deep links on various other screens. \n\n![cortana background app completion screen](images/cortana-completion-screen-upcomingtrip-small.png)\n\n**Prerequisites:  **\n\nThis topic builds on [Interact with a background app in Cortana](interact-with-a-background-app-in-cortana.md). We continue using a trip planning and management app named **Adventure Works** to demonstrate various **Cortana** features.\n\nIf you're new to developing Universal Windows Platform (UWP) apps, have a look through these topics to get familiar with the technologies discussed here.\n\n-   [Create your first app](https://msdn.microsoft.com/library/windows/apps/bg124288)\n-   Learn about events with [Events and routed events overview](https://msdn.microsoft.com/library/windows/apps/mt185584)\n\n**User experience guidelines:  **\n\nSee [Cortana design guidelines](https://msdn.microsoft.com/library/windows/apps/dn974233) for info about how to integrate your app with **Cortana** and [Speech design guidelines](https://msdn.microsoft.com/library/windows/apps/dn596121) for helpful tips on designing a useful and engaging speech-enabled app.\n\n## <span id=\"Overview\"></span><span id=\"overview\"></span><span id=\"OVERVIEW\"></span>Overview\n\n\nUsers can access your app through **Cortana** by:\n\n-   Activating it as a foreground app (see [Activate a foreground app with voice commands through Cortana](launch-a-foreground-app-with-voice-commands-in-cortana.md)).\n-   Exposing specific functionality as a background app service (see [Activate a background app with voice commands through Cortana](launch-a-background-app-with-voice-commands-in-cortana.md)).\n-   Deep linking to specific pages, content, and state or context.\n\nWe discuss deep linking here.\n\nDeep linking is useful when Cortana and your app service act as a gateway to your full-featured app (instead of requiring the user to launch the app through the Start menu), or for providing access to richer detail and functionality within your app that is not possible through Cortana. Deep linking is another way to increase usability and promote your app.\n\nThere are three ways to provide deep links:\n\n-   A \"Go to &lt;app&gt;\" link on various **Cortana** screens.\n-   A link embedded in a content tile on various **Cortana** screens.\n-   Programmatically launching the foreground app from the background app service.\n\n## <span id=\"Go_to__app__deep_link\"></span><span id=\"go_to__app__deep_link\"></span><span id=\"GO_TO__APP__DEEP_LINK\"></span>\"Go to &lt;app&gt;\" deep link\n\n\n**Cortana** displays a \"Go to &lt;app&gt;\" deep link below the content card on most screens.\n\n![cortana background app completion screen](images/cortana-completion-screen.png)\n\nYou can provide a launch argument for this link that opens your app in similar context as the app service. If you don't provide a launch argument, the app is launched to the main screen.\n\nIn this example from AdventureWorksVoiceCommandService.cs of the **AdventureWorks** sample, we pass the specified destination (`destination`) string to the SendCompletionMessageForDestination method, which retrieves all matching trips and provides a deep link to the app.\n\nFirst, we create a  [**VoiceCommandUserMessage**](https://msdn.microsoft.com/library/windows/apps/windows.applicationmodel.voicecommands.voicecommandusermessage.aspx) (```userMessage```) that is spoken by **Cortana** and shown on the **Cortana** canvas. A [**VoiceCommandContentTile**](https://msdn.microsoft.com/library/windows/apps/windows.applicationmodel.voicecommands.voicecommandcontenttile.aspx) list object is then created for displaying the collection of result cards on the canvas. \n\nThese two objects are then passed to the [CreateResponse](https://msdn.microsoft.com/library/windows/apps/windows.applicationmodel.voicecommands.voicecommandresponse.createresponse.aspx) method of the [**VoiceCommandResponse**](https://msdn.microsoft.com/library/windows/apps/dn974182) object (`response`). We then set the [**AppLaunchArgument**](https://msdn.microsoft.com/library/windows/apps/dn974183) property value of the response object to the value of `destination` passsed to this function. When a user taps a content tile on the Cortana canvas, the parameter values are passed to the app through the response object.\n\nFinally, we call the [**ReportSuccessAsync**](https://msdn.microsoft.com/library/windows/apps/dn706580) method of the [**VoiceCommandServiceConnection**](https://msdn.microsoft.com/library/windows/apps/dn974204).\n\n```csharp\n/// <summary>\n/// Show details for a single trip, if the trip can be found. \n/// This demonstrates a simple response flow in Cortana.\n/// </summary>\n/// <param name=\"destination\">The destination specified in the voice command.</param>\nprivate async Task SendCompletionMessageForDestination(string destination)\n{\n...\n    IEnumerable<Model.Trip> trips = store.Trips.Where(p => p.Destination == destination);\n\n    var userMessage = new VoiceCommandUserMessage();\n    var destinationsContentTiles = new List<VoiceCommandContentTile>();\n...\n    var response = VoiceCommandResponse.CreateResponse(userMessage, destinationsContentTiles);\n\n    if (trips.Count() > 0)\n    {\n        response.AppLaunchArgument = destination;\n    }\n\n    await voiceServiceConnection.ReportSuccessAsync(response);\n}\n```\n\n\n## <span id=\"Content_tile_deep_link\"></span><span id=\"content_tile_deep_link\"></span><span id=\"CONTENT_TILE_DEEP_LINK\"></span>Content tile deep link\n\n\nYou can add deep links to content cards on various **Cortana** screens.\n\n![cortana background app hand-off screen ](images/cortana-backgroundapp-progress-result.png)\n\nLike the \"Go to &lt;app&gt;\" links, you can provide a launch argument to open your app with similar context as the app service. If you don't provide a launch argument, the content tile does not link to your app.\n\nIn this example from AdventureWorksVoiceCommandService.cs of the **AdventureWorks** sample, we pass the specified destination to the SendCompletionMessageForDestination method, which retrieves all matching trips and provides content cards with deep links to the app.\n\nFirst, we create a  [**VoiceCommandUserMessage**](https://msdn.microsoft.com/library/windows/apps/windows.applicationmodel.voicecommands.voicecommandusermessage.aspx) (```userMessage```) that is spoken by **Cortana** and shown on the **Cortana** canvas. A [**VoiceCommandContentTile**](https://msdn.microsoft.com/library/windows/apps/windows.applicationmodel.voicecommands.voicecommandcontenttile.aspx) list object is then created for displaying the collection of result cards on the canvas. \n\nThese two objects are then passed to the [CreateResponse](https://msdn.microsoft.com/library/windows/apps/windows.applicationmodel.voicecommands.voicecommandresponse.createresponse.aspx) method of the [**VoiceCommandResponse**](https://msdn.microsoft.com/library/windows/apps/dn974182) object (```response```). We then set the [**AppLaunchArgument**](https://msdn.microsoft.com/library/windows/apps/dn974183) property value to the value of the destination in the voice command.\n\nFinally, we call the [**ReportSuccessAsync**](https://msdn.microsoft.com/library/windows/apps/dn706580) method of the [**VoiceCommandServiceConnection**](https://msdn.microsoft.com/library/windows/apps/dn974204).\nHere, we add two content tiles with different [**AppLaunchArgument**](https://msdn.microsoft.com/library/windows/apps/dn974183) parameter values to a [**VoiceCommandContentTile**](https://msdn.microsoft.com/library/windows/apps/dn974168) list used in the [**ReportSuccessAsync**](https://msdn.microsoft.com/library/windows/apps/dn706580) call of the [**VoiceCommandServiceConnection**](https://msdn.microsoft.com/library/windows/apps/dn974204) object.\n\n```csharp\n/// <summary>\n/// Show details for a single trip, if the trip can be found. \n/// This demonstrates a simple response flow in Cortana.\n/// </summary>\n/// <param name=\"destination\">The destination specified in the voice command.</param>\nprivate async Task SendCompletionMessageForDestination(string destination)\n{\n    // If this operation is expected to take longer than 0.5 seconds, the task must\n    // supply a progress response to Cortana before starting the operation, and\n    // updates must be provided at least every 5 seconds.\n    string loadingTripToDestination = string.Format(\n               cortanaResourceMap.GetValue(\"LoadingTripToDestination\", cortanaContext).ValueAsString,\n               destination);\n    await ShowProgressScreen(loadingTripToDestination);\n    Model.TripStore store = new Model.TripStore();\n    await store.LoadTrips();\n\n    // Query for the specified trip. \n    // The destination should be in the phrase list. However, there might be  \n    // multiple trips to the destination. We pick the first.\n    IEnumerable<Model.Trip> trips = store.Trips.Where(p => p.Destination == destination);\n\n    var userMessage = new VoiceCommandUserMessage();\n    var destinationsContentTiles = new List<VoiceCommandContentTile>();\n    if (trips.Count() == 0)\n    {\n        string foundNoTripToDestination = string.Format(\n               cortanaResourceMap.GetValue(\"FoundNoTripToDestination\", cortanaContext).ValueAsString,\n               destination);\n        userMessage.DisplayMessage = foundNoTripToDestination;\n        userMessage.SpokenMessage = foundNoTripToDestination;\n    }\n    else\n    {\n        // Set plural or singular title.\n        string message = \"\";\n        if (trips.Count() > 1)\n        {\n            message = cortanaResourceMap.GetValue(\"PluralUpcomingTrips\", cortanaContext).ValueAsString;\n        }\n        else\n        {\n            message = cortanaResourceMap.GetValue(\"SingularUpcomingTrip\", cortanaContext).ValueAsString;\n        }\n        userMessage.DisplayMessage = message;\n        userMessage.SpokenMessage = message;\n\n        // Define a tile for each destination.\n        foreach (Model.Trip trip in trips)\n        {\n            int i = 1;\n            \n            var destinationTile = new VoiceCommandContentTile();\n\n            destinationTile.ContentTileType = VoiceCommandContentTileType.TitleWith68x68IconAndText;\n            destinationTile.Image = await StorageFile.GetFileFromApplicationUriAsync(new Uri(\"ms-appx:///AdventureWorks.VoiceCommands/Images/GreyTile.png\"));\n\n            destinationTile.AppLaunchArgument = trip.Destination;\n            destinationTile.Title = trip.Destination;\n            if (trip.StartDate != null)\n            {\n                destinationTile.TextLine1 = trip.StartDate.Value.ToString(dateFormatInfo.LongDatePattern);\n            }\n            else\n            {\n                destinationTile.TextLine1 = trip.Destination + \" \" + i;\n            }\n\n            destinationsContentTiles.Add(destinationTile);\n            i++;\n        }\n    }\n\n    var response = VoiceCommandResponse.CreateResponse(userMessage, destinationsContentTiles);\n\n    if (trips.Count() > 0)\n    {\n        response.AppLaunchArgument = destination;\n    }\n\n    await voiceServiceConnection.ReportSuccessAsync(response);\n}\n```\n## <span id=\"Programmatic_deep_link\"></span><span id=\"programmatic_deep_link\"></span><span id=\"PROGRAMMATIC_DEEP_LINK\"></span>Programmatic deep link\n\n\nYou can also programmatically launch your app with a launch argument to open your app with similar context as the app service. If you don't provide a launch argument, the app is launched to the main screen.\n\nHere, we add an [**AppLaunchArgument**](https://msdn.microsoft.com/library/windows/apps/dn974183) parameter with a value of \"Las Vegas\" to a [**VoiceCommandResponse**](https://msdn.microsoft.com/library/windows/apps/dn974182) object used in the [**RequestAppLaunchAsync**](https://msdn.microsoft.com/library/windows/apps/dn706581) call of the [**VoiceCommandServiceConnection**](https://msdn.microsoft.com/library/windows/apps/dn974204) object.\n\n```CSharp\nvar userMessage = new VoiceCommandUserMessage();\nuserMessage.DisplayMessage = \"Here are your trips.\";\nuserMessage.SpokenMessage = \n  \"You have one trip to Vegas coming up.\";\n\nresponse = VoiceCommandResponse.CreateResponse(userMessage);\nresponse.AppLaunchArgument = “Las Vegas”;\nawait  VoiceCommandServiceConnection.RequestAppLaunchAsync(response);\n```\n\n## <span id=\"App_manifest\"></span><span id=\"app_manifest\"></span><span id=\"APP_MANIFEST\"></span>App manifest\n\n\nTo enable deep linking to your app, you must declare the `windows.personalAssistantLaunch` extension in the Package.appxmanifest file of your app project.\n\nHere, we declare the `windows.personalAssistantLaunch` extension for the **Adventure Works** app.\n\n```XML\n<Extensions>\n  <uap:Extension Category=\"windows.appService\" \n    EntryPoint=\"AdventureWorks.VoiceCommands.AdventureWorksVoiceCommandService\">\n    <uap:AppService Name=\"AdventureWorksVoiceCommandService\"/>\n  </uap:Extension>\n  <uap:Extension Category=\"windows.personalAssistantLaunch\"/> \n</Extensions>\n```\n\n## <span id=\"Protocol_contract\"></span><span id=\"protocol_contract\"></span><span id=\"PROTOCOL_CONTRACT\"></span>Protocol contract\n\n\nYour app is launched to the foreground through Uniform Resource Identifier (URI) activation using a [**Protocol**](https://msdn.microsoft.com/library/windows/apps/br224693) contract. Your app must override your app's [**OnActivated**](https://msdn.microsoft.com/library/windows/apps/br242330) event and check for an **ActivationKind** of **Protocol**. For more info, see [Handle URI activation](https://msdn.microsoft.com/library/windows/apps/mt228339).\n\nHere, we decode the URI provided by the [**ProtocolActivatedEventArgs**](https://msdn.microsoft.com/library/windows/apps/br224742) to access the launch argument. For this example, the [**Uri**](https://msdn.microsoft.com/library/windows/apps/br224746) is set to \"windows.personalassistantlaunch:?LaunchContext=Las Vegas\".\n\n```CSharp\nif (args.Kind == ActivationKind.Protocol)\n  {\n    var commandArgs = args as ProtocolActivatedEventArgs;\n    Windows.Foundation.WwwFormUrlDecoder decoder = \n      new Windows.Foundation.WwwFormUrlDecoder(commandArgs.Uri.Query);\n    var destination = decoder.GetFirstValueByName(\"LaunchContext\");\n\n    navigationCommand = new ViewModel.TripVoiceCommand(\n      \"protocolLaunch\",\n      \"text\",\n      \"destination\",\n      destination);\n\n    navigationToPageType = typeof(View.TripDetails);\n\n    rootFrame.Navigate(navigationToPageType, navigationCommand);\n\n    // Ensure the current window is active.\n    Window.Current.Activate();\n  }\n```\n\n## <span id=\"related_topics\"></span>Related articles\n\n\n**Developers**\n* [Cortana interactions](cortana-interactions.md)\n* [**VCD elements and attributes v1.2**](https://msdn.microsoft.com/library/windows/apps/dn706593)\n\n**Designers**\n* [Cortana design guidelines](https://msdn.microsoft.com/library/windows/apps/dn974233)\n* [Speech design guidelines](https://msdn.microsoft.com/library/windows/apps/dn596121)\n\n**Samples**\n* [Cortana voice command sample](http://go.microsoft.com/fwlink/p/?LinkID=619899)\n \n\n \n\n\n\n\n"}