{"nodes":[{"content":"Read about solutions to common development issues with the Microsoft advertising libraries in JavaScript/HTML apps.","pos":[86,201]},{"content":"HTML and JavaScript troubleshooting guide","pos":[209,250]},{"content":"HTML and JavaScript troubleshooting guide","pos":[259,300]},{"content":"Updated for UWP apps on Windows 10.","pos":[306,341]},{"content":"For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept>","pos":[342,434]},{"content":"This topic contains solutions to common development issues with the Microsoft advertising libraries in JavaScript/HTML apps.","pos":[439,563]},{"content":"HTML","pos":[570,574]},{"content":"AdControl not appearing","pos":[593,616]},{"content":"Black box blinks and disappears","pos":[648,679]},{"content":"Ads not refreshing","pos":[723,741]},{"content":"JavaScript","pos":[773,783]},{"content":"AdControl not appearing","pos":[800,823]},{"content":"Black box blinks and disappears","pos":[862,893]},{"content":"Ads not refreshing","pos":[935,953]},{"content":"HTML","pos":[981,985]},{"content":"AdControl not appearing","pos":[1022,1045]},{"pos":[1051,1136],"content":"Ensure that the <bpt id=\"p1\">**</bpt>Internet (Client)<ept id=\"p1\">**</ept> capability is selected in Package.appxmanifest."},{"content":"Ensure the JavaScript reference is present.","pos":[1142,1185]},{"content":"Without the ad.js reference in the <ph id=\"ph1\">&amp;lt;</ph>head<ph id=\"ph2\">&amp;gt;</ph> section (after the default.js reference) the <bpt id=\"p1\">**</bpt>AdControl<ept id=\"p1\">**</ept> will be unable to display and an error will occur during build.","pos":[1186,1356]},{"content":"Windows 10:","pos":[1362,1373]},{"content":"Windows 8.x:","pos":[1519,1531]},{"content":"Check the application ID and ad unit ID.","pos":[1681,1721]},{"content":"These IDs must match the application ID and ad unit ID that you obtained in Windows Dev Center.","pos":[1722,1817]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Set up ad units in your app<ept id=\"p1\">](set-up-ad-units-in-your-app.md)</ept>.","pos":[1818,1906]},{"content":"Check the <bpt id=\"p1\">**</bpt>height<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>width<ept id=\"p2\">**</ept> properties.","pos":[2258,2304]},{"content":"These must be set to one of the <bpt id=\"p1\">[</bpt>supported ad sizes for banner ads<ept id=\"p1\">](supported-ad-sizes-for-banner-ads.md)</ept>.","pos":[2305,2411]},{"content":"Check the element positioning.","pos":[2763,2793]},{"content":"The <bpt id=\"p1\">[</bpt>AdControl<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/microsoft.advertising.winrt.ui.adcontrol.aspx)</ept> must be inside the viewable area.","pos":[2794,2938]},{"content":"Check the <bpt id=\"p1\">**</bpt>visibility<ept id=\"p1\">**</ept> property.","pos":[2944,2978]},{"content":"This property must not be set to collapsed or hidden.","pos":[2979,3032]},{"content":"This property can be set inline (as shown below) or in an external style sheet.","pos":[3033,3112]},{"content":"Check the <bpt id=\"p1\">**</bpt>position<ept id=\"p1\">**</ept> property.","pos":[3489,3521]},{"content":"The position property must be set to an appropriate value depending on the element’s other properties (for example, margins in parent element and z-index).","pos":[3522,3677]},{"content":"This property can be set inline (as shown below) or in an external style sheet.","pos":[3678,3757]},{"content":"Check the <bpt id=\"p1\">**</bpt>z-index<ept id=\"p1\">**</ept> property.","pos":[4134,4165]},{"content":"The <bpt id=\"p1\">**</bpt>z-index<ept id=\"p1\">**</ept> property must be set high enough so the <bpt id=\"p2\">**</bpt>AdControl<ept id=\"p2\">**</ept> always appears on top of other elements.","pos":[4166,4276]},{"content":"This property can be set inline (as shown below) or in an external style sheet.","pos":[4277,4356]},{"content":"Check external style sheets.","pos":[4733,4761]},{"content":"If properties are set on the <bpt id=\"p1\">**</bpt>AdControl<ept id=\"p1\">**</ept> element through an external style sheet, ensure all of the above properties are correctly set.","pos":[4762,4899]},{"content":"Check the parent of the <bpt id=\"p1\">**</bpt>AdControl<ept id=\"p1\">**</ept>.","pos":[5276,5314]},{"content":"If the <bpt id=\"p1\">**</bpt>AdControl<ept id=\"p1\">**</ept> resides in a parent element, the parent must be active and visible.","pos":[5315,5403]},{"content":"Ensure the <bpt id=\"p1\">**</bpt>AdControl<ept id=\"p1\">**</ept> is not hidden from the viewport.","pos":[5858,5915]},{"content":"The <bpt id=\"p1\">**</bpt>AdControl<ept id=\"p1\">**</ept> must be visible for ads to display properly.","pos":[5916,5978]},{"content":"Live values for <bpt id=\"p1\">[</bpt>ApplicationId<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/microsoft.advertising.winrt.ui.adcontrol.applicationid.aspx)</ept> and <bpt id=\"p2\">[</bpt>AdUnitId<ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/microsoft.advertising.winrt.ui.adcontrol.adunitid.aspx)</ept> should not be tested in the emulator.","pos":[5984,6281]},{"content":"To ensure the <bpt id=\"p1\">**</bpt>AdControl<ept id=\"p1\">**</ept> is functioning as expected, use the test IDs for both <bpt id=\"p2\">**</bpt>ApplicationId<ept id=\"p2\">**</ept> and <bpt id=\"p3\">**</bpt>AdUnitId<ept id=\"p3\">**</ept> found in <bpt id=\"p4\">[</bpt>Test mode values<ept id=\"p4\">](test-mode-values.md)</ept>.","pos":[6282,6448]},{"content":"Black box blinks and disappears","pos":[6497,6528]},{"pos":[6534,6627],"content":"Double-check all steps in the previous <bpt id=\"p1\">[</bpt>AdControl not appearing<ept id=\"p1\">](#html-notappearing)</ept> section."},{"content":"Handle the <bpt id=\"p1\">**</bpt>onErrorOccurred<ept id=\"p1\">**</ept> event, and use the message that is passed to the event handler to determine whether an error occurred and what type of error was thrown.","pos":[6633,6800]},{"content":"More details can be found in <bpt id=\"p1\">[</bpt>Error handling in JavaScript walkthrough<ept id=\"p1\">](error-handling-in-javascript-walkthrough.md)</ept>.","pos":[6801,6918]},{"content":"The most common error that causes a black box is “No ad available.”","pos":[7534,7601]},{"content":"This error means there is no ad available to return from the request.","pos":[7602,7671]},{"content":"The <bpt id=\"p1\">**</bpt>AdControl<ept id=\"p1\">**</ept> is behaving normally.","pos":[7677,7716]},{"content":"By default, the <bpt id=\"p1\">**</bpt>AdControl<ept id=\"p1\">**</ept> will collapse when it cannot display an ad.","pos":[7717,7790]},{"content":"If other elements are children of the same parent they may move to fill the gap of the collapsed <bpt id=\"p1\">**</bpt>AdControl<ept id=\"p1\">**</ept> and expand when the next request is made.","pos":[7791,7943]},{"content":"Ads not refreshing","pos":[7984,8002]},{"content":"Check the <bpt id=\"p1\">**</bpt>isAutoRefreshEnabled<ept id=\"p1\">**</ept> property.","pos":[8008,8052]},{"content":"By default, this optional property is set to true.","pos":[8053,8103]},{"content":"When set to false, the <bpt id=\"p1\">**</bpt>refresh<ept id=\"p1\">**</ept> method must be used to retrieve another ad.","pos":[8104,8182]},{"content":"Check calls to the <bpt id=\"p1\">**</bpt>refresh<ept id=\"p1\">**</ept> method.","pos":[8648,8686]},{"content":"When using automatic refresh, <bpt id=\"p1\">**</bpt>refresh<ept id=\"p1\">**</ept> cannot be used to retrieve another ad.","pos":[8687,8767]},{"content":"When using manual refresh, <bpt id=\"p1\">**</bpt>refresh<ept id=\"p1\">**</ept> should be called only after a minimum of 30 to 60 seconds depending on the device’s current data connection.","pos":[8768,8915]},{"content":"This example demonstrates how to use the <bpt id=\"p1\">**</bpt>refresh<ept id=\"p1\">**</ept> method.","pos":[8921,8981]},{"content":"The following HTML code shows an example of how to instantiate the <bpt id=\"p1\">**</bpt>AdControl<ept id=\"p1\">**</ept> with <bpt id=\"p2\">**</bpt>isAutoRefreshEnabled<ept id=\"p2\">**</ept> set to false.","pos":[8982,9106]},{"pos":[9573,9636],"content":"Theis example demonstrates how to use the <bpt id=\"p1\">**</bpt>refresh<ept id=\"p1\">**</ept> function."},{"content":"The <bpt id=\"p1\">**</bpt>AdControl<ept id=\"p1\">**</ept> is behaving normally.","pos":[9906,9945]},{"content":"Sometimes the same ad will appear more than once in a row giving the appearance that ads are not refreshing.","pos":[9946,10054]},{"content":"JavaScript","pos":[10075,10085]},{"content":"AdControl not appearing","pos":[10129,10152]},{"pos":[10158,10243],"content":"Ensure that the <bpt id=\"p1\">**</bpt>Internet (Client)<ept id=\"p1\">**</ept> capability is selected in Package.appxmanifest."},{"content":"Ensure the <bpt id=\"p1\">**</bpt>AdControl<ept id=\"p1\">**</ept> is instantiated.","pos":[10249,10290]},{"content":"If the <bpt id=\"p1\">**</bpt>AdControl<ept id=\"p1\">**</ept> is not instantiated.","pos":[10291,10332]},{"content":"it will not be available.","pos":[10333,10358]},{"content":"The following snippets show an example of instantiating the <bpt id=\"p1\">**</bpt>AdControl<ept id=\"p1\">**</ept>.","pos":[10364,10438]},{"content":"This HTML code shows an example of setting up the UI for the <bpt id=\"p1\">**</bpt>AdControl<ept id=\"p1\">**</ept>","pos":[10439,10513]},{"pos":[10753,10834],"content":"The following JavaScript code shows an example of instantiating the <bpt id=\"p1\">**</bpt>AdControl<ept id=\"p1\">**</ept>"},{"content":"Check the parent element.","pos":[11532,11557]},{"content":"The parent <bpt id=\"p1\">**</bpt><ph id=\"ph1\">&amp;lt;</ph>div<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p1\">**</ept> must be correctly assigned, active, and visible.","pos":[11558,11633]},{"content":"Check the application ID and ad unit ID.","pos":[11866,11906]},{"content":"These IDs must match the application ID and ad unit ID that you obtained in Windows Dev Center.","pos":[11907,12002]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Set up ad units in your app<ept id=\"p1\">](set-up-ad-units-in-your-app.md)</ept>.","pos":[12003,12091]},{"content":"Check the parent element of the <bpt id=\"p1\">**</bpt>AdControl<ept id=\"p1\">**</ept>.","pos":[12275,12321]},{"content":"The parent must be active and visible.","pos":[12322,12360]},{"content":"Live values for <bpt id=\"p1\">**</bpt>ApplicationId<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>AdUnitId<ept id=\"p2\">**</ept> should not be tested in the emulator.","pos":[12366,12454]},{"content":"To ensure the <bpt id=\"p1\">**</bpt>AdControl<ept id=\"p1\">**</ept> is functioning as expected, use the test IDs for both <bpt id=\"p2\">**</bpt>ApplicationId<ept id=\"p2\">**</ept> and <bpt id=\"p3\">**</bpt>AdUnitId<ept id=\"p3\">**</ept> found in <bpt id=\"p4\">[</bpt>Test mode values<ept id=\"p4\">](test-mode-values.md)</ept>.","pos":[12455,12621]},{"content":"Black box blinks and disappears","pos":[12668,12699]},{"pos":[12705,12796],"content":"Double-check all steps in the <bpt id=\"p1\">[</bpt>AdControl not appearing<ept id=\"p1\">](#js-adcontrolnotappearing)</ept> section."},{"content":"Handle the <bpt id=\"p1\">**</bpt>onErrorOccurred<ept id=\"p1\">**</ept> event, and use the message that is passed to the event handler to determine whether an error occurred and what type of error was thrown.","pos":[12802,12969]},{"content":"More details can be found in <bpt id=\"p1\">[</bpt>Error handling in JavaScript walkthrough<ept id=\"p1\">](error-handling-in-javascript-walkthrough.md)</ept>.","pos":[12970,13087]},{"content":"This example demonstrates how to implement an error handler that reports error messages.","pos":[13093,13181]},{"content":"This snippet of HTML code provides an example of how to set up the UI to display error messages.","pos":[13182,13278]},{"content":"This example demonstrates how to instantiate the <bpt id=\"p1\">**</bpt>AdControl<ept id=\"p1\">**</ept>.","pos":[13505,13568]},{"content":"This function would be inserted in the app.onactivated file.","pos":[13569,13629]},{"content":"This example demonstrates how to report errors.","pos":[13876,13923]},{"content":"This function would be inserted below the self-running function in the default.js file.","pos":[13924,14011]},{"content":"The most common error that causes a black box is “No ad available.”","pos":[14388,14455]},{"content":"This error means there is no ad available to return from the request.","pos":[14456,14525]},{"content":"The <bpt id=\"p1\">**</bpt>AdControl<ept id=\"p1\">**</ept> is behaving normally.","pos":[14531,14570]},{"content":"Sometimes the same ad will appear more than once in a row giving the appearance that ads are not refreshing.","pos":[14571,14679]},{"content":"Ads not refreshing","pos":[14718,14736]},{"content":"Check the <bpt id=\"p1\">**</bpt>isAutoRefreshEnabled<ept id=\"p1\">**</ept> property.","pos":[14742,14786]},{"content":"By default, this optional property is set to <bpt id=\"p1\">**</bpt>true<ept id=\"p1\">**</ept>.","pos":[14787,14841]},{"content":"When set to <bpt id=\"p1\">**</bpt>false<ept id=\"p1\">**</ept>, the <bpt id=\"p2\">**</bpt>refresh<ept id=\"p2\">**</ept> method must be used to retrieve another ad.","pos":[14842,14924]},{"pos":[14930,15005],"content":"This example demonstrates how to use the <bpt id=\"p1\">**</bpt>isAutoRefreshEnabled<ept id=\"p1\">**</ept> property."},{"content":"Check calls to the <bpt id=\"p1\">**</bpt>refresh<ept id=\"p1\">**</ept> method.","pos":[15223,15261]},{"content":"When using automatic refresh, <bpt id=\"p1\">**</bpt>refresh<ept id=\"p1\">**</ept> cannot be used to retrieve another ad.","pos":[15262,15342]},{"content":"When using manual refresh, <bpt id=\"p1\">**</bpt>refresh<ept id=\"p1\">**</ept> should be called only after a minimum of 30 to 60 seconds depending on the device’s current data connection.","pos":[15343,15490]},{"pos":[15496,15570],"content":"This example demonstrates how to create the <bpt id=\"p1\">**</bpt>div<ept id=\"p1\">**</ept> for the <bpt id=\"p2\">**</bpt>AdControl<ept id=\"p2\">**</ept>."},{"pos":[15810,15864],"content":"This example shows how to use the <bpt id=\"p1\">**</bpt>refresh<ept id=\"p1\">**</ept> function"},{"content":"The <bpt id=\"p1\">**</bpt>AdControl<ept id=\"p1\">**</ept> is behaving normally.","pos":[16327,16366]},{"content":"Sometimes the same ad will appear more than once in a row giving the appearance that ads are not refreshing.","pos":[16367,16475]}],"content":"---\nauthor: mcleanbyron\nms.assetid: 7a61c328-77be-4614-b117-a32a592c9efe\ndescription: Read about solutions to common development issues with the Microsoft advertising libraries in JavaScript/HTML apps.\ntitle: HTML and JavaScript troubleshooting guide\n\n---\n\n# HTML and JavaScript troubleshooting guide\n\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\nThis topic contains solutions to common development issues with the Microsoft advertising libraries in JavaScript/HTML apps.\n\n-   [HTML](#html)\n\n    -   [AdControl not appearing](#html-notappearing)\n\n    -   [Black box blinks and disappears](#html-blackboxblinksdisappears)\n\n    -   [Ads not refreshing](#html-adsnotrefreshing)\n\n-   [JavaScript](#js)\n\n    -   [AdControl not appearing](#js-adcontrolnotappearing)\n\n    -   [Black box blinks and disappears](#js-blackboxblinksdisappears)\n\n    -   [Ads not refreshing](#js-adsnotrefreshing)\n\n## HTML\n\n<span id=\"html-notappearing\"/>\n### AdControl not appearing\n\n1.  Ensure that the **Internet (Client)** capability is selected in Package.appxmanifest.\n\n2.  Ensure the JavaScript reference is present. Without the ad.js reference in the &lt;head&gt; section (after the default.js reference) the **AdControl** will be unable to display and an error will occur during build.\n\n    Windows 10:\n\n    ``` syntax\n    <head>\n        …\n        <script src=\"//Microsoft.Advertising.JavaScript/ad.js\"></script>\n        …\n    </head>\n    ```\n\n    Windows 8.x:\n\n    ``` syntax\n    <head>\n        …\n        <script src=\"//Microsoft.Advertising.JavaScript/ads/ad.js\"></script>\n        …\n    </head>\n    ```\n\n3.  Check the application ID and ad unit ID. These IDs must match the application ID and ad unit ID that you obtained in Windows Dev Center. For more information, see [Set up ad units in your app](set-up-ad-units-in-your-app.md).\n\n    ``` syntax\n    <div id=\"myAd\" style=\"position: absolute; top: 50px; left: 0px;\n                          width: 250px; height: 250px; z-index: 1\"\n         data-win-control=\"MicrosoftNSJS.Advertising.AdControl\"\n         data-win-options=\"{applicationId: 'ApplicationID',\n                            adUnitId: 'AdUnitID'}\">\n    </div>\n    ```\n\n4.  Check the **height** and **width** properties. These must be set to one of the [supported ad sizes for banner ads](supported-ad-sizes-for-banner-ads.md).\n\n    ``` syntax\n    <div id=\"myAd\" style=\"position: absolute; top: 50px; left: 0px;\n                          width: 250px; height: 250px; z-index: 1\"\n         data-win-control=\"MicrosoftNSJS.Advertising.AdControl\"\n         data-win-options=\"{applicationId: 'ApplicationID',\n                            adUnitId: 'AdUnitID'}\">\n    </div>\n    ```\n\n5.  Check the element positioning. The [AdControl](https://msdn.microsoft.com/library/windows/apps/microsoft.advertising.winrt.ui.adcontrol.aspx) must be inside the viewable area.\n\n6.  Check the **visibility** property. This property must not be set to collapsed or hidden. This property can be set inline (as shown below) or in an external style sheet.\n\n    ``` syntax\n    <div id=\"myAd\" style=\"visibility: visible; position: absolute; top: 1025px;\n                          left: 500px; width: 250px; height: 250px; z-index: 1\"\n         data-win-control=\"MicrosoftNSJS.Advertising.AdControl\"\n         data-win-options=\"{applicationId: 'ApplicationID',\n                            adUnitId: 'AdUnitID'}\">\n    </div>\n    ```\n\n7.  Check the **position** property. The position property must be set to an appropriate value depending on the element’s other properties (for example, margins in parent element and z-index). This property can be set inline (as shown below) or in an external style sheet.\n\n    ``` syntax\n    <div id=\"myAd\" style=\"visibility: visible; position: absolute; top: 1025px;\n                          left: 500px; width: 250px; height: 250px; z-index: 1\"\n         data-win-control=\"MicrosoftNSJS.Advertising.AdControl\"\n         data-win-options=\"{applicationId: 'ApplicationID',\n                            adUnitId: 'AdUnitID'}\">\n    </div>\n    ```\n\n8.  Check the **z-index** property. The **z-index** property must be set high enough so the **AdControl** always appears on top of other elements. This property can be set inline (as shown below) or in an external style sheet.\n\n    ``` syntax\n    <div id=\"myAd\" style=\"visibility: visible; position: absolute; top: 1025px;\n                          left: 500px; width: 250px; height: 250px; z-index: 1\"\n         data-win-control=\"MicrosoftNSJS.Advertising.AdControl\"\n         data-win-options=\"{applicationId: 'ApplicationID',\n                            adUnitId: 'AdUnitID'}\">\n    </div>\n    ```\n\n9.  Check external style sheets. If properties are set on the **AdControl** element through an external style sheet, ensure all of the above properties are correctly set.\n\n    ``` syntax\n    <div id=\"myAd\" style=\"visibility: visible; position: absolute; top: 1025px;\n                          left: 500px; width: 250px; height: 250px; z-index: 1\"\n         data-win-control=\"MicrosoftNSJS.Advertising.AdControl\"\n         data-win-options=\"{applicationId: 'ApplicationID',\n                            adUnitId: 'AdUnitID'}\">\n    </div>\n    ```\n\n10. Check the parent of the **AdControl**. If the **AdControl** resides in a parent element, the parent must be active and visible.\n\n    ``` syntax\n    <div style=\"position: absolute; width: 500px; height: 500px;\">\n        <div id=\"myAd\" style=\"position: relative; top: 0px; left: 100px;\n                              width: 250px; height: 250px; z-index: 1\"\n             data-win-control=\"MicrosoftNSJS.Advertising.AdControl\"\n             data-win-options=\"{applicationId: 'ApplicationID',\n                                adUnitId: 'AdUnitID'}\">\n        </div>\n    </div>\n    ```\n\n11. Ensure the **AdControl** is not hidden from the viewport. The **AdControl** must be visible for ads to display properly.\n\n12. Live values for [ApplicationId](https://msdn.microsoft.com/library/windows/apps/microsoft.advertising.winrt.ui.adcontrol.applicationid.aspx) and [AdUnitId](https://msdn.microsoft.com/library/windows/apps/microsoft.advertising.winrt.ui.adcontrol.adunitid.aspx) should not be tested in the emulator. To ensure the **AdControl** is functioning as expected, use the test IDs for both **ApplicationId** and **AdUnitId** found in [Test mode values](test-mode-values.md).\n\n<span id=\"html-blackboxblinksdisappears\"/>\n### Black box blinks and disappears\n\n1.  Double-check all steps in the previous [AdControl not appearing](#html-notappearing) section.\n\n2.  Handle the **onErrorOccurred** event, and use the message that is passed to the event handler to determine whether an error occurred and what type of error was thrown. More details can be found in [Error handling in JavaScript walkthrough](error-handling-in-javascript-walkthrough.md).\n\n    ``` syntax\n    <div id=\"myAd\" style=\"position: absolute; top: 0px; left: 0px;\n                          width: 728px; height: 90px; z-index: 1\"\n         data-win-control=\"MicrosoftNSJS.Advertising.AdControl\"\n         data-win-options=\"{applicationId: 'ApplicationID',\n                            adUnitId: 'AdUnitID',\n                            onErrorOccurred: errorLogger}\">\n    </div>\n\n    <div style=\"position:absolute; width:100%; height:130px; top:300px; left:0px\">\n        <b>Ad Events</b><br />\n        <div id=\"adEvents\" style=\"width:100%; height:110px; overflow:auto\"></div>\n    </div>\n    ```\n\n    The most common error that causes a black box is “No ad available.” This error means there is no ad available to return from the request.\n\n3.  The **AdControl** is behaving normally. By default, the **AdControl** will collapse when it cannot display an ad. If other elements are children of the same parent they may move to fill the gap of the collapsed **AdControl** and expand when the next request is made.\n\n<span id=\"html-adsnotrefreshing\"/>\n### Ads not refreshing\n\n1.  Check the **isAutoRefreshEnabled** property. By default, this optional property is set to true. When set to false, the **refresh** method must be used to retrieve another ad.\n\n    ``` syntax\n    <div id=\"myAd\" style=\"position: absolute; top: 0px; left: 0px;\n                          width: 250px; height: 250px; z-index: 1\"\n         data-win-control=\"MicrosoftNSJS.Advertising.AdControl\"\n         data-win-options=\"{ applicationId: 'ApplicationID',\n                            adUnitId: 'AdUnitID',\n                            onErrorOccurred: errorLogger,\n                            isAutoRefreshEnabled: true}\">\n    </div>\n    ```\n\n2.  Check calls to the **refresh** method. When using automatic refresh, **refresh** cannot be used to retrieve another ad. When using manual refresh, **refresh** should be called only after a minimum of 30 to 60 seconds depending on the device’s current data connection.\n\n    This example demonstrates how to use the **refresh** method. The following HTML code shows an example of how to instantiate the **AdControl** with **isAutoRefreshEnabled** set to false.\n\n    ``` syntax\n    <div id=\"myAd\" style=\"position: absolute; top: 0px; left: 0px;\n                          width: 250px; height: 250px; z-index: 1\"\n         data-win-control=\"MicrosoftNSJS.Advertising.AdControl\"\n         data-win-options=\"{ applicationId: 'ApplicationID',\n                            adUnitId: 'AdUnitID',\n                            onErrorOccurred: errorLogger,\n                            isAutoRefreshEnabled: false}\">\n    </div>\n    ```\n\n    Theis example demonstrates how to use the **refresh** function.\n\n    ``` syntax\n    args.setPromise(WinJS.UI.processAll()\n        .then(function (args) {\n            window.setInterval(function()\n            {\n                document.getElementById(\"myAd\").winControl.refresh();\n            }, 60000)\n        })\n    );\n    ```\n\n3.  The **AdControl** is behaving normally. Sometimes the same ad will appear more than once in a row giving the appearance that ads are not refreshing.\n\n<span id=\"js\"/>\n## JavaScript\n\n<span id=\"js-adcontrolnotappearing\"/>\n### AdControl not appearing\n\n1.  Ensure that the **Internet (Client)** capability is selected in Package.appxmanifest.\n\n2.  Ensure the **AdControl** is instantiated. If the **AdControl** is not instantiated. it will not be available.\n\n    The following snippets show an example of instantiating the **AdControl**. This HTML code shows an example of setting up the UI for the **AdControl**\n\n    ``` syntax\n    <div id=\"myAd\" style=\"position: absolute; top: 0px; left: 0px;\n                          width: 250px; height: 250px; z-index: 1\"\n         data-win-control=\"MicrosoftNSJS.Advertising.AdControl\">\n    </div>\n    ```\n\n    The following JavaScript code shows an example of instantiating the **AdControl**\n\n    ``` syntax\n    app.onactivated = function (args) {\n        if (args.detail.kind === activation.ActivationKind.launch) {\n            if (args.detail.previousExecutionState !==\n                    activation.ApplicationExecutionState.terminated)\n            {\n                var adDiv = document.getElementById(\"myAd\");\n                var myAdControl = new MicrosoftNSJS.Advertising.AdControl(adDiv,\n                {\n                    applicationId: \"{ApplicationID}\",\n                    adUnitId: \"{AdUnitID}\"\n                 });                \n                 myAdControl.onErrorOccurred = myAdError;\n            } else {\n                …\n            }\n        }\n    }\n    ```\n\n3.  Check the parent element. The parent **&lt;div&gt;** must be correctly assigned, active, and visible.\n\n    ``` syntax\n    var adDiv = document.getElementById(\"myAd\");\n    var myAdControl = new MicrosoftNSJS.Advertising.AdControl(adDiv, {\n        applicationId: \"{ApplicationID}\",\n        adUnitId: \"{AdUnitID}\"\n    });  \n    ```\n\n4.  Check the application ID and ad unit ID. These IDs must match the application ID and ad unit ID that you obtained in Windows Dev Center. For more information, see [Set up ad units in your app](set-up-ad-units-in-your-app.md).\n\n    ``` syntax\n    var myAdControl = new MicrosoftNSJS.Advertising.AdControl(adDiv, {\n        applicationId: \"{ApplicationID}\",\n        adUnitId: \"{AdUnitID}\"\n    });  \n    ```\n\n5.  Check the parent element of the **AdControl**. The parent must be active and visible.\n\n6.  Live values for **ApplicationId** and **AdUnitId** should not be tested in the emulator. To ensure the **AdControl** is functioning as expected, use the test IDs for both **ApplicationId** and **AdUnitId** found in [Test mode values](test-mode-values.md).\n\n<span id=\"js-blackboxblinksdisappears\"/>\n### Black box blinks and disappears\n\n1.  Double-check all steps in the [AdControl not appearing](#js-adcontrolnotappearing) section.\n\n2.  Handle the **onErrorOccurred** event, and use the message that is passed to the event handler to determine whether an error occurred and what type of error was thrown. More details can be found in [Error handling in JavaScript walkthrough](error-handling-in-javascript-walkthrough.md).\n\n    This example demonstrates how to implement an error handler that reports error messages. This snippet of HTML code provides an example of how to set up the UI to display error messages.\n\n    ``` syntax\n    <div style=\"position:absolute; width:100%; height:130px; top:300px\">\n        <b>Ad Events</b><br />\n        <div id=\"adEvents\" style=\"width:100%; height:110px; overflow:auto\"></div>\n    </div>\n    ```\n\n    This example demonstrates how to instantiate the **AdControl**. This function would be inserted in the app.onactivated file.\n\n    ``` syntax\n    var myAdControl = new MicrosoftNSJS.Advertising.AdControl(adDiv,\n    {\n        applicationId: \"{ApplicationID}\",\n        adUnitId: \"{AdUnitID}\"\n    });                \n    myAdControl.onErrorOccurred = myAdError;\n    ```\n\n    This example demonstrates how to report errors. This function would be inserted below the self-running function in the default.js file.\n\n    ``` syntax\n    WinJS.Utilities.markSupportedForProcessing\n    (\n        window.errorLogger = function (sender, evt)\n        {\n            adEvents.innerHTML = (new Date()).toLocaleTimeString() + \": \" +\n            sender.element.id + \" error: \" + evt.errorMessage + \" error code: \" +\n            evt.errorCode + \"<br>\" + adEvents.innerHTML;\n        }\n    );\n    ```\n\n    The most common error that causes a black box is “No ad available.” This error means there is no ad available to return from the request.\n\n3.  The **AdControl** is behaving normally. Sometimes the same ad will appear more than once in a row giving the appearance that ads are not refreshing.\n\n<span id=\"js-adsnotrefreshing\"/>\n### Ads not refreshing\n\n1.  Check the **isAutoRefreshEnabled** property. By default, this optional property is set to **true**. When set to **false**, the **refresh** method must be used to retrieve another ad.\n\n    This example demonstrates how to use the **isAutoRefreshEnabled** property.\n\n    ``` syntax\n    var myAdControl = new MicrosoftNSJS.Advertising.AdControl(adDiv,\n    {\n      applicationId: \"{ApplicationID}\",\n      adUnitId: \"{AdUnitID}\",\n      isAutoRefreshEnabled: true\n    });  \n    ```\n\n2.  Check calls to the **refresh** method. When using automatic refresh, **refresh** cannot be used to retrieve another ad. When using manual refresh, **refresh** should be called only after a minimum of 30 to 60 seconds depending on the device’s current data connection.\n\n    This example demonstrates how to create the **div** for the **AdControl**.\n\n    ``` syntax\n    <div id=\"myAd\" style=\"position: absolute; top: 0px; left: 0px;\n                          width: 250px; height: 250px; z-index: 1\"\n         data-win-control=\"MicrosoftNSJS.Advertising.AdControl\">\n    </div>\n    ```\n\n    This example shows how to use the **refresh** function\n\n    ``` syntax\n    var myAdControl = new MicrosoftNSJS.Advertising.AdControl(adDiv,\n    {\n      applicationId: \"{ApplicationID}\",\n      adUnitId: \"{AdUnitID}\",\n      isAutoRefreshEnabled: false\n    });\n    …\n    args.setPromise(WinJS.UI.processAll()\n        .then(function (args) {\n            window.setInterval(function()\n            {\n                document.getElementById(\"myAd\").winControl.refresh();\n            }, 60000)\n        })\n    );\n    ```\n\n3.  The **AdControl** is behaving normally. Sometimes the same ad will appear more than once in a row giving the appearance that ads are not refreshing.\n\n \n\n \n"}