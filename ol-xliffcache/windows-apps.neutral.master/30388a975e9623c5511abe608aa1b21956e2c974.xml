{"nodes":[{"content":"Use the Windows Store analytics API to programmatically retrieve analytics data for apps that are registered to your or your organization''s Windows Dev Center account.","pos":[86,254]},{"content":"Access analytics data using Windows Store services","pos":[262,312]},{"content":"Access analytics data using Windows Store services","pos":[320,370]},{"content":"Updated for UWP apps on Windows 10.","pos":[376,411]},{"content":"For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept>","pos":[412,504]},{"content":"Use the <bpt id=\"p1\">*</bpt>Windows Store analytics API<ept id=\"p1\">*</ept> to programmatically retrieve analytics data for apps that are registered to your or your organization's Windows Dev Center account.","pos":[510,679]},{"content":"This API enables you to retrieve data for app and IAP acquisitions, errors, app ratings and reviews.","pos":[680,780]},{"content":"This API uses Azure Active Directory (Azure AD) to authenticate the calls from your app or service.","pos":[781,880]},{"content":"Prerequisites for using the Windows Store analytics API","pos":[885,940]},{"content":"You (or your organization) must have an Azure AD directory.","pos":[947,1006]},{"content":"If you already use Office 365 or other business services from Microsoft, you already have Azure AD directory.","pos":[1007,1116]},{"content":"Otherwise, you can <bpt id=\"p1\">[</bpt>get one for free<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=703757)</ept>.","pos":[1117,1204]},{"pos":[1209,1413],"content":"You must have a <bpt id=\"p1\">[</bpt>user account<ept id=\"p1\">](https://azure.microsoft.com/documentation/articles/active-directory-create-users/)</ept> in the Azure AD directory that you want to associate with your Windows Dev Center account."},{"content":"Using the Windows Store analytics API","pos":[1418,1455]},{"content":"Before you can use the Windows Store analytics API, you must associate an Azure AD application with your Dev Center account and obtain an Azure AD access token.","pos":[1458,1618]},{"content":"The Azure AD application represents the app or service from which you want to call the Windows Store analytics API.","pos":[1619,1734]},{"content":"After you have an access token, you can call the Windows Store analytics API from your app or service.","pos":[1735,1837]},{"content":"The following steps describe the end-to-end process:","pos":[1839,1891]},{"pos":[1897,2043],"content":"<bpt id=\"p1\">[</bpt>Associate an Azure AD application with your Windows Dev Center account<ept id=\"p1\">](#associate-an-azure-ad-application-with-your-windows-dev-center-account)</ept>."},{"pos":[2048,2116],"content":"<bpt id=\"p1\">[</bpt>Obtain an Azure AD access token<ept id=\"p1\">](#obtain-an-azure-ad-access-token)</ept>."},{"pos":[2121,2199],"content":"<bpt id=\"p1\">[</bpt>Call the Windows Store analytics API<ept id=\"p1\">](#call-the-windows-store-analytics-api)</ept>."},{"content":"Associate an Azure AD application with your Windows Dev Center account","pos":[2206,2276]},{"content":"In Dev Center, go to your <bpt id=\"p1\">**</bpt>Account settings<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>Manage users<ept id=\"p2\">**</ept>, and associate your organization's Dev Center account with your organization's Azure AD directory.","pos":[2282,2451]},{"content":"For detailed instructions, see <bpt id=\"p1\">[</bpt>Manage account users<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/mt489008)</ept>.","pos":[2452,2564]},{"content":"You can optionally add other users from your organization's Azure AD directory so they can also access the Dev Center account.","pos":[2565,2691]},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  Only one Dev Center account can be associated with an Azure Active Directory.","pos":[2699,2786]},{"content":"Similarly, only one Azure Active Directory can be associated with a Dev Center account.","pos":[2787,2874]},{"content":"After you establish this association, you won't be able to remove it without contacting support.","pos":[2875,2971]},{"content":"In the <bpt id=\"p1\">**</bpt>Manage users<ept id=\"p1\">**</ept> page, click <bpt id=\"p2\">**</bpt>Add Azure AD applications<ept id=\"p2\">**</ept>, add the Azure AD application that represents the app or service that you will use to access analytics data for your Dev Center account, and assign it the <bpt id=\"p3\">**</bpt>Manager<ept id=\"p3\">**</ept> role.","pos":[2984,3222]},{"content":"If this application already exists in your Azure AD directory, you can select it on the <bpt id=\"p1\">**</bpt>Add Azure AD applications<ept id=\"p1\">**</ept> page to add it to your Dev Center account.","pos":[3223,3383]},{"content":"Otherwise, you can create a new Azure AD application on the <bpt id=\"p1\">**</bpt>Add Azure AD applications<ept id=\"p1\">**</ept> page.","pos":[3384,3479]},{"content":"For more information, see the section about managing Azure AD applications in <bpt id=\"p1\">[</bpt>Manage account users<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/mt489008)</ept>.","pos":[3480,3639]},{"content":"Return to the <bpt id=\"p1\">**</bpt>Manage users<ept id=\"p1\">**</ept> page, click the name of your Azure AD application to go to the application settings, and click <bpt id=\"p2\">**</bpt>Add new key<ept id=\"p2\">**</ept>.","pos":[3645,3787]},{"content":"On the following screen, copy down the <bpt id=\"p1\">**</bpt>Client ID<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Key<ept id=\"p2\">**</ept> values.","pos":[3788,3860]},{"content":"For more information, see the section about managing Azure AD applications in <bpt id=\"p1\">[</bpt>Manage account users<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/mt489008)</ept>.","pos":[3861,4020]},{"content":"You need these the client ID and key to obtain an Azure AD access token to use when calling the Windows Store analytics API.","pos":[4021,4145]},{"content":"You won't be able to access this info again after you leave this page.","pos":[4146,4216]},{"content":"Obtain an Azure AD access token","pos":[4223,4254]},{"content":"After you associate an Azure AD application with your Dev Center account and you retrieve the client ID and key for the application, you can use this info to obtain an Azure AD access token.","pos":[4256,4446]},{"content":"You need an access token before you can call any of the methods in the Windows Store analytics API.","pos":[4447,4546]},{"content":"After you create an access token, you have 60 minutes to use it before it expires.","pos":[4547,4629]},{"pos":[4631,4850],"content":"To obtain the access token, follow the instructions in <bpt id=\"p1\">[</bpt>Service to Service Calls Using Client Credentials<ept id=\"p1\">](https://msdn.microsoft.com/library/azure/dn645543.aspx)</ept> to send an HTTP POST to the following Azure AD endpoint."},{"content":"To get your tenant ID, log in to the <bpt id=\"p1\">[</bpt>Azure Management Portal<ept id=\"p1\">](http://manage.windowsazure.com/)</ept>, navigate to <bpt id=\"p2\">**</bpt>Active Directory<ept id=\"p2\">**</ept>, and click the directory that you linked to your Dev Center account.","pos":[4930,5128]},{"content":"The tenant ID for this directory is embedded in the URL for this page, as shown by the <bpt id=\"p1\">*</bpt>your<ph id=\"ph1\">\\_</ph>tenant<ph id=\"ph2\">\\_</ph>ID<ept id=\"p1\">*</ept> string in the example below.","pos":[5129,5263]},{"pos":[5425,5577],"content":"For the <bpt id=\"p1\">*</bpt>client<ph id=\"ph1\">\\_</ph>id<ept id=\"p1\">*</ept> and <bpt id=\"p2\">*</bpt>client<ph id=\"ph2\">\\_</ph>secret<ept id=\"p2\">*</ept> parameters, specify the client ID and the key for your application that you retrieved earlier from Dev Center."},{"pos":[5582,5684],"content":"For the <bpt id=\"p1\">*</bpt>resource<ept id=\"p1\">*</ept> parameter, specify the following URI: <ph id=\"ph1\">```https://manage.devcenter.microsoft.com```</ph>."},{"content":"Call the Windows Store analytics API","pos":[5691,5727]},{"content":"After you have an Azure AD access token, you are ready to call the Windows Store analytics API.","pos":[5729,5824]},{"content":"For information about the syntax of each method, see the following articles.","pos":[5825,5901]},{"content":"You must pass the access token to the <bpt id=\"p1\">**</bpt>Authorization<ept id=\"p1\">**</ept> header of each method.","pos":[5902,5980]},{"content":"Get app acquisitions","pos":[5987,6007]},{"content":"Get IAP acquisitions","pos":[6039,6059]},{"content":"Get error reporting data","pos":[6094,6118]},{"content":"Get app ratings","pos":[6154,6169]},{"content":"Get app reviews","pos":[6196,6211]},{"content":"Code example","pos":[6237,6249]},{"content":"The following code example demonstrates how to obtain an Azure AD access token and call the Windows Store analytics API from a C# console app.","pos":[6252,6394]},{"content":"To use this code example, assign the <bpt id=\"p1\">*</bpt>tenantId<ept id=\"p1\">*</ept>, <bpt id=\"p2\">*</bpt>clientId<ept id=\"p2\">*</ept>, <bpt id=\"p3\">*</bpt>clientSecret<ept id=\"p3\">*</ept>, and <bpt id=\"p4\">*</bpt>appID<ept id=\"p4\">*</ept> variables to the appropriate values for your scenario.","pos":[6395,6538]},{"content":"This example requires the <bpt id=\"p1\">[</bpt>Json.NET package<ept id=\"p1\">](http://www.newtonsoft.com/json)</ept> from Newtonsoft to deserialize the JSON data returned by the Windows Store analytics API.","pos":[6539,6705]},{"content":"Error responses","pos":[11727,11742]},{"content":"The Windows Store analytics API returns error responses in a JSON object that contains error codes and messages.","pos":[11745,11857]},{"content":"The following example demonstrates an error response caused by an invalid parameter.","pos":[11858,11942]},{"content":"Related topics","pos":[12394,12408]},{"content":"Get app acquisitions","pos":[12413,12433]},{"content":"Get IAP acquisitions","pos":[12463,12483]},{"content":"Get error reporting data","pos":[12516,12540]},{"content":"Get app ratings","pos":[12574,12589]},{"content":"Get app reviews","pos":[12614,12629]}],"content":"---\nauthor: mcleanbyron\nms.assetid: 4BF9EF21-E9F0-49DB-81E4-062D6E68C8B1\ndescription: Use the Windows Store analytics API to programmatically retrieve analytics data for apps that are registered to your or your organization''s Windows Dev Center account.\ntitle: Access analytics data using Windows Store services\n---\n\n# Access analytics data using Windows Store services\n\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\n\nUse the *Windows Store analytics API* to programmatically retrieve analytics data for apps that are registered to your or your organization's Windows Dev Center account. This API enables you to retrieve data for app and IAP acquisitions, errors, app ratings and reviews. This API uses Azure Active Directory (Azure AD) to authenticate the calls from your app or service.\n\n## Prerequisites for using the Windows Store analytics API\n\n\n-   You (or your organization) must have an Azure AD directory. If you already use Office 365 or other business services from Microsoft, you already have Azure AD directory. Otherwise, you can [get one for free](http://go.microsoft.com/fwlink/p/?LinkId=703757).\n-   You must have a [user account](https://azure.microsoft.com/documentation/articles/active-directory-create-users/) in the Azure AD directory that you want to associate with your Windows Dev Center account.\n\n## Using the Windows Store analytics API\n\n\nBefore you can use the Windows Store analytics API, you must associate an Azure AD application with your Dev Center account and obtain an Azure AD access token. The Azure AD application represents the app or service from which you want to call the Windows Store analytics API. After you have an access token, you can call the Windows Store analytics API from your app or service.\n\nThe following steps describe the end-to-end process:\n\n1.  [Associate an Azure AD application with your Windows Dev Center account](#associate-an-azure-ad-application-with-your-windows-dev-center-account).\n2.  [Obtain an Azure AD access token](#obtain-an-azure-ad-access-token).\n3.  [Call the Windows Store analytics API](#call-the-windows-store-analytics-api).\n\n\n### Associate an Azure AD application with your Windows Dev Center account\n\n1.  In Dev Center, go to your **Account settings**, click **Manage users**, and associate your organization's Dev Center account with your organization's Azure AD directory. For detailed instructions, see [Manage account users](https://msdn.microsoft.com/library/windows/apps/mt489008). You can optionally add other users from your organization's Azure AD directory so they can also access the Dev Center account.\n\n    > **Note**  Only one Dev Center account can be associated with an Azure Active Directory. Similarly, only one Azure Active Directory can be associated with a Dev Center account. After you establish this association, you won't be able to remove it without contacting support.\n\n     \n\n2.  In the **Manage users** page, click **Add Azure AD applications**, add the Azure AD application that represents the app or service that you will use to access analytics data for your Dev Center account, and assign it the **Manager** role. If this application already exists in your Azure AD directory, you can select it on the **Add Azure AD applications** page to add it to your Dev Center account. Otherwise, you can create a new Azure AD application on the **Add Azure AD applications** page. For more information, see the section about managing Azure AD applications in [Manage account users](https://msdn.microsoft.com/library/windows/apps/mt489008).\n\n3.  Return to the **Manage users** page, click the name of your Azure AD application to go to the application settings, and click **Add new key**. On the following screen, copy down the **Client ID** and **Key** values. For more information, see the section about managing Azure AD applications in [Manage account users](https://msdn.microsoft.com/library/windows/apps/mt489008). You need these the client ID and key to obtain an Azure AD access token to use when calling the Windows Store analytics API. You won't be able to access this info again after you leave this page.\n\n\n### Obtain an Azure AD access token\n\nAfter you associate an Azure AD application with your Dev Center account and you retrieve the client ID and key for the application, you can use this info to obtain an Azure AD access token. You need an access token before you can call any of the methods in the Windows Store analytics API. After you create an access token, you have 60 minutes to use it before it expires.\n\nTo obtain the access token, follow the instructions in [Service to Service Calls Using Client Credentials](https://msdn.microsoft.com/library/azure/dn645543.aspx) to send an HTTP POST to the following Azure AD endpoint.\n\n```syntax\nhttps://login.microsoftonline.com/<tenant id>/oauth2/token\n```\n\n-   To get your tenant ID, log in to the [Azure Management Portal](http://manage.windowsazure.com/), navigate to **Active Directory**, and click the directory that you linked to your Dev Center account. The tenant ID for this directory is embedded in the URL for this page, as shown by the *your\\_tenant\\_ID* string in the example below.\n\n  ```syntax\n  https://manage.windowsazure.com/@<your_tenant_name>#Workspaces/ActiveDirectoryExtension/Directory/<your_tenant_ID>/directoryQuickStart\n  ```\n\n-   For the *client\\_id* and *client\\_secret* parameters, specify the client ID and the key for your application that you retrieved earlier from Dev Center.\n-   For the *resource* parameter, specify the following URI: ```https://manage.devcenter.microsoft.com```.\n\n\n### Call the Windows Store analytics API\n\nAfter you have an Azure AD access token, you are ready to call the Windows Store analytics API. For information about the syntax of each method, see the following articles. You must pass the access token to the **Authorization** header of each method.\n\n-   [Get app acquisitions](get-app-acquisitions.md)\n-   [Get IAP acquisitions](get-in-app-acquisitions.md)\n-   [Get error reporting data](get-error-reporting-data.md)\n-   [Get app ratings](get-app-ratings.md)\n-   [Get app reviews](get-app-reviews.md)\n\n## Code example\n\n\nThe following code example demonstrates how to obtain an Azure AD access token and call the Windows Store analytics API from a C# console app. To use this code example, assign the *tenantId*, *clientId*, *clientSecret*, and *appID* variables to the appropriate values for your scenario. This example requires the [Json.NET package](http://www.newtonsoft.com/json) from Newtonsoft to deserialize the JSON data returned by the Windows Store analytics API.\n\n```CSharp\nusing Newtonsoft.Json;\nusing System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Net.Http;\nusing System.Net.Http.Headers;\nusing System.Text;\nusing System.Threading.Tasks;\n\nnamespace TestAnalyticsAPI\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            string tenantId = \"<your tenant ID>\";\n            string clientId = \"<your client ID>\";\n            string clientSecret = \"<your secret>\";\n\n            string scope = \"https://manage.devcenter.microsoft.com\";\n\n            // Retrieve an Azure AD access token\n            string accessToken = GetClientCredentialAccessToken(\n                    tenantId,\n                    clientId,\n                    clientSecret,\n                    scope).Result;\n\n            // This is your app's Store ID. This ID is available on\n            // the App identity page of the Dev Center dashboard.\n            string appID = \"<your app's Store ID>\";\n\n            DateTime startDate = DateTime.Parse(\"08-01-2015\");\n            DateTime endDate = DateTime.Parse(\"11-01-2015\");\n            int pageSize = 1000;\n            int startPageIndex = 0;\n\n            // Call the Windows Store analytics API\n            CallAnalyticsAPI(accessToken, appID, startDate, endDate, pageSize, startPageIndex);\n\n            Console.Read();\n        }\n\n        private static void CallAnalyticsAPI(string accessToken, string appID, DateTime startDate, DateTime endDate, int top, int skip)\n        {\n            string requestURI;\n\n            // Get app acquisitions\n            requestURI = string.Format(\n                \"https://manage.devcenter.microsoft.com/v1.0/my/analytics/appacquisitions?applicationId={0}&startDate={1}&endDate={2}&top={3}&skip={4}\",\n                appID, startDate, endDate, top, skip);\n\n            //// Get IAP acquisitions\n            //requestURI = string.Format(\n            //    \"https://manage.devcenter.microsoft.com/v1.0/my/analytics/inappacquisitions?applicationId={0}&startDate={1}&endDate={2}&top={3}&skip={4}\",\n            //    appID, startDate, endDate, top, skip);\n\n            //// Get app failures\n            //requestURI = string.Format(\n            //    \"https://manage.devcenter.microsoft.com/v1.0/my/analytics/failurehits?applicationId={0}&startDate={1}&endDate={2}&top={3}&skip={4}\",\n            //    appID, startDate, endDate, top, skip);\n\n            //// Get app ratings\n            //requestURI = string.Format(\n            //    \"https://manage.devcenter.microsoft.com/v1.0/my/analytics/ratings?applicationId={0}&startDate={1}&endDate={2}top={3}&skip={4}\",\n            //    appID, startDate, endDate, top, skip);\n\n            //// Get app reviews\n            //requestURI = string.Format(\n            //    \"https://manage.devcenter.microsoft.com/v1.0/my/analytics/reviews?applicationId={0}&startDate={1}&endDate={2}&top={3}&skip={4}\",\n            //    appID, startDate, endDate, top, skip);\n\n            HttpRequestMessage requestMessage = new HttpRequestMessage(HttpMethod.Get, requestURI);\n            requestMessage.Headers.Authorization = new AuthenticationHeaderValue(\"Bearer\", accessToken);\n\n            WebRequestHandler handler = new WebRequestHandler();\n            HttpClient httpClient = new HttpClient(handler);\n\n            HttpResponseMessage response = httpClient.SendAsync(requestMessage).Result;\n\n            Console.WriteLine(response);\n            Console.WriteLine(response.Content.ReadAsStringAsync().Result);\n\n            response.Dispose();\n        }\n\n        public static async Task<string> GetClientCredentialAccessToken(string tenantId, string clientId, string clientSecret, string scope)\n        {\n            string tokenEndpointFormat = \"https://login.microsoftonline.com/{0}/oauth2/token\";\n            string tokenEndpoint = string.Format(tokenEndpointFormat, tenantId);\n\n            dynamic result;\n            using (HttpClient client = new HttpClient())\n            {\n                string tokenUrl = tokenEndpoint;\n                using (\n                    HttpRequestMessage request = new HttpRequestMessage(\n                        HttpMethod.Post,\n                        tokenUrl))\n                {\n                    string content =\n                        string.Format(\n                            \"grant_type=client_credentials&client_id={0}&client_secret={1}&resource={2}\",\n                            clientId,\n                            clientSecret,\n                            scope);\n\n                    request.Content = new StringContent(content, Encoding.UTF8, \"application/x-www-form-urlencoded\");\n\n                    using (HttpResponseMessage response = await client.SendAsync(request))\n                    {\n                        string responseContent = await response.Content.ReadAsStringAsync();\n                        result = JsonConvert.DeserializeObject(responseContent);\n                    }\n                }\n            }\n\n            return result.access_token;\n        }\n    }\n}\n```\n\n## Error responses\n\n\nThe Windows Store analytics API returns error responses in a JSON object that contains error codes and messages. The following example demonstrates an error response caused by an invalid parameter.\n\n```json\n{\n    \"code\":\"BadRequest\",\n    \"data\":[],\n    \"details\":[],\n    \"innererror\":{\n        \"code\":\"InvalidQueryParameters\",\n        \"data\":[\n            \"top parameter cannot be more than 10000\"\n        ],\n        \"details\":[],\n        \"message\":\"One or More Query Parameters has invalid values.\",\n        \"source\":\"AnalyticsAPI\"\n    },\n    \"message\":\"The calling client sent a bad request to the service.\",\n    \"source\":\"AnalyticsAPI\"\n}\n```\n\n## Related topics\n\n* [Get app acquisitions](get-app-acquisitions.md)\n* [Get IAP acquisitions](get-in-app-acquisitions.md)\n* [Get error reporting data](get-error-reporting-data.md)\n* [Get app ratings](get-app-ratings.md)\n* [Get app reviews](get-app-reviews.md)\n \n"}