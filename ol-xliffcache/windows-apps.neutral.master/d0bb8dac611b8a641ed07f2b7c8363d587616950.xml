{"nodes":[{"content":"This topic describes how to add PlayReady protected media content to your Universal Windows Platform (UWP) app.","pos":[86,197]},{"content":"PlayReady DRM","pos":[205,218]},{"content":"PlayReady DRM","pos":[226,239]},{"content":"Updated for UWP apps on Windows 10.","pos":[244,279]},{"content":"For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept>","pos":[280,372]},{"content":"This topic describes how to add PlayReady protected media content to your Universal Windows Platform (UWP) app.","pos":[378,489]},{"content":"PlayReady DRM enables developers to create UWP apps capable of providing PlayReady content to the user while enforcing the access rules defined by the content provider.","pos":[491,659]},{"content":"This section describes changes made to Microsoft PlayReady DRM for Windows 10 and how to modify your PlayReady UWP app to support the changes made from the previous Windows 8.1 version to the Windows 10 version.","pos":[660,871]},{"content":"Topic","pos":[876,881]},{"content":"Description","pos":[952,963]},{"content":"Hardware DRM","pos":[1597,1609]},{"content":"This topic provides an overview of how to add PlayReady hardware-based digital rights management (DRM) to your UWP app.","pos":[1672,1791]},{"content":"Adaptive Streaming with PlayReady","pos":[1957,1990]},{"content":"This article describes how to add adaptive streaming of multimedia content with Microsoft PlayReady content protection to a Universal Windows Platform (UWP) app.","pos":[2032,2193]},{"content":"This feature currently supports playback of Http Live Streaming (HLS) and Dynamic Streaming over HTTP (DASH) content.","pos":[2194,2311]},{"content":"What's new in PlayReady DRM","pos":[2318,2345]},{"content":"The following list describes the new features and changes made to PlayReady DRM for Windows 10.","pos":[2347,2442]},{"content":"Added hardware digital rights management (HWDRM).","pos":[2448,2497]},{"content":"Hardware-based content protection support enables secure playback of high definition (HD) and ultra-high definition (UHD) content on multiple device platforms.","pos":[2503,2662]},{"content":"Key material (including private keys, content keys, and any other key material used to derive or unlock said keys), and decrypted compressed and uncompressed video samples are protected by leveraging hardware security.","pos":[2663,2881]},{"content":"When Hardware DRM is being used, neither unknown enabler (play to unknown / play to unknown with downres) has meaning as the HWDRM pipeline always knows the output being used.","pos":[2882,3057]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Hardware DRM<ept id=\"p1\">](hardware-drm.md)</ept>.","pos":[3058,3116]},{"content":"PlayReady is no longer an appX framework component, but instead is an in-box operating system component.","pos":[3122,3226]},{"content":"The namespace was changed from <bpt id=\"p1\">**</bpt>Microsoft.Media.PlayReadyClient<ept id=\"p1\">**</ept> to <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>Windows.Media.Protection.PlayReady<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/dn986454)</ept>.","pos":[3227,3396]},{"content":"The following headers defining the PlayReady error codes are now part of the Windows Software Development Kit (SDK): Windows.Media.Protection.PlayReadyErrors.h and Windows.Media.Protection.PlayReadyResults.h.","pos":[3401,3609]},{"content":"Provides proactive acquisition of non-persistent licenses.","pos":[3614,3672]},{"content":"Previous versions of PlayReady DRM did not support proactive acquisition of non-persistent licenses.","pos":[3678,3778]},{"content":"This capability has been added to this version.","pos":[3779,3826]},{"content":"This can decrease the time to first frame.","pos":[3827,3869]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Proactively Acquire a Non-Persistent License Before Playback<ept id=\"p1\">](#proactively_acquire_a_non_persistent_license_before_playback)</ept>.","pos":[3870,4022]},{"content":"Provides acquisition of multiple licenses in one message.","pos":[4028,4085]},{"content":"Allows the client app to acquire multiple non-persistent licenses in one license acquisition message.","pos":[4091,4192]},{"content":"This can decrease the time to first frame by acquiring licenses for multiple pieces of content while the user is still browsing your content library; this prevents a delay for license acquisition when the user selects the content to play.","pos":[4193,4431]},{"content":"In addition, it allows audio and video streams to be encrypted to separate keys by enabling a content header that includes multiple key identifiers (KIDs); this enables a single license acquisition to acquire all licenses for all streams within a content file instead of having to use custom logic and multiple license acquisition requests to achieve the same result.","pos":[4432,4799]},{"content":"Added real time expiration support, or limited duration license (LDL).","pos":[4805,4875]},{"content":"Provides the ability to set real-time expiration on licenses and smoothly transition from an expiring license to another (valid) license in the middle of playback.","pos":[4881,5044]},{"content":"When combined with acquisition of multiple licenses in one message, this allows an app to acquire several LDLs asynchronously while the user is still browsing the content library and only acquire a longer duration license once the user has selected content to playback.","pos":[5045,5314]},{"content":"Playback will then start more quickly (because a license is already available) and, since the app will have acquired a longer duration license by the time the LDL expires, smoothly continue playback to the end of the content without interruption.","pos":[5315,5561]},{"content":"Added non-persistent license chains.","pos":[5567,5603]},{"content":"Added support for time-based restrictions (including expiration, expire after first play, and real time expiration) on non-persistent licenses.","pos":[5608,5751]},{"content":"Added HDCP Type 1 (version 2.2 on Windows 10) policy support.","pos":[5756,5817]},{"pos":[5823,5890],"content":"See <bpt id=\"p1\">[</bpt>Things to Consider<ept id=\"p1\">](#things_to_consider)</ept> for more information."},{"content":"Miracast is now implicit as an output.","pos":[5896,5934]},{"content":"Added secure stop.","pos":[5939,5957]},{"content":"Secure stop provides the means for a PlayReady device to confidently assert to a media streaming service that media playback has stopped for any given piece of content.","pos":[5963,6131]},{"content":"This capability ensures your media streaming services provide accurate enforcement and reporting of usage limitations on different devices for a given account.","pos":[6132,6291]},{"content":"Added audio and video license separation.","pos":[6297,6338]},{"content":"Separate tracks prevent video from being decoded as audio; enabling more robust content protection.","pos":[6344,6443]},{"content":"Emerging standards are requiring separate keys for audio and visual tracks.","pos":[6444,6519]},{"content":"Added MaxResDecode.","pos":[6525,6544]},{"content":"This feature was added to limit playback of content to a maximum resolution even when in possession of a more capable key (but not a license).","pos":[6550,6692]},{"content":"It supports cases where multiple stream sizes are encoded with a single key.","pos":[6693,6769]},{"content":"The following new interfaces, classes, and enumerations were added to PlayReady DRM:","pos":[6771,6855]},{"pos":[6861,6977],"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>IPlayReadyLicenseAcquisitionServiceRequest<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn986077)</ept> interface"},{"pos":[6982,7080],"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>IPlayReadyLicenseSession<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn986080)</ept> interface"},{"pos":[7085,7193],"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>IPlayReadySecureStopServiceRequest<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn986090)</ept> interface"},{"pos":[7198,7291],"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>PlayReadyLicenseSession<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn986309)</ept> class"},{"pos":[7296,7393],"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>PlayReadySecureStopIterable<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn986371)</ept> class"},{"pos":[7398,7495],"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>PlayReadySecureStopIterator<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn986375)</ept> class"},{"pos":[7500,7603],"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>PlayReadyHardwareDRMFeatures<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn986265)</ept> enumerator"},{"content":"A new sample has been created to demonstrate how to use the new features of PlayReady DRM.","pos":[7605,7695]},{"content":"The sample can be downloaded from <bpt id=\"p1\">[</bpt>http://go.microsoft.com/fwlink/p/?linkid=331670&amp;clcid=0x409<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=331670)</ept>.","pos":[7696,7841]},{"content":"Things to consider","pos":[7846,7864]},{"content":"PlayReady DRM now supports HDCP Type 1 (supported in HDCP version 2.1 or later).","pos":[7870,7950]},{"content":"PlayReady carries an HDCP Type Restriction policy in the license for the device to enforce.","pos":[7951,8042]},{"content":"On Windows 10, this policy will enforce that HDCP 2.2 or later is engaged.","pos":[8043,8117]},{"content":"This feature can be enabled in your PlayReady Server v3.0 SDK license (the server controls this policy in the license using the HDCP Type Restriction GUID).","pos":[8118,8274]},{"content":"For more information, see the <bpt id=\"p1\">[</bpt>PlayReady Compliance and Robustness Rules<ept id=\"p1\">](http://www.microsoft.com/playready/licensing/compliance/)</ept>.","pos":[8275,8407]},{"pos":[8412,8555],"content":"Windows Media Video (also known as VC-1) is not supported in hardware DRM (see <bpt id=\"p1\">[</bpt>Override Hardware DRM<ept id=\"p1\">](hardware-drm.md#override-hardware-drm)</ept>)."},{"content":"PlayReady DRM now supports the High Efficiency Video Coding (HEVC /H.265) video compression standard.","pos":[8560,8661]},{"content":"To support HEVC, your app must use Common Encryption Scheme (CENC) version 2 content which includes leaving the content's slice headers in the clear.","pos":[8662,8811]},{"content":"Refer to ISO/IEC 23001-7 Information technology -- MPEG systems technologies -- Part 7: Common encryption in ISO base media file format files (Spec version ISO/IEC 23001-7:2015 or higher is required.) for more information.","pos":[8812,9034]},{"content":"Microsoft also recommends using CENC version 2 for all HWDRM content.","pos":[9035,9104]},{"content":"In addition, some hardware DRM will support HEVC and some will not (see <bpt id=\"p1\">[</bpt>Override Hardware DRM<ept id=\"p1\">](hardware-drm.md#override-hardware-drm)</ept>).","pos":[9105,9241]},{"content":"To take advantage of certain new PlayReady 3.0 features (including, but not limited to, SL3000 for hardware-based clients, acquiring multiple non-persistent licenses in one license acquisition message, and time-based restrictions on non-persistent licenses), the PlayReady server is required to be the Microsoft PlayReady Server Software Development Kit v3.0.2769 Release version or later.","pos":[9246,9635]},{"content":"Depending on the Output Protection Policy specified in the content license, media playback may fail for end users if their connected output does not support those requirements.","pos":[9640,9816]},{"content":"The following table lists the set of common errors that occur as a result.","pos":[9817,9891]},{"content":"For more information, see the <bpt id=\"p1\">[</bpt>PlayReady Compliance and Robustness Rules<ept id=\"p1\">](http://www.microsoft.com/playready/licensing/compliance/)</ept>.","pos":[9892,10024]},{"content":"Error","pos":[10028,10033]},{"content":"Value","pos":[10086,10091]},{"content":"Description","pos":[10099,10110]},{"content":"ERROR<ph id=\"ph1\">\\_</ph>GRAPHICS<ph id=\"ph2\">\\_</ph>OPM<ph id=\"ph3\">\\_</ph>OUTPUT<ph id=\"ph4\">\\_</ph>DOES<ph id=\"ph5\">\\_</ph>NOT<ph id=\"ph6\">\\_</ph>SUPPORT<ph id=\"ph7\">\\_</ph>HDCP","pos":[11162,11216]},{"content":"0xC0262513","pos":[11220,11230]},{"content":"The license's Output Protection Policy requires the monitor to engage HDCP, but HDCP was unable to be engaged.","pos":[11233,11343]},{"content":"MF<ph id=\"ph1\">\\_</ph>E<ph id=\"ph2\">\\_</ph>POLICY<ph id=\"ph3\">\\_</ph>UNSUPPORTED","pos":[11729,11755]},{"content":"0xC00D7159","pos":[11787,11797]},{"content":"The license's Output Protection Policy requires the monitor to engage HDCP Type 1, but HDCP Type 1 was unable to be engaged.","pos":[11800,11924]},{"content":"DRM<ph id=\"ph1\">\\_</ph>E<ph id=\"ph2\">\\_</ph>TEE<ph id=\"ph3\">\\_</ph>OUTPUT<ph id=\"ph4\">\\_</ph>PROTECTION<ph id=\"ph5\">\\_</ph>REQUIREMENTS<ph id=\"ph6\">\\_</ph>NOT<ph id=\"ph7\">\\_</ph>MET","pos":[12296,12351]},{"content":"0x8004CD22","pos":[12354,12364]},{"content":"This error code only occurs when running under hardware DRM.","pos":[12367,12427]},{"content":"The license's Output Protection Policy requires the monitor to engage HDCP or to reduce the content's effective resolution, but HDCP was unable to be engaged and the content's effective resolution could not be reduced because hardware DRM does not support reducing the content's resolution.","pos":[12428,12718]},{"content":"Under software DRM, the content plays.","pos":[12719,12757]},{"content":"See <bpt id=\"p1\">[</bpt>Considerations for Using Hardware DRM<ept id=\"p1\">](hardware-drm.md#considerations-for-using-hardware-drm)</ept>.","pos":[12758,12857]},{"content":"ERROR<ph id=\"ph1\">\\_</ph>GRAPHICS<ph id=\"ph2\">\\_</ph>OPM<ph id=\"ph3\">\\_</ph>NOT<ph id=\"ph4\">\\_</ph>SUPPORTED","pos":[12862,12898]},{"content":"0xc0262500","pos":[12920,12930]},{"content":"The graphics driver does not support Output Protection.","pos":[12933,12988]},{"content":"For example, the monitor is connected through VGA or an appropriate graphics driver for the digital output is not installed.","pos":[12989,13113]},{"content":"In the latter case, the typical driver that is installed is the Microsoft Basic Display Adapter and installing an appropriate graphics driver will resolve the issue.","pos":[13114,13279]},{"content":"Output protection","pos":[13431,13448]},{"content":"The following section describes the behavior when using PlayReady DRM for Windows 10 with output protection policies in a PlayReady license.","pos":[13450,13590]},{"content":"PlayReady DRM supports output protection levels contained in the <bpt id=\"p1\">**</bpt>Microsoft PlayReady Extensible Media Rights Specification<ept id=\"p1\">**</ept>.","pos":[13592,13719]},{"content":"This document can be found in the documentation pack that comes with PlayReady licensed products.","pos":[13720,13817]},{"pos":[13821,14035],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>The allowed values for output protection levels that can be set by a licensing server are governed by the <bpt id=\"p2\">[</bpt>PlayReady Compliance Rules<ept id=\"p2\">](https://www.microsoft.com/playready/licensing/compliance/)</ept>."},{"content":"PlayReady DRM allows playback of content with output protection policies only on output connectors as specified in the PlayReady Compliance Rules.","pos":[14037,14183]},{"content":"For more information about output connector terms specified in the PlayReady Compliance Rules, see <bpt id=\"p1\">[</bpt>Defined Terms for PlayReady Compliance and Robustness Rules<ept id=\"p1\">](https://www.microsoft.com/playready/licensing/compliance/)</ept>.","pos":[14184,14404]},{"content":"This section focuses on output protection scenarios with PlayReady DRM for Windows 10 and PlayReady Hardware DRM for Windows 10, which is also available on some Windows clients.","pos":[14406,14583]},{"content":"With PlayReady HWDRM, all output protections are enforced from within the Windows TEE implementation (see <bpt id=\"p1\">[</bpt>Hardware DRM<ept id=\"p1\">](hardware-drm.md)</ept>).","pos":[14584,14723]},{"content":"As a result, some behaviors differ from when using PlayReady SWDRM (software DRM):","pos":[14724,14806]},{"content":"Support for Output Protection Level (OPL) for Uncompressed Digital Video 270: PlayReady HWDRM for Windows 10 doesn't support down-resolution and will enforce that HDCP (High-bandwidth Digital Content Protection) is engaged.","pos":[14810,15033]},{"content":"It is recommended that high definition content for HWDRM have an OPL greater than 270 (although it is not required).","pos":[15034,15150]},{"content":"Additionally, you should set HDCP type restriction in the license (HDCP version 2.2 or later).","pos":[15151,15245]},{"content":"Unlike SWDRM, with HWDRM, output protections are enforced on all monitors based on the least capable monitor.","pos":[15248,15357]},{"content":"For example, if the user has two monitors connected where one supports HDCP and the other doesn't, playback will fail if the license requires HDCP even if the content is only being rendered on the monitor that supports HDCP.","pos":[15358,15582]},{"content":"In SWDRM, content will play back as long as it's only being rendered on the monitor that supports HDCP.","pos":[15583,15686]},{"content":"HWDRM is not guaranteed to be used by the client and secure unless the following conditions are met by the content keys and licenses:","pos":[15689,15822]},{"content":"The license used for the video content key must have a minimum security level of 3000.","pos":[15829,15915]},{"content":"Audio must be encrypted to a different content key than video, and the license used for audio must have a minimum security level of 2000.","pos":[15922,16059]},{"content":"Alternatively, audio could be left in the clear.","pos":[16060,16108]},{"content":"All SWDRM scenarios require that the minimum security level of the PlayReady license used for the audio and/or video content key is lower or equal to 2000.","pos":[16111,16266]},{"content":"Output protection levels","pos":[16272,16296]},{"content":"The following table outlines the mappings between various OPLs in the PlayReady license and how PlayReady DRM for Windows 10 enforces them.","pos":[16298,16437]},{"content":"Video","pos":[16444,16449]},{"content":"OPL","pos":[16492,16495]},{"content":"Compressed digital video","pos":[16513,16537]},{"content":"Uncompressed digital video","pos":[16567,16593]},{"content":"Analog TV","pos":[16611,16620]},{"content":"Any","pos":[16657,16660]},{"content":"HDMI, DVI, DisplayPort, MHL","pos":[16690,16717]},{"content":"Component, Composite","pos":[16735,16755]},{"content":"0-100","pos":[16792,16797]},{"content":"Windows 10 never passes compressed digital video content to outputs, regardless of the subsequent OPL value.","pos":[16827,16935]},{"content":"For more information about compressed digital video content, see the <bpt id=\"p1\">[</bpt>Compliance Rules for PlayReady Products<ept id=\"p1\">](https://www.microsoft.com/playready/licensing/compliance/)</ept>","pos":[16936,17105]},{"content":"Passes content","pos":[17147,17161]},{"content":"Passes content","pos":[17179,17193]},{"content":"101-150","pos":[17230,17237]},{"content":"Passes content when CGMS-A CopyNever is engaged or if CGMS-A can't be engaged","pos":[17255,17332]},{"content":"151-200","pos":[17369,17376]},{"content":"Passes content when CGMS-A CopyNever is engaged","pos":[17394,17441]},{"content":"201-250","pos":[17478,17485]},{"content":"Attempts to engage HDCP, but passes content regardless of result","pos":[17515,17579]},{"content":"Does NOT pass content","pos":[17609,17630]},{"content":"251-270","pos":[17667,17674]},{"content":"<bpt id=\"p1\">**</bpt>SWDRM<ept id=\"p1\">**</ept>: Attempts to engage HDCP.","pos":[17692,17727]},{"content":"If HDCP fails to engage, the PC will constrain the effective resolution to 520,000 pixels per frame and pass the content","pos":[17728,17848]},{"content":"<bpt id=\"p1\">**</bpt>HWDRM<ept id=\"p1\">**</ept>: Passes content with HDCP.","pos":[17866,17902]},{"content":"If HDCP fails to engage, playback to HDMI/DVI ports is blocked","pos":[17903,17965]},{"content":"271-299","pos":[18002,18009]},{"content":"Passes content with HDCP.","pos":[18039,18064]},{"content":"If HDCP fails to engage, playback to HDMI/DVI ports is blocked","pos":[18065,18127]},{"content":"300","pos":[18164,18167]},{"content":"<bpt id=\"p1\">**</bpt>When HDCP type restriction is defined<ept id=\"p1\">**</ept>: passes content with HDCP 2.2 and content stream type set to 1.","pos":[18197,18302]},{"content":"If HDCP fails to engage or content stream type can't be set to 1, playback to HDMI/DVI ports is blocked","pos":[18303,18406]},{"content":"300","pos":[18445,18448]},{"content":"Does NOT pass content","pos":[18478,18499]},{"content":"Audio","pos":[18530,18535]},{"content":"OPL","pos":[18578,18581]},{"content":"Compressed digital audio","pos":[18599,18623]},{"content":"Uncompressed digital audio","pos":[18641,18667]},{"content":"Analog or USB audio","pos":[18685,18704]},{"content":"HDMI, DisplayPort, MHL","pos":[18741,18763]},{"content":"HDMI, DisplayPort, MHL","pos":[18781,18803]},{"content":"Any","pos":[18821,18824]},{"content":"0-100","pos":[18861,18866]},{"content":"Passes content","pos":[18896,18910]},{"content":"Passes content","pos":[18928,18942]},{"content":"Passes content","pos":[18972,18986]},{"content":"101-200","pos":[19023,19030]},{"content":"Does NOT pass content","pos":[19060,19081]},{"content":"201-250","pos":[19118,19125]},{"content":"Passes content when HDCP is engaged on HDMI, DisplayPort, or MHL, or when SCMS is engaged and set to CopyNever","pos":[19143,19253]},{"content":"251-300","pos":[19290,19297]},{"content":"Passes content when HDCP is engaged on HDMI, DisplayPort, or MHL","pos":[19315,19379]},{"content":"300","pos":[19418,19421]},{"content":"Does NOT pass content","pos":[19439,19460]},{"content":"Does NOT pass content","pos":[19478,19499]},{"content":"Miracast","pos":[19529,19537]},{"content":"PlayReady DRM allows you to play content over Miracast output as soon as HDCP 2.0 or later is engaged.","pos":[19539,19641]},{"content":"On Windows 10, however, Miracast is considered a <bpt id=\"p1\">*</bpt>digital<ept id=\"p1\">*</ept> output.","pos":[19642,19708]},{"content":"For more information about Miracast scenarios, see the <bpt id=\"p1\">[</bpt>PlayReady Compliance Rules<ept id=\"p1\">](https://www.microsoft.com/playready/licensing/compliance/)</ept>.","pos":[19709,19852]},{"content":"The following table outlines the mappings between various OPLs in the PlayReady license and how PlayReady DRM enforces them on Miracast outputs.","pos":[19853,19997]},{"content":"OPL","pos":[20028,20031]},{"content":"Compressed digital audio","pos":[20049,20073]},{"content":"Uncompressed digital audio","pos":[20091,20117]},{"content":"Compressed digital video","pos":[20135,20159]},{"content":"Uncompressed digital video","pos":[20177,20203]},{"content":"0-100","pos":[20240,20245]},{"content":"Passes content when HDCP 2.0 or later is engaged.","pos":[20275,20324]},{"content":"If it fails to engage, it does NOT pass content","pos":[20325,20372]},{"content":"Passes content when HDCP 2.0 or later is engaged.","pos":[20390,20439]},{"content":"If it fails to engage, it does NOT pass content","pos":[20440,20487]},{"content":"Windows 10 never passes compressed digital video content to outputs, regardless of the subsequent OPL value.","pos":[20517,20625]},{"content":"For more information about compressed digital video content, see the <bpt id=\"p1\">[</bpt>PlayReady Compliance Rules<ept id=\"p1\">](https://www.microsoft.com/playready/licensing/compliance/)</ept>","pos":[20626,20782]},{"content":"Passes content when HDCP 2.0 or later is engaged.","pos":[20812,20861]},{"content":"If it fails to engage, it does NOT pass content","pos":[20862,20909]},{"content":"101-299","pos":[20946,20953]},{"content":"Does NOT pass content","pos":[20983,21004]},{"content":"300","pos":[21041,21044]},{"content":"<bpt id=\"p1\">**</bpt>When HDCP type restriction is defined:<ept id=\"p1\">**</ept> passes content with HDCP 2.2 and content stream type set to 1.","pos":[21062,21167]},{"content":"If HDCP fails to engage or content stream type can't be set to 1, it does NOT pass content","pos":[21168,21258]},{"content":"300","pos":[21297,21300]},{"content":"Does NOT pass content","pos":[21318,21339]},{"content":"Does NOT pass content","pos":[21357,21378]},{"content":"Additional explicit output restrictions","pos":[21408,21447]},{"content":"The following table describes the PlayReady DRM for Windows 10 implementation of explicit digital video output protection restrictions.","pos":[21449,21584]},{"content":"Scenario","pos":[21615,21623]},{"content":"GUID","pos":[21641,21645]},{"content":"If...","pos":[21663,21668]},{"content":"Then...","pos":[21686,21693]},{"content":"Maximum effective resolution decode size","pos":[21730,21770]},{"content":"9645E831-E01D-4FFF-8342-0A720E3E028F","pos":[21788,21824]},{"content":"Connected output is: digital video output, Miracast, HDMI, DVI, etc.","pos":[21842,21910]},{"content":"Passes content when constrained to:","pos":[21961,21996]},{"content":"(a) the width of the frame must be less than or equal to the maximum frame width in pixels and the height of the frame less than or equal to the maximum frame height in pixels, or","pos":[22053,22232]},{"content":"(b) the height of the frame must be less than or equal to the maximum frame width in pixels and the width of the frame less than or equal to the maximum frame height in pixels","pos":[22258,22433]},{"content":"HDCP type restriction","pos":[22521,22542]},{"content":"ABB2C6F1-E663-4625-A945-972D17B231E7","pos":[22560,22596]},{"content":"Connected output is: digital video output, Miracast, HDMI, DVI, etc.","pos":[22614,22682]},{"content":"Passes content with HDCP 2.2 and the content stream type set to 1.","pos":[22700,22766]},{"content":"If HDCP 2.2 fails to engage or the content stream type can't be set to 1, it does NOT pass content.","pos":[22767,22866]},{"content":"Uncompressed digital video output protection level of a value greater than or equal to 300 must also be specified","pos":[22867,22980]},{"content":"The following table describes the PlayReady DRM for Windows 10 implementation of explicit analog video output protection restrictions.","pos":[23006,23140]},{"content":"Scenario","pos":[23171,23179]},{"content":"GUID","pos":[23197,23201]},{"content":"If...","pos":[23219,23224]},{"content":"Then...","pos":[23254,23261]},{"content":"Analog computer monitor","pos":[23298,23321]},{"content":"D783A191-E083-4BAF-B2DA-E69F910B3772","pos":[23339,23375]},{"content":"Connected output is: VGA, DVI<ph id=\"ph1\">&amp;ndash;</ph>analog, etc.","pos":[23393,23441]},{"content":"<bpt id=\"p1\">**</bpt>SWDRM:<ept id=\"p1\">**</ept> PC will constrain effective resolution to 520,000 epx per frame and pass content","pos":[23459,23550]},{"content":"<bpt id=\"p1\">**</bpt>HWDRM:<ept id=\"p1\">**</ept> Does NOT pass content","pos":[23568,23600]},{"content":"Analog component","pos":[23637,23653]},{"content":"811C5110-46C8-4C6E-8163-C0482A15D47E","pos":[23671,23707]},{"content":"Connected output is: component","pos":[23725,23755]},{"content":"<bpt id=\"p1\">**</bpt>SWDRM:<ept id=\"p1\">**</ept> PC will constrain effective resolution to 520,000 epx per frame and pass content","pos":[23773,23864]},{"content":"<bpt id=\"p1\">**</bpt>HWDRM:<ept id=\"p1\">**</ept> Does NOT pass content","pos":[23882,23914]},{"content":"Analog TV outputs","pos":[23963,23980]},{"content":"2098DE8D-7DDD-4BAB-96C6-32EBB6FABEA3","pos":[23998,24034]},{"content":"Analog TV OPL is less than 151","pos":[24052,24082]},{"content":"CGMS-A must be engaged","pos":[24112,24134]},{"content":"225CD36F-F132-49EF-BA8C-C91EA28E4369","pos":[24171,24207]},{"content":"Analog TV OPL is less than 101 and license doesn't contain 2098DE8D-7DDD-4BAB-96C6-32EBB6FABEA3","pos":[24225,24320]},{"content":"CGMS-A engagement must be attempted, but content may play regardless of result","pos":[24350,24428]},{"content":"Automatic gain control and color stripe","pos":[24465,24504]},{"content":"C3FD11C6-F8B7-4D20-B008-1DB17D61F2DA","pos":[24522,24558]},{"content":"Passing content with resolution less than or equal to 520,000 px to analog TV output","pos":[24576,24660]},{"content":"Sets AGC only for component video and PAL mode when resolution is less than 520,000 px and sets AGC and color stripe information for NTSC when resolution is less than 520,000 px, according to table 3.5.7.3.","pos":[24690,24896]},{"content":"in Compliance Rules","pos":[24897,24916]},{"content":"Digital-only output","pos":[24953,24972]},{"content":"760AE755-682A-41E0-B1B3-DCDF836A7306","pos":[24990,25026]},{"content":"Connected output is analog","pos":[25044,25070]},{"content":"Does not pass content","pos":[25100,25121]},{"pos":[25149,25327],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept> When using an adapter dongle such as \"Mini DisplayPort to VGA\" for playback, Windows 10 sees the output as digital video output, and can't enforce analog video policies."},{"content":"The following table describes the PlayReady DRM for Windows 10 implementation that enables playing in other circumstances.","pos":[25329,25451]},{"content":"Scenario","pos":[25482,25490]},{"content":"GUID","pos":[25508,25512]},{"content":"If...","pos":[25530,25535]},{"content":"Then...","pos":[25565,25572]},{"content":"Unknown output","pos":[25609,25623]},{"content":"786627D8-C2A6-44BE-8F88-08AE255B01A7","pos":[25641,25677]},{"content":"If output can't reasonably be determined, or OPM can't be established with graphics driver","pos":[25695,25785]},{"content":"<bpt id=\"p1\">**</bpt>SWDRM:<ept id=\"p1\">**</ept> Passes content","pos":[25803,25828]},{"content":"<bpt id=\"p1\">**</bpt>HWDRM:<ept id=\"p1\">**</ept> Does NOT pass content","pos":[25846,25878]},{"content":"Unknown output with constriction","pos":[25915,25947]},{"content":"B621D91F-EDCC-4035-8D4B-DC71760D43E9","pos":[25965,26001]},{"content":"If output can't reasonably be determined, or OPM can't be established with graphics driver","pos":[26019,26109]},{"content":"<bpt id=\"p1\">**</bpt>SWDRM:<ept id=\"p1\">**</ept> PC will constrain effective resolution to 520,000 epx per frame and pass content","pos":[26127,26218]},{"content":"<bpt id=\"p1\">**</bpt>HWDRM:<ept id=\"p1\">**</ept> Does NOT pass content","pos":[26236,26268]},{"content":"Prerequisites","pos":[26297,26310]},{"content":"Before you begin creating your PlayReady-protected UWP app, the following software needs to be installed on your system:","pos":[26312,26432]},{"content":"Windows 10.","pos":[26438,26449]},{"content":"If you are compiling any of the samples for PlayReady DRM for UWP apps, you must use Microsoft Visual Studio 2015 or later to compile the samples.","pos":[26454,26600]},{"content":"You can still use Microsoft Visual Studio 2013 to compile any of the samples from PlayReady DRM for Windows 8.1 Store Apps.","pos":[26601,26724]},{"pos":[26726,26909],"content":"If you are planning to play back MPEG-2/H.262 content on your app, you must also download and install <bpt id=\"p1\">[</bpt>Windows 8.1 Media Center Pack<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=626876)</ept>."},{"content":"PlayReady Windows Store app migration guide","pos":[26914,26957]},{"content":"This section includes information on how to migrate your existing PlayReady Windows 8.x Store apps to Windows 10.","pos":[26959,27072]},{"content":"The namespace for PlayReady UWP apps on Windows 10 was changed from <bpt id=\"p1\">**</bpt>Microsoft.Media.PlayReadyClient<ept id=\"p1\">**</ept> to <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>Windows.Media.Protection.PlayReady<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/dn986454)</ept>.","pos":[27074,27280]},{"content":"This means that you will need to search and replace the old namespace with the new one in your code.","pos":[27281,27381]},{"content":"You will still be referencing a winmd file.","pos":[27382,27425]},{"content":"It is part of windows.media.winmd on the Windows 10 operating system.","pos":[27426,27495]},{"content":"It is in windows.winmd as part of the TH’s Windows SDK.","pos":[27496,27551]},{"content":"For UWP, it’s referenced in windows.foundation.univeralappcontract.winmd.","pos":[27552,27625]},{"content":"To play back PlayReady-protected high definition (HD) content (1080p) and ultra-high definition (UHD) content, you will need to implement PlayReady hardware DRM.","pos":[27627,27788]},{"content":"For information on how to implement PlayReady hardware DRM, see <bpt id=\"p1\">[</bpt>Hardware DRM<ept id=\"p1\">](hardware-drm.md)</ept>.","pos":[27789,27885]},{"content":"Some content is not supported in hardware DRM.","pos":[27887,27933]},{"content":"For information on disabling hardware DRM and enabling software DRM, see <bpt id=\"p1\">[</bpt>Override Hardware DRM<ept id=\"p1\">](hardware-drm.md#override-hardware-drm)</ept>.","pos":[27934,28070]},{"content":"Regarding the media protection manager, make sure your code has the following settings if it doesn’t already:","pos":[28072,28181]},{"content":"Proactively acquire a non-persistent license before playback","pos":[28886,28946]},{"content":"This section describes how to acquire non-persistent licenses proactively before playback begins.","pos":[28948,29045]},{"content":"In previous versions of PlayReady DRM, non-persistent licenses could only be acquired reactively during playback.","pos":[29047,29160]},{"content":"In this version, you can acquire non-persistent licenses proactively before playback begins.","pos":[29161,29253]},{"content":"Proactively create a playback session where the non-persistent license can be stored.","pos":[29259,29344]},{"content":"For example:","pos":[29345,29357]},{"content":"Tie that playback session to the license acquisition class.","pos":[29966,30025]},{"content":"For example:","pos":[30026,30038]},{"content":"Create a license service request.","pos":[30360,30393]},{"content":"For example:","pos":[30394,30406]},{"content":"Perform the license acquisition using the service request created from step 3.","pos":[30487,30565]},{"content":"The license will be stored in the playback session.","pos":[30566,30617]},{"content":"Tie the playback session to the media source for playback.","pos":[30622,30680]},{"content":"For example:","pos":[30681,30693]},{"content":"Add secure stop","pos":[30870,30885]},{"content":"This section describes how to add secure stop to your UWP app.","pos":[30887,30949]},{"content":"Secure stop provides the means for a PlayReady device to confidently assert to a media streaming service that media playback has stopped for any given piece of content.","pos":[30951,31119]},{"content":"This capability ensures your media streaming services provide accurate enforcement and reporting of usage limitations on different devices for a given account.","pos":[31120,31279]},{"content":"There are two primary scenarios for sending a secure stop challenge:","pos":[31281,31349]},{"content":"When the media presentation stops because end of content was reached or when the user stopped the media presentation somewhere in the middle.","pos":[31355,31496]},{"content":"When the previous session ends unexpectedly (for example, due to a system or app crash).","pos":[31501,31589]},{"content":"The app will need to query, either at startup or shutdown, for any outstanding secure stop sessions and send challenge(s) separate from any other media playback.","pos":[31590,31751]},{"pos":[31753,31970],"content":"For a sample implementation of secure stop, see the securestop.cs file in the PlayReady sample located at <bpt id=\"p1\">[</bpt>http://go.microsoft.com/fwlink/p/?linkid=331670&amp;clcid=0x409<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=331670)</ept>."}],"content":"---\nauthor: eliotcowley\nms.assetid: DD8FFA8C-DFF0-41E3-8F7A-345C5A248FC2\ndescription: This topic describes how to add PlayReady protected media content to your Universal Windows Platform (UWP) app.\ntitle: PlayReady DRM\n---\n\n# PlayReady DRM\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\n\nThis topic describes how to add PlayReady protected media content to your Universal Windows Platform (UWP) app.\n\nPlayReady DRM enables developers to create UWP apps capable of providing PlayReady content to the user while enforcing the access rules defined by the content provider. This section describes changes made to Microsoft PlayReady DRM for Windows 10 and how to modify your PlayReady UWP app to support the changes made from the previous Windows 8.1 version to the Windows 10 version.\n \n| Topic                                                                     | Description                                                                                                                                                                                                                                                                             |\n|---------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| [Hardware DRM](hardware-drm.md)                                           | This topic provides an overview of how to add PlayReady hardware-based digital rights management (DRM) to your UWP app.                                                                                                                                                                 |\n| [Adaptive Streaming with PlayReady](adaptive-streaming-with-playready.md) | This article describes how to add adaptive streaming of multimedia content with Microsoft PlayReady content protection to a Universal Windows Platform (UWP) app. This feature currently supports playback of Http Live Streaming (HLS) and Dynamic Streaming over HTTP (DASH) content. |\n\n## What's new in PlayReady DRM\n\nThe following list describes the new features and changes made to PlayReady DRM for Windows 10.\n\n-   Added hardware digital rights management (HWDRM).\n\n    Hardware-based content protection support enables secure playback of high definition (HD) and ultra-high definition (UHD) content on multiple device platforms. Key material (including private keys, content keys, and any other key material used to derive or unlock said keys), and decrypted compressed and uncompressed video samples are protected by leveraging hardware security. When Hardware DRM is being used, neither unknown enabler (play to unknown / play to unknown with downres) has meaning as the HWDRM pipeline always knows the output being used. For more information, see [Hardware DRM](hardware-drm.md).\n\n-   PlayReady is no longer an appX framework component, but instead is an in-box operating system component. The namespace was changed from **Microsoft.Media.PlayReadyClient** to [**Windows.Media.Protection.PlayReady**](https://msdn.microsoft.com/library/windows/apps/dn986454).\n-   The following headers defining the PlayReady error codes are now part of the Windows Software Development Kit (SDK): Windows.Media.Protection.PlayReadyErrors.h and Windows.Media.Protection.PlayReadyResults.h.\n-   Provides proactive acquisition of non-persistent licenses.\n\n    Previous versions of PlayReady DRM did not support proactive acquisition of non-persistent licenses. This capability has been added to this version. This can decrease the time to first frame. For more information, see [Proactively Acquire a Non-Persistent License Before Playback](#proactively_acquire_a_non_persistent_license_before_playback).\n\n-   Provides acquisition of multiple licenses in one message.\n\n    Allows the client app to acquire multiple non-persistent licenses in one license acquisition message. This can decrease the time to first frame by acquiring licenses for multiple pieces of content while the user is still browsing your content library; this prevents a delay for license acquisition when the user selects the content to play. In addition, it allows audio and video streams to be encrypted to separate keys by enabling a content header that includes multiple key identifiers (KIDs); this enables a single license acquisition to acquire all licenses for all streams within a content file instead of having to use custom logic and multiple license acquisition requests to achieve the same result.\n\n-   Added real time expiration support, or limited duration license (LDL).\n\n    Provides the ability to set real-time expiration on licenses and smoothly transition from an expiring license to another (valid) license in the middle of playback. When combined with acquisition of multiple licenses in one message, this allows an app to acquire several LDLs asynchronously while the user is still browsing the content library and only acquire a longer duration license once the user has selected content to playback. Playback will then start more quickly (because a license is already available) and, since the app will have acquired a longer duration license by the time the LDL expires, smoothly continue playback to the end of the content without interruption.\n\n-   Added non-persistent license chains.\n-   Added support for time-based restrictions (including expiration, expire after first play, and real time expiration) on non-persistent licenses.\n-   Added HDCP Type 1 (version 2.2 on Windows 10) policy support.\n\n    See [Things to Consider](#things_to_consider) for more information.\n\n-   Miracast is now implicit as an output.\n-   Added secure stop.\n\n    Secure stop provides the means for a PlayReady device to confidently assert to a media streaming service that media playback has stopped for any given piece of content. This capability ensures your media streaming services provide accurate enforcement and reporting of usage limitations on different devices for a given account.\n\n-   Added audio and video license separation.\n\n    Separate tracks prevent video from being decoded as audio; enabling more robust content protection. Emerging standards are requiring separate keys for audio and visual tracks.\n\n-   Added MaxResDecode.\n\n    This feature was added to limit playback of content to a maximum resolution even when in possession of a more capable key (but not a license). It supports cases where multiple stream sizes are encoded with a single key.\n\nThe following new interfaces, classes, and enumerations were added to PlayReady DRM:\n\n-   [**IPlayReadyLicenseAcquisitionServiceRequest**](https://msdn.microsoft.com/library/windows/apps/dn986077) interface\n-   [**IPlayReadyLicenseSession**](https://msdn.microsoft.com/library/windows/apps/dn986080) interface\n-   [**IPlayReadySecureStopServiceRequest**](https://msdn.microsoft.com/library/windows/apps/dn986090) interface\n-   [**PlayReadyLicenseSession**](https://msdn.microsoft.com/library/windows/apps/dn986309) class\n-   [**PlayReadySecureStopIterable**](https://msdn.microsoft.com/library/windows/apps/dn986371) class\n-   [**PlayReadySecureStopIterator**](https://msdn.microsoft.com/library/windows/apps/dn986375) class\n-   [**PlayReadyHardwareDRMFeatures**](https://msdn.microsoft.com/library/windows/apps/dn986265) enumerator\n\nA new sample has been created to demonstrate how to use the new features of PlayReady DRM. The sample can be downloaded from [http://go.microsoft.com/fwlink/p/?linkid=331670&clcid=0x409](http://go.microsoft.com/fwlink/p/?linkid=331670).\n\n## Things to consider\n\n-   PlayReady DRM now supports HDCP Type 1 (supported in HDCP version 2.1 or later). PlayReady carries an HDCP Type Restriction policy in the license for the device to enforce. On Windows 10, this policy will enforce that HDCP 2.2 or later is engaged. This feature can be enabled in your PlayReady Server v3.0 SDK license (the server controls this policy in the license using the HDCP Type Restriction GUID). For more information, see the [PlayReady Compliance and Robustness Rules](http://www.microsoft.com/playready/licensing/compliance/).\n-   Windows Media Video (also known as VC-1) is not supported in hardware DRM (see [Override Hardware DRM](hardware-drm.md#override-hardware-drm)).\n-   PlayReady DRM now supports the High Efficiency Video Coding (HEVC /H.265) video compression standard. To support HEVC, your app must use Common Encryption Scheme (CENC) version 2 content which includes leaving the content's slice headers in the clear. Refer to ISO/IEC 23001-7 Information technology -- MPEG systems technologies -- Part 7: Common encryption in ISO base media file format files (Spec version ISO/IEC 23001-7:2015 or higher is required.) for more information. Microsoft also recommends using CENC version 2 for all HWDRM content. In addition, some hardware DRM will support HEVC and some will not (see [Override Hardware DRM](hardware-drm.md#override-hardware-drm)).\n-   To take advantage of certain new PlayReady 3.0 features (including, but not limited to, SL3000 for hardware-based clients, acquiring multiple non-persistent licenses in one license acquisition message, and time-based restrictions on non-persistent licenses), the PlayReady server is required to be the Microsoft PlayReady Server Software Development Kit v3.0.2769 Release version or later.\n-   Depending on the Output Protection Policy specified in the content license, media playback may fail for end users if their connected output does not support those requirements. The following table lists the set of common errors that occur as a result. For more information, see the [PlayReady Compliance and Robustness Rules](http://www.microsoft.com/playready/licensing/compliance/).\n\n| Error                                                   | Value      | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |\n|---------------------------------------------------------|------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| ERROR\\_GRAPHICS\\_OPM\\_OUTPUT\\_DOES\\_NOT\\_SUPPORT\\_HDCP  | 0xC0262513 | The license's Output Protection Policy requires the monitor to engage HDCP, but HDCP was unable to be engaged.                                                                                                                                                                                                                                                                                                                                                                                              |\n| MF\\_E\\_POLICY\\_UNSUPPORTED                              | 0xC00D7159 | The license's Output Protection Policy requires the monitor to engage HDCP Type 1, but HDCP Type 1 was unable to be engaged.                                                                                                                                                                                                                                                                                                                                                                                |\n| DRM\\_E\\_TEE\\_OUTPUT\\_PROTECTION\\_REQUIREMENTS\\_NOT\\_MET | 0x8004CD22 | This error code only occurs when running under hardware DRM. The license's Output Protection Policy requires the monitor to engage HDCP or to reduce the content's effective resolution, but HDCP was unable to be engaged and the content's effective resolution could not be reduced because hardware DRM does not support reducing the content's resolution. Under software DRM, the content plays. See [Considerations for Using Hardware DRM](hardware-drm.md#considerations-for-using-hardware-drm). |\n| ERROR\\_GRAPHICS\\_OPM\\_NOT\\_SUPPORTED                    | 0xc0262500 | The graphics driver does not support Output Protection. For example, the monitor is connected through VGA or an appropriate graphics driver for the digital output is not installed. In the latter case, the typical driver that is installed is the Microsoft Basic Display Adapter and installing an appropriate graphics driver will resolve the issue.                                                                                                                                                  |\n\n## Output protection\n\nThe following section describes the behavior when using PlayReady DRM for Windows 10 with output protection policies in a PlayReady license.\n\nPlayReady DRM supports output protection levels contained in the **Microsoft PlayReady Extensible Media Rights Specification**. This document can be found in the documentation pack that comes with PlayReady licensed products.\n\n> **Note**&nbsp;&nbsp;The allowed values for output protection levels that can be set by a licensing server are governed by the [PlayReady Compliance Rules](https://www.microsoft.com/playready/licensing/compliance/).\n\nPlayReady DRM allows playback of content with output protection policies only on output connectors as specified in the PlayReady Compliance Rules. For more information about output connector terms specified in the PlayReady Compliance Rules, see [Defined Terms for PlayReady Compliance and Robustness Rules](https://www.microsoft.com/playready/licensing/compliance/).\n\nThis section focuses on output protection scenarios with PlayReady DRM for Windows 10 and PlayReady Hardware DRM for Windows 10, which is also available on some Windows clients. With PlayReady HWDRM, all output protections are enforced from within the Windows TEE implementation (see [Hardware DRM](hardware-drm.md)). As a result, some behaviors differ from when using PlayReady SWDRM (software DRM):\n\n* Support for Output Protection Level (OPL) for Uncompressed Digital Video 270: PlayReady HWDRM for Windows 10 doesn't support down-resolution and will enforce that HDCP (High-bandwidth Digital Content Protection) is engaged. It is recommended that high definition content for HWDRM have an OPL greater than 270 (although it is not required). Additionally, you should set HDCP type restriction in the license (HDCP version 2.2 or later).\n* Unlike SWDRM, with HWDRM, output protections are enforced on all monitors based on the least capable monitor. For example, if the user has two monitors connected where one supports HDCP and the other doesn't, playback will fail if the license requires HDCP even if the content is only being rendered on the monitor that supports HDCP. In SWDRM, content will play back as long as it's only being rendered on the monitor that supports HDCP.\n* HWDRM is not guaranteed to be used by the client and secure unless the following conditions are met by the content keys and licenses:\n    * The license used for the video content key must have a minimum security level of 3000.\n    * Audio must be encrypted to a different content key than video, and the license used for audio must have a minimum security level of 2000. Alternatively, audio could be left in the clear.\n* All SWDRM scenarios require that the minimum security level of the PlayReady license used for the audio and/or video content key is lower or equal to 2000.\n\n### Output protection levels\n\nThe following table outlines the mappings between various OPLs in the PlayReady license and how PlayReady DRM for Windows 10 enforces them.\n\n#### Video\n\n<table>\n    <tr>\n        <th rowspan=\"2\">OPL</th>\n        <th>Compressed digital video</th>\n        <th colspan=\"2\">Uncompressed digital video</th>\n        <th>Analog TV</th>\n    </tr>\n    <tr>\n        <th>Any</th>\n        <th colspan=\"2\">HDMI, DVI, DisplayPort, MHL</th>\n        <th>Component, Composite</th>\n    </tr>\n    <tr>\n        <th>0-100</th>\n        <td rowspan=\"8\">Windows 10 never passes compressed digital video content to outputs, regardless of the subsequent OPL value. For more information about compressed digital video content, see the [Compliance Rules for PlayReady Products](https://www.microsoft.com/playready/licensing/compliance/)</td>\n        <td rowspan=\"3\" colspan=\"2\">Passes content</td>\n        <td>Passes content</td>\n    </tr>\n    <tr>\n        <th>101-150</th>\n        <td>Passes content when CGMS-A CopyNever is engaged or if CGMS-A can't be engaged</td>\n    </tr>\n    <tr>\n        <th>151-200</th>\n        <td>Passes content when CGMS-A CopyNever is engaged</td>\n    </tr>\n    <tr>\n        <th>201-250</th>\n        <td colspan=\"2\">Attempts to engage HDCP, but passes content regardless of result</td>\n        <td rowspan=\"5\">Does NOT pass content</td>\n    </tr>\n    <tr>\n        <th>251-270</th>\n        <td>**SWDRM**: Attempts to engage HDCP. If HDCP fails to engage, the PC will constrain the effective resolution to 520,000 pixels per frame and pass the content</td>\n        <td>**HWDRM**: Passes content with HDCP. If HDCP fails to engage, playback to HDMI/DVI ports is blocked</td>\n    </tr>\n    <tr>\n        <th>271-299</th>\n        <td colspan=\"2\">Passes content with HDCP. If HDCP fails to engage, playback to HDMI/DVI ports is blocked</td>\n    </tr>\n    <tr>\n        <th>300</th>\n        <td colspan=\"2\">**When HDCP type restriction is defined**: passes content with HDCP 2.2 and content stream type set to 1. If HDCP fails to engage or content stream type can't be set to 1, playback to HDMI/DVI ports is blocked</td>\n    </tr>\n    <tr>\n        <th>\\>300</th>\n        <td colspan=\"2\">Does NOT pass content</td>\n    </tr>\n</table>\n\n#### Audio\n\n<table>\n    <tr>\n        <th rowspan=\"2\">OPL</th>\n        <th>Compressed digital audio</th>\n        <th>Uncompressed digital audio</th>\n        <th>Analog or USB audio</th>\n    </tr>\n    <tr>\n        <th>HDMI, DisplayPort, MHL</th>\n        <th>HDMI, DisplayPort, MHL</th>\n        <th>Any</th>\n    </tr>\n    <tr>\n        <th>0-100</th>\n        <td rowspan=\"2\">Passes content</td>\n        <td>Passes content</td>\n        <td rowspan=\"4\">Passes content</td>\n    </tr>\n    <tr>\n        <th>101-200</th>\n        <td rowspan=\"4\">Does NOT pass content</td>\n    </tr>\n    <tr>\n        <th>201-250</th>\n        <td>Passes content when HDCP is engaged on HDMI, DisplayPort, or MHL, or when SCMS is engaged and set to CopyNever</td>\n    </tr>\n    <tr>\n        <th>251-300</th>\n        <td>Passes content when HDCP is engaged on HDMI, DisplayPort, or MHL</td>\n    </tr>\n    <tr>\n        <th>\\>300</th>\n        <td>Does NOT pass content</td>\n        <td>Does NOT pass content</td>\n    </tr>\n</table>\n\n### Miracast\n\nPlayReady DRM allows you to play content over Miracast output as soon as HDCP 2.0 or later is engaged. On Windows 10, however, Miracast is considered a *digital* output. For more information about Miracast scenarios, see the [PlayReady Compliance Rules](https://www.microsoft.com/playready/licensing/compliance/). The following table outlines the mappings between various OPLs in the PlayReady license and how PlayReady DRM enforces them on Miracast outputs.\n\n<table>\n    <tr>\n        <th>OPL</th>\n        <th>Compressed digital audio</th>\n        <th>Uncompressed digital audio</th>\n        <th>Compressed digital video</th>\n        <th>Uncompressed digital video</th>\n    </tr>\n    <tr>\n        <th>0-100</th>\n        <td rowspan=\"3\">Passes content when HDCP 2.0 or later is engaged. If it fails to engage, it does NOT pass content</td>\n        <td>Passes content when HDCP 2.0 or later is engaged. If it fails to engage, it does NOT pass content</td>\n        <td rowspan=\"4\">Windows 10 never passes compressed digital video content to outputs, regardless of the subsequent OPL value. For more information about compressed digital video content, see the [PlayReady Compliance Rules](https://www.microsoft.com/playready/licensing/compliance/)</td>\n        <td rowspan=\"2\">Passes content when HDCP 2.0 or later is engaged. If it fails to engage, it does NOT pass content</td>\n    </tr>\n    <tr>\n        <th>101-299</th>\n        <td rowspan=\"3\">Does NOT pass content</td>\n    </tr>\n    <tr>\n        <th>300</th>\n        <td>**When HDCP type restriction is defined:** passes content with HDCP 2.2 and content stream type set to 1. If HDCP fails to engage or content stream type can't be set to 1, it does NOT pass content</td>\n    </tr>\n    <tr>\n        <th>\\>300</th>\n        <td>Does NOT pass content</td>\n        <td>Does NOT pass content</td>\n    </tr>\n</table>\n\n### Additional explicit output restrictions\n\nThe following table describes the PlayReady DRM for Windows 10 implementation of explicit digital video output protection restrictions.\n\n<table>\n    <tr>\n        <th>Scenario</th>\n        <th>GUID</th>\n        <th>If...</th>\n        <th>Then...</th>\n    </tr>\n    <tr>\n        <th>Maximum effective resolution decode size</th>\n        <td>9645E831-E01D-4FFF-8342-0A720E3E028F</td>\n        <td>Connected output is: digital video output, Miracast, HDMI, DVI, etc.</td>\n        <td>\n            <p>\n                Passes content when constrained to:  \n            </p>\n            <ul>\n                <li>(a) the width of the frame must be less than or equal to the maximum frame width in pixels and the height of the frame less than or equal to the maximum frame height in pixels, or</li>\n                <li>(b) the height of the frame must be less than or equal to the maximum frame width in pixels and the width of the frame less than or equal to the maximum frame height in pixels</li>\n            </ul>                   \n        </td>\n    </tr>\n    <tr>\n        <th>HDCP type restriction</th>\n        <td>ABB2C6F1-E663-4625-A945-972D17B231E7</td>\n        <td>Connected output is: digital video output, Miracast, HDMI, DVI, etc.</td>\n        <td>Passes content with HDCP 2.2 and the content stream type set to 1. If HDCP 2.2 fails to engage or the content stream type can't be set to 1, it does NOT pass content. Uncompressed digital video output protection level of a value greater than or equal to 300 must also be specified</td>\n    </tr>\n</table>\n\nThe following table describes the PlayReady DRM for Windows 10 implementation of explicit analog video output protection restrictions.\n\n<table>\n    <tr>\n        <th>Scenario</th>\n        <th>GUID</th>\n        <th>If...</th>\n        <th colspan=\"2\">Then...</th>\n    </tr>\n    <tr>\n        <th>Analog computer monitor</th>\n        <td>D783A191-E083-4BAF-B2DA-E69F910B3772</td>\n        <td>Connected output is: VGA, DVI&ndash;analog, etc.</td>\n        <td>**SWDRM:** PC will constrain effective resolution to 520,000 epx per frame and pass content</td>\n        <td>**HWDRM:** Does NOT pass content</td>\n    </tr>\n    <tr>\n        <th>Analog component</th>\n        <td>811C5110-46C8-4C6E-8163-C0482A15D47E</td>\n        <td>Connected output is: component</td>\n        <td>**SWDRM:** PC will constrain effective resolution to 520,000 epx per frame and pass content</td>\n        <td>**HWDRM:** Does NOT pass content</td>\n    </tr>\n    <tr>\n        <th rowspan=\"2\">Analog TV outputs</th>\n        <td>2098DE8D-7DDD-4BAB-96C6-32EBB6FABEA3</td>\n        <td>Analog TV OPL is less than 151</td>\n        <td colspan=\"2\">CGMS-A must be engaged</td>\n    </tr>\n    <tr>\n        <td>225CD36F-F132-49EF-BA8C-C91EA28E4369</td>\n        <td>Analog TV OPL is less than 101 and license doesn't contain 2098DE8D-7DDD-4BAB-96C6-32EBB6FABEA3</td>\n        <td colspan=\"2\">CGMS-A engagement must be attempted, but content may play regardless of result</td>\n    </tr>\n    <tr>\n        <th>Automatic gain control and color stripe</th>\n        <td>C3FD11C6-F8B7-4D20-B008-1DB17D61F2DA</td>\n        <td>Passing content with resolution less than or equal to 520,000 px to analog TV output</td>\n        <td colspan=\"2\">Sets AGC only for component video and PAL mode when resolution is less than 520,000 px and sets AGC and color stripe information for NTSC when resolution is less than 520,000 px, according to table 3.5.7.3. in Compliance Rules</td>\n    </tr>\n    <tr>\n        <th>Digital-only output</th>\n        <td>760AE755-682A-41E0-B1B3-DCDF836A7306</td>\n        <td>Connected output is analog</td>\n        <td colspan=\"2\">Does not pass content</td>\n    </tr>\n</table>\n\n> **Note** When using an adapter dongle such as \"Mini DisplayPort to VGA\" for playback, Windows 10 sees the output as digital video output, and can't enforce analog video policies.\n\nThe following table describes the PlayReady DRM for Windows 10 implementation that enables playing in other circumstances.\n\n<table>\n    <tr>\n        <th>Scenario</th>\n        <th>GUID</th>\n        <th>If...</th>\n        <th colspan=\"2\">Then...</th>\n    </tr>\n    <tr>\n        <th>Unknown output</th>\n        <td>786627D8-C2A6-44BE-8F88-08AE255B01A7</td>\n        <td>If output can't reasonably be determined, or OPM can't be established with graphics driver</td>\n        <td>**SWDRM:** Passes content</td>\n        <td>**HWDRM:** Does NOT pass content</td>\n    </tr>\n    <tr>\n        <th>Unknown output with constriction</th>\n        <td>B621D91F-EDCC-4035-8D4B-DC71760D43E9</td>\n        <td>If output can't reasonably be determined, or OPM can't be established with graphics driver</td>\n        <td>**SWDRM:** PC will constrain effective resolution to 520,000 epx per frame and pass content</td>\n        <td>**HWDRM:** Does NOT pass content</td>\n    </tr>\n</table>\n\n## Prerequisites\n\nBefore you begin creating your PlayReady-protected UWP app, the following software needs to be installed on your system:\n\n-   Windows 10.\n-   If you are compiling any of the samples for PlayReady DRM for UWP apps, you must use Microsoft Visual Studio 2015 or later to compile the samples. You can still use Microsoft Visual Studio 2013 to compile any of the samples from PlayReady DRM for Windows 8.1 Store Apps.\n\nIf you are planning to play back MPEG-2/H.262 content on your app, you must also download and install [Windows 8.1 Media Center Pack](http://go.microsoft.com/fwlink/p/?LinkId=626876).\n\n## PlayReady Windows Store app migration guide\n\nThis section includes information on how to migrate your existing PlayReady Windows 8.x Store apps to Windows 10.\n\nThe namespace for PlayReady UWP apps on Windows 10 was changed from **Microsoft.Media.PlayReadyClient** to [**Windows.Media.Protection.PlayReady**](https://msdn.microsoft.com/library/windows/apps/dn986454). This means that you will need to search and replace the old namespace with the new one in your code. You will still be referencing a winmd file. It is part of windows.media.winmd on the Windows 10 operating system. It is in windows.winmd as part of the TH’s Windows SDK. For UWP, it’s referenced in windows.foundation.univeralappcontract.winmd.\n\nTo play back PlayReady-protected high definition (HD) content (1080p) and ultra-high definition (UHD) content, you will need to implement PlayReady hardware DRM. For information on how to implement PlayReady hardware DRM, see [Hardware DRM](hardware-drm.md).\n\nSome content is not supported in hardware DRM. For information on disabling hardware DRM and enabling software DRM, see [Override Hardware DRM](hardware-drm.md#override-hardware-drm).\n\nRegarding the media protection manager, make sure your code has the following settings if it doesn’t already:\n\n```cs\nvar mediaProtectionManager = new Windows.Media.Protection.MediaProtectionManager();\n\nmediaProtectionManager.properties[\"Windows.Media.Protection.MediaProtectionSystemId\"] = \n             '{F4637010-03C3-42CD-B932-B48ADF3A6A54}'\nvar cpsystems = new Windows.Foundation.Collections.PropertySet();\ncpsystems[\"{F4637010-03C3-42CD-B932-B48ADF3A6A54}\"] = \n                \"Windows.Media.Protection.PlayReady.PlayReadyWinRTTrustedInput\";\nmediaProtectionManager.properties[\"Windows.Media.Protection.MediaProtectionSystemIdMapping\"] = cpsystems;\n\nmediaProtectionManager.properties[\"Windows.Media.Protection.MediaProtectionContainerGuid\"] = \n                \"{9A04F079-9840-4286-AB92-E65BE0885F95}\";\n```\n\n## Proactively acquire a non-persistent license before playback\n\nThis section describes how to acquire non-persistent licenses proactively before playback begins.\n\nIn previous versions of PlayReady DRM, non-persistent licenses could only be acquired reactively during playback. In this version, you can acquire non-persistent licenses proactively before playback begins.\n\n1.  Proactively create a playback session where the non-persistent license can be stored. For example:\n\n    ```cs\n    var cpsystems = new Windows.Foundation.Collections.PropertySet();       \n    cpsystems[\"{F4637010-03C3-42CD-B932-B48ADF3A6A54}\"] = \"Windows.Media.Protection.PlayReady.PlayReadyWinRTTrustedInput\"; // PlayReady\n\n    var pmpSystemInfo = new Windows.Foundation.Collections.PropertySet();\n    pmpSystemInfo[\"Windows.Media.Protection.MediaProtectionSystemId\"] = \"{F4637010-03C3-42CD-B932-B48ADF3A6A54}\";\n    pmpSystemInfo[\"Windows.Media.Protection.MediaProtectionSystemIdMapping\"] = cpsystems;\n    var pmpServer = new Windows.Media.Protection.MediaProtectionPMPServer( pmpSystemInfo );\n    ```\n\n2.  Tie that playback session to the license acquisition class. For example:\n\n    ```cs\n    var licenseSessionProperties = new Windows.Foundation.Collections.PropertySet();\n    licenseSessionProperties[\"Windows.Media.Protection.MediaProtectionPMPServer\"] = pmpServer;\n    var licenseSession = new Windows.Media.Protection.PlayReady.PlayReadyLicenseSession( licenseSessionProperties );\n    ```\n\n3.  Create a license service request. For example:\n\n    ```cs\n    var laSR = licenseSession.CreateLAServiceRequest();\n    ```\n\n4.  Perform the license acquisition using the service request created from step 3. The license will be stored in the playback session.\n5.  Tie the playback session to the media source for playback. For example:\n\n    ```cs\n    licenseSession.configureMediaProtectionManager( mediaProtectionManager );\n    videoPlayer.msSetMediaProtectionManager( mediaProtectionManager );\n    ```\n    \n## Add secure stop\n\nThis section describes how to add secure stop to your UWP app.\n\nSecure stop provides the means for a PlayReady device to confidently assert to a media streaming service that media playback has stopped for any given piece of content. This capability ensures your media streaming services provide accurate enforcement and reporting of usage limitations on different devices for a given account.\n\nThere are two primary scenarios for sending a secure stop challenge:\n\n-   When the media presentation stops because end of content was reached or when the user stopped the media presentation somewhere in the middle.\n-   When the previous session ends unexpectedly (for example, due to a system or app crash). The app will need to query, either at startup or shutdown, for any outstanding secure stop sessions and send challenge(s) separate from any other media playback.\n\nFor a sample implementation of secure stop, see the securestop.cs file in the PlayReady sample located at [http://go.microsoft.com/fwlink/p/?linkid=331670&clcid=0x409](http://go.microsoft.com/fwlink/p/?linkid=331670).\n\n \n\n \n\n\n\n\n"}