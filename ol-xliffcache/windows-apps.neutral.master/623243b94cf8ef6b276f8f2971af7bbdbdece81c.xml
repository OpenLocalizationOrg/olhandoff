{"nodes":[{"content":"Learn how to access and update the list of supported phrases (PhraseList elements) in a Voice Command Definition (VCD) file using the speech recognition result at run time.","pos":[47,219]},{"content":"Dynamically modify VCD phrase lists","pos":[227,262]},{"content":"Dynamically modify VCD phrase lists","pos":[371,406]},{"content":"Important APIs","pos":[414,428]},{"content":"Windows.ApplicationModel.VoiceCommands","pos":[439,477]},{"content":"VCD elements and attributes v1.2","pos":[546,578]},{"pos":[641,804],"content":"Access and update the list of supported phrases (<bpt id=\"p1\">**</bpt>PhraseList<ept id=\"p1\">**</ept> elements) in a Voice Command Definition (VCD) file at run time using the speech recognition result."},{"content":"Dynamically modifying a phrase list at run time is useful if the voice command is specific to a task involving some kind of user-defined, or transient, app data.","pos":[806,967]},{"content":"For example, let's say you have a travel app where users can enter destinations, and you want users to be able to start the app by saying the app name followed by \"Show trip to <ph id=\"ph1\">&amp;lt;</ph>destination<ph id=\"ph2\">&amp;gt;</ph>\".","pos":[970,1168]},{"content":"In the <bpt id=\"p1\">**</bpt>ListenFor<ept id=\"p1\">**</ept> element itself, you would specify something like: <ph id=\"ph1\">`&lt;ListenFor&gt; Show trip to {destination}  &lt;/ListenFor&gt;`</ph>, where \"destination\" is the value of the <bpt id=\"p2\">**</bpt>Label<ept id=\"p2\">**</ept> attribute for the <bpt id=\"p3\">**</bpt>PhraseList<ept id=\"p3\">**</ept>.","pos":[1169,1379]},{"content":"Updating the phrase list at run time eliminates the need to create a separate <bpt id=\"p1\">**</bpt>ListenFor<ept id=\"p1\">**</ept> element for each possible destination.","pos":[1381,1511]},{"content":"Instead, you can dynamically populate <bpt id=\"p1\">**</bpt>PhraseList<ept id=\"p1\">**</ept> with destinations specified by the user as they enter their itineraries.","pos":[1512,1637]},{"pos":[1640,1814],"content":"For more info about <bpt id=\"p1\">**</bpt>PhraseList<ept id=\"p1\">**</ept> and other VCD elements, see the <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>VCD elements and attributes v1.2<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/dn706593)</ept> reference."},{"content":"Prerequisites:","pos":[1818,1832]},{"content":"This topic builds on <bpt id=\"p1\">[</bpt>Launch a foreground app with voice commands in Cortana<ept id=\"p1\">](launch-a-foreground-app-with-voice-commands-in-cortana.md)</ept>.","pos":[1838,1975]},{"content":"We continue here to demonstrate features with a trip planning and management app named <bpt id=\"p1\">**</bpt>Adventure Works<ept id=\"p1\">**</ept>.","pos":[1976,2083]},{"content":"If you're new to developing Universal Windows Platform (UWP) apps, have a look through these topics to get familiar with the technologies discussed here.","pos":[2085,2238]},{"content":"Create your first app","pos":[2245,2266]},{"pos":[2330,2447],"content":"Learn about events with <bpt id=\"p1\">[</bpt>Events and routed events overview<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/mt185584)</ept>"},{"content":"User experience guidelines:","pos":[2451,2478]},{"pos":[2484,2792],"content":"See <bpt id=\"p1\">[</bpt>Cortana design guidelines<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn974233)</ept> for info about how to integrate your app with <bpt id=\"p2\">**</bpt>Cortana<ept id=\"p2\">**</ept> and <bpt id=\"p3\">[</bpt>Speech design guidelines<ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn596121)</ept> for helpful tips on designing a useful and engaging speech-enabled app."},{"pos":[2914,2961],"content":"Identify the command and update the phrase list"},{"content":"Here's an example VCD file that defines a <bpt id=\"p1\">**</bpt>Command<ept id=\"p1\">**</ept> \"showTripToDestination\" and a <bpt id=\"p2\">**</bpt>PhraseList<ept id=\"p2\">**</ept> that defines three options for destination in our <bpt id=\"p3\">**</bpt>Adventure Works<ept id=\"p3\">**</ept> travel app.","pos":[2963,3143]},{"content":"As the user saves and deletes destinations in the app, the app updates the options in the <bpt id=\"p1\">**</bpt>PhraseList<ept id=\"p1\">**</ept>.","pos":[3144,3249]},{"content":"To update a <bpt id=\"p1\">**</bpt>PhraseList<ept id=\"p1\">**</ept> element in the VCD file, get the <bpt id=\"p2\">**</bpt>CommandSet<ept id=\"p2\">**</ept> element that contains the phrase list.","pos":[4010,4123]},{"content":"Use the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> attribute of that <bpt id=\"p2\">**</bpt>CommandSet<ept id=\"p2\">**</ept> element (<bpt id=\"p3\">**</bpt>Name<ept id=\"p3\">**</ept> must be unique in the VCD file) as a key to access the <bpt id=\"p4\">[</bpt><bpt id=\"p5\">**</bpt>VoiceCommandManager.InstalledCommandSets<ept id=\"p5\">**</ept><ept id=\"p4\">](https://msdn.microsoft.com/library/windows/apps/dn653257)</ept> property and get the <bpt id=\"p6\">[</bpt><bpt id=\"p7\">**</bpt>VoiceCommandSet<ept id=\"p7\">**</ept><ept id=\"p6\">](https://msdn.microsoft.com/library/windows/apps/dn653258)</ept> reference.","pos":[4124,4463]},{"pos":[4465,4789],"content":"After you've identified the command set, get a reference to the phrase list that you want to modify and call the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>SetPhraseListAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn653261)</ept> method; use the <bpt id=\"p3\">**</bpt>Label<ept id=\"p3\">**</ept> attribute of the <bpt id=\"p4\">**</bpt>PhraseList<ept id=\"p4\">**</ept> element and an array of strings as the new content of the phrase list."},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  If you modify a phrase list, the entire phrase list is replaced.","pos":[4791,4865]},{"content":"If you want to insert new items into a phrase list, you must specify both the existing items and the new items in the call to <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>SetPhraseListAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn653261)</ept>.","pos":[4866,5075]},{"pos":[5077,5195],"content":"In this example, we update the <bpt id=\"p1\">**</bpt>PhraseList<ept id=\"p1\">**</ept> shown in the previous example with an additional destination to Phoenix."},{"pos":[5690,5697],"content":"Remarks"},{"content":"Using a <bpt id=\"p1\">**</bpt>PhraseList<ept id=\"p1\">**</ept> to constrain the recognition is appropriate for a relatively small set or words.","pos":[5700,5803]},{"content":"When the set of words is too large (hundreds of words, for example), or shouldn’t be constrained at all, use the <bpt id=\"p1\">**</bpt>PhraseTopic<ept id=\"p1\">**</ept> element and a <bpt id=\"p2\">**</bpt>Subject<ept id=\"p2\">**</ept> element to refine the relevance of speech-recognition results to improve scalability.","pos":[5804,6044]},{"pos":[6046,6171],"content":"In our example, we have a <bpt id=\"p1\">**</bpt>PhraseTopic<ept id=\"p1\">**</ept> with a <bpt id=\"p2\">**</bpt>Scenario<ept id=\"p2\">**</ept> of \"Search\", further refined by a <bpt id=\"p3\">**</bpt>Subject<ept id=\"p3\">**</ept> of \"City<ph id=\"ph1\">\\\\</ph>State\"."},{"pos":[7013,7029],"content":"Related articles"},{"content":"Developers","pos":[7034,7044]},{"content":"Cortana interactions","pos":[7050,7070]},{"content":"Launch a foreground app with voice commands in Cortana","pos":[7100,7154]},{"content":"Launch a background app with voice commands in Cortana","pos":[7218,7272]},{"content":"VCD elements and attributes v1.2","pos":[7338,7370]},{"content":"Designers","pos":[7435,7444]},{"content":"Cortana design guidelines","pos":[7450,7475]},{"content":"Speech design guidelines","pos":[7538,7562]},{"content":"Samples","pos":[7625,7632]},{"content":"Cortana voice command sample","pos":[7638,7666]}],"content":"---\nauthor: Karl-Bridge-Microsoft\nDescription: Learn how to access and update the list of supported phrases (PhraseList elements) in a Voice Command Definition (VCD) file using the speech recognition result at run time.\ntitle: Dynamically modify VCD phrase lists\nms.assetid: 98024EAC-EC0E-44AA-AEC5-A611BA7C5884\nlabel: Modify VCD phrase lists\ntemplate: detail.hbs\n---\n\n# Dynamically modify VCD phrase lists\n\n\n\n\n\n**Important APIs**\n\n-   [**Windows.ApplicationModel.VoiceCommands**](https://msdn.microsoft.com/library/windows/apps/dn706594)\n-   [**VCD elements and attributes v1.2**](https://msdn.microsoft.com/library/windows/apps/dn706593)\n\nAccess and update the list of supported phrases (**PhraseList** elements) in a Voice Command Definition (VCD) file at run time using the speech recognition result.\n\nDynamically modifying a phrase list at run time is useful if the voice command is specific to a task involving some kind of user-defined, or transient, app data. \n\nFor example, let's say you have a travel app where users can enter destinations, and you want users to be able to start the app by saying the app name followed by \"Show trip to &lt;destination&gt;\". In the **ListenFor** element itself, you would specify something like: `<ListenFor> Show trip to {destination}  </ListenFor>`, where \"destination\" is the value of the **Label** attribute for the **PhraseList**.\n\nUpdating the phrase list at run time eliminates the need to create a separate **ListenFor** element for each possible destination. Instead, you can dynamically populate **PhraseList** with destinations specified by the user as they enter their itineraries. \n\nFor more info about **PhraseList** and other VCD elements, see the [**VCD elements and attributes v1.2**](https://msdn.microsoft.com/library/windows/apps/dn706593) reference.\n\n**Prerequisites:  **\n\nThis topic builds on [Launch a foreground app with voice commands in Cortana](launch-a-foreground-app-with-voice-commands-in-cortana.md). We continue here to demonstrate features with a trip planning and management app named **Adventure Works**.\n\nIf you're new to developing Universal Windows Platform (UWP) apps, have a look through these topics to get familiar with the technologies discussed here.\n\n-   [Create your first app](https://msdn.microsoft.com/library/windows/apps/bg124288)\n-   Learn about events with [Events and routed events overview](https://msdn.microsoft.com/library/windows/apps/mt185584)\n\n**User experience guidelines:  **\n\nSee [Cortana design guidelines](https://msdn.microsoft.com/library/windows/apps/dn974233) for info about how to integrate your app with **Cortana** and [Speech design guidelines](https://msdn.microsoft.com/library/windows/apps/dn596121) for helpful tips on designing a useful and engaging speech-enabled app.\n\n## <span id=\"Identify_the_command\"></span><span id=\"identify_the_command\"></span><span id=\"IDENTIFY_THE_COMMAND\"></span>Identify the command and update the phrase list\n\nHere's an example VCD file that defines a **Command** \"showTripToDestination\" and a **PhraseList** that defines three options for destination in our **Adventure Works** travel app. As the user saves and deletes destinations in the app, the app updates the options in the **PhraseList**.\n\n```XML\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<VoiceCommands xmlns=\"http://schemas.microsoft.com/voicecommands/1.1\">\n  <CommandSet xml:lang=\"en-us\" Name=\"AdventureWorksCommandSet_en-us\">\n    <CommandPrefix> Adventure Works, </CommandPrefix>\n    <Example> Show trip to London </Example>\n\n    <Command Name=\"showTripToDestination\">\n      <Example> show trip to London  </Example>\n      <ListenFor> show trip to {destination} </ListenFor>\n      <Feedback> Showing trip to {destination} </Feedback>\n      <Navigate/>\n    </Command>\n\n    <PhraseList Label=\"destination\">\n      <Item> London </Item>\n      <Item> Dallas </Item>\n      <Item> New York </Item>\n    </PhraseList>\n\n  </CommandSet>\n\n<!-- Other CommandSets for other languages -->\n\n</VoiceCommands>\n\n```\n\nTo update a **PhraseList** element in the VCD file, get the **CommandSet** element that contains the phrase list. Use the **Name** attribute of that **CommandSet** element (**Name** must be unique in the VCD file) as a key to access the [**VoiceCommandManager.InstalledCommandSets**](https://msdn.microsoft.com/library/windows/apps/dn653257) property and get the [**VoiceCommandSet**](https://msdn.microsoft.com/library/windows/apps/dn653258) reference.\n\nAfter you've identified the command set, get a reference to the phrase list that you want to modify and call the [**SetPhraseListAsync**](https://msdn.microsoft.com/library/windows/apps/dn653261) method; use the **Label** attribute of the **PhraseList** element and an array of strings as the new content of the phrase list.\n\n**Note**  If you modify a phrase list, the entire phrase list is replaced. If you want to insert new items into a phrase list, you must specify both the existing items and the new items in the call to [**SetPhraseListAsync**](https://msdn.microsoft.com/library/windows/apps/dn653261).\n\nIn this example, we update the **PhraseList** shown in the previous example with an additional destination to Phoenix.\n\n```CSharp\nWindows.ApplicationModel.VoiceCommands.VoiceCommnadDefinition.VoiceCommandSet commandSetEnUs;\n\nif (Windows.ApplicationModel.VoiceCommands.VoiceCommandDefinitionManager.\n      InstalledCommandSets.TryGetValue(\n        \"AdventureWorksCommandSet_en-us\", out commandSetEnUs))\n{\n  await commandSetEnUs.SetPhraseListAsync(\n    \"destination\", new string[] {“London”, “Dallas”, “New York”, “Phoenix”});\n}\n```\n\n## <span id=\"Remarks\"></span><span id=\"remarks\"></span><span id=\"REMARKS\"></span>Remarks\n\n\nUsing a **PhraseList** to constrain the recognition is appropriate for a relatively small set or words. When the set of words is too large (hundreds of words, for example), or shouldn’t be constrained at all, use the **PhraseTopic** element and a **Subject** element to refine the relevance of speech-recognition results to improve scalability.\n\nIn our example, we have a **PhraseTopic** with a **Scenario** of \"Search\", further refined by a **Subject** of \"City\\\\State\".\n\n```XML\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<VoiceCommands xmlns=\"http://schemas.microsoft.com/voicecommands/1.1\">\n  <CommandSet xml:lang=\"en-us\" Name=\"AdventureWorksCommandSet_en-us\">\n    <CommandPrefix> Adventure Works, </CommandPrefix>\n    <Example> Show trip to London </Example>\n\n    <Command Name=\"showTripToDestination\">\n      <Example> show trip to London  </Example>\n      <ListenFor> show trip to {destination} </ListenFor>\n      <Feedback> Showing trip to {destination} </Feedback>\n      <Navigate/>\n    </Command>\n\n    <PhraseList Label=\"destination\">\n      <Item> London </Item>\n      <Item> Dallas </Item>\n      <Item> New York </Item>\n    </PhraseList>\n\n    <PhraseTopic Label=\"destination\" Scenario=\"Search\">\n      <Subject>City/State</Subject>\n    </PhraseTopic>\n\n  </CommandSet>\n```\n\n## <span id=\"related_topics\"></span>Related articles\n\n\n**Developers**\n* [Cortana interactions](cortana-interactions.md)\n* [Launch a foreground app with voice commands in Cortana](launch-a-foreground-app-with-voice-commands-in-cortana.md)\n* [Launch a background app with voice commands in Cortana](launch-a-background-app-with-voice-commands-in-cortana.md)\n* [**VCD elements and attributes v1.2**](https://msdn.microsoft.com/library/windows/apps/dn706593)\n\n**Designers**\n* [Cortana design guidelines](https://msdn.microsoft.com/library/windows/apps/dn974233)\n* [Speech design guidelines](https://msdn.microsoft.com/library/windows/apps/dn596121)\n\n**Samples**\n* [Cortana voice command sample](http://go.microsoft.com/fwlink/p/?LinkID=619899)\n \n\n \n\n\n\n\n"}