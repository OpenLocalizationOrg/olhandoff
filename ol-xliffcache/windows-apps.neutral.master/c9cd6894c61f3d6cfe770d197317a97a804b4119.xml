{"nodes":[{"content":"Learn how to extend Cortana with more flexible and natural voice commands, so a user can say your app's name anywhere in the command.","pos":[47,180]},{"content":"Support natural language voice commands in Cortana","pos":[188,238]},{"content":"Support natural language voice commands in Cortana","pos":[363,413]},{"pos":[415,540],"content":"Extend <bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> with more flexible and natural voice commands that let a user say your app's name anywhere in the command."},{"content":"Important APIs","pos":[544,558]},{"content":"Windows.ApplicationModel.VoiceCommands","pos":[569,607]},{"content":"Voice Command Definition (VCD) elements and attributes v1.2","pos":[676,735]},{"content":"Using voice commands to extend Cortana with functionality from your app requires the user to specify both the app and the command or function to execute.","pos":[799,952]},{"content":"This is typically accomplished by announcing the app name at the beginning or the end of the voice command.","pos":[953,1060]},{"content":"For example, \"Adventure Works, add a new trip to Las Vegas.\"","pos":[1061,1121]},{"content":"However, specifying the application name in this way can sound awkward, stilted, or not even make sense.","pos":[1123,1227]},{"content":"In many cases, being able to say the app name elsewhere in the command is more comfortable and natural, and helps make the interaction much more intuitive and engaging for the user.","pos":[1228,1409]},{"content":"Our previous example, \"Adventure Works, add a new trip to Las Vegas.\"","pos":[1410,1479]},{"content":"could be rephrased as \"Add a new Adventure Works trip to Las Vegas.\"","pos":[1480,1548]},{"content":"or \"Using Adventure Works, add a new trip to Las Vegas.\"","pos":[1549,1605]},{"content":"You can set up your voice commands to support the app name as a:","pos":[1607,1671]},{"content":"Prefix - before the command phrase","pos":[1677,1711]},{"content":"Infix - within the command phrase","pos":[1716,1749]},{"content":"Suffix - after the command phrase","pos":[1754,1787]},{"content":"Prerequisites:","pos":[1791,1805]},{"content":"This topic builds on <bpt id=\"p1\">[</bpt>Launch a background app with voice commands in Cortana<ept id=\"p1\">](launch-a-background-app-with-voice-commands-in-cortana.md)</ept>.","pos":[1811,1948]},{"content":"We continue here to demonstrate features with a trip planning and management app named <bpt id=\"p1\">**</bpt>Adventure Works<ept id=\"p1\">**</ept>.","pos":[1949,2056]},{"content":"If you're new to developing Universal Windows Platform (UWP) apps, have a look through these topics to get familiar with the technologies discussed here.","pos":[2058,2211]},{"content":"Create your first app","pos":[2218,2239]},{"pos":[2303,2420],"content":"Learn about events with <bpt id=\"p1\">[</bpt>Events and routed events overview<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/mt185584)</ept>"},{"content":"User experience guidelines:","pos":[2424,2451]},{"pos":[2457,2765],"content":"See <bpt id=\"p1\">[</bpt>Cortana design guidelines<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/dn974233)</ept> for info about how to integrate your app with <bpt id=\"p2\">**</bpt>Cortana<ept id=\"p2\">**</ept> and <bpt id=\"p3\">[</bpt>Speech design guidelines<ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/dn596121)</ept> for helpful tips on designing a useful and engaging speech-enabled app."},{"pos":[2938,2979],"content":"Specify an <bpt id=\"p1\">**</bpt>AppName<ept id=\"p1\">**</ept> element in the VCD"},{"pos":[2982,3076],"content":"The <bpt id=\"p1\">**</bpt>AppName<ept id=\"p1\">**</ept> element is used to specify a user-friendly name for an app in a voice command."},{"pos":[3367,3428],"content":"Specify where the app name can be spoken in the voice command"},{"content":"The <bpt id=\"p1\">**</bpt>ListenFor<ept id=\"p1\">**</ept> element has a <bpt id=\"p2\">**</bpt>RequireAppName<ept id=\"p2\">**</ept> attribute that specifies where the app name can appear in the voice command.","pos":[3431,3558]},{"content":"This attribute supports four values.","pos":[3559,3595]},{"content":"BeforePhrase","pos":[3603,3615]},{"content":"Default.","pos":[3623,3631]},{"content":"Indicates that users must say your app name before the command phrase.","pos":[3637,3707]},{"content":"Here, Cortana listens for \"Adventure Works when is my trip to Las Vegas\".","pos":[3713,3786]},{"content":"AfterPhrase","pos":[3892,3903]},{"content":"Indicates that users must say your app name after the command phrase.","pos":[3911,3980]},{"content":"A localized phrase list of prepositional conjunctions is provided by the system.","pos":[3986,4066]},{"content":"This includes phrases such as, \"using\", \"with \"and \"on\".","pos":[4067,4123]},{"content":"Here, Cortana listens for commands like \"Show my next trip to Las Vegas on Adventure Works\" and \"Show my next trip to Las Vegas using Adventure Works\".","pos":[4129,4280]},{"content":"BeforeOrAfterPhrase","pos":[4389,4408]},{"content":"Indicates that users must say your app name either before or after the command phrase.","pos":[4416,4502]},{"content":"For the suffix version, a localized phrase list of prepositional conjunctions is provided by the system.","pos":[4508,4612]},{"content":"This includes phrases such as, \"using\", \"with \"and \"on\".","pos":[4613,4669]},{"content":"Here, Cortana listens for commands like \"Adventure Works, show my next trip to Las Vegas\" or \"Show my next trip to Last Vegas on Adventure works\".","pos":[4675,4821]},{"content":"ExplicitlySpecified","pos":[4938,4957]},{"content":"Indicates that users must say your app name exactly where you specify in the command phrase.","pos":[4965,5057]},{"content":"The user is not required to say the app name either before or after the phrase.","pos":[5058,5137]},{"pos":[5143,5223],"content":"You must explicitly reference your app name using the <bpt id=\"p1\">**</bpt>{builtin:AppName}<ept id=\"p1\">**</ept> tag."},{"content":"Here, Cortana listens for commands like \"Adventure Works, show my next trip to Las Vegas\" or \"Show my next Adventure Works trip to Las Vegas\".","pos":[5229,5371]},{"pos":[5599,5612],"content":"Special cases"},{"pos":[5614,5775],"content":"When you declare a <bpt id=\"p1\">**</bpt>ListenFor<ept id=\"p1\">**</ept> element where <bpt id=\"p2\">**</bpt>RequireAppName<ept id=\"p2\">**</ept> is either \"AfterPhrase\" or \"ExplicitlySpecified\", you must ensure certain requirements are met:"},{"pos":[5781,5883],"content":"<bpt id=\"p1\">**</bpt>{builtin:AppName}<ept id=\"p1\">**</ept> must appear once and only once when <bpt id=\"p2\">**</bpt>RequireAppName<ept id=\"p2\">**</ept> is \"ExplicitlySpecified\"."},{"content":"With this value, the system cannot infer where the app name can appear in the voice command.","pos":[5889,5981]},{"content":"You must explicitly specify the location.","pos":[5982,6023]},{"content":"You cannot have a voice command begin with a <bpt id=\"p1\">**</bpt>PhraseTopic<ept id=\"p1\">**</ept> element, which is typically used for large vocabulary speech recognition.","pos":[6029,6163]},{"content":"At least one word must precede it.","pos":[6164,6198]},{"pos":[6204,6351],"content":"This helps to minimize the chance that <bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> launches your app if a command contains your app name, or part of it, anywhere in the utterance."},{"pos":[6357,6534],"content":"Here is an invalid declaration that could lead to <bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> launching the <bpt id=\"p2\">**</bpt>Adventure Works<ept id=\"p2\">**</ept> app if the user says something like \"Show me reviews for Kinect Adventure works\"."},{"pos":[6644,6770],"content":"There must be at least two words in the <bpt id=\"p1\">**</bpt>ListenFor<ept id=\"p1\">**</ept> string besides your app name and references to <bpt id=\"p2\">**</bpt>PhraseTopic<ept id=\"p2\">**</ept> elements."},{"content":"Similar to case 2, you need to ensure your commands contain sufficient phonetic content to minimize the chances your app is launched unintentionally.","pos":[6776,6925]},{"content":"This helps you set up your application for best possible success so your application does not get incorrectly launched when user says for example “Find Kinect Adventure works”.","pos":[6931,7107]},{"pos":[7113,7299],"content":"Here are invalid declarations that could lead to <bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> launching the <bpt id=\"p2\">**</bpt>Adventure Works<ept id=\"p2\">**</ept> app if the user says something like \"Hey adventure works\" or \"Find Kinect adventure works\"."},{"pos":[7573,7580],"content":"Remarks"},{"pos":[7582,7720],"content":"Supporting more variation in how a voice command can be uttered by a user in <bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> also increases the general usability of your app."},{"content":"Avoid having \"Hey <ph id=\"ph1\">\\[</ph>app name<ph id=\"ph2\">\\]</ph>\" as your <bpt id=\"p1\">**</bpt>AppName<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>CommandPrefix<ept id=\"p2\">**</ept>.","pos":[7722,7795]},{"content":"Users are much more likely to say \"Hey Cortana\" to invoke Cortana through voice activation, and having \"Hey <ph id=\"ph1\">\\[</ph>app name<ph id=\"ph2\">\\]</ph>\" in the utterance does not sound natural.","pos":[7796,7958]},{"content":"For example, \"Hey Cortana, show my next trip to Las Vegas on Hey Adventure Works\".","pos":[7959,8041]},{"content":"Consider adding infix/suffix variations to your existing voice commands.","pos":[8043,8115]},{"content":"As we've shown here, it doesn't require a lot of effort to add an additional attribute to your existing <bpt id=\"p1\">**</bpt>ListenFor<ept id=\"p1\">**</ept> elements and support suffix variants.","pos":[8116,8271]},{"content":"It feels a lot more natural to say \"Hey Cortana, show my next trip to Las Vegas on Adventure works\" than \"Hey Cortana, Adventure Works, show my next trip to Las Vegas\".","pos":[8272,8440]},{"content":"Consider using your app name as a prefix in cases where the voice command conflicts with existing <bpt id=\"p1\">**</bpt>Cortana<ept id=\"p1\">**</ept> functionality (calling, messaging, and so on).","pos":[8442,8598]},{"content":"For example, \"Adventure Works, message <ph id=\"ph1\">\\[</ph>travel agent<ph id=\"ph2\">\\]</ph> about Las Vegas trip\".","pos":[8599,8677]},{"pos":[8787,8803],"content":"Complete example"},{"content":"Here is a VCD file that demonstrates various ways to provide more natural language voice commands.","pos":[8806,8904]},{"pos":[8906,9026],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  It is valid to have multiple <bpt id=\"p2\">**</bpt>ListenFor<ept id=\"p2\">**</ept> elements, each with a different <bpt id=\"p3\">**</bpt>RequireAppName<ept id=\"p3\">**</ept> attribute value."},{"pos":[10918,10934],"content":"Related articles"},{"content":"Developers","pos":[10939,10949]},{"content":"Cortana interactions","pos":[10955,10975]},{"content":"Define custom recognition constraints","pos":[11005,11042]},{"content":"VCD elements and attributes v1.2","pos":[11091,11123]},{"content":"Designers","pos":[11188,11197]},{"content":"Cortana design guidelines","pos":[11203,11228]},{"content":"Speech design guidelines","pos":[11291,11315]},{"content":"Samples","pos":[11378,11385]},{"content":"Cortana voice command sample","pos":[11391,11419]}],"content":"---\nauthor: Karl-Bridge-Microsoft\nDescription: Learn how to extend Cortana with more flexible and natural voice commands, so a user can say your app's name anywhere in the command.\ntitle: Support natural language voice commands in Cortana\nms.assetid: 281E068A-336A-4A8D-879A-D8715C817911\nlabel: Support natural language voice commands\ntemplate: detail.hbs\n---\n\n# Support natural language voice commands in Cortana\n\nExtend **Cortana** with more flexible and natural voice commands that let a user say your app's name anywhere in the command.\n\n**Important APIs**\n\n-   [**Windows.ApplicationModel.VoiceCommands**](https://msdn.microsoft.com/library/windows/apps/dn706594)\n-   [**Voice Command Definition (VCD) elements and attributes v1.2**](https://msdn.microsoft.com/library/windows/apps/dn706593)\n\n\nUsing voice commands to extend Cortana with functionality from your app requires the user to specify both the app and the command or function to execute. This is typically accomplished by announcing the app name at the beginning or the end of the voice command. For example, \"Adventure Works, add a new trip to Las Vegas.\"\n\nHowever, specifying the application name in this way can sound awkward, stilted, or not even make sense. In many cases, being able to say the app name elsewhere in the command is more comfortable and natural, and helps make the interaction much more intuitive and engaging for the user. Our previous example, \"Adventure Works, add a new trip to Las Vegas.\" could be rephrased as \"Add a new Adventure Works trip to Las Vegas.\" or \"Using Adventure Works, add a new trip to Las Vegas.\"\n\nYou can set up your voice commands to support the app name as a:\n\n-   Prefix - before the command phrase\n-   Infix - within the command phrase\n-   Suffix - after the command phrase\n\n**Prerequisites:  **\n\nThis topic builds on [Launch a background app with voice commands in Cortana](launch-a-background-app-with-voice-commands-in-cortana.md). We continue here to demonstrate features with a trip planning and management app named **Adventure Works**.\n\nIf you're new to developing Universal Windows Platform (UWP) apps, have a look through these topics to get familiar with the technologies discussed here.\n\n-   [Create your first app](https://msdn.microsoft.com/library/windows/apps/bg124288)\n-   Learn about events with [Events and routed events overview](https://msdn.microsoft.com/library/windows/apps/mt185584)\n\n**User experience guidelines:  **\n\nSee [Cortana design guidelines](https://msdn.microsoft.com/library/windows/apps/dn974233) for info about how to integrate your app with **Cortana** and [Speech design guidelines](https://msdn.microsoft.com/library/windows/apps/dn596121) for helpful tips on designing a useful and engaging speech-enabled app.\n\n## <span id=\"Specify_an_AppName_element_in_the_VCD\"></span><span id=\"specify_an_appname_element_in_the_vcd\"></span><span id=\"SPECIFY_AN_APPNAME_ELEMENT_IN_THE_VCD\"></span>Specify an **AppName** element in the VCD\n\n\nThe **AppName** element is used to specify a user-friendly name for an app in a voice command.\n```XML\n<AppName>Adventure Works</AppName>\n```\n\n## <span id=\"Specify_where_the_app_name_can_be_spoken_in_the_voice_command\"></span><span id=\"specify_where_the_app_name_can_be_spoken_in_the_voice_command\"></span><span id=\"SPECIFY_WHERE_THE_APP_NAME_CAN_BE_SPOKEN_IN_THE_VOICE_COMMAND\"></span>Specify where the app name can be spoken in the voice command\n\n\nThe **ListenFor** element has a **RequireAppName** attribute that specifies where the app name can appear in the voice command. This attribute supports four values.\n\n1.  **BeforePhrase**\n\n    Default.\n\n    Indicates that users must say your app name before the command phrase.\n\n    Here, Cortana listens for \"Adventure Works when is my trip to Las Vegas\".\n```xml\n<ListenFor RequireAppName=\"BeforePhrase\"> show [my] trip to {destination} </ListenFor>\n```\n\n2.  **AfterPhrase**\n\n    Indicates that users must say your app name after the command phrase.\n\n    A localized phrase list of prepositional conjunctions is provided by the system. This includes phrases such as, \"using\", \"with \"and \"on\".\n\n    Here, Cortana listens for commands like \"Show my next trip to Las Vegas on Adventure Works\" and \"Show my next trip to Las Vegas using Adventure Works\".\n```xml\n<ListenFor RequireAppName=\"AfterPhrase\">show [my] next trip to {destination} </ListenFor>\n```\n\n3.  **BeforeOrAfterPhrase**\n\n    Indicates that users must say your app name either before or after the command phrase.\n\n    For the suffix version, a localized phrase list of prepositional conjunctions is provided by the system. This includes phrases such as, \"using\", \"with \"and \"on\".\n\n    Here, Cortana listens for commands like \"Adventure Works, show my next trip to Las Vegas\" or \"Show my next trip to Last Vegas on Adventure works\".\n``` xml\n<ListenFor RequireAppName=\"BeforeOrAfterPhrase\">show [my] next trip to {destination}</ListenFor>\n```\n\n4.  **ExplicitlySpecified**\n\n    Indicates that users must say your app name exactly where you specify in the command phrase. The user is not required to say the app name either before or after the phrase.\n\n    You must explicitly reference your app name using the **{builtin:AppName}** tag.\n\n    Here, Cortana listens for commands like \"Adventure Works, show my next trip to Las Vegas\" or \"Show my next Adventure Works trip to Las Vegas\".\n```xml\n<ListenFor RequireAppName=\"ExplicitlySpecified\">show [my] next {builtin:AppName} trip to {destination} </ListenFor>\n```\n\n## <span id=\"Special_cases\"></span><span id=\"special_cases\"></span><span id=\"SPECIAL_CASES\"></span>Special cases\n\nWhen you declare a **ListenFor** element where **RequireAppName** is either \"AfterPhrase\" or \"ExplicitlySpecified\", you must ensure certain requirements are met:\n\n1.  **{builtin:AppName}** must appear once and only once when **RequireAppName** is \"ExplicitlySpecified\".\n\n    With this value, the system cannot infer where the app name can appear in the voice command. You must explicitly specify the location.\n\n2.  You cannot have a voice command begin with a **PhraseTopic** element, which is typically used for large vocabulary speech recognition. At least one word must precede it.\n\n    This helps to minimize the chance that **Cortana** launches your app if a command contains your app name, or part of it, anywhere in the utterance.\n\n    Here is an invalid declaration that could lead to **Cortana** launching the **Adventure Works** app if the user says something like \"Show me reviews for Kinect Adventure works\".\n```xml\n<ListenFor RequireAppName=\"ExplicitlySpecified\">{searchPhrase} {builtin:AppName}</ListenFor>\n```\n\n3.  There must be at least two words in the **ListenFor** string besides your app name and references to **PhraseTopic** elements.\n\n    Similar to case 2, you need to ensure your commands contain sufficient phonetic content to minimize the chances your app is launched unintentionally.\n\n    This helps you set up your application for best possible success so your application does not get incorrectly launched when user says for example “Find Kinect Adventure works”.\n\n    Here are invalid declarations that could lead to **Cortana** launching the **Adventure Works** app if the user says something like \"Hey adventure works\" or \"Find Kinect adventure works\".\n```xml\n<ListenFor RequireAppName=\"ExplicitlySpecified\">Hey {builtin:AppName}</ListenFor>\n<ListenFor RequireAppName=\"ExplicitlySpecified\">Find {searchPhrase} {builtin:AppName}</ListenFor>\n```\n\n## <span id=\"Remarks\"></span><span id=\"remarks\"></span><span id=\"REMARKS\"></span>Remarks\n\nSupporting more variation in how a voice command can be uttered by a user in **Cortana** also increases the general usability of your app.\n\nAvoid having \"Hey \\[app name\\]\" as your **AppName** or **CommandPrefix**. Users are much more likely to say \"Hey Cortana\" to invoke Cortana through voice activation, and having \"Hey \\[app name\\]\" in the utterance does not sound natural. For example, \"Hey Cortana, show my next trip to Las Vegas on Hey Adventure Works\".\n\nConsider adding infix/suffix variations to your existing voice commands. As we've shown here, it doesn't require a lot of effort to add an additional attribute to your existing **ListenFor** elements and support suffix variants. It feels a lot more natural to say \"Hey Cortana, show my next trip to Las Vegas on Adventure works\" than \"Hey Cortana, Adventure Works, show my next trip to Las Vegas\".\n\nConsider using your app name as a prefix in cases where the voice command conflicts with existing **Cortana** functionality (calling, messaging, and so on). For example, \"Adventure Works, message \\[travel agent\\] about Las Vegas trip\".\n\n## <span id=\"Complete_example\"></span><span id=\"complete_example\"></span><span id=\"COMPLETE_EXAMPLE\"></span>Complete example\n\n\nHere is a VCD file that demonstrates various ways to provide more natural language voice commands.\n\n**Note**  It is valid to have multiple **ListenFor** elements, each with a different **RequireAppName** attribute value. \n\n```XML\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<VoiceCommands xmlns=\"http://schemas.microsoft.com/voicecommands/1.1\">\n  <CommandSet xml:lang=\"en-us\" Name=\"commandSet_en-us\">\n    <AppName>Adventure Works</AppName>\n    <Example> When is my trip to Las Vegas? </Example>\n    <Command Name=\"whenIsTripToDestination\">\n      <Example> When is my trip to Las Vegas?</Example>\n      <ListenFor RequireAppName=\"BeforePhrase\">\n        when is my] trip to {destination} </ListenFor>\n\n      <!-- This ListenFor command will set up Cortana to accept commands like \n           “Show my next trip to Las Vegas on Adventure Works”; “Show my next \n           trip to Las Vegas using Adventure Works” -->\n      <ListenFor RequireAppName=\"AfterPhrase\">\n        show [my] next trip to {destination} </ListenFor>\n\n      <!-- This ListenFor command will set up Cortana to accept commands when \n           the user specifies your app name either before or after the command. \n           “Adventure Works, show my next trip to Las Vegas”; \n           “Show my next trip to Last Vegas on Adventure works” -->\n      <ListenFor RequireAppName=\"BeforeOrAfterPhrase\">\n        show [my] next trip to {destination} </ListenFor>\n\n      <!-- This ListenFor command will set up Cortana to accept commands \n           when the user specifies your app name inline. \n           “Show my next Adventure Works trip to Las Vegas” -->\n      <ListenFor RequireAppName=\"ExplicitlySpecified\">\n        show [my] next {builtin:AppName} trip to {destination} </ListenFor>\n\n      <Feedback> Looking for trip to {destination} </Feedback>\n      <Navigate />\n    </Command>\n    <PhraseList Label=\"destination\">\n      <Item> Las Vegas </Item>\n      <Item> Dallas </Item>\n      <Item> New York </Item>\n    </PhraseList>\n  </CommandSet>\n  <!-- Other CommandSets for other languages -->\n</VoiceCommands>\n```\n\n## <span id=\"related_topics\"></span>Related articles\n\n\n**Developers**\n* [Cortana interactions](cortana-interactions.md)\n* [Define custom recognition constraints](define-custom-recognition-constraints.md)\n* [**VCD elements and attributes v1.2**](https://msdn.microsoft.com/library/windows/apps/dn706593)\n\n**Designers**\n* [Cortana design guidelines](https://msdn.microsoft.com/library/windows/apps/dn974233)\n* [Speech design guidelines](https://msdn.microsoft.com/library/windows/apps/dn596121)\n\n**Samples**\n* [Cortana voice command sample](http://go.microsoft.com/fwlink/p/?LinkID=619899)\n \n\n \n\n\n\n\n"}