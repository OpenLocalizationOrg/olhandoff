{"nodes":[{"content":"Learn how to use the AdControl class to display banner ads in a JavaScript/HTML app for Windows 10 (UWP), Windows 8.1, or Windows Phone 8.1.","pos":[86,226]},{"content":"AdControl in HTML 5 and Javascript","pos":[234,268]},{"content":"AdControl in HTML 5 and Javascript","pos":[276,310]},{"content":"Updated for UWP apps on Windows 10.","pos":[316,351]},{"content":"For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept>","pos":[352,444]},{"content":"This walkthrough shows how to use the <bpt id=\"p1\">[</bpt>AdControl<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/microsoft.advertising.winrt.ui.adcontrol.aspx)</ept> class to display banner ads in a JavaScript/HTML app for Windows 10 (UWP), Windows 8.1, or Windows Phone 8.1.","pos":[449,703]},{"content":"This walkthrough does not use the <bpt id=\"p1\">**</bpt>AdMediatorControl<ept id=\"p1\">**</ept> or ad mediation.","pos":[704,776]},{"pos":[778,939],"content":"For a complete sample project that demonstrates how to add banner ads to a JavaScript/HTML app, see the <bpt id=\"p1\">[</bpt>advertising samples on GitHub<ept id=\"p1\">](http://aka.ms/githubads)</ept>."},{"content":"Prerequisites","pos":[944,957]},{"pos":[962,1098],"content":"Install the <bpt id=\"p1\">[</bpt>Microsoft Store Engagement and Monetization SDK<ept id=\"p1\">](http://aka.ms/store-em-sdk)</ept> with Visual Studio 2015 or Visual Studio 2013."},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept> If you have installed Windows 10 Anniversary SDK Preview Build 14295 or later with Visual Studio 2015, you must also install the WinJS library.","pos":[1102,1254]},{"content":"This library used to be included in previous versions of the Windows SDK for Windows 10, but starting with the Windows 10 Anniversary SDK Preview Build 14295 this library must be installed separately.","pos":[1255,1455]},{"content":"To install WinJS, see <bpt id=\"p1\">[</bpt>Get WinJS<ept id=\"p1\">](http://try.buildwinjs.com/download/GetWinJS/)</ept>.","pos":[1456,1536]},{"content":"Code development","pos":[1541,1557]},{"content":"In Visual Studio, open your project or create a new project.","pos":[1562,1622]},{"content":"If your project targets <bpt id=\"p1\">**</bpt>Any CPU<ept id=\"p1\">**</ept>, update your project to use an architecture-specific build output (for example, <bpt id=\"p2\">**</bpt>x86<ept id=\"p2\">**</ept>).","pos":[1627,1752]},{"content":"If your project targets <bpt id=\"p1\">**</bpt>Any CPU<ept id=\"p1\">**</ept>, you will not be able to successfully add a reference to the Microsoft advertising library in the following steps.","pos":[1753,1903]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Reference errors caused by targeting Any CPU in your project<ept id=\"p1\">](known-issues-for-the-advertising-libraries.md#reference_errors)</ept>.","pos":[1904,2057]},{"pos":[2063,2159],"content":"From the <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept> window, right click <bpt id=\"p2\">**</bpt>References<ept id=\"p2\">**</ept>, and select <bpt id=\"p3\">**</bpt>Add Reference…<ept id=\"p3\">**</ept>"},{"pos":[2165,2261],"content":"In <bpt id=\"p1\">**</bpt>Reference Manager<ept id=\"p1\">**</ept>, select one of the following references depending on your project type:"},{"pos":[2271,2469],"content":"For a Universal Windows Platform (UWP) project: Expand <bpt id=\"p1\">**</bpt>Universal Windows<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>Extensions<ept id=\"p2\">**</ept>, and then select the check box next to <bpt id=\"p3\">**</bpt>Microsoft Advertising SDK for JavaScript<ept id=\"p3\">**</ept> (Version 10.0)."},{"pos":[2479,2648],"content":"For a Windows 8.1 project: Expand <bpt id=\"p1\">**</bpt>Windows 8.1<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>Extensions<ept id=\"p2\">**</ept>, and then select the check box next to <bpt id=\"p3\">**</bpt>Microsoft Advertising SDK for Windows 8.1 Native (JS)<ept id=\"p3\">**</ept>."},{"pos":[2658,2839],"content":"For a Windows 8.1 project: Expand <bpt id=\"p1\">**</bpt>Windows Phone 8.1<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>Extensions<ept id=\"p2\">**</ept>, and then select the check box next to <bpt id=\"p3\">**</bpt>Microsoft Advertising SDK for Windows Phone 8.1 Native (JS)<ept id=\"p3\">**</ept>."},{"content":"javascriptaddreference","pos":[2847,2869]},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  This image is for Visual Studio 2015 building a UWP project for Windows 10.","pos":[2930,3015]},{"content":"If you are building a Windows 8.1 or Windows Phone 8.1 app or using Visual Studio 2013, your screen will look different.","pos":[3016,3136]},{"pos":[3142,3177],"content":"In <bpt id=\"p1\">**</bpt>Reference Manager<ept id=\"p1\">**</ept>, click OK."},{"content":"Open the default.html file (or other html file as appropriate for your project).","pos":[3183,3263]},{"pos":[3269,3402],"content":"In the <bpt id=\"p1\">**</bpt><ph id=\"ph1\">&amp;lt;</ph>head<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p1\">**</ept> section, after the project’s JavaScript references of default.css and default.js, add the reference to ad.js."},{"content":"In a UWP project, add the following code.","pos":[3408,3449]},{"content":"In a Windows 8.1 or Windows Phone 8.1 project, add the following code.","pos":[3603,3673]},{"pos":[3815,3983],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>   This line must be placed in the <bpt id=\"p2\">**</bpt><ph id=\"ph1\">&amp;lt;</ph>head<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p2\">**</ept> section after the include of default.js; otherwise, you will encounter an error when you build your project."},{"content":"Modify the <bpt id=\"p1\">**</bpt><ph id=\"ph1\">&amp;lt;</ph>body<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p1\">**</ept> section in the default.html file (or other html file as appropriate for your project) to include the div for the <bpt id=\"p2\">**</bpt>AdControl<ept id=\"p2\">**</ept>.","pos":[3989,4144]},{"content":"Assign the <bpt id=\"p1\">**</bpt>applicationId<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>adUnitId<ept id=\"p2\">**</ept> properties in the <bpt id=\"p3\">**</bpt>AdControl<ept id=\"p3\">**</ept> to the test values provided in <bpt id=\"p4\">[</bpt>Test mode values<ept id=\"p4\">](test-mode-values.md)</ept>, and adjust the height and width of the control so it is one of the <bpt id=\"p5\">[</bpt>supported ad sizes for banner ads<ept id=\"p5\">](supported-ad-sizes-for-banner-ads.md)</ept>.","pos":[4145,4436]},{"content":"Note","pos":[4446,4450]},{"content":"You will replace the test <bpt id=\"p1\">**</bpt>applicationId<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>adUnitId<ept id=\"p2\">**</ept> values with live values before submitting your app for submission.","pos":[4459,4586]},{"content":"Compile and run the app to see it with an ad.","pos":[4909,4954]},{"content":"Release your app with live ads using Windows Dev Center","pos":[4959,5014]},{"content":"In the Dev Center dashboard, go to the <bpt id=\"p1\">**</bpt>Monetization<ept id=\"p1\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p2\">**</bpt>Monetize with ads<ept id=\"p2\">**</ept> page for your app, and <bpt id=\"p3\">[</bpt>create a standalone Microsoft Advertising unit<ept id=\"p3\">](../publish/monetize-with-ads.md)</ept>.","pos":[5021,5209]},{"content":"For the ad unit type, specify <bpt id=\"p1\">**</bpt>Banner<ept id=\"p1\">**</ept>.","pos":[5210,5251]},{"content":"Make note of both the ad unit ID and the application ID.","pos":[5252,5308]},{"pos":[5314,5446],"content":"In your code, replace the test ad unit values (<bpt id=\"p1\">**</bpt>applicationId<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>adUnitId<ept id=\"p2\">**</ept>) with the live values you generated in Dev Center."},{"pos":[5452,5545],"content":"<bpt id=\"p1\">[</bpt>Submit your app<ept id=\"p1\">](../publish/app-submissions.md)</ept> to the Store using the Dev Center dashboard."},{"pos":[5551,5671],"content":"Review your <bpt id=\"p1\">[</bpt>advertising performance reports<ept id=\"p1\">](../publish/advertising-performance-report.md)</ept> in the Dev Center dashboard."},{"content":"Complete default.html for a sample UWP project","pos":[5676,5722]},{"content":"Related topics","pos":[6742,6756]},{"content":"Advertising samples on GitHub","pos":[6761,6790]}],"content":"---\nauthor: mcleanbyron\nms.assetid: adb2fa45-e18f-4254-bd8b-a749a386e3b4\ndescription: Learn how to use the AdControl class to display banner ads in a JavaScript/HTML app for Windows 10 (UWP), Windows 8.1, or Windows Phone 8.1.\ntitle: AdControl in HTML 5 and Javascript\n---\n\n# AdControl in HTML 5 and Javascript\n\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\nThis walkthrough shows how to use the [AdControl](https://msdn.microsoft.com/library/windows/apps/microsoft.advertising.winrt.ui.adcontrol.aspx) class to display banner ads in a JavaScript/HTML app for Windows 10 (UWP), Windows 8.1, or Windows Phone 8.1. This walkthrough does not use the **AdMediatorControl** or ad mediation.\n\nFor a complete sample project that demonstrates how to add banner ads to a JavaScript/HTML app, see the [advertising samples on GitHub](http://aka.ms/githubads).\n\n## Prerequisites\n\n\n* Install the [Microsoft Store Engagement and Monetization SDK](http://aka.ms/store-em-sdk) with Visual Studio 2015 or Visual Studio 2013.\n\n> **Note** If you have installed Windows 10 Anniversary SDK Preview Build 14295 or later with Visual Studio 2015, you must also install the WinJS library. This library used to be included in previous versions of the Windows SDK for Windows 10, but starting with the Windows 10 Anniversary SDK Preview Build 14295 this library must be installed separately. To install WinJS, see [Get WinJS](http://try.buildwinjs.com/download/GetWinJS/).\n\n## Code development\n\n1. In Visual Studio, open your project or create a new project.\n\n2. If your project targets **Any CPU**, update your project to use an architecture-specific build output (for example, **x86**). If your project targets **Any CPU**, you will not be able to successfully add a reference to the Microsoft advertising library in the following steps. For more information, see [Reference errors caused by targeting Any CPU in your project](known-issues-for-the-advertising-libraries.md#reference_errors).\n\n3.  From the **Solution Explorer** window, right click **References**, and select **Add Reference…**\n\n4.  In **Reference Manager**, select one of the following references depending on your project type:\n\n    -   For a Universal Windows Platform (UWP) project: Expand **Universal Windows**, click **Extensions**, and then select the check box next to **Microsoft Advertising SDK for JavaScript** (Version 10.0).\n\n    -   For a Windows 8.1 project: Expand **Windows 8.1**, click **Extensions**, and then select the check box next to **Microsoft Advertising SDK for Windows 8.1 Native (JS)**.\n\n    -   For a Windows 8.1 project: Expand **Windows Phone 8.1**, click **Extensions**, and then select the check box next to **Microsoft Advertising SDK for Windows Phone 8.1 Native (JS)**.\n\n    ![javascriptaddreference](images/13-f7f6d6a6-161e-4f17-995d-1236d0b5d9f2.png)\n\n    > **Note**  This image is for Visual Studio 2015 building a UWP project for Windows 10. If you are building a Windows 8.1 or Windows Phone 8.1 app or using Visual Studio 2013, your screen will look different.\n\n5.  In **Reference Manager**, click OK.\n\n6.  Open the default.html file (or other html file as appropriate for your project).\n\n7.  In the **&lt;head&gt;** section, after the project’s JavaScript references of default.css and default.js, add the reference to ad.js.\n\n    In a UWP project, add the following code.\n\n    ``` syntax\n    <!-- Microsoft advertising required references -->\n    <script src=\"//Microsoft.Advertising.JavaScript/ad.js\"></script>\n    ```\n\n    In a Windows 8.1 or Windows Phone 8.1 project, add the following code.\n\n    ``` syntax\n    <!-- Microsoft advertising required references -->\n    <script src=\"/MSAdvertisingJS/ads/ad.js\"></script>\n    ```\n\n    > **Note**   This line must be placed in the **&lt;head&gt;** section after the include of default.js; otherwise, you will encounter an error when you build your project.\n\n8.  Modify the **&lt;body&gt;** section in the default.html file (or other html file as appropriate for your project) to include the div for the **AdControl**. Assign the **applicationId** and **adUnitId** properties in the **AdControl** to the test values provided in [Test mode values](test-mode-values.md), and adjust the height and width of the control so it is one of the [supported ad sizes for banner ads](supported-ad-sizes-for-banner-ads.md).\n\n    > **Note**  \n    You will replace the test **applicationId** and **adUnitId** values with live values before submitting your app for submission.\n\n    ``` syntax\n    <div id=\"myAd\" style=\"position: absolute; top: 50px; left: 0px; width: 300px; height: 250px; z-index: 1\"\n          data-win-control=\"MicrosoftNSJS.Advertising.AdControl\"\n          data-win-options=\"{applicationId: '3f83fe91-d6be-434d-a0ae-7351c5a997f1', adUnitId: '10865270'}\">\n    </div>\n    ```\n\n9.  Compile and run the app to see it with an ad.\n\n## Release your app with live ads using Windows Dev Center\n\n\n1.  In the Dev Center dashboard, go to the **Monetization** &gt; **Monetize with ads** page for your app, and [create a standalone Microsoft Advertising unit](../publish/monetize-with-ads.md). For the ad unit type, specify **Banner**. Make note of both the ad unit ID and the application ID.\n\n2.  In your code, replace the test ad unit values (**applicationId** and **adUnitId**) with the live values you generated in Dev Center.\n\n3.  [Submit your app](../publish/app-submissions.md) to the Store using the Dev Center dashboard.\n\n4.  Review your [advertising performance reports](../publish/advertising-performance-report.md) in the Dev Center dashboard.\n\n## Complete default.html for a sample UWP project\n\n\n``` syntax\n<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"utf-8\" />\n    <title>My_Windows_10_Ad_Funded_JavaScript_App</title>\n\n    <!-- WinJS references -->\n    <link href=\"//Microsoft.WinJS.2.0.Preview/css/ui-dark.css\" rel=\"stylesheet\" />\n    <script src=\"//Microsoft.WinJS.2.0.Preview/js/base.js\"></script>\n    <script src=\"//Microsoft.WinJS.2.0.Preview/js/ui.js\"></script>\n\n    <!-- My_Windows_10_Ad_Funded_JavaScript_App references -->\n    <link href=\"/css/default.css\" rel=\"stylesheet\" />\n    <script src=\"/js/default.js\"></script>\n\n    <!-- Microsoft advertising required references -->\n    <script src=\"//Microsoft.Advertising.JavaScript/ad.js\"></script>\n</head>\n<body>\n    <div id=\"myAd\" style=\"position: absolute; top: 50px; left: 0px; width: 300px; height: 250px; z-index: 1\"\n      data-win-control=\"MicrosoftNSJS.Advertising.AdControl\"\n      data-win-options=\"{applicationId: '3f83fe91-d6be-434d-a0ae-7351c5a997f1', adUnitId: '10865270'}\">\n    </div>\n    <p>Content goes here</p>\n</body>\n</html>\n```\n\n## Related topics\n\n* [Advertising samples on GitHub](http://aka.ms/githubads)\n \n\n \n"}