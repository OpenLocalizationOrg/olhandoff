{"nodes":[{"content":"author: mcleanbyron Description: If you enable customers to use your app for free during a trial period, you can entice your customers to upgrade to the full version of your app by excluding or limiting some features during the trial period.","pos":[4,245]},{"content":"title: Exclude or limit features in a trial version ms.assetid: 1B62318F-9EF5-432A-8593-F3E095CA7056 keywords: free trial keywords: free trial period keywords: free trial code example keywords: free trial code sample","pos":[246,462]},{"content":"Exclude or limit features in a trial version","pos":[470,514]},{"content":"Updated for UWP apps on Windows 10.","pos":[520,555]},{"content":"For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept>","pos":[556,648]},{"content":"If you enable customers to use your app for free during a trial period, you can entice your customers to upgrade to the full version of your app by excluding or limiting some features during the trial period.","pos":[653,861]},{"content":"Determine which features should be limited before you begin coding, then make sure that your app only allows them to work when a full license has been purchased.","pos":[862,1023]},{"content":"You can also enable features, such as banners or watermarks, that are shown only during the trial, before a customer buys your app.","pos":[1024,1155]},{"content":"Let's look at how to add this to your app.","pos":[1157,1199]},{"content":"Prerequisites","pos":[1204,1217]},{"content":"A Windows app in which to add features for customers to buy.","pos":[1219,1279]},{"content":"Step 1: Pick the features you want to enable or disable during the trial period","pos":[1284,1363]},{"content":"The current license state of your app is stored as properties of the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>LicenseInformation<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br225157)</ept> class.","pos":[1365,1523]},{"content":"Typically, you put the functions that depend on the license state in a conditional block, as we describe in the next step.","pos":[1524,1646]},{"content":"When considering these features, make sure you can implement them in a way that will work in all license states.","pos":[1647,1759]},{"content":"Also, decide how you want to handle changes to the app's license while the app is running.","pos":[1761,1851]},{"content":"Your trial app can be full-featured, but have in-app ad banners where the paid-for version doesn't.","pos":[1852,1951]},{"content":"Or, your trial app can disable certain features, or display regular messages asking the user to buy it.","pos":[1952,2055]},{"content":"Think about the type of app you're making and what a good trial or expiration strategy is for it.","pos":[2057,2154]},{"content":"For a trial version of a game, a good strategy is to limit the amount of game content that a user can play.","pos":[2155,2262]},{"content":"For a trial version of a utility, you might consider setting an expiration date, or limiting the features that a potential buyer can use.","pos":[2263,2400]},{"content":"For most non-gaming apps, setting an expiration date works well, because users can develop a good understanding of the complete app.","pos":[2402,2534]},{"content":"Here are a few common expiration scenarios and your options for handling them.","pos":[2535,2613]},{"content":"Trial license expires while the app is running","pos":[2621,2667]},{"content":"If the trial expires while your app is running, your app can:","pos":[2675,2736]},{"content":"Do nothing.","pos":[2746,2757]},{"content":"Display a message to your customer.","pos":[2766,2801]},{"content":"Close.","pos":[2810,2816]},{"content":"Prompt your customer to buy the app.","pos":[2825,2861]},{"content":"The best practice is to display a message with a prompt for buying the app, and if the customer buys it, continue with all features enabled.","pos":[2867,3007]},{"content":"If the user decides not to buy the app, close it or remind them to buy the app at regular intervals.","pos":[3008,3108]},{"content":"Trial license expires before the app is launched","pos":[3116,3164]},{"content":"If the trial expires before the user launches the app, your app won't launch.","pos":[3172,3249]},{"content":"Instead, users see a dialog box that gives them the option to purchase your app from the Store.","pos":[3250,3345]},{"content":"Customer buys the app while it is running","pos":[3353,3394]},{"content":"If the customer buys your app while it is running, here are some actions your app can take.","pos":[3402,3493]},{"content":"Do nothing and let them continue in trial mode until they restart the app.","pos":[3503,3577]},{"content":"Thank them for buying or display a message.","pos":[3586,3629]},{"content":"Silently enable the features that are available with a full-license (or disable the trial-only notices).","pos":[3638,3742]},{"content":"If you want to detect the license change and take some action in your app, you must add an event handler for this as described in the next step.","pos":[3744,3888]},{"content":"Step 2: Initialize the license info","pos":[3892,3927]},{"content":"When your app is initializing, get the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>LicenseInformation<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br225157)</ept> object for your app as shown in this example.","pos":[3929,4096]},{"content":"We assume that <bpt id=\"p1\">**</bpt>licenseInformation<ept id=\"p1\">**</ept> is a global variable or field of type <bpt id=\"p2\">**</bpt>LicenseInformation<ept id=\"p2\">**</ept>.","pos":[4097,4196]},{"pos":[4198,4408],"content":"Initialize the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>CurrentApp<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh779765)</ept> or <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>CurrentAppSimulator<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/hh779766)</ept> to access the app's license info."},{"content":"Add an event handler to receive notifications when the license changes while the app is running.","pos":[4791,4887]},{"content":"The app's license could change if the trial period expires or the customer buys the app through a Store, for example.","pos":[4888,5005]},{"content":"Step 3: Code the features in conditional blocks","pos":[5633,5680]},{"content":"When the license change event is raised, your app must call the License API to determine if the trial status has changed.","pos":[5682,5803]},{"content":"The code in this step shows how to structure your handler for this event.","pos":[5804,5877]},{"content":"At this point, if a user bought the app, it is a good practice to provide feedback to the user that the licensing status has changed.","pos":[5878,6011]},{"content":"You might need to ask the user to restart the app if that's how you've coded it.","pos":[6012,6092]},{"content":"But make this transition as seamless and painless as possible.","pos":[6093,6155]},{"content":"This example shows how to evaluate an app's license status so that you can enable or disable a feature of your app accordingly.","pos":[6157,6284]},{"content":"Step 4: Get an app's trial expiration date","pos":[6716,6758]},{"content":"Include code to determine the app's trial expiration date.","pos":[6760,6818]},{"content":"The code in this example defines a function to get the expiration date of the app's trial license.","pos":[6820,6918]},{"content":"If the license is still valid, display the expiration date with the number of days left until the trial expires.","pos":[6919,7031]},{"content":"Step 5: Test the features using simulated calls to the License API","pos":[7788,7854]},{"content":"Now, test your app using simulated calls to the license server.","pos":[7856,7919]},{"content":"In JavaScript, C#, Visual Basic, or Visual C++, replace references to <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>CurrentApp<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh779765)</ept> with <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>CurrentAppSimulator<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/hh779766)</ept> in the app's initialization code.","pos":[7920,8187]},{"content":"<bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>CurrentAppSimulator<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh779766)</ept> gets test-specific licensing info from an XML file called \"WindowsStoreProxy.xml\", located in %userprofile%<ph id=\"ph1\">\\\\</ph>AppData<ph id=\"ph2\">\\\\</ph>local<ph id=\"ph3\">\\\\</ph>packages<ph id=\"ph4\">\\\\&amp;lt;</ph>package name<ph id=\"ph5\">&amp;gt;\\\\</ph>LocalState<ph id=\"ph6\">\\\\</ph>Microsoft<ph id=\"ph7\">\\\\</ph>Windows Store<ph id=\"ph8\">\\\\</ph>ApiData.","pos":[8189,8476]},{"content":"If this path and file don't exist, you must create them, either during installation or at run-time.","pos":[8477,8576]},{"content":"If you try to access the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>CurrentAppSimulator.LicenseInformation<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh779768)</ept> property without WindowsStoreProxy.xml present in that specific location, you will get an error.","pos":[8577,8801]},{"content":"This example illustrates how you can add code to your app to test it under different licensing states.","pos":[8803,8905]},{"content":"You can edit WindowsStoreProxy.xml to change the simulated expiration dates for your app and for its features.","pos":[9356,9466]},{"content":"Test all your possible expiration and licensing configurations to make sure everything works as intended.","pos":[9467,9572]},{"content":"Step 6: Replace the simulated License API methods with the actual API","pos":[9577,9646]},{"pos":[9648,9974],"content":"After you test your app with the simulated license server, and before you submit your app to a Store for certification, replace <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>CurrentAppSimulator<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh779766)</ept> with <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>CurrentApp<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/hh779765)</ept>, as shown in the next code sample."},{"pos":[9976,10161],"content":"<bpt id=\"p1\">**</bpt>Important<ept id=\"p1\">**</ept>  Your app must use the <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>CurrentApp<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/hh779765)</ept> object when you submit your app to a Store or it will fail certification."},{"content":"Step 7: Describe how the free trial works to your customers","pos":[10615,10674]},{"content":"Be sure to explain how your app will behave during and after the free trial period so your customers won't be surprised by your app's behavior.","pos":[10676,10819]},{"pos":[10821,10950],"content":"For more info about describing your app, see <bpt id=\"p1\">[</bpt>Create app descriptions<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/mt148529)</ept>."},{"content":"Related topics","pos":[10955,10969]},{"content":"Store sample (demonstrates trials and in-app purchases)","pos":[10974,11029]},{"content":"Set app pricing and availability","pos":[11083,11115]},{"content":"CurrentApp","pos":[11180,11190]},{"content":"CurrentAppSimulator","pos":[11257,11276]}],"content":"---\nauthor: mcleanbyron\nDescription: If you enable customers to use your app for free during a trial period, you can entice your customers to upgrade to the full version of your app by excluding or limiting some features during the trial period.\ntitle: Exclude or limit features in a trial version\nms.assetid: 1B62318F-9EF5-432A-8593-F3E095CA7056\nkeywords: free trial\nkeywords: free trial period\nkeywords: free trial code example\nkeywords: free trial code sample\n---\n\n# Exclude or limit features in a trial version\n\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\nIf you enable customers to use your app for free during a trial period, you can entice your customers to upgrade to the full version of your app by excluding or limiting some features during the trial period. Determine which features should be limited before you begin coding, then make sure that your app only allows them to work when a full license has been purchased. You can also enable features, such as banners or watermarks, that are shown only during the trial, before a customer buys your app.\n\nLet's look at how to add this to your app.\n\n## Prerequisites\n\nA Windows app in which to add features for customers to buy.\n\n## Step 1: Pick the features you want to enable or disable during the trial period\n\nThe current license state of your app is stored as properties of the [**LicenseInformation**](https://msdn.microsoft.com/library/windows/apps/br225157) class. Typically, you put the functions that depend on the license state in a conditional block, as we describe in the next step. When considering these features, make sure you can implement them in a way that will work in all license states.\n\nAlso, decide how you want to handle changes to the app's license while the app is running. Your trial app can be full-featured, but have in-app ad banners where the paid-for version doesn't. Or, your trial app can disable certain features, or display regular messages asking the user to buy it.\n\nThink about the type of app you're making and what a good trial or expiration strategy is for it. For a trial version of a game, a good strategy is to limit the amount of game content that a user can play. For a trial version of a utility, you might consider setting an expiration date, or limiting the features that a potential buyer can use.\n\nFor most non-gaming apps, setting an expiration date works well, because users can develop a good understanding of the complete app. Here are a few common expiration scenarios and your options for handling them.\n\n-   **Trial license expires while the app is running**\n\n    If the trial expires while your app is running, your app can:\n\n    -   Do nothing.\n    -   Display a message to your customer.\n    -   Close.\n    -   Prompt your customer to buy the app.\n\n    The best practice is to display a message with a prompt for buying the app, and if the customer buys it, continue with all features enabled. If the user decides not to buy the app, close it or remind them to buy the app at regular intervals.\n\n-   **Trial license expires before the app is launched**\n\n    If the trial expires before the user launches the app, your app won't launch. Instead, users see a dialog box that gives them the option to purchase your app from the Store.\n\n-   **Customer buys the app while it is running**\n\n    If the customer buys your app while it is running, here are some actions your app can take.\n\n    -   Do nothing and let them continue in trial mode until they restart the app.\n    -   Thank them for buying or display a message.\n    -   Silently enable the features that are available with a full-license (or disable the trial-only notices).\n\nIf you want to detect the license change and take some action in your app, you must add an event handler for this as described in the next step.\n## Step 2: Initialize the license info\n\nWhen your app is initializing, get the [**LicenseInformation**](https://msdn.microsoft.com/library/windows/apps/br225157) object for your app as shown in this example. We assume that **licenseInformation** is a global variable or field of type **LicenseInformation**.\n\nInitialize the [**CurrentApp**](https://msdn.microsoft.com/library/windows/apps/hh779765) or [**CurrentAppSimulator**](https://msdn.microsoft.com/library/windows/apps/hh779766) to access the app's license info.\n\n```CSharp\nvoid initializeLicense()\n{\n    // Initialize the license info for use in the app that is uploaded to the Store.\n    // uncomment for release\n    //   licenseInformation = CurrentApp.LicenseInformation;\n\n    // Initialize the license info for testing.\n    // comment the next line for release\n    licenseInformation = CurrentAppSimulator.LicenseInformation;\n      \n}\n```\n\nAdd an event handler to receive notifications when the license changes while the app is running. The app's license could change if the trial period expires or the customer buys the app through a Store, for example.\n\n```CSharp\nvoid InitializeLicense()\n{\n    // Initialize the license info for use in the app that is uploaded to the Store.\n    // uncomment for release\n    //   licenseInformation = CurrentApp.LicenseInformation;\n\n    // Initialize the license info for testing.\n    // comment the next line for release\n    licenseInformation = CurrentAppSimulator.LicenseInformation;\n\n    // Register for the license state change event.\n     licenseInformation.LicenseChanged += new LicenseChangedEventHandler(licenseChangedEventHandler);\n\n}\n\n// ...\n\nvoid licenseChangedEventHandler()\n{\n    ReloadLicense(); // code is in next steps\n}\n```\n\n## Step 3: Code the features in conditional blocks\n\nWhen the license change event is raised, your app must call the License API to determine if the trial status has changed. The code in this step shows how to structure your handler for this event. At this point, if a user bought the app, it is a good practice to provide feedback to the user that the licensing status has changed. You might need to ask the user to restart the app if that's how you've coded it. But make this transition as seamless and painless as possible.\n\nThis example shows how to evaluate an app's license status so that you can enable or disable a feature of your app accordingly.\n\n```CSharp\nvoid ReloadLicense()\n{\n    if (licenseInformation.IsActive)\n    {\n         if (licenseInformation.IsTrial)\n         {\n             // Show the features that are available during trial only.\n         }\n         else\n         {\n             // Show the features that are available only with a full license.\n         }\n     }\n     else\n     {\n         // A license is inactive only when there' s an error.\n     }\n}\n```\n\n## Step 4: Get an app's trial expiration date\n\nInclude code to determine the app's trial expiration date.\n\nThe code in this example defines a function to get the expiration date of the app's trial license. If the license is still valid, display the expiration date with the number of days left until the trial expires.\n\n```CSharp\nvoid DisplayTrialVersionExpirationTime()\n{\n    if (licenseInformation.IsActive)\n    {\n        if (licenseInformation.IsTrial)\n        {\n            var longDateFormat = new Windows.Globalization.DateTimeFormatting.DateTimeFormatter(\"longdate\");\n                                                \n            // Display the expiration date using the DateTimeFormatter. \n            // For example, longDateFormat.Format(licenseInformation.ExpirationDate)\n\n            var daysRemaining = (licenseInformation.ExpirationDate - DateTime.Now).Days;\n\n            // Let the user know the number of days remaining before the feature expires\n        }\n        else\n        {\n            // ...\n        }\n    }\n    else\n    {\n       // ...\n    }\n}\n```\n\n## Step 5: Test the features using simulated calls to the License API\n\nNow, test your app using simulated calls to the license server. In JavaScript, C#, Visual Basic, or Visual C++, replace references to [**CurrentApp**](https://msdn.microsoft.com/library/windows/apps/hh779765) with [**CurrentAppSimulator**](https://msdn.microsoft.com/library/windows/apps/hh779766) in the app's initialization code.\n\n[**CurrentAppSimulator**](https://msdn.microsoft.com/library/windows/apps/hh779766) gets test-specific licensing info from an XML file called \"WindowsStoreProxy.xml\", located in %userprofile%\\\\AppData\\\\local\\\\packages\\\\&lt;package name&gt;\\\\LocalState\\\\Microsoft\\\\Windows Store\\\\ApiData. If this path and file don't exist, you must create them, either during installation or at run-time. If you try to access the [**CurrentAppSimulator.LicenseInformation**](https://msdn.microsoft.com/library/windows/apps/hh779768) property without WindowsStoreProxy.xml present in that specific location, you will get an error.\n\nThis example illustrates how you can add code to your app to test it under different licensing states.\n\n```CSharp\nvoid appInit()\n{\n    // some app initialization functions\n\n    // Initialize the license info for use in the app that is uploaded to the Store.\n    // uncomment for release\n    //   licenseInformation = CurrentApp.LicenseInformation;\n\n    // Initialize the license info for testing.\n    // comment the next line for release\n    licenseInformation = CurrentAppSimulator.LicenseInformation;\n\n    // other app initialization functions\n}\n```\n\nYou can edit WindowsStoreProxy.xml to change the simulated expiration dates for your app and for its features. Test all your possible expiration and licensing configurations to make sure everything works as intended.\n\n## Step 6: Replace the simulated License API methods with the actual API\n\nAfter you test your app with the simulated license server, and before you submit your app to a Store for certification, replace [**CurrentAppSimulator**](https://msdn.microsoft.com/library/windows/apps/hh779766) with [**CurrentApp**](https://msdn.microsoft.com/library/windows/apps/hh779765), as shown in the next code sample.\n\n**Important**  Your app must use the [**CurrentApp**](https://msdn.microsoft.com/library/windows/apps/hh779765) object when you submit your app to a Store or it will fail certification.\n\n```CSharp\nvoid appInit()\n{\n    // some app initialization functions\n\n    // Initialize the license info for use in the app that is uploaded to the Store.\n    // uncomment for release\n    licenseInformation = CurrentApp.LicenseInformation;\n\n    // Initialize the license info for testing.\n    // comment the next line for release\n    //   licenseInformation = CurrentAppSimulator.LicenseInformation;\n\n    // other app initialization functions\n}\n```\n\n## Step 7: Describe how the free trial works to your customers\n\nBe sure to explain how your app will behave during and after the free trial period so your customers won't be surprised by your app's behavior.\n\nFor more info about describing your app, see [Create app descriptions](https://msdn.microsoft.com/library/windows/apps/mt148529).\n\n## Related topics\n\n* [Store sample (demonstrates trials and in-app purchases)](http://go.microsoft.com/fwlink/p/?LinkID=627610)\n* [Set app pricing and availability](https://msdn.microsoft.com/library/windows/apps/mt148548)\n* [**CurrentApp**](https://msdn.microsoft.com/library/windows/apps/hh779765)\n* [**CurrentAppSimulator**](https://msdn.microsoft.com/library/windows/apps/hh779766)\n \n\n \n\n\n\n\n"}