{"nodes":[{"content":"Respond to system events with background tasks","pos":[29,75]},{"content":"Learn how to create a background task that responds to SystemTrigger events.","pos":[89,165]},{"content":"Respond to system events with background tasks","pos":[222,268]},{"content":"Updated for UWP apps on Windows 10.","pos":[274,309]},{"content":"For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept>","pos":[310,402]},{"content":"Important APIs","pos":[410,424]},{"content":"IBackgroundTask","pos":[435,450]},{"content":"BackgroundTaskBuilder","pos":[519,540]},{"content":"SystemTrigger","pos":[609,622]},{"pos":[685,825],"content":"Learn how to create a background task that responds to <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>SystemTrigger<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br224839)</ept> events."},{"content":"This topic assumes that you have a background task class written for your app, and that this task needs to run in response to an event triggered by the system such as the internet becoming available or the user logging in.","pos":[827,1049]},{"content":"This topic focuses on the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>SystemTrigger<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br224839)</ept> class.","pos":[1050,1160]},{"content":"More information on writing a background task class is available in <bpt id=\"p1\">[</bpt>Create and register a background task<ept id=\"p1\">](create-and-register-a-background-task.md)</ept>.","pos":[1161,1311]},{"content":"Create a SystemTrigger object","pos":[1316,1345]},{"content":"In your app code, create a new <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>SystemTrigger<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br224838)</ept> object.","pos":[1352,1468]},{"content":"The first parameter, <bpt id=\"p1\">*</bpt>triggerType<ept id=\"p1\">*</ept>, specifies the type of system event trigger that will activate this background task.","pos":[1469,1588]},{"content":"For a list of event types, see <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>SystemTriggerType<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br224839)</ept>.","pos":[1589,1702]},{"pos":[1708,1933],"content":"The second parameter, <bpt id=\"p1\">*</bpt>OneShot<ept id=\"p1\">*</ept>, specifies whether the background task will run once the next time the system event occurs and triggers background tasks; or, every time the system event occurs, until the task is unregistered."},{"content":"The following code specifies that the background task runs whenever the Internet becomes available:","pos":[1939,2038]},{"content":"[!div class=\"tabbedCodeSnippets\"]","pos":[2046,2079]},{"content":"Register the background task","pos":[2338,2366]},{"content":"Register the background task by calling your background task registration function.","pos":[2373,2456]},{"content":"For more information on registering background tasks, see <bpt id=\"p1\">[</bpt>Register a background task<ept id=\"p1\">](register-a-background-task.md)</ept>.","pos":[2457,2575]},{"content":"The following code registers the background task:","pos":[2581,2630]},{"content":"[!div class=\"tabbedCodeSnippets\"]","pos":[2638,2671]},{"pos":[3228,3409],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  Universal Windows apps must call <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>RequestAccessAsync<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/hh700485)</ept> before registering any of the background trigger types."},{"content":"To ensure that your Universal Windows app continues to run properly after you release an update, you must call <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>RemoveAccess<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh700471)</ept> and then call <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>RequestAccessAsync<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/hh700485)</ept> when your app launches after being updated.","pos":[3415,3743]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Guidelines for background tasks<ept id=\"p1\">](guidelines-for-background-tasks.md)</ept>.","pos":[3744,3840]},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  Background task registration parameters are validated at the time of registration.","pos":[3848,3940]},{"content":"An error is returned if any of the registration parameters are invalid.","pos":[3941,4012]},{"content":"Ensure that your app gracefully handles scenarios where background task registration fails - if instead your app depends on having a valid registration object after attempting to register a task, it may crash.","pos":[4013,4222]},{"content":"Remarks","pos":[4234,4241]},{"pos":[4244,4378],"content":"To see background task registration in action, download the <bpt id=\"p1\">[</bpt>background task sample<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=618666)</ept>."},{"content":"Background tasks can run in response to <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>SystemTrigger<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br224838)</ept> and <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>MaintenanceTrigger<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/hh700517)</ept> events, but you still need to <bpt id=\"p5\">[</bpt>Declare background tasks in the application manifest<ept id=\"p5\">](declare-background-tasks-in-the-application-manifest.md)</ept>.","pos":[4380,4727]},{"content":"You must also call <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>RequestAccessAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh700485)</ept> before registering any background task type.","pos":[4728,4874]},{"content":"Apps can register background tasks that respond to <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>TimeTrigger<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br224843)</ept>, <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>PushNotificationTrigger<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/hh700543)</ept>, and <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>NetworkOperatorNotificationTrigger<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/br224831)</ept> events, enabling them to provide real-time communication with the user even when the app is not in the foreground.","pos":[4876,5310]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Support your app with background tasks<ept id=\"p1\">](support-your-app-with-background-tasks.md)</ept>.","pos":[5311,5421]},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  This article is for Windows 10 developers writing Universal Windows Platform (UWP) apps.","pos":[5425,5523]},{"content":"If you’re developing for Windows 8.x or Windows Phone 8.x, see the <bpt id=\"p1\">[</bpt>archived documentation<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept>.","pos":[5524,5665]},{"content":"Related topics","pos":[5672,5686]},{"content":"Create and register a background task","pos":[5698,5735]},{"content":"Declare background tasks in the application manifest","pos":[5782,5834]},{"content":"Handle a cancelled background task","pos":[5896,5930]},{"content":"Monitor background task progress and completion","pos":[5974,6021]},{"content":"Register a background task","pos":[6078,6104]},{"content":"Set conditions for running a background task","pos":[6140,6184]},{"content":"Update a live tile from a background task","pos":[6238,6279]},{"content":"Use a maintenance trigger","pos":[6330,6355]},{"content":"Run a background task on a timer","pos":[6390,6422]},{"content":"Guidelines for background tasks","pos":[6465,6496]},{"content":"Debug a background task","pos":[6544,6567]},{"content":"How to trigger suspend, resume, and background events in Windows Store apps (when debugging)","pos":[6600,6692]}],"content":"---\nauthor: TylerMSFT\ntitle: Respond to system events with background tasks\ndescription: Learn how to create a background task that responds to SystemTrigger events.\nms.assetid: 43C21FEA-28B9-401D-80BE-A61B71F01A89\n---\n\n# Respond to system events with background tasks\n\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\n\n**Important APIs**\n\n-   [**IBackgroundTask**](https://msdn.microsoft.com/library/windows/apps/br224794)\n-   [**BackgroundTaskBuilder**](https://msdn.microsoft.com/library/windows/apps/br224768)\n-   [**SystemTrigger**](https://msdn.microsoft.com/library/windows/apps/br224838)\n\nLearn how to create a background task that responds to [**SystemTrigger**](https://msdn.microsoft.com/library/windows/apps/br224839) events.\n\nThis topic assumes that you have a background task class written for your app, and that this task needs to run in response to an event triggered by the system such as the internet becoming available or the user logging in. This topic focuses on the [**SystemTrigger**](https://msdn.microsoft.com/library/windows/apps/br224839) class. More information on writing a background task class is available in [Create and register a background task](create-and-register-a-background-task.md).\n\n## Create a SystemTrigger object\n\n\n-   In your app code, create a new [**SystemTrigger**](https://msdn.microsoft.com/library/windows/apps/br224838) object. The first parameter, *triggerType*, specifies the type of system event trigger that will activate this background task. For a list of event types, see [**SystemTriggerType**](https://msdn.microsoft.com/library/windows/apps/br224839).\n\n    The second parameter, *OneShot*, specifies whether the background task will run once the next time the system event occurs and triggers background tasks; or, every time the system event occurs, until the task is unregistered.\n\n    The following code specifies that the background task runs whenever the Internet becomes available:\n\n    > [!div class=\"tabbedCodeSnippets\"]\n    > ```cs\n    > SystemTrigger internetTrigger = new SystemTrigger(SystemTriggerType.InternetAvailable, false);\n    > ```\n    > ```cpp\n    > SystemTrigger ^ internetTrigger = ref new SystemTrigger(SystemTriggerType::InternetAvailable, false);\n    > ```\n\n## Register the background task\n\n\n-   Register the background task by calling your background task registration function. For more information on registering background tasks, see [Register a background task](register-a-background-task.md).\n\n    The following code registers the background task:\n\n    > [!div class=\"tabbedCodeSnippets\"]\n    > ```cs\n    > string entryPoint = \"Tasks.ExampleBackgroundTaskClass\";\n    > string taskName   = \"Internet-based background task\";\n    >\n    > BackgroundTaskRegistration task = RegisterBackgroundTask(entryPoint, taskName, internetTrigger, exampleCondition);\n    > ```\n    > ```cpp\n    > String ^ entryPoint = \"Tasks.ExampleBackgroundTaskClass\";\n    > String ^ taskName   = \"Internet-based background task\";\n    >\n    > BackgroundTaskRegistration ^ task = RegisterBackgroundTask(entryPoint, taskName, internetTrigger, exampleCondition);\n    > ```\n\n    > **Note**  Universal Windows apps must call [**RequestAccessAsync**](https://msdn.microsoft.com/library/windows/apps/hh700485) before registering any of the background trigger types.\n\n    To ensure that your Universal Windows app continues to run properly after you release an update, you must call [**RemoveAccess**](https://msdn.microsoft.com/library/windows/apps/hh700471) and then call [**RequestAccessAsync**](https://msdn.microsoft.com/library/windows/apps/hh700485) when your app launches after being updated. For more information, see [Guidelines for background tasks](guidelines-for-background-tasks.md).\n\n    > **Note**  Background task registration parameters are validated at the time of registration. An error is returned if any of the registration parameters are invalid. Ensure that your app gracefully handles scenarios where background task registration fails - if instead your app depends on having a valid registration object after attempting to register a task, it may crash.\n\n     \n\n## Remarks\n\n\nTo see background task registration in action, download the [background task sample](http://go.microsoft.com/fwlink/p/?LinkId=618666).\n\nBackground tasks can run in response to [**SystemTrigger**](https://msdn.microsoft.com/library/windows/apps/br224838) and [**MaintenanceTrigger**](https://msdn.microsoft.com/library/windows/apps/hh700517) events, but you still need to [Declare background tasks in the application manifest](declare-background-tasks-in-the-application-manifest.md). You must also call [**RequestAccessAsync**](https://msdn.microsoft.com/library/windows/apps/hh700485) before registering any background task type.\n\nApps can register background tasks that respond to [**TimeTrigger**](https://msdn.microsoft.com/library/windows/apps/br224843), [**PushNotificationTrigger**](https://msdn.microsoft.com/library/windows/apps/hh700543), and [**NetworkOperatorNotificationTrigger**](https://msdn.microsoft.com/library/windows/apps/br224831) events, enabling them to provide real-time communication with the user even when the app is not in the foreground. For more information, see [Support your app with background tasks](support-your-app-with-background-tasks.md).\n\n> **Note**  This article is for Windows 10 developers writing Universal Windows Platform (UWP) apps. If you’re developing for Windows 8.x or Windows Phone 8.x, see the [archived documentation](http://go.microsoft.com/fwlink/p/?linkid=619132).\n\n \n## Related topics\n\n\n****\n\n* [Create and register a background task](create-and-register-a-background-task.md)\n* [Declare background tasks in the application manifest](declare-background-tasks-in-the-application-manifest.md)\n* [Handle a cancelled background task](handle-a-cancelled-background-task.md)\n* [Monitor background task progress and completion](monitor-background-task-progress-and-completion.md)\n* [Register a background task](register-a-background-task.md)\n* [Set conditions for running a background task](set-conditions-for-running-a-background-task.md)\n* [Update a live tile from a background task](update-a-live-tile-from-a-background-task.md)\n* [Use a maintenance trigger](use-a-maintenance-trigger.md)\n* [Run a background task on a timer](run-a-background-task-on-a-timer-.md)\n* [Guidelines for background tasks](guidelines-for-background-tasks.md)\n\n****\n\n* [Debug a background task](debug-a-background-task.md)\n* [How to trigger suspend, resume, and background events in Windows Store apps (when debugging)](http://go.microsoft.com/fwlink/p/?linkid=254345)\n\n \n\n \n"}