{"nodes":[{"content":"Learn how to use the AdControl class to display banner ads in a XAML app for Windows 10 (UWP), Windows 8.1, or Windows Phone 8.1.","pos":[86,215]},{"content":"AdControl in XAML and .NET","pos":[223,249]},{"content":"AdControl in XAML and .NET","pos":[257,283]},{"content":"Updated for UWP apps on Windows 10.","pos":[289,324]},{"content":"For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept>","pos":[325,417]},{"content":"This walkthrough shows how to use the <bpt id=\"p1\">[</bpt>AdControl<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/microsoft.advertising.winrt.ui.adcontrol.aspx)</ept> class to display banner ads in a XAML app for Windows 10 (UWP), Windows 8.1, or Windows Phone 8.1.","pos":[422,665]},{"content":"This walkthrough does not use the <bpt id=\"p1\">**</bpt>AdMediatorControl<ept id=\"p1\">**</ept> or ad mediation.","pos":[666,738]},{"pos":[740,907],"content":"For a complete sample project that demonstrates how to add banner ads to a XAML app using C# and C++, see the <bpt id=\"p1\">[</bpt>advertising samples on GitHub<ept id=\"p1\">](http://aka.ms/githubads)</ept>."},{"content":"Prerequisites","pos":[912,925]},{"pos":[929,1065],"content":"Install the <bpt id=\"p1\">[</bpt>Microsoft Store Engagement and Monetization SDK<ept id=\"p1\">](http://aka.ms/store-em-sdk)</ept> with Visual Studio 2015 or Visual Studio 2013."},{"content":"Code development","pos":[1070,1086]},{"content":"In Visual Studio, open your project or create a new project.","pos":[1091,1151]},{"content":"If your project targets <bpt id=\"p1\">**</bpt>Any CPU<ept id=\"p1\">**</ept>, update your project to use an architecture-specific build output (for example, <bpt id=\"p2\">**</bpt>x86<ept id=\"p2\">**</ept>).","pos":[1156,1281]},{"content":"If your project targets <bpt id=\"p1\">**</bpt>Any CPU<ept id=\"p1\">**</ept>, you will not be able to successfully add a reference to the Microsoft advertising library in the following steps.","pos":[1282,1432]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Reference errors caused by targeting Any CPU in your project<ept id=\"p1\">](known-issues-for-the-advertising-libraries.md#reference_errors)</ept>.","pos":[1433,1586]},{"pos":[1592,1688],"content":"From the <bpt id=\"p1\">**</bpt>Solution Explorer<ept id=\"p1\">**</ept> window, right click <bpt id=\"p2\">**</bpt>References<ept id=\"p2\">**</ept>, and select <bpt id=\"p3\">**</bpt>Add Reference…<ept id=\"p3\">**</ept>"},{"pos":[1694,1790],"content":"In <bpt id=\"p1\">**</bpt>Reference Manager<ept id=\"p1\">**</ept>, select one of the following references depending on your project type:"},{"pos":[1800,1992],"content":"For a Universal Windows Platform (UWP) project: Expand <bpt id=\"p1\">**</bpt>Universal Windows<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>Extensions<ept id=\"p2\">**</ept>, and then select the check box next to <bpt id=\"p3\">**</bpt>Microsoft Advertising SDK for XAML<ept id=\"p3\">**</ept> (Version 10.0)."},{"content":"For a Windows 8.1 project: Expand <bpt id=\"p1\">**</bpt>Windows 8.1<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>Extensions<ept id=\"p2\">**</ept>, and then select the check box next to <bpt id=\"p3\">**</bpt>Ad Mediator SDK for Windows 8.1 XAML<ept id=\"p3\">**</ept>.","pos":[2002,2154]},{"content":"This option will add both the Microsoft advertising and ad mediator libraries to your project, but you can ignore the ad mediator libraries.","pos":[2155,2295]},{"content":"For a Windows Phone 8.1 project: Expand <bpt id=\"p1\">**</bpt>Windows Phone 8.1<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>Extensions<ept id=\"p2\">**</ept>, and then select the check box next to <bpt id=\"p3\">**</bpt>Ad Mediator SDK for Windows Phone 8.1 XAML<ept id=\"p3\">**</ept>.","pos":[2305,2475]},{"content":"This option will add both the Microsoft advertising and ad mediator libraries to your project, but you can ignore the ad mediator libraries.","pos":[2476,2616]},{"content":"addreferences","pos":[2622,2635]},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  This image is for Visual Studio 2015 building a UWP project for Windows 10.","pos":[2696,2781]},{"content":"If you are building a Windows 8.1 or Windows Phone 8.1 app or using Visual Studio 2013, your screen will look different.","pos":[2782,2902]},{"pos":[2908,2943],"content":"In <bpt id=\"p1\">**</bpt>Reference Manager<ept id=\"p1\">**</ept>, click OK."},{"content":"Modify the XAML for the page where you are embedding advertising to include the <bpt id=\"p1\">**</bpt>Microsoft.Advertising.WinRT.UI<ept id=\"p1\">**</ept> namespace.","pos":[2948,3073]},{"content":"For example, in the default sample app generated by Visual Studio (named, in this app, MyAdFundedWindows10AppXAML), the XAML page is <bpt id=\"p1\">**</bpt>MainPage.XAML<ept id=\"p1\">**</ept>.","pos":[3074,3225]},{"pos":[3231,3328],"content":"The <bpt id=\"p1\">**</bpt>Page<ept id=\"p1\">**</ept> section of the MainPage.xaml file generated by Visual Studio has the following code."},{"pos":[3898,4034],"content":"Add the namespace reference <bpt id=\"p1\">**</bpt>Microsoft.Advertising.WinRT.UI<ept id=\"p1\">**</ept> so the <bpt id=\"p2\">**</bpt>Page<ept id=\"p2\">**</ept> section of the MainPage.xaml file has the following code."},{"pos":[4660,4716],"content":"In the <bpt id=\"p1\">**</bpt>Grid<ept id=\"p1\">**</ept> tag, add the code for the <bpt id=\"p2\">**</bpt>AdControl<ept id=\"p2\">**</ept>."},{"pos":[4726,5079],"content":"Assign the <bpt id=\"p1\">[</bpt>ApplicationId<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/microsoft.advertising.winrt.ui.adcontrol.applicationid.aspx)</ept> and <bpt id=\"p2\">[</bpt>AdUnitId<ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/microsoft.advertising.winrt.ui.adcontrol.adunitid.aspx)</ept> properties in the <bpt id=\"p3\">**</bpt>Page<ept id=\"p3\">**</ept> to the test values provided in <bpt id=\"p4\">[</bpt>Test mode values<ept id=\"p4\">](test-mode-values.md)</ept>."},{"pos":[5091,5194],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>   You will replace the test values with live values before submitting your app for submission."},{"pos":[5204,5341],"content":"Adjust the height and width of the control so it is one of the <bpt id=\"p1\">[</bpt>supported ad sizes for banner ads<ept id=\"p1\">](supported-ad-sizes-for-banner-ads.md)</ept>."},{"pos":[5347,5394],"content":"The complete <bpt id=\"p1\">**</bpt>Grid<ept id=\"p1\">**</ept> tag looks like this code."},{"content":"The complete code for the MainPage.xaml file should look like this.","pos":[5821,5888]},{"content":"Compile and run the app to see it with an ad.","pos":[6822,6867]},{"content":"Release your app with live ads using Windows Dev Center","pos":[6872,6927]},{"content":"In the Dev Center dashboard, go to the <bpt id=\"p1\">**</bpt>Monetization<ept id=\"p1\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p2\">**</bpt>Monetize with ads<ept id=\"p2\">**</ept> page for your app, and <bpt id=\"p3\">[</bpt>create a standalone Microsoft Advertising unit<ept id=\"p3\">](../publish/monetize-with-ads.md)</ept>.","pos":[6934,7122]},{"content":"For the ad unit type, specify <bpt id=\"p1\">**</bpt>Banner<ept id=\"p1\">**</ept>.","pos":[7123,7164]},{"content":"Make note of both the ad unit ID and the application ID.","pos":[7165,7221]},{"pos":[7227,7359],"content":"In your code, replace the test ad unit values (<bpt id=\"p1\">**</bpt>ApplicationId<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>AdUnitId<ept id=\"p2\">**</ept>) with the live values you generated in Dev Center."},{"pos":[7365,7458],"content":"<bpt id=\"p1\">[</bpt>Submit your app<ept id=\"p1\">](../publish/app-submissions.md)</ept> to the Store using the Dev Center dashboard."},{"pos":[7464,7584],"content":"Review your <bpt id=\"p1\">[</bpt>advertising performance reports<ept id=\"p1\">](../publish/advertising-performance-report.md)</ept> in the Dev Center dashboard."},{"content":"Notes","pos":[7589,7594]},{"content":"C#: See <bpt id=\"p1\">[</bpt>XAML properties example<ept id=\"p1\">](xaml-properties-example.md)</ept> for an example of how to assign event handlers to <bpt id=\"p2\">**</bpt>AdControl<ept id=\"p2\">**</ept> events.","pos":[7596,7729]},{"content":"Then see <bpt id=\"p1\">[</bpt>AdControl events in C#<ept id=\"p1\">](adcontrol-events-in-c.md)</ept> for sample code that shows event handlers written in C#.","pos":[7730,7846]},{"pos":[7848,7991],"content":"Visual Basic: See <bpt id=\"p1\">[</bpt>XAML properties example<ept id=\"p1\">](xaml-properties-example.md)</ept> for an example of how to assign event handlers to <bpt id=\"p2\">**</bpt>AdControl<ept id=\"p2\">**</ept> events."},{"content":"C++: The current release of the Microsoft advertising libraries support C++.","pos":[7993,8069]},{"content":"The <bpt id=\"p1\">**</bpt>AdControl<ept id=\"p1\">**</ept> loads the CLR and uses managed C++.","pos":[8070,8123]},{"pos":[8125,8238],"content":"Error Handling: To learn about how to handle errors, see <bpt id=\"p1\">[</bpt>AdControl error handling<ept id=\"p1\">](adcontrol-error-handling.md)</ept>."},{"content":"Related topics","pos":[8243,8257]},{"content":"Advertising samples on GitHub","pos":[8262,8291]}],"content":"---\nauthor: mcleanbyron\nms.assetid: 4e7c2388-b94e-4828-a104-14fa33f6eb2d\ndescription: Learn how to use the AdControl class to display banner ads in a XAML app for Windows 10 (UWP), Windows 8.1, or Windows Phone 8.1.\ntitle: AdControl in XAML and .NET\n---\n\n# AdControl in XAML and .NET\n\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\nThis walkthrough shows how to use the [AdControl](https://msdn.microsoft.com/library/windows/apps/microsoft.advertising.winrt.ui.adcontrol.aspx) class to display banner ads in a XAML app for Windows 10 (UWP), Windows 8.1, or Windows Phone 8.1. This walkthrough does not use the **AdMediatorControl** or ad mediation.\n\nFor a complete sample project that demonstrates how to add banner ads to a XAML app using C# and C++, see the [advertising samples on GitHub](http://aka.ms/githubads).\n\n## Prerequisites\n\n* Install the [Microsoft Store Engagement and Monetization SDK](http://aka.ms/store-em-sdk) with Visual Studio 2015 or Visual Studio 2013.\n\n## Code development\n\n1. In Visual Studio, open your project or create a new project.\n\n2. If your project targets **Any CPU**, update your project to use an architecture-specific build output (for example, **x86**). If your project targets **Any CPU**, you will not be able to successfully add a reference to the Microsoft advertising library in the following steps. For more information, see [Reference errors caused by targeting Any CPU in your project](known-issues-for-the-advertising-libraries.md#reference_errors).\n\n1.  From the **Solution Explorer** window, right click **References**, and select **Add Reference…**\n\n2.  In **Reference Manager**, select one of the following references depending on your project type:\n\n    -   For a Universal Windows Platform (UWP) project: Expand **Universal Windows**, click **Extensions**, and then select the check box next to **Microsoft Advertising SDK for XAML** (Version 10.0).\n\n    -   For a Windows 8.1 project: Expand **Windows 8.1**, click **Extensions**, and then select the check box next to **Ad Mediator SDK for Windows 8.1 XAML**. This option will add both the Microsoft advertising and ad mediator libraries to your project, but you can ignore the ad mediator libraries.\n\n    -   For a Windows Phone 8.1 project: Expand **Windows Phone 8.1**, click **Extensions**, and then select the check box next to **Ad Mediator SDK for Windows Phone 8.1 XAML**. This option will add both the Microsoft advertising and ad mediator libraries to your project, but you can ignore the ad mediator libraries.\n\n  ![addreferences](images/13-a84c026e-b283-44f2-8816-f950a1ef89aa.png)\n\n    > **Note**  This image is for Visual Studio 2015 building a UWP project for Windows 10. If you are building a Windows 8.1 or Windows Phone 8.1 app or using Visual Studio 2013, your screen will look different.\n\n3.  In **Reference Manager**, click OK.\n4.  Modify the XAML for the page where you are embedding advertising to include the **Microsoft.Advertising.WinRT.UI** namespace. For example, in the default sample app generated by Visual Studio (named, in this app, MyAdFundedWindows10AppXAML), the XAML page is **MainPage.XAML**.\n\n    The **Page** section of the MainPage.xaml file generated by Visual Studio has the following code.\n\n    ``` syntax\n    <Page\n        x:Class=\"MyAdFundedWindows10AppXAML.MainPage\"\n        xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n        xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n        xmlns:local=\"using:MyAdFundedWindows10AppXAML\"\n        xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\"\n        xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\n        mc:Ignorable=\"d\">\n\n        <Grid Background=\"{ThemeResource ApplicationPageBackgroundThemeBrush}\">\n\n        </Grid>\n    </Page>\n    ```\n\n    Add the namespace reference **Microsoft.Advertising.WinRT.UI** so the **Page** section of the MainPage.xaml file has the following code.\n\n    ``` syntax\n    <Page\n        x:Class=\"MyAdFundedWindows10AppXAML.MainPage\"\n        xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n        xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n        xmlns:local=\"using:MyAdFundedWindows10AppXAML\"\n        xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\"\n        xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\n        xmlns:UI=\"using:Microsoft.Advertising.WinRT.UI\"\n        mc:Ignorable=\"d\">\n\n        <Grid Background=\"{ThemeResource ApplicationPageBackgroundThemeBrush}\">\n\n        </Grid>\n    </Page>\n    ```\n\n5.  In the **Grid** tag, add the code for the **AdControl**.\n\n    1.  Assign the [ApplicationId](https://msdn.microsoft.com/library/windows/apps/microsoft.advertising.winrt.ui.adcontrol.applicationid.aspx) and [AdUnitId](https://msdn.microsoft.com/library/windows/apps/microsoft.advertising.winrt.ui.adcontrol.adunitid.aspx) properties in the **Page** to the test values provided in [Test mode values](test-mode-values.md).\n\n        > **Note**   You will replace the test values with live values before submitting your app for submission.\n\n    2.  Adjust the height and width of the control so it is one of the [supported ad sizes for banner ads](supported-ad-sizes-for-banner-ads.md).\n\n    The complete **Grid** tag looks like this code.\n\n    ``` syntax\n    <Grid Background=\"{StaticResource ApplicationPageBackgroundThemeBrush}\">\n\n            <UI:AdControl ApplicationId=\"3f83fe91-d6be-434d-a0ae-7351c5a997f1\"\n                          AdUnitId=\"10865270\"\n                          HorizontalAlignment=\"Left\"\n                          Height=\"250\"\n                          VerticalAlignment=\"Top\"\n                          Width=\"300\"/>\n    </Grid>\n    ```\n\n    The complete code for the MainPage.xaml file should look like this.\n\n    ``` syntax\n    <Page\n        x:Class=\"MyAdFundedWindows10AppXAML.MainPage\"\n        xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n        xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n        xmlns:local=\"using:MyAdFundedWindows10AppXAML\"\n        xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\"\n        xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\n        xmlns:UI=\"using:Microsoft.Advertising.WinRT.UI\"\n        mc:Ignorable=\"d\">\n\n        <Grid Background=\"{StaticResource ApplicationPageBackgroundThemeBrush}\">\n\n            <UI:AdControl ApplicationId=\"3f83fe91-d6be-434d-a0ae-7351c5a997f1\"\n                          AdUnitId=\"10865270\"\n                          HorizontalAlignment=\"Left\"\n                          Height=\"250\"\n                          VerticalAlignment=\"Top\"\n                          Width=\"300\"/>\n        </Grid>\n    </Page>\n    ```\n\n6.  Compile and run the app to see it with an ad.\n\n## Release your app with live ads using Windows Dev Center\n\n\n1.  In the Dev Center dashboard, go to the **Monetization** &gt; **Monetize with ads** page for your app, and [create a standalone Microsoft Advertising unit](../publish/monetize-with-ads.md). For the ad unit type, specify **Banner**. Make note of both the ad unit ID and the application ID.\n\n2.  In your code, replace the test ad unit values (**ApplicationId** and **AdUnitId**) with the live values you generated in Dev Center.\n\n3.  [Submit your app](../publish/app-submissions.md) to the Store using the Dev Center dashboard.\n\n4.  Review your [advertising performance reports](../publish/advertising-performance-report.md) in the Dev Center dashboard.\n\n## Notes\n\nC#: See [XAML properties example](xaml-properties-example.md) for an example of how to assign event handlers to **AdControl** events. Then see [AdControl events in C#](adcontrol-events-in-c.md) for sample code that shows event handlers written in C#.\n\nVisual Basic: See [XAML properties example](xaml-properties-example.md) for an example of how to assign event handlers to **AdControl** events.\n\nC++: The current release of the Microsoft advertising libraries support C++. The **AdControl** loads the CLR and uses managed C++.\n\nError Handling: To learn about how to handle errors, see [AdControl error handling](adcontrol-error-handling.md).\n\n## Related topics\n\n* [Advertising samples on GitHub](http://aka.ms/githubads)\n\n \n"}