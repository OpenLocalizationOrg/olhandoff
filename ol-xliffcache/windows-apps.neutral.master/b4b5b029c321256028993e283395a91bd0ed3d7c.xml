{"nodes":[{"content":"Shows how to launch the compose email dialog to allow the user to send an email message.","pos":[32,120]},{"content":"You can pre-populate the fields of the email with data before showing the dialog.","pos":[121,202]},{"content":"The message will not be sent until the user taps the send button.","pos":[203,268]},{"content":"Send email","pos":[276,286]},{"content":"Send email","pos":[375,385]},{"content":"Updated for UWP apps on Windows 10.","pos":[390,425]},{"content":"For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept>","pos":[426,518]},{"content":"Shows how to launch the compose email dialog to allow the user to send an email message.","pos":[524,612]},{"content":"You can pre-populate the fields of the email with data before showing the dialog.","pos":[613,694]},{"content":"The message will not be sent until the user taps the send button.","pos":[695,760]},{"content":"In this article","pos":[764,779]},{"content":"Launch the compose email dialog","pos":[788,819]},{"content":"Summary and next steps","pos":[860,882]},{"content":"Related topics","pos":[914,928]},{"content":"Launch the compose email dialog","pos":[951,982]},{"content":"Create a new <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>EmailMessage<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/Dn631270)</ept> object and set the data that you want to be pre-populated in the compose email dialog.","pos":[984,1160]},{"content":"Call <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ShowComposeNewEmailAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/Dn631269)</ept> to show the dialog.","pos":[1161,1274]},{"content":"Summary and next steps","pos":[2261,2283]},{"content":"This topic has shown you how to launch the compose email dialog.","pos":[2285,2349]},{"content":"For information on selecting contacts to use as recipients for an email message, see <bpt id=\"p1\">[</bpt>Select contacts<ept id=\"p1\">](selecting-contacts.md)</ept>.","pos":[2350,2476]},{"content":"See <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>PickSingleFileAsync<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/JJ635275)</ept> to select a file to use as an email attachment.","pos":[2477,2612]},{"content":"Related topics","pos":[2617,2631]},{"content":"Selecting contacts","pos":[2636,2654]},{"content":"How to continue your Windows Phone app after calling a file picker","pos":[2682,2748]}],"content":"---\nauthor: Xansky\ndescription: Shows how to launch the compose email dialog to allow the user to send an email message. You can pre-populate the fields of the email with data before showing the dialog. The message will not be sent until the user taps the send button.\ntitle: Send email\nms.assetid: 74511E90-9438-430E-B2DE-24E196A111E5\nkeywords: contacts, email, send\n---\n\n# Send email\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\n\nShows how to launch the compose email dialog to allow the user to send an email message. You can pre-populate the fields of the email with data before showing the dialog. The message will not be sent until the user taps the send button.\n\n**In this article**\n\n-   [Launch the compose email dialog](#launch-the-compose-email-dialog)\n-   [Summary and next steps](#summary-and-next-steps)\n-   [Related topics](#related-topics)\n\n## Launch the compose email dialog\n\nCreate a new [**EmailMessage**](https://msdn.microsoft.com/library/windows/apps/Dn631270) object and set the data that you want to be pre-populated in the compose email dialog. Call [**ShowComposeNewEmailAsync**](https://msdn.microsoft.com/library/windows/apps/Dn631269) to show the dialog.\n\n``` cs\nprivate async void ComposeEmail(Windows.ApplicationModel.Contacts.Contact recipient, \n    string messageBody, \n    StorageFile attachmentFile)\n{\n    var emailMessage = new Windows.ApplicationModel.Email.EmailMessage();\n    emailMessage.Body = messageBody;\n\n    if (attachmentFile != null)\n    {\n        var stream = Windows.Storage.Streams.RandomAccessStreamReference.CreateFromFile(attachmentFile);\n\n        var attachment = new Windows.ApplicationModel.Email.EmailAttachment(\n            attachmentFile.Name,\n            stream);\n\n        emailMessage.Attachments.Add(attachment);\n    }\n\n    var email = recipient.Emails.FirstOrDefault<Windows.ApplicationModel.Contacts.ContactEmail>();\n    if (email != null)\n    {\n        var emailRecipient = new Windows.ApplicationModel.Email.EmailRecipient(email.Address);\n        emailMessage.To.Add(emailRecipient);\n    }\n\n    await Windows.ApplicationModel.Email.EmailManager.ShowComposeNewEmailAsync(emailMessage);\n        \n}\n```\n\n## Summary and next steps\n\nThis topic has shown you how to launch the compose email dialog. For information on selecting contacts to use as recipients for an email message, see [Select contacts](selecting-contacts.md). See [**PickSingleFileAsync**](https://msdn.microsoft.com/library/windows/apps/JJ635275) to select a file to use as an email attachment.\n\n## Related topics\n\n* [Selecting contacts](selecting-contacts.md)\n* [How to continue your Windows Phone app after calling a file picker](https://msdn.microsoft.com/library/windows/apps/xaml/Dn614994)\n \n\n \n\n\n\n\n"}