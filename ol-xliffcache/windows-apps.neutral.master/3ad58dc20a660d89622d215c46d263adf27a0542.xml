{"nodes":[{"content":"Handle app suspend","pos":[29,47]},{"content":"Learn how to save important application data when the system suspends your app.","pos":[61,140]},{"content":"Handle app suspend","pos":[197,215]},{"content":"Updated for UWP apps on Windows 10.","pos":[221,256]},{"content":"For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept>","pos":[257,349]},{"content":"Important APIs","pos":[357,371]},{"content":"Suspending","pos":[382,392]},{"content":"Learn how to save important application data when the system suspends your app.","pos":[455,534]},{"content":"The example registers an event handler for the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Suspending<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br242341)</ept> event and saves a string to a file.","pos":[535,692]},{"content":"Register the suspending event handler","pos":[697,734]},{"pos":[737,935],"content":"Register to handle the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Suspending<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br242341)</ept> event, which indicates that your app should save its application data before the system suspends it."},{"content":"[!div class=\"tabbedCodeSnippets\"]","pos":[939,972]},{"content":"Save application data before suspension","pos":[1910,1949]},{"content":"When your app handles the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Suspending<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br242341)</ept> event, it has the opportunity to save its important application data in the handler function.","pos":[1952,2146]},{"content":"The app should use the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>LocalSettings<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br241622)</ept> storage API to save simple application data synchronously.","pos":[2147,2306]},{"content":"[!div class=\"tabbedCodeSnippets\"]","pos":[2310,2343]},{"content":"Remarks","pos":[3120,3127]},{"content":"The system suspends your app whenever the user switches to another app or to the desktop or Start screen.","pos":[3130,3235]},{"content":"The system resumes your app whenever the user switches back to it.","pos":[3236,3302]},{"content":"When the system resumes your app, the content of your variables and data structures is the same as it was before the system suspended the app.","pos":[3303,3445]},{"content":"The system restores the app exactly where it left off, so that it appears to the user as if it's been running in the background.","pos":[3446,3574]},{"content":"The system attempts to keep your app and its data in memory while it's suspended.","pos":[3576,3657]},{"content":"However, if the system does not have the resources to keep your app in memory, the system will terminate your app.","pos":[3658,3772]},{"content":"When the user switches back to a suspended app that has been terminated, the system sends an <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Activated<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br225018)</ept> event and should restore its application data in its <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>OnLaunched<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br242335)</ept> method.","pos":[3773,4075]},{"content":"The system doesn't notify an app when it's terminated, so your app must save its application data and release exclusive resources and file handles when it's suspended, and restore them when the app is activated after termination.","pos":[4077,4306]},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>   If you need to do asynchronous work when your app is being suspended you will need to defer completion of suspend until after your work completes.","pos":[4310,4467]},{"content":"You can use the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GetDeferral<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br224690)</ept> method on the <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>SuspendingOperation<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br224688)</ept> object (available via the event args) to delay completion of suspend until after you call the <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>Complete<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/br224685)</ept> method on the returned <bpt id=\"p7\">[</bpt><bpt id=\"p8\">**</bpt>SuspendingDeferral<ept id=\"p8\">**</ept><ept id=\"p7\">](https://msdn.microsoft.com/library/windows/apps/br224684)</ept> object.","pos":[4468,4938]},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  To improve system responsiveness in Windows 8.1, apps are given low priority access to resources after they are suspended.","pos":[4942,5074]},{"content":"To support this new priority, the suspend operation timeout is extended so that the app has the equivalent of the 5-second timeout for normal priority on Windows or between 1 and 10 seconds on Windows Phone.","pos":[5075,5282]},{"content":"You cannot extend or alter this timeout window.","pos":[5283,5330]},{"content":"<bpt id=\"p1\">**</bpt>A note about debugging using Visual Studio:<ept id=\"p1\">**</ept>  Visual Studio prevents Windows from suspending an app that is attached to the debugger.","pos":[5334,5470]},{"content":"This is to allow the user to view the Visual Studio debug UI while the app is running.","pos":[5471,5557]},{"content":"When you're debugging an app, you can send it a suspend event using Visual Studio.","pos":[5558,5640]},{"content":"Make sure the <bpt id=\"p1\">**</bpt>Debug Location<ept id=\"p1\">**</ept> toolbar is being shown, then click the <bpt id=\"p2\">**</bpt>Suspend<ept id=\"p2\">**</ept> icon.","pos":[5641,5730]},{"content":"Related topics","pos":[5735,5749]},{"content":"Handle app activation","pos":[5755,5776]},{"content":"Handle app resume","pos":[5801,5818]},{"content":"UX guidelines for launch, suspend, and resume","pos":[5841,5886]},{"content":"App lifecycle","pos":[5949,5962]}],"content":"---\nauthor: TylerMSFT\ntitle: Handle app suspend\ndescription: Learn how to save important application data when the system suspends your app.\nms.assetid: F84F1512-24B9-45EC-BF23-A09E0AC985B0\n---\n\n# Handle app suspend\n\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\n\n**Important APIs**\n\n-   [**Suspending**](https://msdn.microsoft.com/library/windows/apps/br242341)\n\nLearn how to save important application data when the system suspends your app. The example registers an event handler for the [**Suspending**](https://msdn.microsoft.com/library/windows/apps/br242341) event and saves a string to a file.\n\n## Register the suspending event handler\n\n\nRegister to handle the [**Suspending**](https://msdn.microsoft.com/library/windows/apps/br242341) event, which indicates that your app should save its application data before the system suspends it.\n\n> [!div class=\"tabbedCodeSnippets\"]\n> ```cs\n> using System;\n> using Windows.ApplicationModel;\n> using Windows.ApplicationModel.Activation;\n> using Windows.UI.Xaml;\n>\n> partial class MainPage\n> {\n>    public MainPage()\n>    {\n>       InitializeComponent();\n>       Application.Current.Suspending += new SuspendingEventHandler(App_Suspending);\n>    }\n> }\n> ```\n> ```vb\n> Public NotInheritable Class MainPage\n>\n>    Public Sub New()\n>       InitializeComponent()\n>       AddHandler Application.Current.Suspending, AddressOf App_Suspending\n>    End Sub\n>    \n> End Class\n> ```\n> ```cpp\n> using namespace Windows::ApplicationModel;\n> using namespace Windows::ApplicationModel::Activation;\n> using namespace Windows::Foundation;\n> using namespace Windows::UI::Xaml;\n> using namespace AppName;\n>\n> MainPage::MainPage()\n> {\n>    InitializeComponent();\n>    Application::Current->Suspending +=\n>        ref new SuspendingEventHandler(this, &MainPage::App_Suspending);\n> }\n> ```\n\n## Save application data before suspension\n\n\nWhen your app handles the [**Suspending**](https://msdn.microsoft.com/library/windows/apps/br242341) event, it has the opportunity to save its important application data in the handler function. The app should use the [**LocalSettings**](https://msdn.microsoft.com/library/windows/apps/br241622) storage API to save simple application data synchronously.\n\n> [!div class=\"tabbedCodeSnippets\"]\n> ```cs\n> partial class MainPage\n> {\n>     async void App_Suspending(\n>         Object sender,\n>         Windows.ApplicationModel.SuspendingEventArgs e)\n>     {\n>         // TODO: This is the time to save app data in case the process is terminated\n>     }\n> }\n> ```\n> ```vb\n> Public NonInheritable Class MainPage\n>\n>     Private Sub App_Suspending(\n>         sender As Object,\n>         e As Windows.ApplicationModel.SuspendingEventArgs) Handles OnSuspendEvent.Suspending\n>\n>         ' TODO: This is the time to save app data in case the process is terminated\n>     End Sub\n>\n> End Class\n> ```\n> ```cpp\n> void MainPage::App_Suspending(Object^ sender, SuspendingEventArgs^ e)\n> {\n>     // TODO: This is the time to save app data in case the process is terminated\n> }\n> ```\n\n## Remarks\n\n\nThe system suspends your app whenever the user switches to another app or to the desktop or Start screen. The system resumes your app whenever the user switches back to it. When the system resumes your app, the content of your variables and data structures is the same as it was before the system suspended the app. The system restores the app exactly where it left off, so that it appears to the user as if it's been running in the background.\n\nThe system attempts to keep your app and its data in memory while it's suspended. However, if the system does not have the resources to keep your app in memory, the system will terminate your app. When the user switches back to a suspended app that has been terminated, the system sends an [**Activated**](https://msdn.microsoft.com/library/windows/apps/br225018) event and should restore its application data in its [**OnLaunched**](https://msdn.microsoft.com/library/windows/apps/br242335) method.\n\nThe system doesn't notify an app when it's terminated, so your app must save its application data and release exclusive resources and file handles when it's suspended, and restore them when the app is activated after termination.\n\n> **Note**   If you need to do asynchronous work when your app is being suspended you will need to defer completion of suspend until after your work completes. You can use the [**GetDeferral**](https://msdn.microsoft.com/library/windows/apps/br224690) method on the [**SuspendingOperation**](https://msdn.microsoft.com/library/windows/apps/br224688) object (available via the event args) to delay completion of suspend until after you call the [**Complete**](https://msdn.microsoft.com/library/windows/apps/br224685) method on the returned [**SuspendingDeferral**](https://msdn.microsoft.com/library/windows/apps/br224684) object.\n\n> **Note**  To improve system responsiveness in Windows 8.1, apps are given low priority access to resources after they are suspended. To support this new priority, the suspend operation timeout is extended so that the app has the equivalent of the 5-second timeout for normal priority on Windows or between 1 and 10 seconds on Windows Phone. You cannot extend or alter this timeout window.\n\n> **A note about debugging using Visual Studio:**  Visual Studio prevents Windows from suspending an app that is attached to the debugger. This is to allow the user to view the Visual Studio debug UI while the app is running. When you're debugging an app, you can send it a suspend event using Visual Studio. Make sure the **Debug Location** toolbar is being shown, then click the **Suspend** icon.\n\n## Related topics\n\n\n* [Handle app activation](activate-an-app.md)\n* [Handle app resume](resume-an-app.md)\n* [UX guidelines for launch, suspend, and resume](https://msdn.microsoft.com/library/windows/apps/dn611862)\n* [App lifecycle](app-lifecycle.md)\n\n \n\n \n"}