{"nodes":[{"content":"Learn how to launch an interstitial ad using C#.","pos":[86,134]},{"content":"Interstitial ad sample code in C","pos":[142,174]},{"content":"Interstitial ad sample code in C","pos":[184,216]},{"content":"Updated for UWP apps on Windows 10.","pos":[228,263]},{"content":"For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept>","pos":[264,356]},{"content":"This topic shows how to launch an interstitial ad using C#.","pos":[361,420]},{"content":"For step-by-step instructions that show how to configure your project to use this code, see <bpt id=\"p1\">[</bpt>Interstitial ads<ept id=\"p1\">](interstitial-ads.md)</ept>.","pos":[421,553]},{"content":"For a complete sample project that demonstrates how to add video interstitial ads to a XAML app using C#, see the <bpt id=\"p1\">[</bpt>advertising samples on GitHub<ept id=\"p1\">](http://aka.ms/githubads)</ept>.","pos":[554,725]},{"content":"Code example","pos":[731,743]},{"content":"This code sample shows a working MainPage.xaml.cs code file that implements an interstitial ad.","pos":[745,840]},{"content":"This code assumes that the MainPage.xaml file has a working button with a <bpt id=\"p1\">**</bpt>Click<ept id=\"p1\">**</ept> event that fires and is handled by a method named <bpt id=\"p2\">**</bpt>button_Click<ept id=\"p2\">**</ept>.","pos":[841,992]},{"content":"This code launches the interstitial ad when the <bpt id=\"p1\">**</bpt>Click<ept id=\"p1\">**</ept> event on the button is fired.","pos":[993,1080]},{"content":"Replace the text in the <bpt id=\"p1\">**</bpt>AppID<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>AdUnitId<ept id=\"p2\">**</ept> variables with live values before submitting your app to the Store.","pos":[1082,1200]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Set up ad units in your app<ept id=\"p1\">](set-up-ad-units-in-your-app.md)</ept>.","pos":[1201,1289]},{"content":"Related topics","pos":[3431,3445]},{"content":"Advertising samples on GitHub","pos":[3450,3479]}],"content":"---\nauthor: mcleanbyron\nms.assetid: 7a16b0ca-6b8e-4ade-9853-85690e06bda6\ndescription: Learn how to launch an interstitial ad using C#.\ntitle: Interstitial ad sample code in C#\n\n---\n\n# Interstitial ad sample code in C\\# #  \n\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\nThis topic shows how to launch an interstitial ad using C#. For step-by-step instructions that show how to configure your project to use this code, see [Interstitial ads](interstitial-ads.md). For a complete sample project that demonstrates how to add video interstitial ads to a XAML app using C#, see the [advertising samples on GitHub](http://aka.ms/githubads).\n\n\n## Code example\n\nThis code sample shows a working MainPage.xaml.cs code file that implements an interstitial ad. This code assumes that the MainPage.xaml file has a working button with a **Click** event that fires and is handled by a method named **button_Click**. This code launches the interstitial ad when the **Click** event on the button is fired.\n\nReplace the text in the **AppID** and **AdUnitId** variables with live values before submitting your app to the Store. For more information, see [Set up ad units in your app](set-up-ad-units-in-your-app.md).\n\n``` syntax\nusing System;\nusing System.Collections.Generic;\nusing System.IO;\nusing System.Linq;\nusing System.Runtime.InteropServices.WindowsRuntime;\nusing Windows.Foundation;\nusing Windows.Foundation.Collections;\nusing Windows.UI.Xaml;\nusing Windows.UI.Xaml.Controls;\nusing Windows.UI.Xaml.Controls.Primitives;\nusing Windows.UI.Xaml.Data;\nusing Windows.UI.Xaml.Input;\nusing Windows.UI.Xaml.Media;\nusing Windows.UI.Xaml.Navigation;\nusing Microsoft.Advertising.WinRT.UI;\n\n\nnamespace BasicCSharpInterstitialUWP\n{\n    /// <summary>\n    /// An empty page that can be used on its own or navigated to within a Frame.\n    /// </summary>\n    public sealed partial class MainPage : Page\n    {\n        InterstitialAd MyVideoAd = new InterstitialAd();\n\n        public MainPage()\n        {\n            this.InitializeComponent();\n        }\n\n        private void button_Click(object sender, RoutedEventArgs e)\n        {\n            // Define ApplicationId and AdUnitId.\n            // Test values are shown here. Replace the test values with live values before submitting the app to the Store.\n            var MyAppId = \"d25517cb-12d4-4699-8bdc-52040c712cab\";\n            var MyAdUnitId = \"11389925\";\n\n            MyVideoAd.AdReady += MyVideoAd_AdReady;\n            MyVideoAd.ErrorOccurred += MyVideoAd_ErrorOccurred;\n            MyVideoAd.Completed += MyVideoAd_Completed;\n            MyVideoAd.Cancelled += MyVideoAd_Cancelled;\n\n            // Pre-fetch an ad 30-60 seconds before you need it.\n            MyVideoAd.RequestAd(AdType.Video, MyAppId, MyAdUnitId);\n        }\n\n        void MyVideoAd_AdReady(object sender, object e)\n        {\n            if ((InterstitialAdState.Ready) == (MyVideoAd.State))\n            {\n                MyVideoAd.Show();\n            }\n        }\n\n        void MyVideoAd_ErrorOccurred(object sender, AdErrorEventArgs e)\n        {\n            // Add your code here.\n        }\n\n        void MyVideoAd_Completed(object sender, object e)\n        {\n            // Add your code here.\n        }\n\n        void MyVideoAd_Cancelled(object sender, object e)\n        {\n            // Add your code here.  \n        }\n    }\n}\n```\n\n \n## Related topics\n\n* [Advertising samples on GitHub](http://aka.ms/githubads)\n \n"}