{"nodes":[{"content":"Learn how to programmatically create an **AdControl** using JavaScript.","pos":[86,157]},{"content":"Create an AdControl in Javascript","pos":[165,198]},{"content":"Create an AdControl in Javascript","pos":[207,240]},{"content":"Updated for UWP apps on Windows 10.","pos":[246,281]},{"content":"For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept>","pos":[282,374]},{"pos":[379,556],"content":"This example shows how to programmatically create an <bpt id=\"p1\">[</bpt>AdControl<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/microsoft.advertising.winrt.ui.adcontrol.aspx)</ept> using JavaScript."},{"content":"HTML div for an AdControl","pos":[561,586]},{"content":"An <bpt id=\"p1\">**</bpt>AdControl<ept id=\"p1\">**</ept> needs to have a <bpt id=\"p2\">**</bpt>div<ept id=\"p2\">**</ept> on the html page that will show the ad.","pos":[588,668]},{"content":"The code below provides an example of such a <bpt id=\"p1\">**</bpt>div<ept id=\"p1\">**</ept>.","pos":[669,722]},{"content":"JavaScript for creating an AdControl","pos":[915,951]},{"pos":[953,1056],"content":"The following example assumes that you are using an existing <bpt id=\"p1\">**</bpt>div<ept id=\"p1\">**</ept> in your HTML with the ID <bpt id=\"p2\">**</bpt>myAd<ept id=\"p2\">**</ept>."},{"pos":[1058,1124],"content":"Instantiate the <bpt id=\"p1\">**</bpt>AdControl<ept id=\"p1\">**</ept> in the <bpt id=\"p2\">**</bpt>app.onactivated<ept id=\"p2\">**</ept> function."},{"content":"The values are examples.","pos":[1623,1647]},{"content":"In your code you will set the values of these functions and properties appropriate for your app.","pos":[1648,1744]},{"content":"If you use this code and do not see ads, you can try inserting an attribute of <bpt id=\"p1\">**</bpt>position:relative<ept id=\"p1\">**</ept> in the <bpt id=\"p2\">**</bpt>div<ept id=\"p2\">**</ept> that contains the <bpt id=\"p3\">**</bpt>AdControl<ept id=\"p3\">**</ept>.","pos":[1746,1894]},{"content":"This will override the default setting of the <bpt id=\"p1\">**</bpt>IFrame<ept id=\"p1\">**</ept>.","pos":[1895,1952]},{"content":"Ads will be displayed correctly, unless they are not being shown due to the value of this attribute.","pos":[1953,2053]},{"content":"Note that new ad units may not be available for up to 30 minutes.","pos":[2054,2119]},{"content":"Related topics","pos":[2124,2138]},{"content":"Advertising samples on GitHub","pos":[2143,2172]}],"content":"---\nauthor: mcleanbyron\nms.assetid: 48a1ef86-8514-4af8-9c93-81e869d36de7\ndescription: Learn how to programmatically create an **AdControl** using JavaScript.\ntitle: Create an AdControl in Javascript\n\n---\n\n# Create an AdControl in Javascript\n\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\nThis example shows how to programmatically create an [AdControl](https://msdn.microsoft.com/library/windows/apps/microsoft.advertising.winrt.ui.adcontrol.aspx) using JavaScript.\n\n## HTML div for an AdControl\n\nAn **AdControl** needs to have a **div** on the html page that will show the ad. The code below provides an example of such a **div**.\n\n``` syntax\n<div id=\"myAd\" style=\"position: absolute; top: 50px; left: 0px; width: 300px; height: 250px; z-index: 1\"\n    data-win-control=\"MicrosoftNSJS.Advertising.AdControl\">\n</div>\n```\n\n## JavaScript for creating an AdControl\n\nThe following example assumes that you are using an existing **div** in your HTML with the ID **myAd**.\n\nInstantiate the **AdControl** in the **app.onactivated** function.\n\n``` syntax\n// TODO: This application has been newly launched. Initialize\n// your application here.\nvar adDiv = document.getElementById(\"myAd\");\nvar myAdControl = new MicrosoftNSJS.Advertising.AdControl(adDiv,\n    {\n        applicationId: \"3f83fe91-d6be-434d-a0ae-7351c5a997f1\",\n        adUnitId: \"10865270\"\n    });\nmyAdControl.isAutoRefreshEnabled = false;\nmyAdControl.onErrorOccurred = myAdError;\nmyAdControl.onAdRefreshed = myAdRefreshed;\nmyAdControl.onEngagedChanged = myAdEngagedChanged;\n```\n\nThe values are examples. In your code you will set the values of these functions and properties appropriate for your app.\n\nIf you use this code and do not see ads, you can try inserting an attribute of **position:relative** in the **div** that contains the **AdControl**. This will override the default setting of the **IFrame**. Ads will be displayed correctly, unless they are not being shown due to the value of this attribute. Note that new ad units may not be available for up to 30 minutes.\n\n## Related topics\n\n* [Advertising samples on GitHub](http://aka.ms/githubads)\n\n \n\n \n"}