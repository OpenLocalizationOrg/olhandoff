{"nodes":[{"content":"description: Provides a value for any XAML attribute by evaluating a reference to a resource, with additional system logic that retrieves different resources depending on the currently active theme.","pos":[4,202]},{"content":"title: {ThemeResource} markup extension' ms.assetid: 8A1C79D2-9566-44AA-B8E1-CC7ADAD1BCC5","pos":[203,292],"source":"\ntitle: {ThemeResource} markup extension'\nms.assetid: 8A1C79D2-9566-44AA-B8E1-CC7ADAD1BCC5"},{"content":"{ThemeResource} markup extension","pos":[300,332]},{"content":"\\[ Updated for UWP apps on Windows 10.","pos":[334,372]},{"content":"For Windows 8.x articles, see the <bpt id=\"p1\">[</bpt>archive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619132)</ept> \\]","pos":[373,468],"source":" For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]"},{"content":"Provides a value for any XAML attribute by evaluating a reference to a resource, with additional system logic that retrieves different resources depending on the currently active theme.","pos":[470,655]},{"content":"Similar to <bpt id=\"p1\">[</bpt>{StaticResource} markup extension<ept id=\"p1\">](staticresource-markup-extension.md)</ept>, resources are defined in a <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>ResourceDictionary<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/br208794)</ept>, and a <bpt id=\"p4\">**</bpt>ThemeResource<ept id=\"p4\">**</ept> usage references the key of that resource in the <bpt id=\"p5\">**</bpt>ResourceDictionary<ept id=\"p5\">**</ept>.","pos":[656,947],"source":" Similar to [{StaticResource} markup extension](staticresource-markup-extension.md), resources are defined in a [**ResourceDictionary**](https://msdn.microsoft.com/library/windows/apps/br208794), and a **ThemeResource** usage references the key of that resource in the **ResourceDictionary**."},{"content":"XAML attribute usage","pos":[952,972]},{"content":"XAML values","pos":[1038,1049]},{"content":"Term","pos":[1053,1057]},{"content":"Description","pos":[1060,1071]},{"content":"key","pos":[1099,1102]},{"content":"The key for the requested resource.","pos":[1105,1140]},{"content":"This key is initially assigned by the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ResourceDictionary<ept id=\"p2\">**</ept><ph id=\"ph1\">&gt;</ph><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208794)</ept>.","pos":[1141,1263],"source":" This key is initially assigned by the [**ResourceDictionary**>](https://msdn.microsoft.com/library/windows/apps/br208794)."},{"content":"A resource key can be any string defined in the XamlName Grammar.","pos":[1264,1329]},{"content":"Remarks","pos":[1337,1344]},{"content":"A <bpt id=\"p1\">**</bpt>ThemeResource<ept id=\"p1\">**</ept> is a technique for obtaining values for a XAML attribute that are defined elsewhere in a XAML resource dictionary.","pos":[1346,1480],"source":"A **ThemeResource** is a technique for obtaining values for a XAML attribute that are defined elsewhere in a XAML resource dictionary."},{"content":"The markup extension serves the same basic purpose as the <bpt id=\"p1\">[</bpt>{StaticResource} markup extension<ept id=\"p1\">](staticresource-markup-extension.md)</ept>.","pos":[1481,1611],"source":" The markup extension serves the same basic purpose as the [{StaticResource} markup extension](staticresource-markup-extension.md)."},{"content":"The difference in behavior versus {StaticResource} markup extension is that a <bpt id=\"p1\">**</bpt>ThemeResource<ept id=\"p1\">**</ept> reference can dynamically use different dictionaries as the primary lookup location, depending on which theme is currently being used by the system.","pos":[1612,1856],"source":" The difference in behavior versus {StaticResource} markup extension is that a **ThemeResource** reference can dynamically use different dictionaries as the primary lookup location, depending on which theme is currently being used by the system."},{"content":"When the app first starts, any resource reference made by a <bpt id=\"p1\">**</bpt>ThemeResource<ept id=\"p1\">**</ept> reference is evaluated based on the theme in use at startup.","pos":[1858,1996],"source":"When the app first starts, any resource reference made by a **ThemeResource** reference is evaluated based on the theme in use at startup."},{"content":"But if the user subsequently changes the active theme at run-time, the system will re-evaluate every <bpt id=\"p1\">**</bpt>ThemeResource<ept id=\"p1\">**</ept> reference, retrieve a theme-specific resource that may be different, and redisplay the app with new resource values in all appropriate places in the visual tree.","pos":[1997,2277],"source":" But if the user subsequently changes the active theme at run-time, the system will re-evaluate every **ThemeResource** reference, retrieve a theme-specific resource that may be different, and redisplay the app with new resource values in all appropriate places in the visual tree."},{"content":"A <bpt id=\"p1\">**</bpt>StaticResource<ept id=\"p1\">**</ept> is determined at XAML load time / app startup and won't be re-evaluated at run-time.","pos":[2278,2383],"source":" A **StaticResource** is determined at XAML load time / app startup and won't be re-evaluated at run-time."},{"content":"(There are other techniques such as visual states that reload XAML dynamically, but those techniques operate at a higher level that the basic resource evaluation enabled by <bpt id=\"p1\">[</bpt>{StaticResource} markup extension<ept id=\"p1\">](staticresource-markup-extension.md)</ept>).","pos":[2384,2630],"source":" (There are other techniques such as visual states that reload XAML dynamically, but those techniques operate at a higher level that the basic resource evaluation enabled by [{StaticResource} markup extension](staticresource-markup-extension.md))."},{"content":"<bpt id=\"p1\">**</bpt>ThemeResource<ept id=\"p1\">**</ept> takes one argument, which specifies the key for the requested resource.","pos":[2632,2721],"source":"**ThemeResource** takes one argument, which specifies the key for the requested resource."},{"content":"A resource key is always a string in Windows Runtime XAML.","pos":[2722,2780]},{"content":"For more info on how the resource key is initially specified, see <bpt id=\"p1\">[</bpt>x:Key attribute<ept id=\"p1\">](x-key-attribute.md)</ept>.","pos":[2781,2885],"source":" For more info on how the resource key is initially specified, see [x:Key attribute](x-key-attribute.md)."},{"pos":[2887,3166],"content":"For more info on how to define resources and properly use a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ResourceDictionary<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208794)</ept>, including sample code, see <bpt id=\"p3\">[</bpt>ResourceDictionary and XAML resource references<ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/mt187273)</ept>.","source":"For more info on how to define resources and properly use a [**ResourceDictionary**](https://msdn.microsoft.com/library/windows/apps/br208794), including sample code, see [ResourceDictionary and XAML resource references](https://msdn.microsoft.com/library/windows/apps/mt187273)."},{"content":"Important","pos":[3170,3179]},{"content":"As with <bpt id=\"p1\">**</bpt>StaticResource<ept id=\"p1\">**</ept>, a <bpt id=\"p2\">**</bpt>ThemeResource<ept id=\"p2\">**</ept> must not attempt to make a forward reference to a resource that is defined lexically further within the XAML file.","pos":[3184,3346],"source":"As with **StaticResource**, a **ThemeResource** must not attempt to make a forward reference to a resource that is defined lexically further within the XAML file."},{"content":"Attempting to do so is not supported.","pos":[3347,3384]},{"content":"Even if the forward reference doesn't fail, trying to make one carries a performance penalty.","pos":[3385,3478]},{"content":"For best results, adjust the composition of your resource dictionaries so that forward references are avoided.","pos":[3479,3589]},{"content":"Attempting to specify a <bpt id=\"p1\">**</bpt>ThemeResource<ept id=\"p1\">**</ept> to a key that cannot resolve throws a XAML parse exception at run time.","pos":[3591,3704],"source":"Attempting to specify a **ThemeResource** to a key that cannot resolve throws a XAML parse exception at run time."},{"content":"Design tools may also offer warnings or errors.","pos":[3705,3752]},{"content":"In the Windows Runtime XAML processor implementation, there is no backing class representation for <bpt id=\"p1\">**</bpt>ThemeResource<ept id=\"p1\">**</ept>.","pos":[3754,3871],"source":"In the Windows Runtime XAML processor implementation, there is no backing class representation for **ThemeResource**."},{"content":"The closest equivalent in code is to use the collection API of a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>ResourceDictionary<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br208794)</ept>, for example calling <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>Contains<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/jj635925)</ept> or <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>TryGetValue<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/jj603139)</ept>.","pos":[3872,4193],"source":" The closest equivalent in code is to use the collection API of a [**ResourceDictionary**](https://msdn.microsoft.com/library/windows/apps/br208794), for example calling [**Contains**](https://msdn.microsoft.com/library/windows/apps/jj635925) or [**TryGetValue**](https://msdn.microsoft.com/library/windows/apps/jj603139)."},{"content":"<bpt id=\"p1\">**</bpt>ThemeResource<ept id=\"p1\">**</ept> is a markup extension.","pos":[4195,4235],"source":"**ThemeResource** is a markup extension."},{"content":"Markup extensions are typically implemented when there is a requirement to escape attribute values to be other than literal values or handler names, and the requirement is more global than just putting type converters on certain types or properties.","pos":[4236,4485]},{"content":"All markup extensions in XAML use the \"{\" and \"}\" characters in their attribute syntax, which is the convention by which a XAML processor recognizes that a markup extension must process the attribute.","pos":[4486,4686]},{"content":"When and how to use {ThemeResource} rather than {StaticResource}","pos":[4692,4756]},{"content":"The rules by which a <bpt id=\"p1\">**</bpt>ThemeResource<ept id=\"p1\">**</ept> resolves to an item in a resource dictionary are generally the same as <bpt id=\"p2\">**</bpt>StaticResource<ept id=\"p2\">**</ept>.","pos":[4758,4887],"source":"The rules by which a **ThemeResource** resolves to an item in a resource dictionary are generally the same as **StaticResource**."},{"content":"A <bpt id=\"p1\">**</bpt>ThemeResource<ept id=\"p1\">**</ept> lookup can extend into the <bpt id=\"p2\">[</bpt><bpt id=\"p3\">**</bpt>ResourceDictionary<ept id=\"p3\">**</ept><ept id=\"p2\">](https://msdn.microsoft.com/library/windows/apps/br208794)</ept> files that are referenced in a <bpt id=\"p4\">[</bpt><bpt id=\"p5\">**</bpt>ThemeDictionaries<ept id=\"p5\">**</ept><ept id=\"p4\">](https://msdn.microsoft.com/library/windows/apps/br208807)</ept> collection, but a <bpt id=\"p6\">**</bpt>StaticResource<ept id=\"p6\">**</ept> can do that also.","pos":[4888,5185],"source":" A **ThemeResource** lookup can extend into the [**ResourceDictionary**](https://msdn.microsoft.com/library/windows/apps/br208794) files that are referenced in a [**ThemeDictionaries**](https://msdn.microsoft.com/library/windows/apps/br208807) collection, but a **StaticResource** can do that also."},{"content":"The difference is that a <bpt id=\"p1\">**</bpt>ThemeResource<ept id=\"p1\">**</ept> can re-evaluate at run-time and a <bpt id=\"p2\">**</bpt>StaticResource<ept id=\"p2\">**</ept> can't.","pos":[5186,5288],"source":" The difference is that a **ThemeResource** can re-evaluate at run-time and a **StaticResource** can't."},{"content":"The set of keys in each theme dictionary should provide the same set of keyed resources no matter which theme is active.","pos":[5290,5410]},{"content":"If a given keyed resource exists in the <bpt id=\"p1\">**</bpt>HighContrast<ept id=\"p1\">**</ept> theme dictionary, then another resource with that name should also exist in <bpt id=\"p2\">**</bpt>Light<ept id=\"p2\">**</ept> and <bpt id=\"p3\">**</bpt>Default<ept id=\"p3\">**</ept>.","pos":[5411,5570],"source":" If a given keyed resource exists in the **HighContrast** theme dictionary, then another resource with that name should also exist in **Light** and **Default**."},{"content":"If that isn't true, resource lookup might fail when the user switches themes and your app won't look right.","pos":[5571,5678]},{"content":"It is possible though that a theme dictionary can contain keyed resources that are only referenced from within the same scope to provide sub-values; these don't need to be equivalent in all themes.","pos":[5679,5876]},{"content":"In general you should place resources in theme dictionaries and make references to those resources using <bpt id=\"p1\">**</bpt>ThemeResource<ept id=\"p1\">**</ept> only when those values can change between themes or are supported by values that change.","pos":[5878,6089],"source":"In general you should place resources in theme dictionaries and make references to those resources using **ThemeResource** only when those values can change between themes or are supported by values that change."},{"content":"This is appropriate for these kinds of resources:","pos":[6090,6139]},{"content":"Brushes, in particular colors for <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>SolidColorBrush<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br242962)</ept>.","pos":[6145,6259],"source":"Brushes, in particular colors for [**SolidColorBrush**](https://msdn.microsoft.com/library/windows/apps/br242962)."},{"content":"These make up about 80% of the <bpt id=\"p1\">**</bpt>ThemeResource<ept id=\"p1\">**</ept> usages in the default XAML control templates (generic.xaml).","pos":[6260,6369],"source":" These make up about 80% of the **ThemeResource** usages in the default XAML control templates (generic.xaml)."},{"content":"Pixel values for borders, offsets, margin and padding and so on.","pos":[6374,6438]},{"pos":[6443,6498],"content":"Font properties such as <bpt id=\"p1\">**</bpt>FontFamily<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>FontSize<ept id=\"p2\">**</ept>.","source":"Font properties such as **FontFamily** or **FontSize**."},{"pos":[6503,6784],"content":"Complete templates for a limited number of controls that are usually system-styled and used for dynamic presentation, like <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>GridViewItem<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh738501)</ept> and <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>ListViewItem<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br242919)</ept>.","source":"Complete templates for a limited number of controls that are usually system-styled and used for dynamic presentation, like [**GridViewItem**](https://msdn.microsoft.com/library/windows/apps/hh738501) and [**ListViewItem**](https://msdn.microsoft.com/library/windows/apps/br242919)."},{"content":"Text display styles (usually to change font color, background, and possibly size).","pos":[6789,6871]},{"content":"The Windows Runtime provides a set of resources that are specifically intended to be referenced by <bpt id=\"p1\">**</bpt>ThemeResource<ept id=\"p1\">**</ept>.","pos":[6873,6990],"source":"The Windows Runtime provides a set of resources that are specifically intended to be referenced by **ThemeResource**."},{"content":"These are all listed as part of the XAML file themeresources.xaml, which is available in the include/winrt/xaml/design folder as part of the Windows Software Development Kit (SDK).","pos":[6991,7171]},{"content":"For documentation on the theme brushes and additional styles that are defined in themeresources.xaml, see <bpt id=\"p1\">[</bpt>XAML theme resources<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/mt187274)</ept>.","pos":[7172,7359],"source":" For documentation on the theme brushes and additional styles that are defined in themeresources.xaml, see [XAML theme resources](https://msdn.microsoft.com/library/windows/apps/mt187274)."},{"content":"The brushes are documented in a table that tells you what color value each brush has for each of the three possible active themes.","pos":[7360,7490]},{"content":"The XAML definitions of visual states in a control template should use <bpt id=\"p1\">**</bpt>ThemeResource<ept id=\"p1\">**</ept> references whenever there's an underlying resource that might change because of a theme change.","pos":[7492,7676],"source":"The XAML definitions of visual states in a control template should use **ThemeResource** references whenever there's an underlying resource that might change because of a theme change."},{"content":"A system theme change won't typically also cause a visual state change.","pos":[7677,7748]},{"content":"The resources need to use <bpt id=\"p1\">**</bpt>ThemeResource<ept id=\"p1\">**</ept> references in this case so that values can be re-evaluated for the still-active visual state.","pos":[7749,7886],"source":" The resources need to use **ThemeResource** references in this case so that values can be re-evaluated for the still-active visual state."},{"content":"For example, if you have a visual state that changes a brush color of a particular UI part and one of its properties, and that brush color is different per-theme, you should use a <bpt id=\"p1\">**</bpt>ThemeResource<ept id=\"p1\">**</ept> reference for providing that property's value in the default template and also any visual state modification to that default template.","pos":[7887,8219],"source":" For example, if you have a visual state that changes a brush color of a particular UI part and one of its properties, and that brush color is different per-theme, you should use a **ThemeResource** reference for providing that property's value in the default template and also any visual state modification to that default template."},{"content":"<bpt id=\"p1\">**</bpt>ThemeResource<ept id=\"p1\">**</ept> usages might be seen in a series of dependent values.","pos":[8221,8292],"source":"**ThemeResource** usages might be seen in a series of dependent values."},{"content":"For example, a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Color<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/hh673723)</ept> value used by a <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>SolidColorBrush<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br242962)</ept> that is also a keyed resource might use a <bpt id=\"p5\">**</bpt>ThemeResource<ept id=\"p5\">**</ept> reference.","pos":[8293,8544],"source":" For example, a [**Color**](https://msdn.microsoft.com/library/windows/apps/hh673723) value used by a [**SolidColorBrush**](https://msdn.microsoft.com/library/windows/apps/br242962) that is also a keyed resource might use a **ThemeResource** reference."},{"content":"But any UI properties that use the keyed <bpt id=\"p1\">**</bpt>SolidColorBrush<ept id=\"p1\">**</ept> resource would also use a <bpt id=\"p2\">**</bpt>ThemeResource<ept id=\"p2\">**</ept> reference, so that it's specifically each <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>Brush<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br228076)</ept>-type property that's enabling a dynamic value change when the theme changes.","pos":[8545,8838],"source":" But any UI properties that use the keyed **SolidColorBrush** resource would also use a **ThemeResource** reference, so that it's specifically each [**Brush**](https://msdn.microsoft.com/library/windows/apps/br228076)-type property that's enabling a dynamic value change when the theme changes."},{"pos":[8840,9008],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  <ph id=\"ph1\">`{ThemeResource}`</ph> and run-time resource evaluation on theme switching is supported in Windows 8.1 XAML but not supported in XAML for apps targeting Windows 8.","source":"**Note**  `{ThemeResource}` and run-time resource evaluation on theme switching is supported in Windows 8.1 XAML but not supported in XAML for apps targeting Windows 8."},{"content":"System resources","pos":[9014,9030]},{"content":"Some theme resources reference system resource values as an underlying sub-value.","pos":[9032,9113]},{"content":"A system resource is a special resource value that isn't found in any XAML resource dictionary.","pos":[9114,9209]},{"content":"These values rely on behavior in Windows Runtime XAML support to forward values from the system itself, and represent them in a form that a XAML resource can reference.","pos":[9210,9378]},{"content":"For example, there is a system resource named \"SystemColorButtonFaceColor\" that represents an RGB color.","pos":[9379,9483]},{"content":"This color comes from the aspects of system colors and themes that aren't just specific to Windows Runtime and Windows Runtime apps.","pos":[9484,9616]},{"content":"System resources are often the underlying values for a high-contrast theme.","pos":[9618,9693]},{"content":"The user is in control of the color choices for their high-contrast theme, and the user makes these choices using system features that also aren't specific to Windows Runtime apps.","pos":[9694,9874]},{"content":"By referencing the system resources as <bpt id=\"p1\">**</bpt>ThemeResource<ept id=\"p1\">**</ept> references, the default behavior of the high-contrast themes for Windows Runtime apps can use these theme-specific values that are controlled by the user and exposed by the system.","pos":[9875,10112],"source":" By referencing the system resources as **ThemeResource** references, the default behavior of the high-contrast themes for Windows Runtime apps can use these theme-specific values that are controlled by the user and exposed by the system."},{"content":"Also, the references are now marked for re-evaluation if the system detects a run-time theme change.","pos":[10113,10213]},{"content":"An example {ThemeResource} usage","pos":[10219,10251]},{"content":"Here's some example XAML taken from the default generic.xaml and themeresources.xaml files to illustrate how to use <bpt id=\"p1\">**</bpt>ThemeResource<ept id=\"p1\">**</ept>.","pos":[10253,10387],"source":"Here's some example XAML taken from the default generic.xaml and themeresources.xaml files to illustrate how to use **ThemeResource**."},{"content":"We'll look at just one template (the default <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Button<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br209265)</ept>) and how two properties are declared (<bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>Background<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br209395)</ept> and <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>Foreground<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/br209414)</ept>) to be responsive to theme changes.","pos":[10388,10731],"source":" We'll look at just one template (the default [**Button**](https://msdn.microsoft.com/library/windows/apps/br209265)) and how two properties are declared ([**Background**](https://msdn.microsoft.com/library/windows/apps/br209395) and [**Foreground**](https://msdn.microsoft.com/library/windows/apps/br209414)) to be responsive to theme changes."},{"pos":[11028,11345],"content":"Here, the properties take a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Brush<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br228076)</ept> value, and the reference to <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>SolidColorBrush<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br242962)</ept> resources named <ph id=\"ph1\">`ButtonBackgroundThemeBrush`</ph> and <ph id=\"ph2\">`ButtonForegroundThemeBrush`</ph> are made using <bpt id=\"p5\">**</bpt>ThemeResource<ept id=\"p5\">**</ept>.","source":"Here, the properties take a [**Brush**](https://msdn.microsoft.com/library/windows/apps/br228076) value, and the reference to [**SolidColorBrush**](https://msdn.microsoft.com/library/windows/apps/br242962) resources named `ButtonBackgroundThemeBrush` and `ButtonForegroundThemeBrush` are made using **ThemeResource**."},{"content":"These same properties are also adjusted by some of the visual states for a <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Button<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br209265)</ept>.","pos":[11347,11493],"source":"These same properties are also adjusted by some of the visual states for a [**Button**](https://msdn.microsoft.com/library/windows/apps/br209265)."},{"content":"Notably, the background color changes when a button is clicked.","pos":[11494,11557]},{"content":"Here too, the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Background<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br209395)</ept> and <bpt id=\"p3\">[</bpt><bpt id=\"p4\">**</bpt>Foreground<ept id=\"p4\">**</ept><ept id=\"p3\">](https://msdn.microsoft.com/library/windows/apps/br209414)</ept> animations in the visual state storyboard use <bpt id=\"p5\">[</bpt><bpt id=\"p6\">**</bpt>DiscreteObjectKeyFrame<ept id=\"p6\">**</ept><ept id=\"p5\">](https://msdn.microsoft.com/library/windows/apps/br243132)</ept> objects and references to brushes with <bpt id=\"p7\">**</bpt>ThemeResource<ept id=\"p7\">**</ept> as the key frame value.","pos":[11558,11939],"source":" Here too, the [**Background**](https://msdn.microsoft.com/library/windows/apps/br209395) and [**Foreground**](https://msdn.microsoft.com/library/windows/apps/br209414) animations in the visual state storyboard use [**DiscreteObjectKeyFrame**](https://msdn.microsoft.com/library/windows/apps/br243132) objects and references to brushes with **ThemeResource** as the key frame value."},{"content":"Each of these brushes is defined earlier in generic.xaml: they had to be defined prior to any templates using them to avoid XAML forward references.","pos":[12551,12699]},{"content":"Here's those definitions, for the \"Default\" theme dictionary.","pos":[12700,12761]},{"content":"Then each of the other theme dictionaries also has these brushes defined, for example:","pos":[13233,13319]},{"content":"Here the <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Color<ept id=\"p2\">**</ept><ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/br242963)</ept> value is another <bpt id=\"p3\">**</bpt>ThemeResource<ept id=\"p3\">**</ept> reference to a system resource.","pos":[13930,14075],"source":"Here the [**Color**](https://msdn.microsoft.com/library/windows/apps/br242963) value is another **ThemeResource** reference to a system resource."},{"content":"If you reference a system resource, and you want it to change in response to a theme change, you should use <bpt id=\"p1\">**</bpt>ThemeResource<ept id=\"p1\">**</ept> to make the reference.","pos":[14076,14224],"source":" If you reference a system resource, and you want it to change in response to a theme change, you should use **ThemeResource** to make the reference."},{"content":"Windows 8 behavior","pos":[14229,14247]},{"content":"Windows 8 did not support the <bpt id=\"p1\">**</bpt>ThemeResource<ept id=\"p1\">**</ept> markup extension, it is available starting with Windows 8.1.","pos":[14249,14357],"source":"Windows 8 did not support the **ThemeResource** markup extension, it is available starting with Windows 8.1."},{"content":"Also, Windows 8 did not support dynamically switching the theme-related resources for a Windows Runtime app.","pos":[14358,14466]},{"content":"The app had to be restarted in order to pick up the theme change for the XAML templates and styles.","pos":[14467,14566]},{"content":"This isn't a good user experience, so apps are strongly encouraged to recompile and target Windows 8.1 so that they can use styles with <bpt id=\"p1\">**</bpt>ThemeResource<ept id=\"p1\">**</ept> usages and can dynamically switch themes when the user does.","pos":[14567,14781],"source":" This isn't a good user experience, so apps are strongly encouraged to recompile and target Windows 8.1 so that they can use styles with **ThemeResource** usages and can dynamically switch themes when the user does."},{"content":"Apps that were compiled for Windows 8 but running on Windows 8.1 continue to use the Windows 8 behavior.","pos":[14782,14886]},{"pos":[14891,14961],"content":"Design-time tools support for the <bpt id=\"p1\">**</bpt>{ThemeResource}<ept id=\"p1\">**</ept> markup extension","source":"Design-time tools support for the **{ThemeResource}** markup extension"},{"content":"Microsoft Visual Studio 2013 can include possible key values in the Microsoft IntelliSense dropdowns when you use the <bpt id=\"p1\">**</bpt>{ThemeResource}<ept id=\"p1\">**</ept> markup extension in a XAML page.","pos":[14963,15133],"source":"Microsoft Visual Studio 2013 can include possible key values in the Microsoft IntelliSense dropdowns when you use the **{ThemeResource}** markup extension in a XAML page."},{"content":"For example, as soon as you type \"{ThemeResource\", any of the resource keys from the <bpt id=\"p1\">[</bpt>XAML theme resources<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/apps/mt187274)</ept> are displayed.","pos":[15134,15314],"source":" For example, as soon as you type \"{ThemeResource\", any of the resource keys from the [XAML theme resources](https://msdn.microsoft.com/library/windows/apps/mt187274) are displayed."},{"content":"Once a resource key exists as part of any <bpt id=\"p1\">**</bpt>{ThemeResource}<ept id=\"p1\">**</ept> usage, the <bpt id=\"p2\">**</bpt>Go To Definition<ept id=\"p2\">**</ept> (F12) feature can resolve that resource and show you the generic.xaml for design time, where the theme resource is defined.","pos":[15316,15533],"source":"Once a resource key exists as part of any **{ThemeResource}** usage, the **Go To Definition** (F12) feature can resolve that resource and show you the generic.xaml for design time, where the theme resource is defined."},{"content":"Because theme resources are defined more than once (per-theme) <bpt id=\"p1\">**</bpt>Go To Definition<ept id=\"p1\">**</ept> takes you to the first definition found in the file, which is the definition for <bpt id=\"p2\">**</bpt>Default<ept id=\"p2\">**</ept>.","pos":[15534,15711],"source":" Because theme resources are defined more than once (per-theme) **Go To Definition** takes you to the first definition found in the file, which is the definition for **Default**."},{"content":"If you want the other definitions you can search for the key name within the file and find the other themes' definitions.","pos":[15712,15833]},{"content":"Related topics","pos":[15838,15852]},{"content":"ResourceDictionary and XAML resource references","pos":[15857,15904]},{"content":"XAML theme resources","pos":[15967,15987]},{"content":"ResourceDictionary","pos":[16052,16070]},{"content":"x:Key attribute","pos":[16135,16150]}],"content":"---\ndescription: Provides a value for any XAML attribute by evaluating a reference to a resource, with additional system logic that retrieves different resources depending on the currently active theme.\ntitle: {ThemeResource} markup extension'\nms.assetid: 8A1C79D2-9566-44AA-B8E1-CC7ADAD1BCC5\n---\n\n# {ThemeResource} markup extension\n\n\\[ Updated for UWP apps on Windows 10. For Windows 8.x articles, see the [archive](http://go.microsoft.com/fwlink/p/?linkid=619132) \\]\n\nProvides a value for any XAML attribute by evaluating a reference to a resource, with additional system logic that retrieves different resources depending on the currently active theme. Similar to [{StaticResource} markup extension](staticresource-markup-extension.md), resources are defined in a [**ResourceDictionary**](https://msdn.microsoft.com/library/windows/apps/br208794), and a **ThemeResource** usage references the key of that resource in the **ResourceDictionary**.\n\n## XAML attribute usage\n\n``` syntax\n<object property=\"{ThemeResource key}\" .../>\n```\n\n## XAML values\n\n| Term | Description |\n|------|-------------|\n| key | The key for the requested resource. This key is initially assigned by the [**ResourceDictionary**>](https://msdn.microsoft.com/library/windows/apps/br208794). A resource key can be any string defined in the XamlName Grammar. |\n \n## Remarks\n\nA **ThemeResource** is a technique for obtaining values for a XAML attribute that are defined elsewhere in a XAML resource dictionary. The markup extension serves the same basic purpose as the [{StaticResource} markup extension](staticresource-markup-extension.md). The difference in behavior versus {StaticResource} markup extension is that a **ThemeResource** reference can dynamically use different dictionaries as the primary lookup location, depending on which theme is currently being used by the system.\n\nWhen the app first starts, any resource reference made by a **ThemeResource** reference is evaluated based on the theme in use at startup. But if the user subsequently changes the active theme at run-time, the system will re-evaluate every **ThemeResource** reference, retrieve a theme-specific resource that may be different, and redisplay the app with new resource values in all appropriate places in the visual tree. A **StaticResource** is determined at XAML load time / app startup and won't be re-evaluated at run-time. (There are other techniques such as visual states that reload XAML dynamically, but those techniques operate at a higher level that the basic resource evaluation enabled by [{StaticResource} markup extension](staticresource-markup-extension.md)).\n\n**ThemeResource** takes one argument, which specifies the key for the requested resource. A resource key is always a string in Windows Runtime XAML. For more info on how the resource key is initially specified, see [x:Key attribute](x-key-attribute.md).\n\nFor more info on how to define resources and properly use a [**ResourceDictionary**](https://msdn.microsoft.com/library/windows/apps/br208794), including sample code, see [ResourceDictionary and XAML resource references](https://msdn.microsoft.com/library/windows/apps/mt187273).\n\n**Important**  \nAs with **StaticResource**, a **ThemeResource** must not attempt to make a forward reference to a resource that is defined lexically further within the XAML file. Attempting to do so is not supported. Even if the forward reference doesn't fail, trying to make one carries a performance penalty. For best results, adjust the composition of your resource dictionaries so that forward references are avoided.\n\nAttempting to specify a **ThemeResource** to a key that cannot resolve throws a XAML parse exception at run time. Design tools may also offer warnings or errors.\n\nIn the Windows Runtime XAML processor implementation, there is no backing class representation for **ThemeResource**. The closest equivalent in code is to use the collection API of a [**ResourceDictionary**](https://msdn.microsoft.com/library/windows/apps/br208794), for example calling [**Contains**](https://msdn.microsoft.com/library/windows/apps/jj635925) or [**TryGetValue**](https://msdn.microsoft.com/library/windows/apps/jj603139).\n\n**ThemeResource** is a markup extension. Markup extensions are typically implemented when there is a requirement to escape attribute values to be other than literal values or handler names, and the requirement is more global than just putting type converters on certain types or properties. All markup extensions in XAML use the \"{\" and \"}\" characters in their attribute syntax, which is the convention by which a XAML processor recognizes that a markup extension must process the attribute.\n\n### When and how to use {ThemeResource} rather than {StaticResource}\n\nThe rules by which a **ThemeResource** resolves to an item in a resource dictionary are generally the same as **StaticResource**. A **ThemeResource** lookup can extend into the [**ResourceDictionary**](https://msdn.microsoft.com/library/windows/apps/br208794) files that are referenced in a [**ThemeDictionaries**](https://msdn.microsoft.com/library/windows/apps/br208807) collection, but a **StaticResource** can do that also. The difference is that a **ThemeResource** can re-evaluate at run-time and a **StaticResource** can't.\n\nThe set of keys in each theme dictionary should provide the same set of keyed resources no matter which theme is active. If a given keyed resource exists in the **HighContrast** theme dictionary, then another resource with that name should also exist in **Light** and **Default**. If that isn't true, resource lookup might fail when the user switches themes and your app won't look right. It is possible though that a theme dictionary can contain keyed resources that are only referenced from within the same scope to provide sub-values; these don't need to be equivalent in all themes.\n\nIn general you should place resources in theme dictionaries and make references to those resources using **ThemeResource** only when those values can change between themes or are supported by values that change. This is appropriate for these kinds of resources:\n\n-   Brushes, in particular colors for [**SolidColorBrush**](https://msdn.microsoft.com/library/windows/apps/br242962). These make up about 80% of the **ThemeResource** usages in the default XAML control templates (generic.xaml).\n-   Pixel values for borders, offsets, margin and padding and so on.\n-   Font properties such as **FontFamily** or **FontSize**.\n-   Complete templates for a limited number of controls that are usually system-styled and used for dynamic presentation, like [**GridViewItem**](https://msdn.microsoft.com/library/windows/apps/hh738501) and [**ListViewItem**](https://msdn.microsoft.com/library/windows/apps/br242919).\n-   Text display styles (usually to change font color, background, and possibly size).\n\nThe Windows Runtime provides a set of resources that are specifically intended to be referenced by **ThemeResource**. These are all listed as part of the XAML file themeresources.xaml, which is available in the include/winrt/xaml/design folder as part of the Windows Software Development Kit (SDK). For documentation on the theme brushes and additional styles that are defined in themeresources.xaml, see [XAML theme resources](https://msdn.microsoft.com/library/windows/apps/mt187274). The brushes are documented in a table that tells you what color value each brush has for each of the three possible active themes.\n\nThe XAML definitions of visual states in a control template should use **ThemeResource** references whenever there's an underlying resource that might change because of a theme change. A system theme change won't typically also cause a visual state change. The resources need to use **ThemeResource** references in this case so that values can be re-evaluated for the still-active visual state. For example, if you have a visual state that changes a brush color of a particular UI part and one of its properties, and that brush color is different per-theme, you should use a **ThemeResource** reference for providing that property's value in the default template and also any visual state modification to that default template.\n\n**ThemeResource** usages might be seen in a series of dependent values. For example, a [**Color**](https://msdn.microsoft.com/library/windows/apps/hh673723) value used by a [**SolidColorBrush**](https://msdn.microsoft.com/library/windows/apps/br242962) that is also a keyed resource might use a **ThemeResource** reference. But any UI properties that use the keyed **SolidColorBrush** resource would also use a **ThemeResource** reference, so that it's specifically each [**Brush**](https://msdn.microsoft.com/library/windows/apps/br228076)-type property that's enabling a dynamic value change when the theme changes.\n\n**Note**  `{ThemeResource}` and run-time resource evaluation on theme switching is supported in Windows 8.1 XAML but not supported in XAML for apps targeting Windows 8.\n\n### System resources\n\nSome theme resources reference system resource values as an underlying sub-value. A system resource is a special resource value that isn't found in any XAML resource dictionary. These values rely on behavior in Windows Runtime XAML support to forward values from the system itself, and represent them in a form that a XAML resource can reference. For example, there is a system resource named \"SystemColorButtonFaceColor\" that represents an RGB color. This color comes from the aspects of system colors and themes that aren't just specific to Windows Runtime and Windows Runtime apps.\n\nSystem resources are often the underlying values for a high-contrast theme. The user is in control of the color choices for their high-contrast theme, and the user makes these choices using system features that also aren't specific to Windows Runtime apps. By referencing the system resources as **ThemeResource** references, the default behavior of the high-contrast themes for Windows Runtime apps can use these theme-specific values that are controlled by the user and exposed by the system. Also, the references are now marked for re-evaluation if the system detects a run-time theme change.\n\n### An example {ThemeResource} usage\n\nHere's some example XAML taken from the default generic.xaml and themeresources.xaml files to illustrate how to use **ThemeResource**. We'll look at just one template (the default [**Button**](https://msdn.microsoft.com/library/windows/apps/br209265)) and how two properties are declared ([**Background**](https://msdn.microsoft.com/library/windows/apps/br209395) and [**Foreground**](https://msdn.microsoft.com/library/windows/apps/br209414)) to be responsive to theme changes.\n\n```xaml\n    <!-- Default style for Windows.UI.Xaml.Controls.Button -->\n    <Style TargetType=\"Button\">\n        <Setter Property=\"Background\" Value=\"{ThemeResource ButtonBackgroundThemeBrush}\" />\n        <Setter Property=\"Foreground\" Value=\"{ThemeResource ButtonForegroundThemeBrush}\"/>\n...\n```\n\nHere, the properties take a [**Brush**](https://msdn.microsoft.com/library/windows/apps/br228076) value, and the reference to [**SolidColorBrush**](https://msdn.microsoft.com/library/windows/apps/br242962) resources named `ButtonBackgroundThemeBrush` and `ButtonForegroundThemeBrush` are made using **ThemeResource**.\n\nThese same properties are also adjusted by some of the visual states for a [**Button**](https://msdn.microsoft.com/library/windows/apps/br209265). Notably, the background color changes when a button is clicked. Here too, the [**Background**](https://msdn.microsoft.com/library/windows/apps/br209395) and [**Foreground**](https://msdn.microsoft.com/library/windows/apps/br209414) animations in the visual state storyboard use [**DiscreteObjectKeyFrame**](https://msdn.microsoft.com/library/windows/apps/br243132) objects and references to brushes with **ThemeResource** as the key frame value.\n\n```xaml\n<VisualState x:Name=\"Pressed\">\n  <Storyboard>\n    <ObjectAnimationUsingKeyFrames Storyboard.TargetName=\"Border\"\n        Storyboard.TargetProperty=\"Background\">\n      <DiscreteObjectKeyFrame KeyTime=\"0\" Value=\"{ThemeResource ButtonPressedBackgroundThemeBrush}\" />\n    </ObjectAnimationUsingKeyFrames>\n    <ObjectAnimationUsingKeyFrames Storyboard.TargetName=\"ContentPresenter\"\n         Storyboard.TargetProperty=\"Foreground\">\n       <DiscreteObjectKeyFrame KeyTime=\"0\" Value=\"{ThemeResource ButtonPressedForegroundThemeBrush}\" />\n    </ObjectAnimationUsingKeyFrames>\n  </Storyboard>\n</VisualState>\n```\n\nEach of these brushes is defined earlier in generic.xaml: they had to be defined prior to any templates using them to avoid XAML forward references. Here's those definitions, for the \"Default\" theme dictionary.\n\n```xaml\n    <ResourceDictionary.ThemeDictionaries>\n        <ResourceDictionary x:Key=\"Default\">\n... \n            <SolidColorBrush x:Key=\"ButtonBackgroundThemeBrush\" Color=\"Transparent\" />\n            <SolidColorBrush x:Key=\"ButtonForegroundThemeBrush\" Color=\"#FFFFFFFF\" />\n...\n            <SolidColorBrush x:Key=\"ButtonPressedBackgroundThemeBrush\" Color=\"#FFFFFFFF\" />\n            <SolidColorBrush x:Key=\"ButtonPressedForegroundThemeBrush\" Color=\"#FF000000\" />\n...\n```\n\nThen each of the other theme dictionaries also has these brushes defined, for example:\n\n```xaml\n        <ResourceDictionary x:Key=\"HighContrast\">\n            <!-- High Contrast theme resources -->\n...\n            <SolidColorBrush x:Key=\"ButtonBackgroundThemeBrush\" Color=\"{ThemeResource SystemColorButtonFaceColor}\" />\n            <SolidColorBrush x:Key=\"ButtonForegroundThemeBrush\" Color=\"{ThemeResource SystemColorButtonTextColor}\" />\n\n...\n            <SolidColorBrush x:Key=\"ButtonPressedBackgroundThemeBrush\" Color=\"{ThemeResource SystemColorButtonTextColor}\" />\n            <SolidColorBrush x:Key=\"ButtonPressedForegroundThemeBrush\" Color=\"{ThemeResource SystemColorButtonFaceColor}\" />\n```\n\nHere the [**Color**](https://msdn.microsoft.com/library/windows/apps/br242963) value is another **ThemeResource** reference to a system resource. If you reference a system resource, and you want it to change in response to a theme change, you should use **ThemeResource** to make the reference.\n\n## Windows 8 behavior\n\nWindows 8 did not support the **ThemeResource** markup extension, it is available starting with Windows 8.1. Also, Windows 8 did not support dynamically switching the theme-related resources for a Windows Runtime app. The app had to be restarted in order to pick up the theme change for the XAML templates and styles. This isn't a good user experience, so apps are strongly encouraged to recompile and target Windows 8.1 so that they can use styles with **ThemeResource** usages and can dynamically switch themes when the user does. Apps that were compiled for Windows 8 but running on Windows 8.1 continue to use the Windows 8 behavior.\n\n## Design-time tools support for the **{ThemeResource}** markup extension\n\nMicrosoft Visual Studio 2013 can include possible key values in the Microsoft IntelliSense dropdowns when you use the **{ThemeResource}** markup extension in a XAML page. For example, as soon as you type \"{ThemeResource\", any of the resource keys from the [XAML theme resources](https://msdn.microsoft.com/library/windows/apps/mt187274) are displayed.\n\nOnce a resource key exists as part of any **{ThemeResource}** usage, the **Go To Definition** (F12) feature can resolve that resource and show you the generic.xaml for design time, where the theme resource is defined. Because theme resources are defined more than once (per-theme) **Go To Definition** takes you to the first definition found in the file, which is the definition for **Default**. If you want the other definitions you can search for the key name within the file and find the other themes' definitions.\n\n## Related topics\n\n* [ResourceDictionary and XAML resource references](https://msdn.microsoft.com/library/windows/apps/mt187273)\n* [XAML theme resources](https://msdn.microsoft.com/library/windows/apps/mt187274)\n* [**ResourceDictionary**](https://msdn.microsoft.com/library/windows/apps/br208794)\n* [x:Key attribute](x-key-attribute.md)\n \n\n"}